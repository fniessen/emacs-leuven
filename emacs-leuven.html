<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta name="generator" content="HTML Tidy for Cygwin (vers 1st September 2004), see www.w3.org" />
<title>Leuven Emacs Config</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Org-mode" />
<meta name="author" content="Fabrice Niessen" />
<meta name="keywords" content="emacs, dotfile, config" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" type="text/css" href="d:/Users/fni/src/org-html-themes/styles/readtheorg/css/htmlize.css" />
<link rel="stylesheet" type="text/css" href="d:/Users/fni/src/org-html-themes/styles/readtheorg/css/readtheorg.css" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js" type="text/javascript">
</script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js" type="text/javascript">
</script>
<script type="text/javascript" src="d:/Users/fni/src/org-html-themes/styles/lib/js/jquery.stickytableheaders.js">
</script>
<script type="text/javascript" src="d:/Users/fni/src/org-html-themes/styles/readtheorg/js/readtheorg.js">
</script>
<style type="text/css">
/*<![CDATA[*/
 p.c2 {font-weight: bold}
 dd.c1 {font-weight: bold}
/*]]>*/
</style>
</head>
<body>
<div id="content">
<h1 class="title">Leuven Emacs Config</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgheadline1">Description</a></li>
<li><a href="#orgheadline2">Header</a></li>
<li><a href="#orgheadline3">Code</a></li>
<li><a href="#orgheadline4">Loading Libraries of Lisp Code for Emacs</a>
<ul>
<li><a href="#orgheadline5">Creating and selecting buffers</a></li>
</ul>
</li>
<li><a href="#orgheadline6">Environment</a></li>
<li><a href="#orgheadline7">Debugging</a></li>
<li><a href="#orgheadline8">Emacs Lisp Packages</a>
<ul>
<li><a href="#orgheadline9">The Package Menu Buffer</a></li>
<li><a href="#orgheadline10">Package Installation</a></li>
</ul>
</li>
<li><a href="#orgheadline11">The Organization of the Screen</a></li>
<li><a href="#orgheadline12">Exiting Emacs</a></li>
<li><a href="#orgheadline13">Basic Editing Commands</a>
<ul>
<li><a href="#orgheadline14">Inserting Text</a></li>
<li><a href="#orgheadline15">Moving Point Location</a></li>
<li><a href="#orgheadline16">Basic Undoing Changes</a></li>
</ul>
</li>
<li><a href="#orgheadline17">The Minibuffer</a>
<ul>
<li><a href="#orgheadline18">Editing in the Minibuffer</a></li>
<li><a href="#orgheadline19">Completion</a></li>
<li><a href="#orgheadline20">Repeating Minibuffer Commands</a></li>
</ul>
</li>
<li><a href="#orgheadline21">Help</a>
<ul>
<li><a href="#orgheadline22">Help Summary</a></li>
<li><a href="#orgheadline23">Apropos</a></li>
<li><a href="#orgheadline24">Misc Help Commands</a></li>
</ul>
</li>
<li><a href="#orgheadline25">The Mark and the Region</a>
<ul>
<li><a href="#orgheadline26">Setting the Mark</a></li>
<li><a href="#orgheadline27">Commands to Mark Textual Objects</a></li>
<li><a href="#orgheadline28">Operating on the Region</a></li>
<li><a href="#orgheadline29">Shift Selection</a></li>
<li><a href="#orgheadline30">Multiple selections</a></li>
</ul>
</li>
<li><a href="#orgheadline35">Killing and Moving Text</a>
<ul>
<li><a href="#orgheadline36">Deletion and Killing</a></li>
<li><a href="#orgheadline37">Yanking</a></li>
<li><a href="#orgheadline40">Cutting and Pasting on Graphical Displays</a></li>
<li><a href="#orgheadline41">Rectangles</a></li>
<li><a href="#orgheadline42">CUA Bindings</a></li>
</ul>
</li>
<li><a href="#orgheadline43">Registers</a>
<ul>
<li><a href="#orgheadline44">Saving Positions in Registers</a></li>
<li><a href="#orgheadline45">Bookmarks</a></li>
<li><a href="#orgheadline46">Ace Jump</a></li>
</ul>
</li>
<li><a href="#orgheadline47">Controlling the Display</a>
<ul>
<li><a href="#orgheadline48">Scrolling</a></li>
<li><a href="#orgheadline49">Automatic Scrolling</a></li>
<li><a href="#orgheadline50">Horizontal Scrolling</a></li>
<li><a href="#orgheadline51">Narrowing</a></li>
<li><a href="#orgheadline52">Font Lock mode</a></li>
<li><a href="#orgheadline53">Interactive Highlighting</a></li>
<li><a href="#orgheadline54">Window Fringes</a></li>
<li><a href="#orgheadline55">Displaying Boundaries</a></li>
<li><a href="#orgheadline56">Useless Whitespace</a></li>
<li><a href="#orgheadline57">Selective Display</a></li>
<li><a href="#orgheadline58">Optional Mode Line Features</a></li>
<li><a href="#orgheadline59">Displaying the Cursor</a></li>
<li><a href="#orgheadline60">Truncation of Lines</a></li>
<li><a href="#orgheadline61">Customization of Display</a></li>
</ul>
</li>
<li><a href="#orgheadline62">Searching and Replacement</a>
<ul>
<li><a href="#orgheadline63">Incremental Search (aka "Live Search")</a></li>
<li><a href="#orgheadline64">Symbol Search</a></li>
<li><a href="#orgheadline65">Regexp Search</a></li>
<li><a href="#orgheadline66">Search Case</a></li>
<li><a href="#orgheadline67">Replacement Commands</a></li>
<li><a href="#orgheadline68">Other Search-and-Loop Commands</a></li>
</ul>
</li>
<li><a href="#orgheadline69">Commands for Fixing Typos</a>
<ul>
<li><a href="#orgheadline70">Checking and Correcting Spelling</a></li>
</ul>
</li>
<li><a href="#orgheadline71">Keyboard Macros</a>
<ul>
<li><a href="#orgheadline72">Basic Use</a></li>
<li><a href="#orgheadline73">Naming and Saving Keyboard Macros</a></li>
</ul>
</li>
<li><a href="#orgheadline74">Files Handling</a>
<ul>
<li><a href="#orgheadline75">Visiting Files</a></li>
<li><a href="#orgheadline76">Saving Files</a></li>
<li><a href="#orgheadline77">Reverting a Buffer</a></li>
<li><a href="#orgheadline78">Auto Reverting Non-File Buffers</a></li>
<li><a href="#orgheadline79">Auto-Saving: Protection Against Disasters</a></li>
<li><a href="#orgheadline80">Comparing Files</a></li>
<li><a href="#orgheadline81">Diff mode</a></li>
<li><a href="#orgheadline82">Miscellaneous File Operations</a></li>
<li><a href="#orgheadline83">Accessing Compressed Files</a></li>
<li><a href="#orgheadline84">Auto Encryption</a></li>
<li><a href="#orgheadline85">Remote Files</a></li>
<li><a href="#orgheadline89">Convenience Features for Finding Files</a></li>
</ul>
</li>
<li><a href="#orgheadline99">Using Multiple Buffers</a>
<ul>
<li><a href="#orgheadline100">Listing Existing Buffers</a></li>
<li><a href="#orgheadline101">Killing Buffers</a></li>
<li><a href="#orgheadline102">Operating on Several Buffers</a></li>
<li><a href="#orgheadline103">Convenience Features and Customization of Buffer Handling</a></li>
</ul>
</li>
<li><a href="#orgheadline104">Multiple Windows</a>
<ul>
<li><a href="#orgheadline105">Concepts of Emacs Windows</a></li>
<li><a href="#orgheadline106">Using Other Windows</a></li>
<li><a href="#orgheadline107">Deleting and Rearranging Windows</a></li>
<li><a href="#orgheadline108">Displaying a Buffer in a Window</a></li>
<li><a href="#orgheadline109">Window Handling Convenience Features and Customization</a></li>
</ul>
</li>
<li><a href="#orgheadline110">Frames and Graphical Displays</a>
<ul>
<li><a href="#orgheadline111">Mouse Commands for Editing</a></li>
<li><a href="#orgheadline112">Creating Frames</a></li>
<li><a href="#orgheadline113">Frame Commands</a></li>
<li><a href="#orgheadline114">Speedbar Frames</a></li>
<li><a href="#orgheadline115">Scroll Bars</a></li>
<li><a href="#orgheadline116">Tool Bars</a></li>
<li><a href="#orgheadline117">Using Dialog Boxes</a></li>
<li><a href="#orgheadline118">Tooltips</a></li>
</ul>
</li>
<li><a href="#orgheadline119">International Character Set Support</a>
<ul>
<li><a href="#orgheadline120">Language Environments</a></li>
<li><a href="#orgheadline121">Input Methods</a></li>
<li><a href="#orgheadline122">Recognizing Coding Systems</a></li>
<li><a href="#orgheadline123">Specifying a File's Coding System</a></li>
<li><a href="#orgheadline124">Bidirectional Editing</a></li>
</ul>
</li>
<li><a href="#orgheadline125">Major and Minor Modes</a>
<ul>
<li><a href="#orgheadline126">How Major Modes are Chosen</a></li>
</ul>
</li>
<li><a href="#orgheadline130">Indentation</a>
<ul>
<li><a href="#orgheadline131">Indentation Commands</a></li>
<li><a href="#orgheadline132">Tabs vs. Spaces</a></li>
</ul>
</li>
<li><a href="#orgheadline133">Commands for Human Languages</a>
<ul>
<li><a href="#orgheadline134">Words</a></li>
<li><a href="#orgheadline135">Sentences</a></li>
<li><a href="#orgheadline136">Filling Text</a></li>
<li><a href="#orgheadline137">Case Conversion Commands</a></li>
<li><a href="#orgheadline138">Outline Mode</a></li>
<li><a href="#orgheadline146">Boxquote</a></li>
<li><a href="#orgheadline147">Phonetic</a></li>
</ul>
</li>
<li><a href="#orgheadline148">Org Mode (Getting Things Done)</a>
<ul>
<li><a href="#orgheadline150">Document Structure</a></li>
<li><a href="#orgheadline158">Tables</a></li>
<li><a href="#orgheadline159">Hyperlinks</a></li>
<li><a href="#orgheadline163">"TODO" Items</a></li>
<li><a href="#orgheadline168">Tags</a></li>
<li><a href="#orgheadline169">Properties and Columns</a></li>
<li><a href="#orgheadline170">Dates and Times</a></li>
<li><a href="#orgheadline185">Capture - Refile - Archive</a></li>
<li><a href="#orgheadline186">Agenda Views</a></li>
<li><a href="#orgheadline202">Markup for rich export</a></li>
<li><a href="#orgheadline206">Exporting</a></li>
<li><a href="#orgheadline213">Publishing</a></li>
<li><a href="#orgheadline216">Working With Source Code</a></li>
<li><a href="#orgheadline222">Miscellaneous</a></li>
<li><a href="#orgheadline232">Other</a></li>
<li><a href="#orgheadline233">A.3 Adding hyperlink types</a></li>
<li><a href="#orgheadline234">A.5 Tables and lists in arbitrary syntax</a></li>
<li><a href="#orgheadline235">A.6 Dynamic blocks</a></li>
<li><a href="#orgheadline239">Org-contrib</a></li>
</ul>
</li>
<li><a href="#orgheadline240">TeX</a>
<ul>
<li><a href="#orgheadline241">Native TeX Mode</a></li>
<li><a href="#orgheadline242">AUCTeX</a></li>
<li><a href="#orgheadline243">Preview-LaTeX</a></li>
<li><a href="#orgheadline244">RefTeX</a></li>
<li><a href="#orgheadline245">BibTeX</a></li>
</ul>
</li>
<li><a href="#orgheadline246">SGML and HTML Modes</a>
<ul>
<li><a href="#orgheadline249">HTML</a></li>
<li><a href="#orgheadline251">XHTML</a></li>
<li><a href="#orgheadline252">web-mode</a></li>
<li><a href="#orgheadline250">XML</a></li>
<li><a href="#orgheadline253">Highlight the closing tag</a></li>
<li><a href="#orgheadline254">CSS</a></li>
<li><a href="#orgheadline255">Skewer: live web development with Emacs</a></li>
</ul>
</li>
<li><a href="#orgheadline256">Editing Programs</a>
<ul>
<li><a href="#orgheadline257">Major Modes for Programming Languages</a></li>
<li><a href="#orgheadline258">Top-Level Definitions, or Defuns</a></li>
<li><a href="#orgheadline259">Indentation for Programs</a></li>
<li><a href="#orgheadline260">Commands for Editing with Parentheses</a></li>
<li><a href="#orgheadline263">Manipulating Comments</a></li>
<li><a href="#orgheadline264">Documentation Lookup</a></li>
<li><a href="#orgheadline139">Hideshow minor mode</a></li>
<li><a href="#orgheadline266">Completion for Symbol Names</a></li>
<li><a href="#orgheadline267">Glasses minor mode</a></li>
<li><a href="#orgheadline268">Other Features Useful for Editing Programs</a></li>
</ul>
</li>
<li><a href="#orgheadline269">Compiling and Testing Programs</a>
<ul>
<li><a href="#orgheadline270">Running Compilations under Emacs</a></li>
<li><a href="#orgheadline271">Compilation Mode</a></li>
<li><a href="#orgheadline272">Searching with Grep under Emacs</a></li>
<li><a href="#orgheadline273">Finding Syntax Errors On The Fly</a></li>
<li><a href="#orgheadline274">Running Debuggers Under Emacs</a></li>
<li><a href="#orgheadline275">Debugging Lisp programs</a></li>
<li><a href="#orgheadline276">Executing Lisp Expressions</a></li>
<li><a href="#orgheadline277">Libraries of Lisp Code for Emacs</a></li>
<li><a href="#orgheadline278">Evaluating Emacs Lisp Expressions</a></li>
<li><a href="#orgheadline279">Lisp Interaction Buffers (<code>*scratch*</code>)</a></li>
</ul>
</li>
<li><a href="#orgheadline280">Maintaining Programs</a>
<ul>
<li><a href="#orgheadline281">Version Control</a></li>
<li><a href="#orgheadline289">Change Logs</a></li>
<li><a href="#orgheadline291">Tags Tables (navigating code)</a></li>
<li><a href="#orgheadline299">Emacs Development Environment</a></li>
</ul>
</li>
<li><a href="#orgheadline300">Abbrevs</a>
<ul>
<li><a href="#orgheadline301">Controlling Abbrev Expansion</a></li>
<li><a href="#orgheadline265">Dynamic Abbrev Expansion</a></li>
</ul>
</li>
<li><a href="#orgheadline318">Dired, the Directory Editor</a>
<ul>
<li><a href="#orgheadline319">Entering Dired</a></li>
<li><a href="#orgheadline320">30.2 Navigation in the Dired Buffer</a></li>
<li><a href="#orgheadline321">Deleting Files with Dired</a></li>
<li><a href="#orgheadline322">Visiting Files in Dired</a></li>
<li><a href="#orgheadline328">Operating on Files</a></li>
<li><a href="#orgheadline329">Updating the Dired Buffer</a></li>
<li><a href="#orgheadline330">Dired and <code>find</code></a></li>
<li><a href="#orgheadline331">Editing the Dired Buffer</a></li>
<li><a href="#orgheadline332">Viewing Image Thumbnails in Dired</a></li>
<li><a href="#orgheadline333">Dired Extra</a></li>
<li><a href="#orgheadline334">Dired+</a></li>
<li><a href="#orgheadline335">Emulation of <code>ls</code> on MS-Windows</a></li>
</ul>
</li>
<li><a href="#orgheadline336">The Calendar and the Diary</a>
<ul>
<li><a href="#orgheadline337">Calendar Motion</a></li>
<li><a href="#orgheadline338">Scroll Calendar</a></li>
<li><a href="#orgheadline339">Times of Sunrise/Sunset</a></li>
<li><a href="#orgheadline340">Diary</a></li>
<li><a href="#orgheadline341">Appointments</a></li>
<li><a href="#orgheadline342">Advanced Calendar/Diary Usage</a></li>
<li><a href="#orgheadline343">Calendar framework</a></li>
</ul>
</li>
<li><a href="#orgheadline344">Sending Mail</a></li>
<li><a href="#orgheadline345">Gnus</a>
<ul>
<li><a href="#orgheadline346">BBDB</a></li>
</ul>
</li>
<li><a href="#orgheadline351">Document Viewing</a>
<ul>
<li><a href="#orgheadline352">Navigation</a></li>
<li><a href="#orgheadline353">Conversion</a></li>
<li><a href="#orgheadline354">XXX</a></li>
</ul>
</li>
<li><a href="#orgheadline357">Web Browsing</a>
<ul>
<li><a href="#orgheadline355">Emacs-w3m</a></li>
<li><a href="#orgheadline356">EWW (Emacs Web Browser)</a></li>
</ul>
</li>
<li><a href="#orgheadline358">Running Shell Commands from Emacs</a>
<ul>
<li><a href="#orgheadline359">Single Shell</a></li>
<li><a href="#orgheadline360">Interactive Shell</a></li>
<li><a href="#orgheadline365">Shell Mode</a></li>
<li><a href="#orgheadline366">Shell Prompts</a></li>
<li><a href="#orgheadline367">History</a></li>
<li><a href="#orgheadline370">Directory Tracking</a></li>
<li><a href="#orgheadline371">Options</a></li>
<li><a href="#orgheadline372">Terminal emulator</a></li>
<li><a href="#orgheadline374">Term Mode</a></li>
<li><a href="#orgheadline375">Remote Host</a></li>
<li><a href="#orgheadline376">Serial Terminal</a></li>
<li><a href="#orgheadline377">Helper for GNU Emacs on w32</a></li>
<li><a href="#orgheadline378">Helper for Cygwin Emacs</a></li>
<li><a href="#orgheadline379">Emacs Speaks Statistics (ESS)</a></li>
<li><a href="#orgheadline395">Proced</a></li>
</ul>
</li>
<li><a href="#orgheadline396">Using Emacs Server</a></li>
<li><a href="#orgheadline397">Printing Hard Copies</a></li>
<li><a href="#orgheadline398">Sorting Text</a></li>
<li><a href="#orgheadline399">Saving Emacs Sessions</a></li>
<li><a href="#orgheadline400">Hyperlinking and Navigation Features</a>
<ul>
<li><a href="#orgheadline401">Following URLs</a></li>
<li><a href="#orgheadline402">Finding Files and URLs at Point</a></li>
<li><a href="#orgheadline403">Google search</a></li>
<li><a href="#orgheadline404">Babel translator</a></li>
</ul>
</li>
<li><a href="#orgheadline405">Other Amusements</a></li>
<li><a href="#orgheadline406">Customization</a>
<ul>
<li><a href="#orgheadline407">Color</a></li>
<li><a href="#orgheadline408">Color theme</a></li>
<li><a href="#orgheadline409">Not sorted</a></li>
<li><a href="#orgheadline410">Variables</a></li>
<li><a href="#orgheadline411">Key Bindings</a></li>
<li><a href="#orgheadline412">Syntax Table</a></li>
</ul>
</li>
<li><a href="#orgheadline413">Emacs Display</a>
<ul>
<li><a href="#orgheadline414">Faces</a></li>
<li><a href="#orgheadline282">Images</a></li>
</ul>
</li>
<li><a href="#orgheadline418">Calc</a>
<ul>
<li><a href="#orgheadline421">Introduction</a></li>
<li><a href="#orgheadline422">Embedded Mode</a></li>
</ul>
</li>
<li><a href="#orgheadline423">IRC client for Emacs</a></li>
<li><a href="#orgheadline424">Emacs and Microsoft Windows/MS-DOS</a></li>
<li><a href="#orgheadline425">Profiler</a></li>
<li><a href="#orgheadline426">Reporting Bugs</a></li>
<li><a href="#orgheadline427">Leuven</a>
<ul>
<li><a href="#orgheadline428">Feature</a></li>
<li><a href="#orgheadline429">File Local Variables</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-orgheadline1" class="outline-2">
<h2 id="orgheadline1">Description</h2>
<div class="outline-text-2" id="text-orgheadline1">
<p>Emacs can be very difficult for the beginner, as many of the default choices may seem (and sometimes are) ugly or awkward.</p>
<p>But - that's the joy of Emacs - nearly everything can be adjusted! Hence, this set of customizations to "short-cut" that initial process.</p>
</div>
</div>
<div id="outline-container-orgheadline2" class="outline-2">
<h2 id="orgheadline2">Header</h2>
<div class="outline-text-2" id="text-orgheadline2">
<div class="org-src-container">
<pre class="src src-emacs-lisp" id="orgsrcblock1">
(format-time-string <span class="org-string">"%Y%m%d.%H%M"</span>)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;; </span><span class="org-comment">emacs-leuven.el --- Emacs configuration file with more pleasant defaults</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Copyright (C) 1999-2015 Fabrice Niessen</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Author: Fabrice Niessen &lt;(concat "fniessen" at-sign "pirilampo.org")&gt;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">URL: https://github.com/fniessen/emacs-leuven</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Version: 20150519.1103</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Keywords: emacs, dotfile, config</span>

<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;;    </span><span class="org-comment">___ _ __ ___   __ _  ___ ___</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">/ _ \ '_ ` _ \ / _` |/ __/ __|</span>
<span class="org-comment-delimiter">;;  </span><span class="org-comment">|  __/ | | | | | (_| | (__\__ \</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(_)___|_| |_| |_|\__,_|\___|___/</span>
<span class="org-comment-delimiter">;;</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">This file is NOT part of GNU Emacs.</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">This file is free software: you can redistribute it and/or</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">modify it under the terms of the GNU General Public License as</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">published by the Free Software Foundation, either version 3 of</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">the License, or (at your option) any later version.</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">This file is distributed in the hope that it will be useful,</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">GNU General Public License for more details.</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">You should have received a copy of the GNU General Public License</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">along with this file. If not, see <a href="http://www.gnu.org/licenses/">&lt;http://www.gnu.org/licenses/&gt;</a>.</span>

<span class="org-comment-delimiter">;;; </span><span class="org-comment">Commentary:</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Emacs configuration file with many packages already enabled and a more</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">pleasant set of defaults.</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Operating systems: supposed to work both for Windows and for Linux.</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Minimal .emacs configuration file:</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;;     </span><span class="org-comment">(add-to-list 'load-path "/path/to/emacs-leuven/")</span>
<span class="org-comment-delimiter">;;     </span><span class="org-comment">(require 'emacs-leuven)</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">To get more debug info about the packages getting loaded, add the following</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">line before requiring Leuven Emacs Config.</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;;     </span><span class="org-comment">;; show messages describing progress of loading Leuven Emacs Config</span>
<span class="org-comment-delimiter">;;     </span><span class="org-comment">(setq leuven-load-verbose t)</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">To avoid be questioned about packages to add to your local Emacs</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">installation (though, I think you should install them), add the following</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">line before requiring Leuven Emacs Config.</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;;     </span><span class="org-comment">;; do not (try to) install extra Emacs packages</span>
<span class="org-comment-delimiter">;;     </span><span class="org-comment">(setq leuven-elpa-packages nil)</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">For help on the Emacs Editor, see (info "(emacs)")  &lt;== `C-x C-e' here!</span>

<span class="org-comment-delimiter">;;; </span><span class="org-comment">Citations:</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">- Show me your ~/.emacs and I will tell you who you are.</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">-- Bogdan Maryniuk</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">- Emacs is like a laser guided missile.  It only has to be slightly</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">mis-configured to ruin your whole day.</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">-- Sean McGrath</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">- While any text editor can save your files, only Emacs can save your soul.</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">-- Per Abrahamsen</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline3" class="outline-2">
<h2 id="orgheadline3">Code</h2>
<div class="outline-text-2" id="text-orgheadline3">
<p>Some things are "activated" by default in <code>lisp/loaddefs.el</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;; </span><span class="org-comment">Code:</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">This file is only provided as an example.  Customize it to your own taste!</span>

(<span class="org-keyword">defconst</span> <span class="org-variable-name">leuven--emacs-version</span> <span class="org-string">"20150519.1103"</span>
  <span class="org-doc">"Leuven Emacs Config version (date of the last change)."</span>)

(message <span class="org-string">"* --[ Loading Leuven Emacs Config %s]--"</span> leuven--emacs-version)

<span class="org-comment-delimiter">;; </span><span class="org-comment">Turn on Common Lisp support.</span>
(<span class="org-keyword">eval-when-compile</span> (<span class="org-keyword">require</span> '<span class="org-constant">cl</span>))       <span class="org-comment-delimiter">; </span><span class="org-comment">Provide useful things like `</span><span class="org-constant"><span class="org-comment">setf</span></span><span class="org-comment">'.</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Uptimes.</span>
(<span class="org-keyword">when</span> (string-match <span class="org-string">"XEmacs"</span> (version))
  <span class="org-comment-delimiter">;; </span><span class="org-comment">XEmacs doesn't have `</span><span class="org-constant"><span class="org-comment">float-time</span></span><span class="org-comment">'.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">float-time</span> ()
    <span class="org-doc">"Convert `</span><span class="org-constant"><span class="org-doc">current-time</span></span><span class="org-doc">' to a floating point number."</span>
    (multiple-value-bind (s0 s1 s2) (current-time)
      (+ (* (float (ash 1 16)) s0) (float s1) (* 0.0000001 s2)))))

(<span class="org-keyword">defconst</span> <span class="org-variable-name">leuven--before-time</span> (float-time)
  <span class="org-doc">"Value of `</span><span class="org-constant"><span class="org-doc">float-time</span></span><span class="org-doc">' before loading the Leuven Emacs Config library."</span>)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">defmacro</span> <span class="org-function-name">measure-time</span> (message <span class="org-type">&amp;rest</span> body)
  <span class="org-doc">"Measure the time it takes to evaluate BODY."</span>
  `(<span class="org-keyword">let</span> ((time (current-time)))
     ,@body
     (message <span class="org-string">"__%s (in %.02f s)___________________________"</span>
              ,message (float-time (time-since time)))))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;; </span><span class="org-comment">User Customizable Internal Variables</span>

(<span class="org-keyword">defgroup</span> <span class="org-type">leuven</span> nil
  <span class="org-doc">"Set of Emacs customizations (better defaults)."</span>
  <span class="org-builtin">:group</span> 'convenience
  <span class="org-builtin">:group</span> 'text)

(<span class="org-keyword">defcustom</span> <span class="org-variable-name">leuven-load-verbose</span> nil
  <span class="org-doc">"If non-nil, means show messages describing progress of loading Leuven Emacs Config."</span>
  <span class="org-builtin">:group</span> 'emacs-leuven
  <span class="org-builtin">:type</span> 'integer)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">when</span> (and (string-match <span class="org-string">"GNU Emacs"</span> (version))
           leuven-load-verbose)
  (<span class="org-keyword">defadvice</span> <span class="org-function-name">message</span> (before leuven-when-was-that activate)
    <span class="org-doc">"Add time stamps to `</span><span class="org-constant"><span class="org-doc">message</span></span><span class="org-doc">' output."</span>
    (ad-set-arg 0 (concat (format-time-string <span class="org-string">"[%Y-%m-%d %T."</span>)
                          (substring (format-time-string <span class="org-string">"%N"</span>) 0 3)
                          (format-time-string <span class="org-string">"] "</span>)
                          (ad-get-arg 0)))))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;; </span><span class="org-comment">Allow quick include/exclude of setup parts -- DO NOT EDIT the DEFVAR!</span>
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-0-environment</span> t) <span class="org-comment-delimiter">; </span><span class="org-comment">required</span>
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-0-loading-libraries</span> t) <span class="org-comment-delimiter">; </span><span class="org-comment">required</span>
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-0-debugging</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-47-packages</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-1-screen</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-6-exiting</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-7-basic</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-8-minibuffer</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-10-help</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-11-mark</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-12-killing</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-13-registers</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-14-display</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-15-search</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-16-fixit</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-17-keyboard-macros</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-18-files</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-19-buffers</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-20-windows</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-21-frames</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-22-international</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-23-major-and-minor-modes</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-24-indentation</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-25-text</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-25.9-org-mode</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-25.10-tex-mode</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-26-programs</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-27-building</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-28-maintaining</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-29-abbrevs</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-30-dired</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-31-calendar-diary</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-32-sending-mail</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-34-gnus</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-35-document-view</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-36-shell</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-37-emacs-server</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-38-printing</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-39-sorting</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-42-saving-emacs-sessions</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-45-hyperlinking</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-46-amusements</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-48-customization</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-AppG-ms-dos</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-XX-emacs-display</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-99-debugging</span> t)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven--load-times-list</span> nil
  <span class="org-doc">"List of chapters and time to load them."</span>)

(<span class="org-keyword">defmacro</span> <span class="org-function-name">leuven--chapter</span> (chapterid chaptername <span class="org-type">&amp;rest</span> body)
  <span class="org-doc">"When CHAPTERID is not nil, report as CHAPTERNAME the evaluation of BODY.</span>
<span class="org-doc">Save execution times in the global list `</span><span class="org-constant"><span class="org-doc">leuven--load-times-list</span></span><span class="org-doc">'."</span>
  `(<span class="org-keyword">when</span> ,chapterid
     (<span class="org-keyword">let</span> (before-chapter-time
           this-chapter-time)
       (<span class="org-keyword">when</span> leuven-load-verbose
         (message <span class="org-string">"** %s"</span> ,chaptername))
       (setq before-chapter-time (float-time))
       (setq leuven--before-section-time (float-time)) <span class="org-comment-delimiter">; </span><span class="org-comment">Init section time.</span>
       (<span class="org-keyword">progn</span> ,@body)
       (leuven--section (concat <span class="org-string">"["</span> ,chaptername <span class="org-string">" ends here]"</span>) 'end-of-chapter)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Add fake closing section.</span>
       (setq this-chapter-time
             (format <span class="org-string">"%.3f"</span> (- (float-time) before-chapter-time)))
       (add-to-list 'leuven--load-times-list
                    (concat <span class="org-string">"| "</span> ,chaptername <span class="org-string">" "</span>
                            <span class="org-string">"| "</span> this-chapter-time <span class="org-string">" |"</span>)))))

(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven--before-section-time</span> (float-time)
  <span class="org-doc">"Value of `</span><span class="org-constant"><span class="org-doc">float-time</span></span><span class="org-doc">' before loading some section."</span>)

(<span class="org-keyword">defun</span> <span class="org-function-name">leuven--section</span> (sectionname <span class="org-type">&amp;optional</span> end-of-chapter)
  <span class="org-doc">"Report under SECTIONNAME the time taken since it was last saved.</span>
<span class="org-doc">Last time is saved in global variable `</span><span class="org-constant"><span class="org-doc">leuven--before-section-time</span></span><span class="org-doc">'."</span>
  (<span class="org-keyword">let</span> ((this-section-time (- (float-time)
                              leuven--before-section-time)))
    (<span class="org-keyword">when</span> leuven-load-verbose
      (<span class="org-keyword">when</span> (not (equal this-section-time 0.000))
        (message <span class="org-string">"    Section time: %.3f s"</span> this-section-time))
      (<span class="org-keyword">unless</span> end-of-chapter (message <span class="org-string">"*** %s"</span> sectionname)))
    <span class="org-comment-delimiter">;; </span><span class="org-comment">For next one.</span>
    (setq leuven--before-section-time (float-time))))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline4" class="outline-2">
<h2 id="orgheadline4">Loading Libraries of Lisp Code for Emacs</h2>
<div class="outline-text-2" id="text-orgheadline4">
<p>Adding the right Lisp directories to your <code>load-path</code> (list of directories where Emacs Lisp libraries - <code>.el</code> and <code>.elc</code> files - are installed) must be the very <b>first thing</b> in your <code>.emacs</code> file, before the first time packages are required, to make sure that you're not picking up bits and pieces from older files (bundled with Emacs, and loaded before the path to the <b>newest</b> versions are set).</p>
<p>The most important directories are the last to be added to <code>load-path</code> (so that they become the first of the list)!</p>
<p>Use <code>M-x list-load-path-shadows &lt;RET&gt;</code> to display a list of external Emacs Lisp files that shadow Emacs builtins (listing potential load path problems).</p>
<p>Some Emacs modes are over 10K lines of code (e.g. <code>nxml-mode</code>, <code>CEDET</code>). Many packages (e.g. <code>Org</code>, <code>Gnus</code>) make use of the <code>autoload</code> feature, so that you only need to load a single file that define autoloaded functions.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* Loading Libraries of Lisp Code for Emacs</span>

(leuven--chapter leuven-load-chapter-0-loading-libraries <span class="org-string">"0 Loading Libraries"</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Load-path enhancement.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-add-to-load-path</span> (this-directory)
    <span class="org-doc">"Add THIS-DIRECTORY at the beginning of the load-path, if it exists."</span>
    (<span class="org-keyword">when</span> (and this-directory
               (file-directory-p this-directory))
      <span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment"> Add warning if directory does not exist</span>
      (<span class="org-keyword">let*</span> ((this-directory (expand-file-name this-directory)))

        <span class="org-comment-delimiter">;; </span><span class="org-comment">directories containing a `</span><span class="org-constant"><span class="org-comment">.nosearch</span></span><span class="org-comment">' file (such as</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">`auctex-11.87\style') should not made part of `</span><span class="org-constant"><span class="org-comment">load-path</span></span><span class="org-comment">'.</span>
        <span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment"> `</span><span class="org-constant"><span class="org-comment">RCS</span></span><span class="org-comment">' and `</span><span class="org-constant"><span class="org-comment">CVS</span></span><span class="org-comment">' directories should also be excluded.</span>
        (<span class="org-keyword">unless</span> (file-exists-p (concat this-directory <span class="org-string">"/.nosearch"</span>))
          (add-to-list 'load-path this-directory)
          (<span class="org-keyword">when</span> leuven-load-verbose
            (message <span class="org-string">"(Info) Added `</span><span class="org-constant"><span class="org-string">%s</span></span><span class="org-string">' to `</span><span class="org-constant"><span class="org-string">load-path</span></span><span class="org-string">'"</span> this-directory))))))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Remember this directory.</span>
  (<span class="org-keyword">defconst</span> <span class="org-variable-name">leuven--directory</span>
    (file-name-directory (or load-file-name (buffer-file-name)))
    <span class="org-doc">"Directory path of Leuven Emacs Config installation."</span>)

  (leuven-add-to-load-path
   (concat leuven--directory <span class="org-string">"site-lisp"</span>))
</pre></div>
<p><code>leuven--local-repos-directory</code> is where you put Emacs Git/SVN/CSV repositories.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven--local-repos-directory</span> <span class="org-string">"~/Public/Repositories/"</span>
    <span class="org-doc">"Directory containing additional Emacs Lisp public repositories."</span>)

  (leuven-add-to-load-path
   (concat leuven--local-repos-directory <span class="org-string">"babel"</span>))
  (leuven-add-to-load-path
   (concat leuven--local-repos-directory <span class="org-string">"emacs-bookmark-extension"</span>))
</pre></div>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Specify variables using `defcustom'</b><br />
nil</div>
<p><code>leuven-user-lisp-directory</code> is there so that you have an easy way of installing <b>your own Emacs add-ons</b> (which may be specific to the version of Emacs you're running). This keeps your local add-ons apart from distro supplied ones.</p>
<p>It also means you can do a complete re-install of Emacs (or even your Linux distro) without impacting on stuff you have added by hand.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-user-lisp-directory</span> (concat user-emacs-directory <span class="org-string">"lisp/"</span>)
    <span class="org-doc">"Directory containing personal additional Emacs Lisp packages."</span>)

  (leuven-add-to-load-path leuven-user-lisp-directory)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Require a feature/library if available; if not, fail silently.</span>
  (<span class="org-keyword">unless</span> (fboundp 'try-require)
    (<span class="org-keyword">defun</span> <span class="org-function-name">try-require</span> (feature)
      <span class="org-doc">"Attempt to load a FEATURE (or library).</span>
<span class="org-doc">    Return true if the library given as argument is successfully loaded.  If</span>
<span class="org-doc">    not, just print a message."</span>
      (<span class="org-keyword">condition-case</span> err
          (<span class="org-keyword">progn</span>
            (<span class="org-keyword">if</span> (stringp feature)
                (load-library feature)
              (<span class="org-keyword">require</span> <span class="org-constant">feature</span>))
            t)                          <span class="org-comment-delimiter">; </span><span class="org-comment">Necessary for correct behavior in</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">conditional expressions.</span>
        (file-error
         (message <span class="org-string">"Requiring `</span><span class="org-constant"><span class="org-string">%s</span></span><span class="org-string">'... missing"</span> feature)
         nil))))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">TEMPORARY.</span>
  (<span class="org-keyword">unless</span> (fboundp 'with-eval-after-load)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Wrapper around `</span><span class="org-constant"><span class="org-comment">eval-after-load</span></span><span class="org-comment">' (added in GNU Emacs 24.4).</span>
    (<span class="org-keyword">defmacro</span> <span class="org-function-name">with-eval-after-load</span> (mode <span class="org-type">&amp;rest</span> body)
      <span class="org-doc">"`</span><span class="org-constant"><span class="org-doc">eval-after-load</span></span><span class="org-doc">' MODE evaluate BODY."</span>
      (<span class="org-keyword">declare</span> (indent defun))
      `(eval-after-load ,mode
         '(<span class="org-keyword">progn</span> ,@body))))
</pre></div>
</div>
<div id="outline-container-orgheadline5" class="outline-3">
<h3 id="orgheadline5">Creating and selecting buffers</h3>
<div class="outline-text-3" id="text-orgheadline5">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class="org-function-name">switch-or-start</span> (function buffer)
    <span class="org-doc">"If the BUFFER is current, bury it.  If there is a buffer with that name,</span>
<span class="org-doc">  switch to it; otherwise, invoke the FUNCTION."</span>
    (<span class="org-keyword">if</span> (equal (buffer-name (current-buffer)) buffer)
        (bury-buffer)
      (<span class="org-keyword">if</span> (get-buffer buffer)
          (switch-to-buffer buffer)
        (funcall function))))

  (<span class="org-keyword">defun</span> <span class="org-function-name">switch-or-find-file</span> (file)
    <span class="org-doc">"If the FILE is current, bury it.  If there is a buffer with that name,</span>
<span class="org-doc">  switch to it; otherwise, open it."</span>
    (<span class="org-keyword">when</span> (file-exists-p file)
      (<span class="org-keyword">if</span> (and (buffer-file-name)
               (string= (expand-file-name file)
                        (expand-file-name (buffer-file-name))))
          (bury-buffer)
        (find-file file))))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 0-loading-libraries ends here</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline6" class="outline-2">
<h2 id="orgheadline6">Environment</h2>
<div class="outline-text-2" id="text-orgheadline6">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* Environment</span>

(leuven--chapter leuven-load-chapter-0-environment <span class="org-string">"0 Environment"</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">** Type of OS</span>

  (leuven--section <span class="org-string">"Type of OS"</span>)

  (<span class="org-keyword">defconst</span> <span class="org-variable-name">leuven--linux-p</span>
    (eq system-type 'gnu/linux)
    <span class="org-doc">"Running a GNU/Linux version of Emacs."</span>)

  (<span class="org-keyword">defconst</span> <span class="org-variable-name">leuven--mac-p</span>
    (eq system-type 'darwin)
    <span class="org-doc">"Running a Mac OS version of Emacs."</span>)

  (<span class="org-keyword">defconst</span> <span class="org-variable-name">leuven--win32-p</span>
    (eq system-type 'windows-nt)
    <span class="org-doc">"Running a native Microsoft Windows version of Emacs."</span>)

  (<span class="org-keyword">defconst</span> <span class="org-variable-name">leuven--cygwin-p</span>
    (eq system-type 'cygwin)
    <span class="org-doc">"Running a Cygwin version of Emacs."</span>)

<span class="org-comment-delimiter">;;</span><span class="org-comment">** MS Windows</span>

  <span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">FIXME</span></span><span class="org-comment"> The path is not correct under Cygwin Emacs (gsprint.exe not found)</span>
  (<span class="org-keyword">defconst</span> <span class="org-variable-name">leuven--windows-program-files-dir</span>   <span class="org-comment-delimiter">; </span><span class="org-comment">sys-path</span>
    (<span class="org-keyword">if</span> leuven--win32-p
        (file-name-as-directory (getenv <span class="org-string">"PROGRAMFILES"</span>))
      <span class="org-string">"/usr/local/bin/"</span>)
    <span class="org-doc">"Defines the default Windows Program Files folder."</span>)
</pre></div>
<p>Use <code>(display-graphic-p)</code> (instead of <code>window-system</code>) in conditions.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** Window system</span>

  (leuven--section <span class="org-string">"Window system"</span>)

  (<span class="org-keyword">defconst</span> <span class="org-variable-name">leuven--console-p</span>
    (eq window-system nil)
    <span class="org-doc">"Running a text-only terminal."</span>)

  (<span class="org-keyword">defconst</span> <span class="org-variable-name">leuven--x-window-p</span>
    (eq window-system 'x)
    <span class="org-doc">"Running a X Window system."</span>)

<span class="org-comment-delimiter">;;</span><span class="org-comment">** Testing Emacs versions</span>

  (leuven--section <span class="org-string">"Emacs version"</span>)

  (<span class="org-keyword">defconst</span> <span class="org-variable-name">leuven--gnu-emacs-p</span>
    (string-match <span class="org-string">"GNU Emacs"</span> (version))
    <span class="org-doc">"Running GNU Emacs."</span>)

  (<span class="org-keyword">defconst</span> <span class="org-variable-name">leuven--xemacs-p</span>
    (string-match <span class="org-string">"XEmacs"</span> (version))
    <span class="org-doc">"Running XEmacs."</span>)

  (<span class="org-keyword">defmacro</span> <span class="org-function-name">GNUEmacs</span> (<span class="org-type">&amp;rest</span> body)
    <span class="org-doc">"Execute any number of forms if running GNU Emacs."</span>
    (list 'if leuven--gnu-emacs-p
          (cons 'progn body)))

  (<span class="org-keyword">defmacro</span> <span class="org-function-name">GNUEmacs24</span> (<span class="org-type">&amp;rest</span> body)
    <span class="org-doc">"Execute any number of forms if running GNU Emacs 24."</span>
    (list 'if (string-match <span class="org-string">"GNU Emacs 24"</span> (version))
          (cons 'progn body)))

  (<span class="org-keyword">defmacro</span> <span class="org-function-name">XEmacs</span> (<span class="org-type">&amp;rest</span> body)
    <span class="org-doc">"Execute any number of forms if running XEmacs."</span>
    (list 'if leuven--xemacs-p
          (cons 'progn body)))

<span class="org-comment-delimiter">;;</span><span class="org-comment">** Testing file accessibility</span>

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--file-exists-and-executable-p</span> (file)
    <span class="org-doc">"Make sure the file FILE exists and is executable."</span>
    (<span class="org-keyword">if</span> file
        (<span class="org-keyword">if</span> (file-executable-p file)
            file
          (message <span class="org-string">"(warning) Can't find executable `</span><span class="org-constant"><span class="org-string">%s</span></span><span class="org-string">'"</span> file)
          <span class="org-comment-delimiter">;; </span><span class="org-comment">Sleep 1.5 s so that you can see the warning.</span>
          (sit-for 1.5))
      (<span class="org-warning">error</span> <span class="org-string">"Missing argument to \"leuven--file-exists-and-executable-p\""</span>)))

<span class="org-comment-delimiter">;;</span><span class="org-comment">** Init</span>

  (leuven--section <span class="org-string">"Init"</span>)

  (XEmacs
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't load init file from `</span><span class="org-constant"><span class="org-comment">~/.xemacs/init.el</span></span><span class="org-comment">' (and don't offer its</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">migration).</span>
    (setq load-home-init-file t))

  (GNUEmacs
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Ensure that the echo area is always visible during the early stage of</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">startup (useful in case of error).</span>
    (modify-all-frames-parameters
     '((height . 32))))

)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 0 ends here</span>
</pre></div>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Function for finding executables</b><br />
<p>See function <code>--find-program</code> at <a href="http://www.visualco.de/src/elisp/.emacs.el.html">http://www.visualco.de/src/elisp/.emacs.el.html</a>.</p>
</div>
</div>
</div>
<div id="outline-container-orgheadline7" class="outline-2">
<h2 id="orgheadline7">Debugging</h2>
<div class="outline-text-2" id="text-orgheadline7">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* Debugging</span>

(leuven--chapter leuven-load-chapter-0-debugging <span class="org-string">"0 Debugging"</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Get the backtrace when uncaught errors occur.</span>
  (setq debug-on-error t)               <span class="org-comment-delimiter">; </span><span class="org-comment">Will be unset at the end.</span>

  (XEmacs
    (setq stack-trace-on-error t))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Hit `</span><span class="org-constant"><span class="org-comment">C-g</span></span><span class="org-comment">' while it's frozen to get an Emacs Lisp backtrace.</span>
  (setq debug-on-quit t)                <span class="org-comment-delimiter">; </span><span class="org-comment">Will be unset at the end.</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 0 ends here</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline8" class="outline-2">
<h2 id="orgheadline8"><a id="ID-8c71fa50-b62e-49ae-bcbb-2ed1ee7a5d65" name="ID-8c71fa50-b62e-49ae-bcbb-2ed1ee7a5d65"></a>Emacs Lisp Packages</h2>
<div class="outline-text-2" id="text-orgheadline8">
<p>Another <b>first thing</b> in your init script should be <code>(package-initialize)</code> so that customization of Org variables (for example) doesn't auto-load the old version that came with Emacs.</p>
<p>If you require something from Org mode, it must be after <code>package-initialize</code>.</p>
</div>
<div id="outline-container-orgheadline9" class="outline-3">
<h3 id="orgheadline9">The Package Menu Buffer</h3>
<div class="outline-text-3" id="text-orgheadline9">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 47 Emacs Lisp (info "(emacs)Packages")</span>

(leuven--chapter leuven-load-chapter-47-packages <span class="org-string">"47 Emacs Lisp Packages"</span>
</pre></div>
<p>To upgrade packages after running <code>package-list-packages</code>, type:</p>
<ul class="org-ul">
<li><code>U</code> (<i>mark Upgradable packages</i>) and then</li>
<li><code>x</code> (<i>eXecute the installs and deletions</i>).</li>
</ul>
<p>When it's done installing all the packages, you delete the obsolete packages by hitting <code>y</code> (<i>Yes</i>) when asked.</p>
</div>
</div>
<div id="outline-container-orgheadline10" class="outline-3">
<h3 id="orgheadline10">Package Installation</h3>
<div class="outline-text-3" id="text-orgheadline10">
<ul class="org-ul">
<li>User's Emacs Lisp packages in <code>package-user-dir</code> (<code>~/.emacs.d/elpa</code>)</li>
<li>System-wide Emacs Lisp packages in <code>package-directory-list</code></li>
</ul>
<p>HTTP frontends for the Emacs repositories:</p>
<ul class="org-ul">
<li><a href="http://elpa.gnu.org/packages/">http://elpa.gnu.org/packages/</a></li>
<li><a href="http://melpa.milkbox.net/">http://melpa.milkbox.net/</a></li>
</ul>
<p>In Marmalade, the developers themselves do the packaging. In MELPA, packages are generated programmatically from upstream Git-based sources.</p>
<div class="note">
<p>The Marmalade repository is not recommended by Flycheck (due to frequent outages).</p>
</div>
<p>To list packages which should <i>not</i> be installed by Emacs Leuven, add something like this into your configuration file:</p>
<pre class="example">
(setq leuven-elpa-ignored-packages '(ess))
</pre>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 47.2 Package Installation</span>

  (leuven--section <span class="org-string">"47.2 Package Installation"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Simple package system for GNU Emacs.</span>
  (GNUEmacs
    (try-require 'package)
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"package"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Archives from which to fetch.</span>
      (setq package-archives
            (append '((<span class="org-string">"org"</span>          . <span class="org-string">"http://orgmode.org/elpa/"</span>)
                      <span class="org-comment-delimiter">;; </span><span class="org-comment">("melpa-stable" . "http://melpa-stable.milkbox.net/packages/")</span>
                      (<span class="org-string">"melpa"</span>        . <span class="org-string">"http://melpa.milkbox.net/packages/"</span>))
                    package-archives))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Load the latest version of all installed packages, and activate them.</span>
      (package-initialize)              <span class="org-comment-delimiter">; </span><span class="org-comment">Add ALL ELPA subdirs to `</span><span class="org-constant"><span class="org-comment">load-path</span></span><span class="org-comment">'</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">and load `</span><span class="org-constant"><span class="org-comment">&lt;pkg&gt;-autoloads.el</span></span><span class="org-comment">'.</span>

      (<span class="org-keyword">defconst</span> <span class="org-variable-name">leuven-elpa-packages</span>
        '(ace-jump-mode ace-link ace-window aggressive-indent anzu auctex
          auto-complete bbdb bookmark+ boxquote calfw circe
          color-identifiers-mode company company-quickhelp csv-mode cygwin-mount
          dictionary diff-hl diminish dired+ dired-single ess expand-region
          fancy-narrow fill-column-indicator flycheck flycheck-ledger fuzzy
          git-commit-mode git-messenger git-timemachine google-this
          google-translate goto-chg graphviz-dot-mode graphviz-dot-mode
          guide-key helm helm-descbinds helm-swoop hideshowvis highlight-symbol
          htmlize indent-guide key-chord litable idle-require imenu-anywhere
          info+ interaction-log ledger-mode leuven-theme magit multi-term
          multiple-cursors pager pdf-tools powerline rainbow-mode tidy unbound
          undo-tree w3m ws-butler yasnippet
          <span class="org-comment-delimiter">;; </span><span class="org-comment">jabber multi-term paredit redshank</span>
          )
        <span class="org-doc">"A list of packages to ensure are installed at Emacs startup."</span>)

      (<span class="org-keyword">defcustom</span> <span class="org-variable-name">leuven-elpa-ignored-packages</span>
        nil
        <span class="org-doc">"List of packages that should be ignored by Leuven Emacs Config."</span>
        <span class="org-builtin">:group</span> 'emacs-leuven
        <span class="org-builtin">:type</span> '(repeat (string)))

      (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--missing-elpa-packages</span> ()
        <span class="org-doc">"List packages to install for a full blown Leuven installation.</span>
<span class="org-doc">These packages are neither built-in nor already installed nor ignored."</span>
        (<span class="org-keyword">let</span> (missing-elpa-packages)
          (<span class="org-keyword">dolist</span> (pkg leuven-elpa-packages)
            (<span class="org-keyword">unless</span> (or (package-installed-p pkg)
                        (locate-library (symbol-name pkg))
                        (member pkg leuven-elpa-ignored-packages))
              (push pkg missing-elpa-packages)))
          missing-elpa-packages))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Propose to install all the packages specified in `</span><span class="org-constant"><span class="org-comment">leuven-elpa-packages</span></span><span class="org-comment">'</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">which are missing and which shouldn't be ignored.</span>
      (<span class="org-keyword">let</span> ((missing-elpa-packages (leuven--missing-elpa-packages)))
        (<span class="org-keyword">when</span> missing-elpa-packages
          <span class="org-comment-delimiter">;; </span><span class="org-comment">Download once the ELPA archive description.</span>
          (package-refresh-contents)    <span class="org-comment-delimiter">; </span><span class="org-comment">Ensure that the list of packages is</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">up-to-date.  Otherwise, new packages</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">(not present in the cache of the ELPA</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">contents) won't install.</span>
          (<span class="org-keyword">dolist</span> (pkg missing-elpa-packages)
            (<span class="org-keyword">if</span> (yes-or-no-p (format <span class="org-string">"Install ELPA package `</span><span class="org-constant"><span class="org-string">%s</span></span><span class="org-string">'? "</span> pkg))
                (<span class="org-keyword">ignore-errors</span>
                  (package-install pkg))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Must be run after initializing</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">package-initialize</span></span><span class="org-comment">'.</span>
              (message (concat <span class="org-string">"Customize Emacs Leuven to ignore "</span>
                               <span class="org-string">"the `</span><span class="org-constant"><span class="org-string">%s</span></span><span class="org-string">' package next times..."</span>) pkg)
              (sit-for 1.5)))))))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 47 ends here</span>
</pre></div>
<p><code>Idle-require</code> must be loaded <b>after</b> <code>package-initialize</code>, and should not be cancelable; hence, we put it out of a "chapter".</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Load elisp libraries while Emacs is idle.</span>
  (try-require 'idle-require)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Fail-safe for `</span><span class="org-constant"><span class="org-comment">idle-require</span></span><span class="org-comment">'.</span>
  (<span class="org-keyword">if</span> (not (<span class="org-keyword">featurep</span> '<span class="org-constant">idle-require</span>))
    (<span class="org-keyword">defun</span> <span class="org-function-name">idle-require</span> (feature <span class="org-type">&amp;optional</span> file noerror)
      (try-require feature)))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"idle-require"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Idle time in seconds after which autoload functions will be loaded.</span>
    (setq idle-require-idle-delay 5)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Time in seconds between automatically loaded functions.</span>
    (setq idle-require-load-break 2))

  (add-hook 'after-init-hook
            (<span class="org-keyword">lambda</span> ()
              (<span class="org-keyword">when</span> (fboundp 'idle-require-mode)
                <span class="org-comment-delimiter">;; </span><span class="org-comment">Starts loading.</span>
                (idle-require-mode 1))))
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline11" class="outline-2">
<h2 id="orgheadline11">The Organization of the Screen</h2>
<div class="outline-text-2 org-src-container" id="text-orgheadline11">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 1 The Organization of the (info "(emacs)Screen")</span>

(leuven--chapter leuven-load-chapter-1-screen <span class="org-string">"1 The Organization of the Screen"</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 1.2 The (info "(emacs)Echo Area")</span>

  (leuven--section <span class="org-string">"1.2 (emacs) The Echo Area"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't truncate the message log buffer when it becomes large.</span>
  (setq message-log-max t)

)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 1 ends here</span>
</pre></div>
</div>
<div id="outline-container-orgheadline12" class="outline-2">
<h2 id="orgheadline12">Exiting Emacs</h2>
<div class="outline-text-2 org-src-container" id="text-orgheadline12">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 6 (info "(emacs)Exiting") Emacs</span>

(leuven--chapter leuven-load-chapter-6-exiting <span class="org-string">"6 Exiting Emacs"</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Unbind "minimize".</span>
  (global-unset-key (kbd <span class="org-string">"C-z"</span>))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Quit with Alt + F4.</span>
  (global-set-key (kbd <span class="org-string">"&lt;M-f4&gt;"</span>) 'save-buffers-kill-terminal)

)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 6 ends here</span>
</pre></div>
</div>
<div id="outline-container-orgheadline13" class="outline-2">
<h2 id="orgheadline13">Basic Editing Commands</h2>
<div class="outline-text-2 org-src-container" id="text-orgheadline13">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 7 (info "(emacs)Basic") Editing Commands</span>

(leuven--chapter leuven-load-chapter-7-basic <span class="org-string">"7 Basic Editing Commands"</span>
</pre></div>
<div id="outline-container-orgheadline14" class="outline-3">
<h3 id="orgheadline14">Inserting Text</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline14">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 7.1 (info "(emacs)Inserting Text")</span>

  (leuven--section <span class="org-string">"7.1 (emacs)Inserting Text"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Enter characters by their code in octal (for `C-q NNN &lt;RET&gt;').</span>
  (setq read-quoted-char-radix 8)       <span class="org-comment-delimiter">; </span><span class="org-comment">16 for hexadecimal (for Unicode char)</span>
</pre></div>
</div>
<div id="outline-container-orgheadline15" class="outline-3">
<h3 id="orgheadline15">Moving Point Location</h3>
<div class="outline-text-3" id="text-orgheadline15">
<dl class="org-dl">
<dt><code>M-r</code></dt>
<dd><code>move-to-window-line</code>.</dd>
<dt><code>M-g g</code></dt>
<dd>
<p><b>Jump to</b> the beginning of <b>line</b> number <i>N</i> (<code>goto-line</code>).</p>
<p>Under XEmacs, this was bound by default to <code>M-g</code>. But we cannot do that in GNU Emacs as <code>M-g</code> is a prefix key here</p>
</dd>
</dl>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 7.2 (info "(emacs)Moving Point") Location</span>

  (leuven--section <span class="org-string">"7.2 (emacs)Moving Point Location"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't add newlines to end of buffer when scrolling.</span>
  (setq next-line-add-newlines nil)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Print the current buffer line number.</span>
  (global-set-key (kbd <span class="org-string">"M-G"</span>) 'what-line)
</pre></div>
<p>Show line numbers temporarily - just when you're going to a line number with <code>goto-line</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class="org-function-name">goto-line-with-feedback</span> ()
    <span class="org-doc">"Show line numbers temporarily, while prompting for the line number input"</span>
    (interactive)
    (<span class="org-keyword">unwind-protect</span>
        (<span class="org-keyword">progn</span>
          (linum-mode 1)
          (goto-line (read-number <span class="org-string">"Goto line: "</span>)))
      (linum-mode -1)))

  (global-set-key [remap goto-line] 'goto-line-with-feedback)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline16" class="outline-3">
<h3 id="orgheadline16">Basic Undoing Changes</h3>
<div class="outline-text-3" id="text-orgheadline16">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 7.4 (info "(emacs)Basic Undo")ing Changes</span>

  (leuven--section <span class="org-string">"7.4 (emacs)Basic Undoing Changes"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Undo some previous changes.</span>
  (global-set-key (kbd <span class="org-string">"&lt;f11&gt;"</span>) 'undo)
  (global-set-key (kbd <span class="org-string">"C-z"</span>) 'undo)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"volatile-highlights-autoloads"</span>
    (volatile-highlights-mode 1))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Treat undo history as a tree.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"undo-tree-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable Global-Undo-Tree mode.</span>
    (global-undo-tree-mode 1)

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"diminish-autoloads"</span>
      (diminish 'undo-tree-mode))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Display times relative to current time in visualizer.</span>
    (setq undo-tree-visualizer-relative-timestamps t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Display time-stamps by default in undo-tree visualizer.</span>
    (setq undo-tree-visualizer-timestamps t) <span class="org-comment-delimiter">; </span><span class="org-comment">Toggle time-stamps display using `t'.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Display diff by default in undo-tree visualizer.</span>
    (setq undo-tree-visualizer-diff t) <span class="org-comment-delimiter">; </span><span class="org-comment">Toggle the diff display using `d'.</span>

    (<span class="org-keyword">defalias</span> '<span class="org-function-name">redo</span> 'undo-tree-redo)
    (global-set-key (kbd <span class="org-string">"&lt;S-f11&gt;"</span>) 'redo)
    (global-set-key (kbd <span class="org-string">"C-S-z"</span>) 'redo))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 7 ends here</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline17" class="outline-2">
<h2 id="orgheadline17">The Minibuffer</h2>
<div class="outline-text-2 org-src-container" id="text-orgheadline17">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 8 The (info "(emacs)Minibuffer")</span>

(leuven--chapter leuven-load-chapter-8-minibuffer <span class="org-string">"8 The Minibuffer"</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">How long to display an echo-area message when the minibuffer is active.</span>
  (setq minibuffer-message-timeout 0.5)
</pre></div>
<div id="outline-container-orgheadline18" class="outline-3">
<h3 id="orgheadline18">Editing in the Minibuffer</h3>
<div class="outline-text-3" id="text-orgheadline18">
<p>If the output is short enough to display in the echo area (which is determined by the variables <code>resize-mini-windows</code> and <code>max-mini-window-height</code>), it is shown in echo area.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 8.3 (info "(emacs)Minibuffer Edit")ing</span>

  (leuven--section <span class="org-string">"8.3 (emacs)Minibuffer Editing"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Minibuffer and echo area windows resize vertically as necessary to fit</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">the text displayed in them.</span>
  (setq resize-mini-windows t)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline19" class="outline-3">
<h3 id="orgheadline19">Completion</h3>
<div class="outline-text-3" id="text-orgheadline19">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 8.4 (info "(emacs)Completion")</span>

  (leuven--section <span class="org-string">"8.4 (emacs)Completion"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't consider case significant in completion (GNU Emacs default).</span>
  (XEmacs
    (setq completion-ignore-case t))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Ignore case when reading a file name.</span>
  (setq read-file-name-completion-ignore-case t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Ignore case when reading a buffer name.</span>
  (setq read-buffer-completion-ignore-case t)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Provide the same facility of `ls --color' inside Emacs.</span>
  (<span class="org-keyword">when</span> (locate-library <span class="org-string">"dircolors"</span>)
    (autoload 'dircolors <span class="org-string">"dircolors"</span> nil t)
    (add-hook 'completion-list-mode-hook 'dircolors))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline20" class="outline-3">
<h3 id="orgheadline20">Repeating Minibuffer Commands</h3>
<div class="outline-text-3" id="text-orgheadline20">
<p>Use <code>M-x list-command-history</code> to display the entire command history, showing all the commands <code>C-x &lt;ESC&gt; &lt;ESC&gt;</code> can repeat, most recent first.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 8 ends here</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline21" class="outline-2">
<h2 id="orgheadline21">Help</h2>
<div class="outline-text-2" id="text-orgheadline21">
<p>In general, the following functions are very interesting for finding useful functions and documentation.</p>
<dl class="org-dl">
<dt><code>apropos-documentation</code> (<code>C-h d</code>)</dt>
<dd><b>Show symbols whose documentation contains matches for PATTERN.</b> For example, <code>C-h d yank properties &lt;RET&gt;</code>.</dd>
<dt><code>describe-function</code> (<code>C-h f</code>)</dt>
<dd>Used with TAB completion to show documentation of functions.</dd>
<dt><code>elisp-index-search</code> (<code>C-h E</code> in Leuven Emacs Config)</dt>
<dd>Look up documentation on broad Emacs Lisp topics (in the indices of the Emacs Lisp Reference Manual).</dd>
<dt><code>info-lookup-symbol</code> (<code>C-h S</code>, or <code>C-f1</code> in Leuven Emacs Config)</dt>
<dd class="c1">Bring the relevant section from the manual, which describes the topic in more detail.</dd>
</dl>
<p>With all prefix keys, if you follow them with <code>C-h</code> (<code>h</code> for help), a list of key bindings in that prefix map is displayed. This is automatic and is one of the self-documenting features of Emacs.</p>
<p>Try, for example <code>C-x C-h</code> or <code>C-c C-x C-h</code> to see what it does. I do use it to remind myself of rarely used rectangle commands: <code>C-x r C-h</code>.</p>
<p>FYI, <code>catman</code> create the database files that are used by <code>apropos</code> or <code>man -k</code>.</p>
<p>Note about PHP documentation lookup - PHP Mode has a nice feature to lookup the function's definition in PHP's manual in your web browser (<code>M-x php-search-documentation</code> or <code>C-c C-f</code>). You can combine it with Emacs-w3m to get the relevant manual page without leaving Emacs.</p>
<p><b>Close</b> the help buffer by pressing <code>Q</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 10 (info "(emacs)Help")</span>

(leuven--chapter leuven-load-chapter-10-help <span class="org-string">"10 Help"</span>
</pre></div>
</div>
<div id="outline-container-orgheadline22" class="outline-3">
<h3 id="orgheadline22">Help Summary</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline22">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 10.1 (info "(emacs)Help Summary")</span>

  (leuven--section <span class="org-string">"10.1 (emacs)Help Summary"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Avoid the description of all minor modes.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-describe-major-mode</span> ()
    <span class="org-doc">"Describe only `</span><span class="org-constant"><span class="org-doc">major-mode</span></span><span class="org-doc">'."</span>
    (interactive)
    (describe-function major-mode))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Look up subject in (the indices of the) Emacs Lisp manual.</span>
  (global-set-key (kbd <span class="org-string">"C-h E"</span>) 'elisp-index-search)
</pre></div>
</div>
<div id="outline-container-orgheadline23" class="outline-3">
<h3 id="orgheadline23">Apropos</h3>
<div class="outline-text-3" id="text-orgheadline23">
<p>You can ask what pertains to a given topic by typing <code>M-x apropos &lt;RET&gt; pattern &lt;RET&gt;</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 10.4 (info "(emacs)Apropos")</span>

  (leuven--section <span class="org-string">"10.4 (emacs)Apropos"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"apropos"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Check all variables and non-interactive functions as well.</span>
    (setq apropos-do-all t))

  (GNUEmacs

    <span class="org-comment-delimiter">;; </span><span class="org-comment">apropos commands will search more extensively.</span>
    (setq apropos-do-all t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(defun apropos-user-option (string)</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">"Like apropos, but lists only symbols that are names of user</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">modifiable variables.  Argument REGEXP is a regular expression.</span>
    <span class="org-comment-delimiter">;;    </span><span class="org-comment">Returns a list of symbols, and documentation found"</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(interactive "sVariable apropos (regexp): ")</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(let ((message</span>
    <span class="org-comment-delimiter">;;          </span><span class="org-comment">(let ((standard-output (get-buffer-create "*Help*")))</span>
    <span class="org-comment-delimiter">;;            </span><span class="org-comment">(print-help-return-message 'identity))))</span>
    <span class="org-comment-delimiter">;;     </span><span class="org-comment">(if (apropos string  'user-variable-p)</span>
    <span class="org-comment-delimiter">;;         </span><span class="org-comment">(and message (message message)))))</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Show all variables whose name matches the pattern.</span>
    (define-key help-map (kbd <span class="org-string">"A"</span>) 'apropos-user-option))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline24" class="outline-3">
<h3 id="orgheadline24">Misc Help Commands</h3>
<div class="outline-text-3" id="text-orgheadline24">
<p>The <code>*Messages*</code> buffer is called the " <b>Message-Log</b>" on XEmacs (note the initial space). To display the message log, execute the command <code>M-x show-message-log</code>.</p>
<p><code>update-info-dir</code></p>
<p>The utility <code>install-info</code> is used to maintain the <code>info/dir</code> file.</p>
<p><code>C-h K</code> goes to the node in the Emacs manual describing the command bound to a key.</p>
<p>In a manual, these key bindings will make your life easier:</p>
<dl class="org-dl">
<dt><code>^</code></dt>
<dd>Move "up" from this node.</dd>
<dt><code>]</code></dt>
<dd>Go forward one node, considering all nodes as forming one sequence.</dd>
<dt><code>l</code></dt>
<dd>Move back in history to the last node you were at.</dd>
<dt><code>L</code></dt>
<dd>Go to menu of visited nodes.</dd>
<dt><code>i</code></dt>
<dd><b>Search for a topic in this manual's Index</b> and go to index entry.</dd>
<dt><code>s</code></dt>
<dd><b>Search for a regexp</b> and select node it's found in.</dd>
</dl>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 10.8 (info "(emacs)Misc Help")</span>

  (leuven--section <span class="org-string">"10.8 (emacs)Misc Help"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Enter Info documentation browser.</span>
  (global-set-key (kbd <span class="org-string">"&lt;f1&gt;"</span>) 'info)

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-describe-elisp-symbol-at-point</span> ()
    <span class="org-doc">"Get help for the symbol at point."</span>
    (interactive)
    (<span class="org-keyword">let</span> ((sym (intern-soft (current-word))))
      (<span class="org-keyword">unless</span>
          (<span class="org-keyword">cond</span> ((null sym))
                ((not (eq t (help-function-arglist sym)))
                 (describe-function sym))
                ((boundp sym)
                 (describe-variable sym)))
        (message <span class="org-string">"nothing"</span>))))

  (global-set-key (kbd <span class="org-string">"&lt;f1&gt;"</span>) 'leuven-describe-elisp-symbol-at-point)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Display symbol definitions, as found in the relevant manual</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(for AWK, C, Emacs Lisp, LaTeX, M4, Makefile, Sh and other languages that</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">have documentation in Info)</span>
  (global-set-key (kbd <span class="org-string">"&lt;C-f1&gt;"</span>) 'info-lookup-symbol)
</pre></div>
<p>When Info is called, the variable <code>Info-directory-list</code> is populated from:</p>
<ol class="org-ol">
<li>the <code>INFOPATH</code> environment variable, or (if unset)</li>
<li>the <code>Info-default-directory-list</code> variable - non-existent directories will be removed when copied to <code>Info-directory-list</code></li>
</ol>
<p>The best would be to set the <code>INFOPATH</code> environment variable so that you see the same manuals outside of Emacs, in the same shell from which you invoke Emacs.</p>
<p>However, as EmacsW32 doesn't see that Cygwin environment variable (it would well work with a Windows environment variable), I prefer to try and put the Windows configuration inside the Emacs configuration files.</p>
<p>Normally, <code>Info-directory-list</code> is not intended to be settable by the user. But we must do so if we want to force our Info manuals before the standard ones (from Emacs).</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"info"</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">List of directories to search for Info documentation files (in the order</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">they are listed).</span>
    (<span class="org-keyword">when</span> leuven--win32-p
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(info-initialize)</span>
      (setq Info-directory-list
            `(,(expand-file-name
                (concat (file-name-directory (locate-library <span class="org-string">"org"</span>)) <span class="org-string">"../doc/"</span>))
              <span class="org-string">"c:/cygwin/usr/share/info/"</span>
              ,@Info-directory-list)))

  <span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment"> Replace by add-to-list to ensure we don't insert duplicates (if Cygwin was already there)</span>
</pre></div>
<p><code>Info+</code> fontifies entries for reference items (functions, macros, commands, special forms, constants, options, other variables), and that includes their parameters, even those on continuation lines.</p>
<p>With <code>Info+</code>, you can also merge an Info node with its subnodes into the same buffer, by calling <code>Info-merge-subnodes</code> (bound to <code>+</code>).</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (GNUEmacs
      (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"info+-autoloads"</span>
        (idle-require 'info+))

      (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"info+"</span>

        <span class="org-comment-delimiter">;; </span><span class="org-comment">Show breadcrumbs in the header line.</span>
        (setq Info-breadcrumbs-in-header-flag t)

        <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't show breadcrumbs in the mode line.</span>
        (setq Info-breadcrumbs-in-mode-line-mode nil)))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Some info related functions (to insert links such as `(info</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">"(message)Insertion Variables")').</span>
    (<span class="org-keyword">when</span> (locate-library <span class="org-string">"rs-info"</span>)
      (autoload 'rs-info-insert-current-node <span class="org-string">"rs-info"</span>
        <span class="org-doc">"Insert reference to current Info node using STYPE in buffer."</span> t)
      (autoload 'rs-info-boxquote <span class="org-string">"rs-info"</span>
        <span class="org-doc">"Yank text (from an info node), box it and use current info node as title."</span> t)
      (autoload 'rs-info-reload <span class="org-string">"rs-info"</span>
        <span class="org-doc">"Reload current info node."</span> t)
      (autoload 'rs-info-insert-node-for-variable <span class="org-string">"rs-info"</span>
        <span class="org-doc">"Insert a custom style info node for the top level form at point."</span> t)
      (<span class="org-keyword">defalias</span> '<span class="org-function-name">boxquote-info</span> 'rs-info-boxquote))
    )
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Get a Unix manual page of the item under point.</span>
  (global-set-key (kbd <span class="org-string">"&lt;S-f1&gt;"</span>) 'man-follow)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"man"</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Make the manpage the current buffer in the current window.</span>
    (setq Man-notify-method 'pushy))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Alias man to woman.</span>
  (<span class="org-keyword">defalias</span> '<span class="org-function-name">man</span> 'woman)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Decode and browse Unix man-pages "W.o. (without) Man".</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"woman"</span>
    (<span class="org-keyword">defalias</span> '<span class="org-function-name">man</span> 'woman))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 10 ends here</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline25" class="outline-2">
<h2 id="orgheadline25">The Mark and the Region</h2>
<div class="outline-text-2 org-src-container" id="text-orgheadline25">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 11 The (info "(emacs)Mark") and the Region</span>

(leuven--chapter leuven-load-chapter-11-mark <span class="org-string">"11 The Mark and the Region"</span>
</pre></div>
<div id="outline-container-orgheadline26" class="outline-3">
<h3 id="orgheadline26">Setting the Mark</h3>
<div class="outline-text-3" id="text-orgheadline26">
<p>Instead of setting the mark in order to operate on a region, you can also use it to:</p>
<ul class="org-ul">
<li><b>"remember" a position</b> in the buffer (by typing <code>C-SPC C-SPC</code> to set the mark where point is), and</li>
<li>
<p>later <b>jump</b> back <b>to the mark</b> in the buffer (by typing <code>C-u C-SPC</code>).</p>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Look at `back-button'</b><br />
<p>Visual navigation through mark rings.</p>
</div>
</li>
</ul>
<p><b>Go to</b> the <b>place</b> where you <b>last changed</b> something:</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Goto last change.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"goto-chg-autoloads"</span>
    (global-set-key (kbd <span class="org-string">"&lt;C-S-backspace&gt;"</span>) 'goto-last-change))
</pre></div>
<p>It moves point through <code>buffer-undo-list</code> positions.</p>
</div>
</div>
<div id="outline-container-orgheadline27" class="outline-3">
<h3 id="orgheadline27">Commands to Mark Textual Objects</h3>
<div class="outline-text-3" id="text-orgheadline27">
<dl class="org-dl">
<dt><code>M-@</code></dt>
<dd>Set mark after end of next <b>word</b> (<code>mark-word</code>) without moving point.</dd>
<dt><code>C-M-@</code></dt>
<dd>Set mark after end of following <b>balanced expression</b> (<code>mark-sexp</code>) without moving point.</dd>
</dl>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Increase selected region by semantic units.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"expand-region-autoloads"</span>

    (global-set-key (kbd <span class="org-string">"C-+"</span>) 'er/expand-region)
    (global-set-key (kbd <span class="org-string">"C--"</span>) 'er/contract-region))
</pre></div>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Those key bindings are overridden by <code>text-scale-increase</code></b><br />
nil</div>
</div>
</div>
<div id="outline-container-orgheadline28" class="outline-3">
<h3 id="orgheadline28">Operating on the Region</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline28">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Inserting text while the mark is active causes the text in the region to be</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">deleted first.</span>
  (delete-selection-mode 1)             <span class="org-comment-delimiter">; </span><span class="org-comment">Overwrite region.</span>
</pre></div>
</div>
<div id="outline-container-orgheadline29" class="outline-3">
<h3 id="orgheadline29">Shift Selection</h3>
<div class="outline-text-3" id="text-orgheadline29">
<p>Shifted motion keys activate the mark momentarily.</p>
</div>
</div>
<div id="outline-container-orgheadline30" class="outline-3">
<h3 id="orgheadline30">Multiple selections</h3>
<div class="outline-text-3" id="text-orgheadline30">
<p>You can <a href="http://www.emacsrocks.com/e13.html">watch an intro to multiple-cursors at Emacs Rocks</a>.</p>
<p>In other editors:</p>
<ul class="org-ul">
<li><a href="https://www.sublimetext.com/docs/2/multiple_selection_with_the_keyboard.html">https://www.sublimetext.com/docs/2/multiple_selection_with_the_keyboard.html</a></li>
<li><a href="https://docs.c9.io/multiple_cursors.html">https://docs.c9.io/multiple_cursors.html</a></li>
<li><a href="http://komodoide.com/screencasts/watch/87286656-multiple-selections/">http://komodoide.com/screencasts/watch/87286656-multiple-selections/</a></li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Multiple cursors for Emacs.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"multiple-cursors-autoloads"</span>
</pre></div>
</div>
<div id="outline-container-orgheadline31" class="outline-4">
<h4 id="orgheadline31">Splitting the selection into lines</h4>
<div class="outline-text-4" id="text-orgheadline31">
<p>Make <b>batch edits</b> with Multiple Cursors: select a block of lines, and then <b>split the region into lines</b> which are then <b>edited simultaneously</b>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add a cursor to each (continuous) line in the current region.</span>
    (global-set-key (kbd <span class="org-string">"C-S-c C-S-c"</span>) 'mc/edit-lines)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline32" class="outline-4">
<h4 id="orgheadline32">Quick add next/previous</h4>
<div class="outline-text-4" id="text-orgheadline32">
<p>Use Multiple Cursors to <b>rename variables quickly</b>: <b>add the next</b> or previous <b>occurrence of the current word to the selection</b>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add a cursor and region at the next part of the buffer forwards that</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">matches the current region.</span>
    (global-set-key (kbd <span class="org-string">"C-&gt;"</span>) 'mc/mark-next-like-this)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-c &gt;") 'mc/mark-next-like-this)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add a cursor and region at the next part of the buffer backwards that</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">matches the current region.</span>
    (global-set-key (kbd <span class="org-string">"C-&lt;"</span>) 'mc/mark-previous-like-this)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-c &lt;") 'mc/mark-previous-like-this)</span>

    (global-set-key (kbd <span class="org-string">"C-M-&gt;"</span>) 'mc/skip-to-next-like-this)
    (global-set-key (kbd <span class="org-string">"C-M-&lt;"</span>) 'mc/skip-to-previous-like-this)

    (global-set-key (kbd <span class="org-string">"C-S-&lt;mouse-1&gt;"</span>) 'mc/add-cursor-on-click)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline33" class="outline-4">
<h4 id="orgheadline33">Find All</h4>
<div class="outline-text-4" id="text-orgheadline33">
<p class="c2">Add all occurrences of the current word to the selection.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (global-set-key (kbd <span class="org-string">"C-;"</span>) 'mc/mark-all-like-this-dwim) <span class="org-comment-delimiter">; </span><span class="org-comment">Like Iedit.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Mark all parts of the buffer that matches the current region.</span>
    (global-set-key (kbd <span class="org-string">"C-c C-&lt;"</span>) 'mc/mark-all-like-this)
    (global-set-key (kbd <span class="org-string">"C-c *"</span>) 'mc/mark-all-like-this)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (global-set-key (kbd <span class="org-string">"C-&lt;return&gt;"</span>) 'mc/mark-more-like-this-extended)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (global-set-key (kbd <span class="org-string">"C-S-SPC"</span>) 'set-rectangular-region-anchor)
    (global-set-key (kbd <span class="org-string">"C-M-="</span>) 'mc/insert-numbers)
  )
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline34" class="outline-4">
<h4 id="orgheadline34">Single Selection</h4>
<div class="outline-text-4" id="text-orgheadline34">
<p>To go from multiple selections to a single selection, press <code>C-g</code> or <code>RET</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Multiple cursors for Emacs.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"multiple-cursors-core"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Commands to run for all cursors in multiple-cursors-mode.</span>
    (setq mc/cmds-to-run-for-all
          '(leuven-fill-paragraph
            org-beginning-of-line
            org-end-of-line
            org-kill-line
            org-self-insert-command
            org-shiftleft
            org-shiftright
            org-yank
            orgtbl-self-insert-command
            yas-expand)))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 11 ends here</span>
</pre></div>
</div>
</div>
</div>
</div>
<div id="outline-container-orgheadline35" class="outline-2">
<h2 id="orgheadline35">Killing and Moving Text</h2>
<div class="outline-text-2 org-src-container" id="text-orgheadline35">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 12 (info "(emacs)Killing") and Moving Text</span>

(leuven--chapter leuven-load-chapter-12-killing <span class="org-string">"12 Killing and Moving Text"</span>
</pre></div>
<div id="outline-container-orgheadline36" class="outline-3">
<h3 id="orgheadline36">Deletion and Killing</h3>
<div class="outline-text-3" id="text-orgheadline36">
<dl class="org-dl">
<dt><code>C-S-backspace</code></dt>
<dd>Kill an entire line at once.</dd>
</dl>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 12.1 (info "(emacs)Deletion and Killing")</span>

  (leuven--section <span class="org-string">"12.1 (emacs)Deletion and Killing"</span>)

  (GNUEmacs
<span class="org-comment-delimiter">;; </span><span class="org-comment">old ([2012-09-07 Fri] remove "compile" after "activate")</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add the ability to copy the current line without marking it (no</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">selection).</span>
    (<span class="org-keyword">defadvice</span> <span class="org-function-name">kill-ring-save</span> (before leuven-slick-copy activate)
      <span class="org-doc">"When called with no active region, copy the current line instead."</span>
      (interactive
       (<span class="org-keyword">if</span> (use-region-p) (list (region-beginning) (region-end))
         (message <span class="org-string">"Copied the current line"</span>)
         (list (line-beginning-position)
               (line-beginning-position 2)))))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add the ability to cut the current line without marking it (no</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">selection).</span>
    (<span class="org-keyword">defadvice</span> <span class="org-function-name">kill-region</span> (before leuven-slick-cut activate)
      <span class="org-doc">"When called with no active region, kill the current line instead."</span>
      (interactive
       (<span class="org-keyword">if</span> (use-region-p) (list (region-beginning) (region-end))
         (list (line-beginning-position)
               (line-beginning-position 2))))))

<span class="org-comment-delimiter">;; </span><span class="org-comment">new</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(defadvice kill-ring-save (around leuven-slick-copy activate)</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">"When called interactively with no active region, copy a single line instead."</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(if (or (use-region-p) (not (called-interactively-p 'any)))</span>
    <span class="org-comment-delimiter">;;       </span><span class="org-comment">ad-do-it</span>
    <span class="org-comment-delimiter">;;     </span><span class="org-comment">(kill-new (buffer-substring (line-beginning-position)</span>
    <span class="org-comment-delimiter">;;                                 </span><span class="org-comment">(line-beginning-position 2)))</span>
    <span class="org-comment-delimiter">;;     </span><span class="org-comment">(message "Copied line")))</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(defadvice kill-region (around leuven-slick-cut activate)</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">"When called interactively with no active region, kill a single line instead."</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(if (or (use-region-p) (not (called-interactively-p 'any)))</span>
    <span class="org-comment-delimiter">;;       </span><span class="org-comment">ad-do-it</span>
    <span class="org-comment-delimiter">;;     </span><span class="org-comment">(kill-new (filter-buffer-substring (line-beginning-position)</span>
    <span class="org-comment-delimiter">;;                                        </span><span class="org-comment">(line-beginning-position 2) t))))</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(defun yank-line (string)</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">"Insert STRING above the current line."</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(beginning-of-line)</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(unless (= (elt string (1- (length string))) ?\n)</span>
    <span class="org-comment-delimiter">;;     </span><span class="org-comment">(save-excursion (insert "\n")))</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(insert string))</span>

<span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment"> perf 2.00 s requiring bytecomp and warnings...</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class="org-function-name">duplicate-current-line</span> ()
    <span class="org-doc">"Duplicate the line containing point."</span>
    (interactive)
    (<span class="org-keyword">save-excursion</span>
      (<span class="org-keyword">let</span> (line-text)
        (goto-char (line-beginning-position))
        (<span class="org-keyword">let</span> ((beg (point)))
          (goto-char (line-end-position))
          (setq line-text (buffer-substring beg (point))))
        (<span class="org-keyword">if</span> (eobp)
            (insert ?\n)
          (forward-line))
        (open-line 1)
        (insert line-text))))

  (global-set-key (kbd <span class="org-string">"C-c d"</span>) 'duplicate-current-line)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline37" class="outline-3">
<h3 id="orgheadline37">Yanking</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline37">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 12.2 (info "(emacs)Yanking")</span>

  (leuven--section <span class="org-string">"12.2 (emacs)Yanking"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Auto-indentation of pasted code in the programming modes (fall back to</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">default, non-indented yanking by preceding the yanking command `</span><span class="org-constant"><span class="org-comment">C-y</span></span><span class="org-comment">' with</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">C-u</span></span><span class="org-comment">').</span>
  (<span class="org-keyword">dolist</span> (command '(yank
                     yank-pop))
    (eval `(<span class="org-keyword">defadvice</span> ,command (after leuven-indent-region activate)
             <span class="org-doc">"Indent `</span><span class="org-constant"><span class="org-doc">yank</span></span><span class="org-doc">'ed text if programming mode (and no prefix)."</span>
             (<span class="org-keyword">let</span> ((mark-even-if-inactive t))
               (and (not current-prefix-arg)
                    (derived-mode-p 'prog-mode)
                    (indent-region (region-beginning) (region-end) nil))))))
</pre></div>
<div id="outline-container-orgheadline39" class="outline-4">
<h4 id="orgheadline39">Yanking Earlier Kills</h4>
<div class="outline-text-4" id="text-orgheadline39">
<p>Interactively insert items from kill ring with <code>M-x helm-show-kill-ring</code> (see <a href="#orgheadline38">Helm</a>).</p>
</div>
</div>
</div>
<div id="outline-container-orgheadline40" class="outline-3">
<h3 id="orgheadline40">Cutting and Pasting on Graphical Displays</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline40">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 12.3 (info "(emacs)Cut and Paste")</span>

  (leuven--section <span class="org-string">"12.3 (emacs)Cut and Paste on Graphical Displays"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Copy/paste with Gnome desktop.</span>
  (GNUEmacs
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Make cut, copy and paste (keys and menu bar items) use the clipboard.</span>
    (menu-bar-enable-clipboard))
</pre></div>
</div>
<div id="outline-container-orgheadline41" class="outline-3">
<h3 id="orgheadline41">Rectangles</h3>
<div class="outline-text-3" id="text-orgheadline41">
<p>To kill the text of a rectangular area, use <code>C-x r k</code> (<code>kill-rectangle</code>). Or just "delete" the "region-rectangle" (without "killing" it) with <code>C-x r d</code>.</p>
<p>To copy a (series of) Org column(s) while avoiding the use of registers:</p>
<ol class="org-ol">
<li>select the region-rectangle,</li>
<li>use the command <code>copy-rectangle-as-kill</code> (bound to <code>C-x r M-w</code>), then</li>
<li>paste the copied rectangle by doing <code>yank-rectangle</code> (<code>C-x r y</code>).</li>
</ol>
<p>To do the same with registers:</p>
<ol class="org-ol">
<li>select the region-rectangle,</li>
<li>use <code>C-x r r R</code> to copy the rectangle to the register named <code>R</code>,</li>
<li>use <code>C-x r i R</code> to insert the rectangle that is being held in the register named <code>R</code>.</li>
</ol>
<p>To shift cells up/down within a column of an Org table while leaving remaining columns intact, use <code>kill-rectangle</code> and <code>yank-rectangle</code>.</p>
<p>To delete whitespace in each of the lines on the specified rectangle, use <code>M-x delete-whitespace-rectangle</code>.</p>
<p>Use <code>C-x r t STRING &lt;RET&gt;</code> to replace each line of a region-rectangle with a given string.</p>
<div class="note">
<p>Since Emacs 24.4, you can use <code>rectangle-mark-mode</code> (<code>C-x SPC</code>) and do:</p>
<ul class="org-ul">
<li><code>C-x SPC</code> &lt;move around&gt; <code>DEL</code> to delete the rectangle and</li>
<li><code>C-x SPC</code> &lt;move around&gt; <code>C-t</code> to invoke <code>string-rectangle</code>.</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgheadline42" class="outline-3">
<h3 id="orgheadline42">CUA Bindings</h3>
<div class="outline-text-3" id="text-orgheadline42">
<p>CUA mode sets up key bindings used in many other applications (<code>C-x</code>, <code>C-c</code>, <code>C-v</code> and <code>C-z</code>).</p>
<p>The <code>C-x</code> and <code>C-c</code> keys only do cut and copy when the region is active, so in most cases, they do not conflict with the normal function of these prefix keys.</p>
<p>If you really need to perform a command which starts with one of the prefix keys even when the region is active, you have three options:</p>
<ul class="org-ul">
<li>press the prefix key twice very quickly (within 0.2 seconds),</li>
<li>press the prefix key and the following key within 0.2 seconds, or</li>
<li>use the Shift key with the prefix key, i.e. <code>C-S-x</code> or <code>C-S-c</code>.</li>
</ul>
<p>You can customize <code>cua-enable-cua-keys</code> to completely disable the CUA bindings, or <code>cua-prefix-override-inhibit-delay</code> to change the prefix fallback behavior.</p>
<p>CUA mode also provides enhanced rectangle support with visible rectangle highlighting. Though, since Emacs 24.4, <code>rectangle-mark-mode</code> is the new way.</p>
<ul class="org-ul">
<li><code>&lt;C-RET&gt;</code> runs the command <code>cua-set-rectangle-mark</code></li>
<li><code>M-n</code> runs the command <code>cua-sequence-rectangle</code></li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 12 ends here</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline43" class="outline-2">
<h2 id="orgheadline43">Registers</h2>
<div class="outline-text-2 org-src-container" id="text-orgheadline43">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 13 (info "(emacs)Registers")</span>

(leuven--chapter leuven-load-chapter-13-registers <span class="org-string">"13 Registers"</span>
</pre></div>
<div id="outline-container-orgheadline44" class="outline-3">
<h3 id="orgheadline44">Saving Positions in Registers</h3>
<div class="outline-text-3" id="text-orgheadline44">
<p>Setup registers for files I commonly edit.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 13.1 (info "(emacs)Position Registers")</span>

  (leuven--section <span class="org-string">"13.1 (emacs)Position Registers"</span>)

  (global-set-key (kbd <span class="org-string">"C-j"</span>) 'jump-to-register) <span class="org-comment-delimiter">; </span><span class="org-comment">also on `C-x r j'</span>

  (set-register ?a '(file . <span class="org-string">"/sudo::/etc/apt/sources.list"</span>))
  (set-register ?b '(file . <span class="org-string">"~/.bashrc"</span>))
  (set-register ?e `(file . ,(concat leuven--directory <span class="org-string">"emacs-leuven.txt"</span>)))
  (<span class="org-keyword">when</span> (file-exists-p <span class="org-string">"~/org/personal/Personal.org"</span>)
    (set-register ?p '(file . <span class="org-string">"~/org/personal/Personal.org"</span>)))
  (<span class="org-keyword">when</span> (file-exists-p <span class="org-string">"~/org/refile.org"</span>)
    (set-register ?r '(file . <span class="org-string">"~/org/refile.org"</span>)))
  (<span class="org-keyword">when</span> (file-exists-p <span class="org-string">"~/org/work/Work.org"</span>)
    (set-register ?w '(file . <span class="org-string">"~/org/work/Work.org"</span>)))
  (set-register ?z '(file . <span class="org-string">"~/.zshrc"</span>))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline45" class="outline-3">
<h3 id="orgheadline45">Bookmarks</h3>
<div class="outline-text-3" id="text-orgheadline45">
<p>Bookmarks are <b>persistent</b> and they have <b>names</b>; not <i>markers</i>. Bookmarked positions can also be <b>relocated</b> (found) if they move slightly because of text changes.</p>
<p>To navigate to a bookmark (linking to a file or directory), just press <code>C-x r b</code>. You'll be prompted for the bookmark name, and it will open that file or directory.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 13.7 (info "(emacs)Bookmarks")</span>

  (leuven--section <span class="org-string">"13.7 (emacs)Bookmarks"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"bookmark"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Where to save the bookmarks.</span>
    (setq bookmark-default-file (concat user-emacs-directory <span class="org-string">"bookmarks.bmk"</span>))
                                        <span class="org-comment-delimiter">;</span><span class="org-comment">! a .txt extension would load Org at</span>
                                        <span class="org-comment-delimiter">;</span><span class="org-comment">! the time `</span><span class="org-constant"><span class="org-comment">bookmark</span></span><span class="org-comment">' is required!</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Each command that sets a bookmark will also save your bookmarks.</span>
    (setq bookmark-save-flag 1)
</pre></div>
<p>Visible bookmarks in buffer.</p>
<p><b>Bookmark+</b> offers everything that <code>bm.el</code> offers, and quite a bit more.</p>
<ul class="org-ul">
<li>You can bookmark arbitrary sets of files, from any locations.</li>
<li>You can bookmark Dired buffers (which, again, can actually list arbitrary files, not even necessarily in the same directory). Markings, subdir inclusions, and omissions are all recorded, and restored when you access the bookmark.</li>
<li>You can tag bookmarks or files, using arbitrary strings as tags. You can do this programmatically and interactively, by regexp, name, or Dired markings. Tags give you a great way to define sets of bookmarks or files - sets that can overlap etc. They serve to categorize, but they can do more than that. You can use tags to, in effect, merge projects, split projects, define subprojects, and so on.</li>
</ul>
<p>Key bindings:</p>
<dl class="org-dl">
<dt><code>C-x p RET</code> (C-F2 in Sublime Text and TextMate)</dt>
<dd><b>Set</b> (or delete) a <b>bookmark</b> at point.</dd>
<dt><code>C-x p C-down</code> (F2 in Sublime Text and TextMate)</dt>
<dd>Cycle to the <b>next</b> highlighted <b>bookmark</b> in the current buffer.</dd>
<dt><code>C-x p C-up</code> (S-F2 in Sublime Text and TextMate)</dt>
<dd>Cycle to the <b>previous</b> highlighted <b>bookmark</b> in the current buffer.</dd>
<dt><code>C-x (4) j h</code></dt>
<dd>Jump to a highlighted bookmark (in another window).</dd>
</dl>
<p>In TeXStudio:</p>
<ul class="org-ul">
<li>Set Bookmark 0..9: <code>C-S-0..9</code></li>
<li>Jump to Bookmark 0..9: <code>C-0..9</code></li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Extensions to standard library `</span><span class="org-constant"><span class="org-comment">bookmark.el</span></span><span class="org-comment">'.</span>
    (try-require 'bookmark+)
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"bookmark+"</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Default highlight style for autonamed bookmarks.</span>
(setq bmkp-light-style-autonamed 'rfringe)

<span class="org-comment-delimiter">;; </span><span class="org-comment">Default highlight style for non-autonamed bookmarks.</span>
(setq bmkp-light-style-non-autonamed 'rfringe)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Automatically highlight bookmarks when set.</span>
      (setq bmkp-auto-light-when-set 'any-bookmark)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Automatically highlight bookmarks when jumped to.</span>
      (setq bmkp-auto-light-when-jump 'any-bookmark)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't propertize bookmark names to hold full bookmark data.</span>
      (setq bmkp-propertize-bookmark-names-flag nil)))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">We will often be going back and forth</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">between using Bookmark+ and using</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">vanilla Emacs.</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline46" class="outline-3">
<h3 id="orgheadline46">Ace Jump</h3>
<div class="outline-text-3" id="text-orgheadline46">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Quickly jump to a position in the current view.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ace-jump-mode-autoloads"</span>
    (define-key global-map (kbd <span class="org-string">"C-c SPC"</span>) 'ace-jump-mode))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Quickly follow links using `</span><span class="org-constant"><span class="org-comment">ace-jump-mode</span></span><span class="org-comment">'.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ace-link-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Setup the defualt shortcuts.</span>
    (ace-link-setup-default <span class="org-comment-delimiter">;; </span><span class="org-comment">"f"</span>
     ))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Jump to things tree-style.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"avy-jump"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Default keys for jumping.</span>
    (setq avy-keys '(?a ?b ?c ?d ?e ?f ?g ?h ?i ?j ?k ?l ?m
                     ?n ?o ?p ?q ?r ?s ?t ?u ?v ?w ?x ?y ?z)))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 13 ends here</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline47" class="outline-2">
<h2 id="orgheadline47">Controlling the Display</h2>
<div class="outline-text-2 org-src-container" id="text-orgheadline47">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 14 Controlling the (info "(emacs)Display")</span>

(leuven--chapter leuven-load-chapter-14-display <span class="org-string">"14 Controlling the Display"</span>
</pre></div>
<div id="outline-container-orgheadline48" class="outline-3">
<h3 id="orgheadline48">Scrolling</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline48">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 14.1 (info "(emacs)Scrolling")</span>

  (leuven--section <span class="org-string">"14.1 (emacs)Scrolling"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Keep screen position of point when scrolling.</span>
  (setq scroll-preserve-screen-position t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Better scrolling in Emacs (doing a &lt;PageDown&gt; followed by a &lt;PageUp&gt; will</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">place the point at the same place).</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"pager-autoloads"</span>

    (autoload 'pager-page-up <span class="org-string">"pager"</span>
      <span class="org-doc">"Like scroll-down, but moves a fixed amount of lines."</span> t)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">These autoloads aren't defined in</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">pager-autoloads</span></span><span class="org-comment">'!</span>
    (autoload 'pager-page-down <span class="org-string">"pager"</span>
      <span class="org-doc">"Like scroll-up, but moves a fixed amount of lines."</span> t)

    (global-set-key (kbd <span class="org-string">"&lt;prior&gt;"</span>) 'pager-page-up)
    (global-set-key (kbd <span class="org-string">"&lt;next&gt;"</span>) 'pager-page-down))
</pre></div>
</div>
<div id="outline-container-orgheadline49" class="outline-3">
<h3 id="orgheadline49">Automatic Scrolling</h3>
<div class="outline-text-3" id="text-orgheadline49">
<p>"Smooth" (civilized) scrolling.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 14.3 (info "(emacs)Auto Scrolling")</span>

  (leuven--section <span class="org-string">"14.3 (emacs)Auto Scrolling"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Scroll only one line at a time (redisplay will never recenter point).</span>
  (setq scroll-conservatively 10000)    <span class="org-comment-delimiter">; </span><span class="org-comment">Or `</span><span class="org-constant"><span class="org-comment">most-positive-fixnum</span></span><span class="org-comment">'.</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Number of lines of margin at the top and bottom of a window.</span>
  (setq scroll-margin 1) <span class="org-comment-delimiter">; </span><span class="org-comment">or 3?        ; Also for `</span><span class="org-constant"><span class="org-comment">isearch-forward</span></span><span class="org-comment">'.</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Scrolling down looks much better.</span>
  (setq auto-window-vscroll nil)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline50" class="outline-3">
<h3 id="orgheadline50">Horizontal Scrolling</h3>
<div class="outline-text-3" id="text-orgheadline50">
<p>How to automatically add/remove horizontal scrollbars as needed by text width?</p>
</div>
</div>
<div id="outline-container-orgheadline51" class="outline-3">
<h3 id="orgheadline51">Narrowing</h3>
<div class="outline-text-3" id="text-orgheadline51">
<dl class="org-dl">
<dt><code>C-x n n</code></dt>
<dd><b>Narrow</b> down to between point and mark.</dd>
<dt><code>C-x n d</code></dt>
<dd><b>Narrow</b> down to the current <b>defun</b>.</dd>
<dt><code>C-x n s</code></dt>
<dd><b>Narrow</b> buffer to the current <b>subtree</b> (bound in Org mode).</dd>
<dt><code>C-x n w</code></dt>
<dd><b>Widen</b> to make the entire buffer accessible again.</dd>
</dl>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 14.5 (info "(emacs)Narrowing")</span>

  (leuven--section <span class="org-string">"14.5 (emacs)Narrowing"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable the use of the command `</span><span class="org-constant"><span class="org-comment">narrow-to-region</span></span><span class="org-comment">' without confirmation.</span>
  (put 'narrow-to-region 'disabled nil)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"fancy-narrow-autoloads"</span>
    (fancy-narrow-mode))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline52" class="outline-3">
<h3 id="orgheadline52">Font Lock mode</h3>
<div class="outline-text-3" id="text-orgheadline52">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 14.12 (info "(emacs)Font Lock")</span>

  (leuven--section <span class="org-string">"14.12 (emacs)Font Lock"</span>)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (XEmacs
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Stop showing that annoying progress bar when fontifying.</span>
    (setq progress-feedback-use-echo-area nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable Font Lock mode.</span>
    (font-lock-mode))
</pre></div>
<p>Prior to running their own mode hooks,</p>
<ul class="org-ul">
<li>all text-based major modes run <code>text-mode-hook</code>, and</li>
<li>all programming language modes run <code>prog-mode-hook</code>.</li>
</ul>
<p>XXX Try to get Org TODO overriding the TODO defined in leuven-highlight-keywords, so that only one expression can be used for <b>all</b> modes!</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Highlight </span><span class="org-leuven-highlight"><span class="org-comment">FIXME</span></span><span class="org-comment"> notes.</span>
  (<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-highlight-keywords</span>
    <span class="org-string">"</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">(</span></span><span class="org-leuven-highlight"><span class="org-string">TODO</span></span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">|</span></span><span class="org-leuven-highlight"><span class="org-string">FIXME</span></span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">|</span></span><span class="org-leuven-highlight"><span class="org-string">XXX</span></span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">|</span></span><span class="org-leuven-highlight"><span class="org-string">BUG</span></span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">)</span></span><span class="org-string">"</span>
    <span class="org-doc">"Patterns to highlight."</span>)

  (<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-highlight-keywords-in-org</span>
    <span class="org-string">"</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">(</span></span><span class="org-leuven-highlight"><span class="org-string">FIXME</span></span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">|</span></span><span class="org-leuven-highlight"><span class="org-string">XXX</span></span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">|</span></span><span class="org-leuven-highlight"><span class="org-string">BUG</span></span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">)</span></span><span class="org-string">"</span>
    <span class="org-doc">"Patterns to highlight (for Org mode only).</span>
<span class="org-doc">  The goal is to ensure no conflict with the Org mode </span><span class="org-leuven-highlight"><span class="org-doc">TODO</span></span><span class="org-doc"> keyword."</span>)

  (<span class="org-keyword">defface</span> <span class="org-variable-name">leuven-highlight-face</span>
    '((t (<span class="org-builtin">:foreground</span> <span class="org-string">"#CC0000"</span> <span class="org-builtin">:background</span> <span class="org-string">"#FFFF88"</span>)))
    <span class="org-doc">"Face for making </span><span class="org-leuven-highlight"><span class="org-doc">FIXME</span></span><span class="org-doc"> and other warnings stand out."</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Add highlighting keywords for selected major modes only.</span>
  (<span class="org-keyword">dolist</span> (mode '(fundamental-mode
                  text-mode))
    (font-lock-add-keywords mode
     `((,leuven-highlight-keywords 1 'leuven-highlight-face prepend))
     'end))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Add highlighting keywords for Org mode only.</span>
  (<span class="org-keyword">dolist</span> (mode '(org-mode))
    (font-lock-add-keywords mode
     `((,leuven-highlight-keywords-in-org 1 'leuven-highlight-face prepend))
     'end))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Add highlighting keywords for selected major modes *and* all major modes</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">derived from them.</span>
  (<span class="org-keyword">dolist</span> (hook '(prog-mode-hook
                  <span class="org-comment-delimiter">;; </span><span class="org-comment">text-mode-hook     ; avoid Org</span>
                  css-mode-hook         <span class="org-comment-delimiter">; </span><span class="org-comment">[parent: fundamental]</span>
                  latex-mode-hook
                  shell-mode-hook       <span class="org-comment-delimiter">; </span><span class="org-comment">[parent: fundamental]</span>
                  ssh-config-mode-hook))
    (add-hook hook
     (<span class="org-keyword">lambda</span> ()
       (font-lock-add-keywords nil      <span class="org-comment-delimiter">; </span><span class="org-comment">in the current buffer</span>
        `((,leuven-highlight-keywords 1 'leuven-highlight-face prepend)) 'end))))
        <span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">FIXME</span></span><span class="org-comment">                      0                        t          t</span>
</pre></div>
<p>See doc of <code>font-lock-keywords</code> and <code>font-lock-add-keywords</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Just-in-time fontification.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"jit-lock"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Stealth fontification should show status messages.</span>
    (setq jit-lock-stealth-verbose t))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline53" class="outline-3">
<h3 id="orgheadline53">Interactive Highlighting</h3>
<div class="outline-text-3" id="text-orgheadline53">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 14.13 (info "(emacs)Highlight Interactively") by Matching</span>

  (leuven--section <span class="org-string">"14.13 (emacs)Highlight Interactively by Matching"</span>)
</pre></div>
<p>You can use <b>Hi Lock</b> (part of Emacs) to highlight a regexp (identical tokens) throughout a buffer.</p>
<dl class="org-dl">
<dt><code>M-x hi-lock-mode &lt;RET&gt;</code></dt>
<dd>Enable or disable Hi Lock mode.</dd>
<dt><code>M-s h .</code></dt>
<dd><b>Highlight</b> each instance of the <b>symbol at point</b>.</dd>
<dt><code>M-s h r REGEXP &lt;RET&gt;</code></dt>
<dd>Highlight text that <b>matches REGEXP</b>.</dd>
<dt><code>M-s h l REGEXP &lt;RET&gt;</code></dt>
<dd>Highlight <b>entire lines</b> containing a match for REGEXP.</dd>
<dt><code>M-s h u REGEXP &lt;RET&gt;</code></dt>
<dd><b>Unhighlight</b> REGEXP.</dd>
</dl>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (GNUEmacs

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Do not prompt for the face to use. Instead, cycle through them.</span>
    (setq hi-lock-auto-select-face t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; enable Hi Lock mode for all buffers</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-hi-lock-mode 1)</span>
    )
</pre></div>
<p>It is complementary to the features of the library <b>Highlight-symbol</b> (from Nikolaj Schumacher).</p>
<ul class="org-ul">
<li>Hi Lock and Highlight-symbol both use <b>text properties</b>. Copying and pasting text will also paste the highlighting.</li>
<li>Hi Lock and Highlight-symbol both <b>highlight new text</b> as you type it.</li>
<li>Highlight-symbol lets you <b>navigate among highlights</b>: <code>highlight-symbol-next</code>, <code>highlight-symbol-prev</code>.</li>
</ul>
<p><code>Highlight-symbol</code> automatically chooses <b>rainbow colors</b> and makes it much easier to follow some key variables through a block of code.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"highlight-symbol-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Emulation of Vim's `*' search.</span>
    (global-set-key (kbd <span class="org-string">"C-*"</span>) 'highlight-symbol-at-point)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-&lt;f4&gt;") 'highlight-symbol-next)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "S-&lt;f4&gt;") 'highlight-symbol-prev)</span>
    (global-set-key (kbd <span class="org-string">"C-M-*"</span>) 'highlight-symbol-remove-all)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "+") 'highlight-symbol-query-replace)</span>
    )

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"highlight-symbol"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Number of seconds of idle time before highlighting the current symbol.</span>
    (setq highlight-symbol-idle-delay 0.5)

    (setq highlight-symbol-colors '(<span class="org-string">"#FFCDFF"</span> <span class="org-string">"#CCCCFF"</span> <span class="org-string">"#FFB6C6"</span> <span class="org-string">"#84CFFF"</span>))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Temporarily highlight the symbol when using `</span><span class="org-constant"><span class="org-comment">highlight-symbol-jump</span></span><span class="org-comment">'</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">family of functions.</span>
    (setq highlight-symbol-on-navigation-p t))
</pre></div>
<p>Use Auto-Highlight-Symbol to <b>automatically highlight</b> all found <b>usages of</b> the <b>symbol at point</b> in the current file (if you pause on a symbol). When you move point, the highlighting goes away.</p>
<p>Toggle Auto-Highlight-Symbol using key chord <code>**</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Automatic highlighting current symbol.</span>
  (<span class="org-keyword">when</span> (try-require 'auto-highlight-symbol)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">add R</span>
    (add-to-list 'ahs-modes 'ess-mode t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; toggle Auto-Highlight-Symbol mode in all buffers</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-auto-highlight-symbol-mode t)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; toggle Auto-Highlight-Symbol mode in all programming mode buffers</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'prog-mode-hook 'auto-highlight-symbol-mode)</span>
    )
</pre></div>
<p>XXX Check out <code>light-symbol</code>.</p>
<p>Color Identifiers Mode: <b>color</b> every <b>variable</b> in its own, consistent color.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment"> Impact on Org's HTML export?</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "color-identifiers-mode-autoloads"</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(add-hook 'after-init-hook 'global-color-identifiers-mode))</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline54" class="outline-3">
<h3 id="orgheadline54">Window Fringes</h3>
<div class="outline-text-3" id="text-orgheadline54">
<p>Show an icon in the fringe of version-controlled files indicating which <b>lines</b> have been <b>edited</b> (inserted, modified or deleted) <b>since the last commit</b>.</p>
<p>This feature gives you a really nice at-a-glance view of where you've made changes.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Indicate  changes in the fringe.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"diff-hl-autoloads"</span>
    (idle-require 'diff-hl))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"diff-hl"</span>
    (global-diff-hl-mode))
</pre></div>
<p>If you're using some package other than <code>vc</code> to commit changes, it might not run <code>vc-checkin-hook</code> after commits. In that case, you'll need to either add <code>diff-hl-update</code> to the hook it does run, or advise some function that's called in the buffer after its state has changed.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">defadvice</span> <span class="org-function-name">magit-refresh</span> (after diff-hl-refresh-after-magit-refresh activate)
    (<span class="org-keyword">dolist</span> (buffer (buffer-list))
      (<span class="org-keyword">with-current-buffer</span> buffer
        (<span class="org-keyword">when</span> diff-hl-mode
          (diff-hl-update)))))
</pre></div>
<div class="note">
<p>Of course, <code>diff-hl</code> is not updated when we commit changes with <code>sendpatch</code></p>
</div>
<p>Jump between changes:</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"diff-hl"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Jump to next hunk (also on `C-x v ]').</span>
    (define-key diff-hl-mode-map (kbd <span class="org-string">"C-x v &gt;"</span>) 'diff-hl-next-hunk)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Jump to previous hunk (also on `C-x v [').</span>
    (define-key diff-hl-mode-map (kbd <span class="org-string">"C-x v &lt;"</span>) 'diff-hl-previous-hunk)
</pre></div>
<p>Act on changes:</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Popup current diff.</span>
    (define-key diff-hl-mode-map (kbd <span class="org-string">"C-x v ="</span>) 'diff-hl-diff-goto-hunk)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Revert current hunk (also on `C-x v n').</span>
    (define-key diff-hl-mode-map (kbd <span class="org-string">"C-x v u"</span>) 'diff-hl-revert-hunk))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline55" class="outline-3">
<h3 id="orgheadline55">Displaying Boundaries</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline55">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 14.15 (info "(emacs)Displaying Boundaries")</span>

  (leuven--section <span class="org-string">"14.15 (emacs)Displaying Boundaries"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Visually indicate buffer boundaries and scrolling in the fringe.</span>
  (setq-default indicate-buffer-boundaries '((top . left) (t . right)))
</pre></div>
</div>
<div id="outline-container-orgheadline56" class="outline-3">
<h3 id="orgheadline56">Useless Whitespace</h3>
<div class="outline-text-3" id="text-orgheadline56">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 14.16 (info "(emacs)Useless Whitespace")</span>

  (leuven--section <span class="org-string">"14.16 (emacs)Useless Whitespace"</span>)
</pre></div>
<p>Make trailing whitespace at the end of a line visible.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Highlight trailing whitespaces in all modes.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq-default show-trailing-whitespace t)</span>
</pre></div>
<p>Remove trailing whitespace (right trim lines) <b>in all lines</b>:</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Nuke all trailing whitespaces in the buffer.</span>
  (add-hook 'before-save-hook
            (<span class="org-keyword">lambda</span> ()                  <span class="org-comment-delimiter">; </span><span class="org-comment">Except for ...</span>
              (<span class="org-keyword">let</span> ((buffer-undo-list buffer-undo-list)) <span class="org-comment-delimiter">; </span><span class="org-comment">For goto-chg.</span>
                (<span class="org-keyword">unless</span> (or (derived-mode-p 'message-mode)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">... where "-- " is the signature</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">separator (for when using emacsclient</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">to compose emails and doing C-x #).</span>
                            (derived-mode-p 'diff-mode))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">... where the patch file can't be</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">changed!</span>
                  (delete-trailing-whitespace)))))
</pre></div>
<p>Remove trailing whitespace <b>in edited lines</b> with <code>ws-butler</code>:</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Unobtrusively remove trailing whitespace.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ws-butler-autoloads"</span>

    (add-hook 'text-mode-hook 'ws-butler-mode)
    (add-hook 'prog-mode-hook 'ws-butler-mode))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Visually indicate empty lines after the buffer end in the fringe.</span>
  (setq-default indicate-empty-lines t)
</pre></div>
<p>When Whitespace mode is on, it takes care of highlighting some special characters over the default mechanism of <code>nobreak-char-display</code> and <code>show-trailing-whitespace</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (GNUEmacs
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable Whitespace mode in all file buffers (not in *vc-dir*, etc.).</span>
    (add-hook 'text-mode-hook 'whitespace-mode)
    (add-hook 'prog-mode-hook 'whitespace-mode)

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"whitespace"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Which kind of blank is visualized.</span>
      (setq whitespace-style
            '(face
              trailing
              tabs
              <span class="org-comment-delimiter">;; </span><span class="org-comment">lines-tail</span>
              indentation::space
              space-mark
              tab-mark))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Column beyond which the line is highlighted.</span>
      (setq whitespace-line-column 80)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Mappings for displaying characters.</span>
      (setq whitespace-display-mappings
            '((space-mark ?\u00A0       <span class="org-comment-delimiter">; </span><span class="org-comment">No-break space.</span>
                          [?_]          <span class="org-comment-delimiter">; </span><span class="org-comment">Spacing underscore.</span>
                          [?_])         <span class="org-comment-delimiter">; </span><span class="org-comment">Spacing underscore.</span>

              (space-mark ?\u202F       <span class="org-comment-delimiter">; </span><span class="org-comment">Narrow no-break space.</span>
                          [?\u00B7]     <span class="org-comment-delimiter">; </span><span class="org-comment">Middle dot.</span>
                          [?.])

              (tab-mark ?\t             <span class="org-comment-delimiter">; </span><span class="org-comment">Tabulation.</span>
                        [?\u25BA ?\t]   <span class="org-comment-delimiter">; </span><span class="org-comment">Black right-pointing pointer.</span>
                        [?\\ ?\t])))))
</pre></div>
<p>Example : VPATH= /home/jt/src/cygwin/cygwin-packages/1.7/python-2.6.8-2/python-2.6.8-2/src/Python-2.6.8 LDLAST= SGI_ABI= PYTHON_OBJS= \ Python/pythonrun.o \ Python/random.o \ Python/structmember.o</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Control highlighting of non-ASCII space and hyphen chars, using the</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; `</span><span class="org-constant"><span class="org-comment">nobreak-space</span></span><span class="org-comment">' or `</span><span class="org-constant"><span class="org-comment">escape-glyph</span></span><span class="org-comment">' face respectively.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq nobreak-char-display t)      ; [Default]</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Show zero-width spaces.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(font-lock-add-keywords nil</span>
  <span class="org-comment-delimiter">;;  </span><span class="org-comment">`((,(format "\\(%c\\)" ?\u200B) ; #\ZERO_WIDTH_SPACE</span>
  <span class="org-comment-delimiter">;;     </span><span class="org-comment">(1 (progn (compose-region (match-beginning 1) (match-end 1)</span>
  <span class="org-comment-delimiter">;;                               </span><span class="org-comment">?\u2B1B ; #\BLACK_LARGE_SQUARE</span>
  <span class="org-comment-delimiter">;;                               </span><span class="org-comment">'decompose-region)</span>
  <span class="org-comment-delimiter">;;               </span><span class="org-comment">nil)))))</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline57" class="outline-3">
<h3 id="orgheadline57">Selective Display</h3>
<div class="outline-text-3" id="text-orgheadline57">
<p>Emacs has the ability to <b>hide lines indented more than a given number of columns</b>. You can use this to get an overview of a part of a program.</p>
<p>To hide lines with at least 1 column of indentation (replacing them by an ellipsis), type <code>C-1 C-x $</code> (or <code>C-x $</code> and give it <code>1</code> as depth argument). It gives a quick overview any source file.</p>
<p>To make all lines visible again, type <code>C-x $</code> with no argument.</p>
<p>See also <b>Outline Mode</b> for another way to hide part of the text in a buffer.</p>
</div>
</div>
<div id="outline-container-orgheadline58" class="outline-3">
<h3 id="orgheadline58">Optional Mode Line Features</h3>
<div class="outline-text-3" id="text-orgheadline58">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 14.18 (info "(emacs)Optional Mode Line") Features</span>

  (leuven--section <span class="org-string">"14.18 (emacs)Optional Mode Line Features"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Show the column number in each mode line.</span>
  (column-number-mode 1)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Unclutter the mode line.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"diminish-autoloads"</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"abbrev"</span>       (diminish 'abbrev-mode <span class="org-string">" Ab"</span>))
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"checkdoc"</span>     (diminish 'checkdoc-minor-mode <span class="org-string">" Cd"</span>))
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "company"      (diminish 'company-mode " Cp"))</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Company displays the currently used</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">backend in the mode-line.</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"eldoc"</span>        (diminish 'eldoc-mode))
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"fancy-narrow"</span> (diminish 'fancy-narrow-mode))
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"flycheck"</span>     (diminish 'flycheck-mode <span class="org-string">" fC"</span>))
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"flyspell"</span>     (diminish 'flyspell-mode <span class="org-string">" fS"</span>))
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"google-this"</span>  (diminish 'google-this-mode))
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"hilit-chg"</span>    (diminish 'highlight-changes-mode))
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "isearch"      (diminish 'isearch-mode (string 32 ?\u279c)))</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"paredit"</span>      (diminish 'paredit-mode <span class="org-string">" Pe"</span>))
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"rainbow-mode"</span> (diminish 'rainbow-mode))
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"simple"</span>       (diminish 'auto-fill-function))
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"whitespace"</span>   (diminish 'whitespace-mode))
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"yasnippet"</span>    (diminish 'yas-minor-mode)))
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(diminish-on-load hs-minor-mode-hook hs-minor-mode)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "glasses"      (diminish 'glasses-mode))</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "redshank"     (diminish 'redshank-mode))</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"smartparens"</span>  (diminish 'smartparens-mode))
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "whitespace"   (diminish 'whitespace-mode))</span>
</pre></div>
<p>See <a href="https://powerline.readthedocs.org/en/latest/overview.html#vim-statusline">https://powerline.readthedocs.org/en/latest/overview.html#vim-statusline</a> for screenshots.</p>
<p>See <a href="https://github.com/bling/vim-airline">https://github.com/bling/vim-airline</a> for the original author.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">defface</span> <span class="org-variable-name">powerline-modified-face</span>
    '((((class color))
       (<span class="org-builtin">:background</span> <span class="org-string">"#FFA335"</span> <span class="org-builtin">:foreground</span> <span class="org-string">"black"</span> <span class="org-builtin">:weight</span> bold))
      (t (<span class="org-builtin">:weight</span> bold)))
    <span class="org-doc">"Face to fontify modified files."</span>
    <span class="org-builtin">:group</span> 'powerline)

  (<span class="org-keyword">defface</span> <span class="org-variable-name">powerline-normal-face</span>
    '((((class color))
       (<span class="org-builtin">:background</span> <span class="org-string">"#4F9D03"</span> <span class="org-builtin">:foreground</span> <span class="org-string">"black"</span> <span class="org-builtin">:weight</span> bold))
      (t (<span class="org-builtin">:weight</span> bold)))
    <span class="org-doc">"Face to fontify unchanged files."</span>
    <span class="org-builtin">:group</span> 'powerline)

  (<span class="org-keyword">defface</span> <span class="org-variable-name">powerline-default-dictionary-active-face</span>
    '((((class color))
       (<span class="org-builtin">:background</span> <span class="org-string">"#8A2BE2"</span> <span class="org-builtin">:foreground</span> <span class="org-string">"black"</span> <span class="org-builtin">:weight</span> bold))
      (t (<span class="org-builtin">:weight</span> bold)))
    <span class="org-doc">"Face to fontify default dictionary in the active buffer."</span>
    <span class="org-builtin">:group</span> 'powerline)

  (<span class="org-keyword">defface</span> <span class="org-variable-name">powerline-default-dictionary-inactive-face</span>
    '((((class color))
       (<span class="org-builtin">:background</span> <span class="org-string">"thistle"</span> <span class="org-builtin">:foreground</span> <span class="org-string">"black"</span> <span class="org-builtin">:weight</span> bold))
      (t (<span class="org-builtin">:weight</span> bold)))
    <span class="org-doc">"Face to fontify default dictionary in inactive buffers."</span>
    <span class="org-builtin">:group</span> 'powerline)

  (<span class="org-keyword">defface</span> <span class="org-variable-name">powerline-other-dictionary-active-face</span>
    '((((class color))
       (<span class="org-builtin">:background</span> <span class="org-string">"yellow"</span> <span class="org-builtin">:foreground</span> <span class="org-string">"black"</span> <span class="org-builtin">:weight</span> bold))
      (t (<span class="org-builtin">:weight</span> bold)))
    <span class="org-doc">"Face to fontify another dictionary in the active buffer."</span>
    <span class="org-builtin">:group</span> 'powerline)

  (<span class="org-keyword">defface</span> <span class="org-variable-name">powerline-other-dictionary-inactive-face</span>
    '((((class color))
       (<span class="org-builtin">:background</span> <span class="org-string">"LightYellow1"</span> <span class="org-builtin">:foreground</span> <span class="org-string">"black"</span> <span class="org-builtin">:weight</span> bold))
      (t (<span class="org-builtin">:weight</span> bold)))
    <span class="org-doc">"Face to fontify another dictionary in inactive buffers."</span>
    <span class="org-builtin">:group</span> 'powerline)

  (<span class="org-keyword">defun</span> <span class="org-function-name">powerline-leuven-theme</span> ()
    <span class="org-doc">"Setup the leuven mode-line."</span>
    (interactive)
    (setq-default mode-line-format
     '(<span class="org-string">"%e"</span>
       (<span class="org-builtin">:eval</span>
        (<span class="org-keyword">let*</span> ((active (powerline-selected-window-active))
               (mode-line (<span class="org-keyword">if</span> active
                              'mode-line
                            'mode-line-inactive))
               (face1 (<span class="org-keyword">if</span> active
                          'powerline-active1
                        'powerline-inactive1))
               (face2 (<span class="org-keyword">if</span> active
                          'powerline-active2
                        'powerline-inactive2))
               (default-dictionary-face
                 (<span class="org-keyword">if</span> active
                     'powerline-default-dictionary-active-face
                   'powerline-default-dictionary-inactive-face))
               (other-dictionary-face
                (<span class="org-keyword">if</span> active
                    'powerline-other-dictionary-active-face
                  'powerline-other-dictionary-inactive-face))
               (separator-left
                (intern
                 (format <span class="org-string">"powerline-%s-%s"</span>
                         powerline-default-separator
                         (car powerline-default-separator-dir))))
               (separator-right
                (intern
                 (format <span class="org-string">"powerline-%s-%s"</span>
                         powerline-default-separator
                         (cdr powerline-default-separator-dir))))
               (lhs (list
                     <span class="org-comment-delimiter">;; </span><span class="org-comment">VC mode.</span>
                     (<span class="org-keyword">when</span> (and (fboundp 'vc-switches)
                                buffer-file-name
                                vc-mode)
                       (<span class="org-keyword">if</span> (eq (vc-state buffer-file-name) 'up-to-date)
                           (powerline-vc 'powerline-normal-face 'r)
                         (powerline-vc 'powerline-modified-face 'r)))

                     (<span class="org-keyword">when</span> (and (not (fboundp 'vc-switches))
                                buffer-file-name
                                vc-mode)
                       (powerline-vc face1 'r))

                     (<span class="org-keyword">when</span> (and buffer-file-name
                                vc-mode)
                       (<span class="org-keyword">if</span> (eq (vc-state buffer-file-name) 'up-to-date)
                           (funcall separator-left 'powerline-normal-face mode-line)
                         (funcall separator-left 'powerline-modified-face mode-line)))

                     <span class="org-comment-delimiter">;; </span><span class="org-comment">"Modified" indicator.</span>
                     (<span class="org-keyword">if</span> (not (buffer-modified-p))
                         (powerline-raw <span class="org-string">"%*"</span> nil 'l)
                       (powerline-raw <span class="org-string">"%*"</span> 'mode-line-emphasis 'l))

                     (powerline-raw mode-line-mule-info nil 'l)

                     (powerline-buffer-id nil 'l)

                     (<span class="org-keyword">when</span> (and (boundp 'which-func-mode) which-func-mode)
                       (powerline-raw which-func-format nil 'l))

                     (powerline-raw <span class="org-string">" "</span>)
                     (funcall separator-left mode-line face1)
                     (<span class="org-keyword">when</span> (boundp 'erc-modified-channels-object)
                       (powerline-raw erc-modified-channels-object face1 'l))
                     (powerline-major-mode face1 'l)
                     (powerline-process face1)
                     (powerline-raw <span class="org-string">" "</span> face1)
                     (funcall separator-left face1 face2)
                     (powerline-minor-modes face2 'l)
                     (powerline-narrow face2 'l)
                     (powerline-raw <span class="org-string">" "</span> face2)
                     (funcall separator-left face2 mode-line)))
               (rhs (list (powerline-raw global-mode-string mode-line 'r)
                          (funcall separator-right mode-line face1)
</pre></div>
<p>Line/column replacement. Shows column in red when we go over the 80th character.</p>
<p>See <a href="http://www.elliotglaysher.org/emacs/">http://www.elliotglaysher.org/emacs/</a></p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
                          (powerline-raw <span class="org-string">"%l"</span> face1 'l)
                          (powerline-raw <span class="org-string">", "</span> face1 'l)
                          (powerline-raw <span class="org-string">"%c"</span> face1 'r)
                          (funcall separator-right face1 mode-line)
                          (powerline-raw <span class="org-string">" "</span>)
                          (powerline-raw <span class="org-string">"%4p"</span> nil 'r)
                          (funcall separator-right mode-line face2)
                          (powerline-buffer-size face2 'l)
                          (powerline-raw <span class="org-string">" "</span> face2)

                          (<span class="org-keyword">let</span> ((dict (and (<span class="org-keyword">featurep</span> '<span class="org-constant">ispell</span>)
                                           (or
                                            ispell-local-dictionary
                                            ispell-dictionary))))
                            <span class="org-comment-delimiter">;; </span><span class="org-comment">Add 2 spaces after the language indicator</span>
                            <span class="org-comment-delimiter">;; </span><span class="org-comment">(for GNU/Linux).</span>
                            (<span class="org-keyword">cond</span> (buffer-read-only
                                   (powerline-raw <span class="org-string">"%%%%  "</span> default-dictionary-face 'l))
                                  ((null dict)
                                   (powerline-raw <span class="org-string">"--  "</span> default-dictionary-face 'l))
                                  (t
                                   (powerline-raw (concat (substring dict 0 2) <span class="org-string">"  "</span>) other-dictionary-face 'l))))

                          <span class="org-comment-delimiter">;; </span><span class="org-comment">(powerline-hud face2 face1)</span>
                          )))
          (concat (powerline-render lhs)
                  (powerline-fill mode-line (powerline-width rhs))
                  (powerline-render rhs)))))))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"powerline-autoloads"</span>
    (add-hook 'after-init-hook 'powerline-leuven-theme))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline59" class="outline-3">
<h3 id="orgheadline59">Displaying the Cursor</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline59">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 14.20 The (info "(emacs)Cursor Display")</span>

  (leuven--section <span class="org-string">"14.20 (emacs)The Cursor Display"</span>)

  (GNUEmacs
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Use cursor color and type to indicate some modes (read-only, overwrite</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">and normal insert modes).</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--set-cursor-according-to-mode</span> ()
      <span class="org-doc">"Change cursor color according to some minor modes."</span>
      (<span class="org-keyword">let</span> ((color (<span class="org-keyword">cond</span> (buffer-read-only <span class="org-string">"purple1"</span>)
                         (overwrite-mode   <span class="org-string">"red"</span>)
                         (t                <span class="org-string">"#21BDFF"</span>))) <span class="org-comment-delimiter">; </span><span class="org-comment">Black.</span>
            (type (<span class="org-keyword">if</span> (null overwrite-mode)
                      'bar
                    'box)))
        (set-cursor-color color)
        (setq cursor-type type)))

    (add-hook 'post-command-hook 'leuven--set-cursor-according-to-mode))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Cursor to use.</span>
  (setq-default cursor-type 'bar)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Cursor of the selected window blinks.</span>
  (XEmacs
    (blink-cursor-mode))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Cursor blinks forever.</span>
  (setq blink-cursor-blinks 0)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Toggle line highlighting in all buffers (Global Hl-Line mode).</span>
  (global-hl-line-mode 1)               <span class="org-comment-delimiter">; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment"> Perhaps only in prog-modes?</span>
</pre></div>
</div>
<div id="outline-container-orgheadline60" class="outline-3">
<h3 id="orgheadline60">Truncation of Lines</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline60">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 14.21 (info "(emacs)Line Truncation")</span>

  (leuven--section <span class="org-string">"14.21 (emacs)Line Truncation"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Respect the value of `</span><span class="org-constant"><span class="org-comment">truncate-lines</span></span><span class="org-comment">' in all windows less than the full</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">width of the frame.</span>
  (setq truncate-partial-width-windows nil)
</pre></div>
</div>
<div id="outline-container-orgheadline61" class="outline-3">
<h3 id="orgheadline61">Customization of Display</h3>
<div class="outline-text-3" id="text-orgheadline61">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 14.23 (info "(emacs)Display Custom")ization</span>

  (leuven--section <span class="org-string">"14.23 (emacs)Display Customization"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Echo what I'm typing *immediately*.</span>
  (setq echo-keystrokes 0.01)
</pre></div>
<p>Display pressed keyboard shortcuts on screen during presentations or screencasts.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Exhaustive log of interactions with Emacs (display keystrokes, etc.).</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"interaction-log-autoloads"</span>

    (autoload 'interaction-log-mode <span class="org-string">"interaction-log"</span>
      <span class="org-doc">"Global minor mode logging keys, commands, file loads and messages."</span> t)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">This autoload isn't defined in</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">interaction-log-autoloads</span></span><span class="org-comment">'!</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Maximum number of lines to keep in the *Emacs Log* buffer.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq ilog-log-max 10)</span>

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-display-interaction-log</span> ()
      <span class="org-doc">"Display the Interaction-Log buffer."</span>
      (interactive)
      (interaction-log-mode 1)
      (display-buffer ilog-buffer-name))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Hotkey for showing the log buffer.</span>
    (global-set-key (kbd <span class="org-string">"C-h C-l"</span>) 'leuven-display-interaction-log))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 14 ends here</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline62" class="outline-2">
<h2 id="orgheadline62">Searching and Replacement</h2>
<div class="outline-text-2 org-src-container" id="text-orgheadline62">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 15 (info "(emacs)Search")ing and Replacement</span>

(leuven--chapter leuven-load-chapter-15-search <span class="org-string">"15 Searching and Replacement"</span>
</pre></div>
<div id="outline-container-orgheadline63" class="outline-3">
<h3 id="orgheadline63">Incremental Search (aka "Live Search")</h3>
<div class="outline-text-3" id="text-orgheadline63">
<p>Have a look at the "Standard Isearch Keys" on <a href="http://www.emacswiki.org/emacs/IncrementalSearch">http://www.emacswiki.org/emacs/IncrementalSearch</a></p>
<p>Isearch has a binding which deletes all the non-matching characters from the search string: <code>C-g</code> (not a very intuitive binding, because it's usually associated with aborting operations, not with correcting things).</p>
<p>If you hit <code>M-e</code> (to edit the search string), the cursor is moved to the mismatch position.</p>
<p>Since Emacs 24.3:</p>
<ul class="org-ul">
<li><code>M-s _</code> starts a symbol (identifier) incremental search.</li>
<li><code>M-s _</code> in Isearch toggles symbol search mode.</li>
<li><code>M-s c</code> in Isearch toggles search case-sensitivity.</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 15.1 (info "(emacs)Incremental Search")</span>

  (leuven--section <span class="org-string">"15.1 (emacs)Incremental Search"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">FIXME</span></span><span class="org-comment"> Error when selecting search string from kill ring (`</span><span class="org-constant"><span class="org-comment">M-p</span></span><span class="org-comment">')</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; always exit searches at the beginning of the expression found</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'isearch-mode-end-hook 'isearch-goto-match-beginning)</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(defun isearch-goto-match-beginning ()</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">"Use with isearch hook to end search at first char of match."</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(when isearch-forward (goto-char isearch-other-end)))</span>

  (GNUEmacs
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Incremental search/query-replace will open the contents.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq search-invisible 'open)       ; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't re-hide an invisible match right away.</span>
    (setq isearch-hide-immediately nil))<span class="org-comment-delimiter">; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">scrolling commands are allowed during incremental search (without</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">canceling Isearch mode)</span>
  (setq isearch-allow-scroll t)
</pre></div>
<div class="note">
<p>When <code>search-invisible</code> is <code>t</code>, <code>perform-replace</code> can replace matches in any invisible text, but does not display it when prompting the user for confirmation.</p>
<p>When <code>search-invisible</code> is <code>'open</code>, <code>perform-replace</code> can replace matches only in hidden text (invisible through an overlay), and displays it when prompting the user.</p>
<p>We lack a way to reveal truly invisible text when performing a search and replace. The URL of a bracket link in Org is an example of such truly invisible text.</p>
<p>Juri's solution to add <code>'open-all</code> could also be used in <code>perform-replace</code> to let the user see truly invisible matches before replacing them.</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (GNUEmacs
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Fuzzy matching utilities (a must-have).</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"fuzzy-autoloads"</span>

      (autoload 'turn-on-fuzzy-isearch <span class="org-string">"fuzzy"</span> nil t)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">This autoload isn't defined in</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">fuzzy-autoloads</span></span><span class="org-comment">'!</span>

      (add-hook 'isearch-mode-hook 'turn-on-fuzzy-isearch)))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Show number of matches in mode-line while searching.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"anzu-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable Global-Anzu mode.</span>
    (global-anzu-mode 1)

    (global-set-key (kbd <span class="org-string">"M-%"</span>) 'anzu-query-replace)
    (global-set-key (kbd <span class="org-string">"C-M-%"</span>) 'anzu-query-replace-regexp)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Lighter of anzu-mode.</span>
    (setq anzu-mode-lighter <span class="org-string">""</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq anzu-deactivate-region t)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq anzu-search-threshold 1000)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq anzu-replace-to-string-separator " =&gt; ")</span>
    )
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline64" class="outline-3">
<h3 id="orgheadline64">Symbol Search</h3>
<div class="outline-text-3" id="text-orgheadline64">
<dl class="org-dl">
<dt><code>M-s .</code> (<code>isearch-forward-symbol-at-point</code>)</dt>
<dd>Start a symbol (identifier) incremental search forward with the symbol found near point added to the search string initially.</dd>
</dl>
</div>
</div>
<div id="outline-container-orgheadline65" class="outline-3">
<h3 id="orgheadline65">Regexp Search</h3>
<div class="outline-text-3" id="text-orgheadline65">
<p>Emacs uses basic regular expressions, which means that the extended regexp operators have to be escaped. This means you have to use <code>\(</code>, <code>\|</code>, and <code>\)</code> instead of <code>(</code>, <code>|</code>, and <code>)</code>.</p>
<p>You can build regexps with visual feedback by using:</p>
<ul class="org-ul">
<li><code>M-x re-builder</code> or</li>
<li><code>M-x regex-tool</code> (by John Wiegley)</li>
</ul>
<p>Optimize regexps with <code>regexp-opt.el</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 15.5 (info "(emacs)Regexp Search")</span>

  (leuven--section <span class="org-string">"15.5 (emacs)Regexp Search"</span>)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Use regexps by default (allows searching across line breaks).</span>
  (global-set-key (kbd <span class="org-string">"C-s"</span>) 'isearch-forward-regexp)
  (global-set-key (kbd <span class="org-string">"C-r"</span>) 'isearch-backward-regexp)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Shift the meaning of `</span><span class="org-constant"><span class="org-comment">C-M-s/r</span></span><span class="org-comment">' with `</span><span class="org-constant"><span class="org-comment">C-s/r</span></span><span class="org-comment">'.</span>
  (global-set-key (kbd <span class="org-string">"C-M-s"</span>) 'isearch-forward)
  (global-set-key (kbd <span class="org-string">"C-M-r"</span>) 'isearch-backward)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline66" class="outline-3">
<h3 id="orgheadline66">Search Case</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline66">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 15.9 (info "(emacs)Search Case")</span>

  (leuven--section <span class="org-string">"15.9 (emacs)Search Case"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Searches should ignore case by default (in all buffers that do not</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">override this).</span>
  (setq-default case-fold-search t)
</pre></div>
</div>
<div id="outline-container-orgheadline67" class="outline-3">
<h3 id="orgheadline67">Replacement Commands</h3>
<div class="outline-text-3" id="text-orgheadline67">
<p>Pass the string or the regexp directly to <code>query-replace</code>, so you can't mangle it on the way, by pressing <code>M-%</code> while at the <code>I-search:</code> prompt.</p>
</div>
</div>
<div id="outline-container-orgheadline68" class="outline-3">
<h3 id="orgheadline68">Other Search-and-Loop Commands</h3>
<div class="outline-text-3" id="text-orgheadline68">
<p><code>M-x flush-lines</code> (or <code>delete-matching-lines</code>) deletes each line that contains a match for REGEXP.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 15.11 (info "(emacs)Other Repeating Search") Commands</span>

  (leuven--section <span class="org-string">"15.11 (emacs)Other Repeating Search Commands"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Invoke `</span><span class="org-constant"><span class="org-comment">occur</span></span><span class="org-comment">' easily from within `</span><span class="org-constant"><span class="org-comment">isearch</span></span><span class="org-comment">'.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key isearch-mode-map (kbd "C-o")</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(lambda ()</span>
  <span class="org-comment-delimiter">;;     </span><span class="org-comment">(interactive)</span>
  <span class="org-comment-delimiter">;;     </span><span class="org-comment">(let ((case-fold-search isearch-case-fold-search))</span>
  <span class="org-comment-delimiter">;;       </span><span class="org-comment">(occur</span>
  <span class="org-comment-delimiter">;;        </span><span class="org-comment">(if isearch-regexp</span>
  <span class="org-comment-delimiter">;;            </span><span class="org-comment">isearch-string</span>
  <span class="org-comment-delimiter">;;          </span><span class="org-comment">(regexp-quote isearch-string))))))</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">When doing Isearch, hand the word over to `</span><span class="org-constant"><span class="org-comment">helm-swoop</span></span><span class="org-comment">'.</span>
  (define-key isearch-mode-map (kbd <span class="org-string">"C-o"</span>) 'helm-swoop-from-isearch)

  (global-unset-key (kbd <span class="org-string">"M-o"</span>)) <span class="org-comment-delimiter">; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment">???</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">"Multi-occur" easily inside Isearch.</span>
  (define-key isearch-mode-map (kbd <span class="org-string">"M-o"</span>) 'helm-multi-swoop-all)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Grep all same extension files from inside Isearch.</span>
  (define-key isearch-mode-map (kbd <span class="org-string">"C-M-o"</span>)
    (<span class="org-keyword">lambda</span> ()
      (interactive)
      (grep-compute-defaults)
      (lgrep (<span class="org-keyword">if</span> isearch-regexp isearch-string (regexp-quote isearch-string))
             (<span class="org-keyword">if</span> (file-name-extension (buffer-file-name))
              (format <span class="org-string">"*.%s"</span> (file-name-extension (buffer-file-name)))
              <span class="org-string">"*"</span>)
             default-directory)
      (isearch-abort)))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 15 ends here</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline69" class="outline-2">
<h2 id="orgheadline69">Commands for Fixing Typos</h2>
<div class="outline-text-2 org-src-container" id="text-orgheadline69">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 16 Commands for (info "(emacs)Fixit") Typos</span>

(leuven--chapter leuven-load-chapter-16-fixit <span class="org-string">"16 Commands for Fixing Typos"</span>
</pre></div>
<div id="outline-container-orgheadline70" class="outline-3">
<h3 id="orgheadline70">Checking and Correcting Spelling</h3>
<div class="outline-text-3" id="text-orgheadline70">
<div class="note">
<p>On Windows:</p>
<ul class="org-ul">
<li>Install <a href="http://ftp.gnu.org/gnu/aspell/w32/Aspell-0-50-3-3-Setup.exe">GNU Aspell 0.50.3</a> (more dictionaries than Cygwin Aspell)</li>
<li>Install <a href="http://ftp.gnu.org/gnu/aspell/w32/Aspell-en-0.50-2-3.exe">Aspell English dictionary-0.50-2</a></li>
<li>Add <code>C:\Program Files (x86)\Aspell\bin</code> to the System <code>PATH</code></li>
</ul>
</div>
<p>GNU <b>Aspell</b> is better than <b>Ispell</b>:</p>
<ul class="org-ul">
<li>It does recognize words with apostrophes (l'avion) but it is slower.</li>
<li>It can handle UTF-8 documents far better than Ispell can.</li>
</ul>
<p>When spellchecking a buffer, the <code>A</code> command accepts an incorrect word, and adds it to the <b>file word list</b> (<code>ispell-add-per-file-word-list</code>).</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 16.4 Checking and Correcting (info "(emacs)Spelling")</span>

  (leuven--section <span class="org-string">"16.4 (emacs)Checking and Correcting Spelling"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Spelling checker program.</span>
  (setq ispell-program-name             <span class="org-comment-delimiter">; </span><span class="org-comment">Defined in ispell.el.</span>
        (or (executable-find <span class="org-string">"aspell"</span>)
            (executable-find <span class="org-string">"ispell"</span>)
            <span class="org-comment-delimiter">;; </span><span class="org-comment">nil                      ; [Default: "ispell"]</span>
            ))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Check if `</span><span class="org-constant"><span class="org-comment">ispell-program-name</span></span><span class="org-comment">' seems correct.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--ispell-check-program-name</span> ()
    <span class="org-doc">"Ensure that `</span><span class="org-constant"><span class="org-doc">ispell-program-name</span></span><span class="org-doc">' is defined and non-nil."</span>
    (and (boundp 'ispell-program-name)
         ispell-program-name))

  (<span class="org-keyword">when</span> (leuven--ispell-check-program-name)

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-ispell-region-or-buffer</span> ()
      <span class="org-doc">"Interactively check the current region or buffer for spelling errors."</span>
      (interactive)
      (<span class="org-keyword">if</span> mark-active
          (<span class="org-keyword">if</span> (&lt; (mark) (point))
              (ispell-region (mark) (point))
              (ispell-region (point) (mark)))
          (ispell-buffer)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Key bindings (or `C-c i' prefix key binding?).</span>
    (global-set-key (kbd <span class="org-string">"C-$"</span>) 'leuven-ispell-region-or-buffer)
    (global-set-key (kbd <span class="org-string">"C-M-$"</span>) 'ispell-change-dictionary)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Default dictionary to use (if `</span><span class="org-constant"><span class="org-comment">ispell-local-dictionary</span></span><span class="org-comment">' is nil, that</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; is if there is no local dictionary to use in the buffer).</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq ispell-dictionary "american") ; see `</span><span class="org-constant"><span class="org-comment">sentence-end-double-space</span></span><span class="org-comment">'</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable on-the-fly spell checking.</span>
    (add-hook 'org-mode-hook
              (<span class="org-keyword">lambda</span> ()
                (<span class="org-keyword">if</span> (or (eq (aref (buffer-name) 0) ?\s)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Buffer starting with " *".</span>
                        (and (boundp 'org-babel-exp-reference-buffer)
                             org-babel-exp-reference-buffer))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Export buffer.</span>
                    (message <span class="org-string">"DON'T TURN ON Flyspell mode in `</span><span class="org-constant"><span class="org-string">%s</span></span><span class="org-string">'"</span> (buffer-name))
                  (message <span class="org-string">"Turn on Flyspell mode in `</span><span class="org-constant"><span class="org-string">%s</span></span><span class="org-string">'"</span> (buffer-name))
                  (flyspell-mode))))
</pre></div>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Enable Flyspell in other modes deriving from Text (HTML, etc.)</b><br />
nil</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable on-the-fly spell checking.</span>
    (add-hook 'text-mode-hook
              (<span class="org-keyword">lambda</span> ()
                (message <span class="org-string">"Turn on Flyspell mode in `</span><span class="org-constant"><span class="org-string">%s</span></span><span class="org-string">'"</span> (buffer-name))
                (flyspell-mode)))

    (<span class="org-keyword">defadvice</span> <span class="org-function-name">org-export-as</span> (around leuven-org-export-as activate)
      <span class="org-doc">"Turn off Text mode hooks (Flyspell, etc.) when exporting current Org buffer."</span>
      (<span class="org-keyword">let</span> (text-mode-hook)
        ad-do-it))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Prevent Flyspell from finding mistakes in the code, well in comments and</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">strings.</span>
    (add-hook 'prog-mode-hook 'flyspell-prog-mode)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ispell"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Save the personal dictionary without confirmation.</span>
      (setq ispell-silently-savep t)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Extensions and extra switches to pass to the `</span><span class="org-constant"><span class="org-comment">ispell</span></span><span class="org-comment">' program.</span>
      (<span class="org-keyword">cond</span>
</pre></div>
<p>Tell <code>aspell</code> to speed up, though this reduces somewhat the quality of its suggestions. According to the <code>aspell</code> documentation:</p>
<ul class="org-ul">
<li>"ultra" is the fastest suggestion mode, which is still twice as slow as <code>ispell</code>.</li>
<li>If your machine is fast enough, a better option might be to try "fast" mode, which is twice as slow as "ultra", but more accurate.</li>
<li>The "normal" mode, which is the <code>aspell</code> default, is even more accurate, but is reportedly 10 times slower than "fast" mode.</li>
</ul>
<p>Use the <code>-C</code> option which will ConsiderCamelCaseToBeCorrect.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
       ((string-match <span class="org-string">"aspell"</span> ispell-program-name)
        (setq ispell-extra-args '(<span class="org-string">"--sug-mode=ultra"</span> <span class="org-string">"-C"</span>))
        (setq ispell-really-aspell t)
        (setq ispell-really-hunspell nil))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
       ((string-match <span class="org-string">"ispell"</span> ispell-program-name)
        (setq ispell-extra-args '())
        (setq ispell-really-aspell nil)
        (setq ispell-really-hunspell nil)))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
      <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Solve the problem of words separated by `-' flagged as</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">;; erroneous by removing the `-' from the value of otherchars.</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(if (fboundp 'ispell-get-decoded-string)</span>
      <span class="org-comment-delimiter">;;     </span><span class="org-comment">(defun ispell-get-otherchars ()</span>
      <span class="org-comment-delimiter">;;       </span><span class="org-comment">(replace-regexp-in-string "-" "" (ispell-get-decoded-string 3))))</span>
</pre></div>
<p>Add language indicator.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq-default mode-line-format</span>
      <span class="org-comment-delimiter">;;               </span><span class="org-comment">(cons</span>
      <span class="org-comment-delimiter">;;                </span><span class="org-comment">'(:eval</span>
      <span class="org-comment-delimiter">;;                  </span><span class="org-comment">(let ((dict (and (featurep 'ispell)</span>
      <span class="org-comment-delimiter">;;                                   </span><span class="org-comment">(not buffer-read-only)</span>
      <span class="org-comment-delimiter">;;                                   </span><span class="org-comment">(or ispell-local-dictionary</span>
      <span class="org-comment-delimiter">;;                                       </span><span class="org-comment">ispell-dictionary</span>
      <span class="org-comment-delimiter">;;                                       </span><span class="org-comment">"--" ; default dictionary</span>
      <span class="org-comment-delimiter">;;                                       </span><span class="org-comment">))))</span>
      <span class="org-comment-delimiter">;;                    </span><span class="org-comment">(and dict</span>
      <span class="org-comment-delimiter">;;                         </span><span class="org-comment">(propertize (concat " " (substring dict 0 2))</span>
      <span class="org-comment-delimiter">;;                                     </span><span class="org-comment">'face 'mode-line-highlight))))</span>
      <span class="org-comment-delimiter">;;                </span><span class="org-comment">(default-value 'mode-line-format)))</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
      )
</pre></div>
<div class="note">
<p>Each time you cycle to another window (<code>C-x o</code>), the <b>Ispell process</b> gets <b>killed</b> and a <b>new Ispell process</b> is <b>started</b>, if the language in the next window is different from the language in the current window</p>
</div>
<p><code>flyspell-auto-correct-word</code> is bound to <code>C-.</code>. Press it one time to correct the word under the cursor. If several spellings are possible, they appear in the minibuffer. Just keep hitting <code>C-.</code> to replace the word with the successive suggestions.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"flyspell"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Remove the binding of `</span><span class="org-constant"><span class="org-comment">flyspell-auto-correct-previous-word</span></span><span class="org-comment">', to be used</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">by Multiple Cursors.</span>
      (define-key flyspell-mode-map (kbd <span class="org-string">"C-;"</span>) nil))
</pre></div>
<p><code>flyspell-goto-next-error</code> is bound to "C-,". Press it to go to the next previously detected error.</p>
<p><code>flyspell-correct-word-before-point</code> is bound to <code>C-c $</code>. Press it to <b>pop up a menu</b> of possible corrections for misspelled word before point.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't use `</span><span class="org-constant"><span class="org-comment">M-TAB</span></span><span class="org-comment">' to auto-correct the current word (only use `</span><span class="org-constant"><span class="org-comment">C-.</span></span><span class="org-comment">').</span>
    (setq flyspell-use-meta-tab nil)
    <span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">FIXME</span></span><span class="org-comment"> M-TAB is still bound to `</span><span class="org-constant"><span class="org-comment">flyspell-auto-correct-word</span></span><span class="org-comment">' when this</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">chunk of code is placed within (with-eval-after-load "flyspell"...)</span>

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"flyspell"</span>

     <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't consider that a word repeated twice is an error.</span>
     (setq flyspell-mark-duplications-flag nil)

     <span class="org-comment-delimiter">;; </span><span class="org-comment">Lower (for performance reasons) the maximum distance for finding</span>
     <span class="org-comment-delimiter">;; </span><span class="org-comment">duplicates of unrecognized words.</span>
     (setq flyspell-duplicate-distance 12000) <span class="org-comment-delimiter">; </span><span class="org-comment">[default: 400000]</span>

     <span class="org-comment-delimiter">;; </span><span class="org-comment">Fix the "enabling flyspell mode gave an error" bug.</span>
     (setq flyspell-issue-welcome-flag nil)

     <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Don't print messages for every word (when checking the entire buffer)</span>
     <span class="org-comment-delimiter">;; </span><span class="org-comment">;; as it causes a (small) slowdown.</span>
     <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq flyspell-issue-message-flag nil)</span>

     <span class="org-comment-delimiter">;; </span><span class="org-comment">Dash character (`-') is considered as a word delimiter.</span>
     (setq-default flyspell-consider-dash-as-word-delimiter-flag t)
     <span class="org-comment-delimiter">;; </span><span class="org-comment">'("francais" "deutsch8" "norsk")</span>

     (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-flyspell-toggle-dictionary</span> ()
       <span class="org-doc">"Toggle the local dictionary between French and US English."</span>
       (interactive)
       (<span class="org-keyword">let</span> ((dict (or ispell-local-dictionary
                       ispell-dictionary)))
         (setq dict (<span class="org-keyword">if</span> (string= dict <span class="org-string">"francais"</span>) <span class="org-string">"american"</span> <span class="org-string">"francais"</span>))
         (message <span class="org-string">"Switched to %S"</span> dict)
         (sit-for 0.5)
         (ispell-change-dictionary dict)
         (force-mode-line-update)
         (<span class="org-keyword">when</span> flyspell-mode
           <span class="org-comment-delimiter">;; </span><span class="org-comment">(flyspell-delete-all-overlays)</span>
           <span class="org-comment-delimiter">;; </span><span class="org-comment">If above is executed, the advised `</span><span class="org-constant"><span class="org-comment">org-mode-flyspell-verify</span></span><span class="org-comment">'</span>
           <span class="org-comment-delimiter">;; </span><span class="org-comment">won't work anymore.</span>
           (flyspell-buffer))))

     <span class="org-comment-delimiter">;; </span><span class="org-comment">Key bindings.</span>
     (global-set-key (kbd <span class="org-string">"C-$"</span>) 'flyspell-buffer)
     (global-set-key (kbd <span class="org-string">"C-M-$"</span>) 'leuven-flyspell-toggle-dictionary)

     <span class="org-comment-delimiter">;; </span><span class="org-comment">Spell-check your XHTML (by adding `</span><span class="org-constant"><span class="org-comment">nxml-text-face</span></span><span class="org-comment">' to the list of</span>
     <span class="org-comment-delimiter">;; </span><span class="org-comment">faces corresponding to text in programming-mode buffers).</span>
     (add-to-list 'flyspell-prog-text-faces 'nxml-text-face)))
</pre></div>
<p>I need often bilingual dictionaries like the excellent leo.org and dict.cc; dict.el with the dict servers is not really an option. At the moment I'm using mostly my mobile phone as portable dictionary but I'd rather want do this within Emacs.</p>
<p>There seem to be at least 3 solutions:</p>
<ul class="org-ul">
<li>x-dict.el, <a href="http://www.xsteve.at/prg/python/">http://www.xsteve.at/prg/python/</a></li>
<li>r-dict.el, <a href="https://github.com/tsdh/rdictcc">https://github.com/tsdh/rdictcc</a></li>
<li>eww, but leo.org and dict.cc are barely readable in eww</li>
</ul>
<p>What is working for you?</p>
<p>I use eedic and dict/dictd running on my own computer.</p>
<p>s-d looks up the word under the cursor and displays the result in a second window.</p>
<p>s-n finds any singleword anagrams of the word under the cursor.</p>
<p>s-w uses Wordplay by Evans Crisswell to list all words that can be made from the letters in the current word as well as multiword anagrams.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Client for rfc2229 dictionary servers.</span>
  (try-require <span class="org-string">"dictionary-autoloads"</span>)
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"dictionary-autoloads"</span>

    (global-set-key (kbd <span class="org-string">"C-c C-d s"</span>) 'dictionary-search)
    (global-set-key (kbd <span class="org-string">"C-c C-d l"</span>) 'dictionary-lookup-definition)
    (global-set-key (kbd <span class="org-string">"C-c C-d m"</span>) 'dictionary-match-words))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"dictionary"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable/disable the tooltip support for all buffers.</span>
    (<span class="org-keyword">if</span> leuven--console-p
        (global-dictionary-tooltip-mode 0)
      (global-dictionary-tooltip-mode 1)))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment"> excellent!</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-answers-define</span> ()
    <span class="org-doc">"Look up the word under cursor in a browser."</span>
    (interactive)
    (browse-url
     (concat <span class="org-string">"http://www.answers.com/main/ntquery?s="</span> (find-tag-default))))

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-lookup-word-definition-in-w3m</span> ()
    <span class="org-doc">"Look up the word's definition in a emacs-w3m.</span>
<span class="org-doc">  If a region is active (a phrase), lookup that phrase."</span>
    (interactive)
    (<span class="org-keyword">let</span> (word
          url)
      (setq word
            (<span class="org-keyword">if</span> (use-region-p)
                (buffer-substring-no-properties (region-beginning)
                                                (region-end))
              (find-tag-default)))
      (setq word (replace-regexp-in-string <span class="org-string">" "</span> <span class="org-string">"%20"</span> word))
      (setq url (concat <span class="org-string">"http://www.answers.com/main/ntquery?s="</span> word))
      (w3m-browse-url url)))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 16 ends here</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline71" class="outline-2">
<h2 id="orgheadline71">Keyboard Macros</h2>
<div class="outline-text-2 org-src-container" id="text-orgheadline71">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 17 (info "(emacs)Keyboard Macros")</span>

(leuven--chapter leuven-load-chapter-17-keyboard-macros <span class="org-string">"17 Keyboard Macros"</span>
</pre></div>
<div id="outline-container-orgheadline72" class="outline-3">
<h3 id="orgheadline72">Basic Use</h3>
<div class="outline-text-3" id="text-orgheadline72">
<dl class="org-dl">
<dt><code>&lt;S-f8&gt;</code></dt>
<dd>Start recording your keyboard macro.</dd>
<dt><code>&lt;S-f8&gt;</code> again</dt>
<dd>Stop recording it.</dd>
<dt><code>&lt;f8&gt;</code></dt>
<dd>Call the keyboard macro.</dd>
</dl>
<p>If you want to check the result each time before repeating, type <code>&lt;f8&gt; e e...</code>.</p>
<p>If you want to repeat only N times, type <code>C-u N &lt;f8&gt;</code>.</p>
<p>If you want to repeat forever or until error, type <code>C-u 0 &lt;f8&gt;</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 17.1 (info "(emacs)Basic Keyboard Macro") Use</span>

  (leuven--section <span class="org-string">"17.1 (emacs)Basic Keyboard Macro Use"</span>)

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-kmacro-turn-on-recording</span> ()
    <span class="org-doc">"Start recording a keyboard macro and toggle functionality of key binding."</span>
    (interactive)
    (global-set-key (kbd <span class="org-string">"&lt;S-f8&gt;"</span>) 'leuven-kmacro-turn-off-recording)
    (kmacro-start-macro nil))

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-kmacro-turn-off-recording</span> ()
    <span class="org-doc">"Stop recording a keyboard macro and toggle functionality of key binding."</span>
    (interactive)
    (global-set-key (kbd <span class="org-string">"&lt;S-f8&gt;"</span>) 'leuven-kmacro-turn-on-recording)
    (kmacro-end-macro nil))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Start/stop recording a keyboard macro.</span>
  (global-set-key (kbd <span class="org-string">"&lt;S-f8&gt;"</span>) 'leuven-kmacro-turn-on-recording)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Execute the most recent keyboard macro.</span>
  (global-set-key (kbd <span class="org-string">"&lt;f8&gt;"</span>) 'kmacro-call-macro)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline73" class="outline-3">
<h3 id="orgheadline73">Naming and Saving Keyboard Macros</h3>
<div class="outline-text-3" id="text-orgheadline73">
<dl class="org-dl">
<dt><code>&lt;C-f8&gt;</code></dt>
<dd>Give the keyboard macro a name (to invoke it under that name).</dd>
</dl>
<p>Assign the last macro to a free key binding of your choice with <code>kmacro-bind-to-key</code> (bound to <code>C-x C-k b</code>).</p>
<p>To <b>save a named keyboard macro</b> (with its key binding) for future use, switch to your <code>.emacs</code> file, and run <code>C-u M-x insert-kbd-macro</code> (if you leave out the <code>C-u</code>, then it will just insert the macro definition without the <code>global-set-key</code> sequence).</p>
<p>You can add <code>(interactive)</code> to make it a command, so that you can use it with <code>M-x</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 17.5 Name and (info "(emacs)Save Keyboard Macro")s</span>

  (leuven--section <span class="org-string">"17.5 (emacs)Name and Save Keyboard Macros"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Assign a name to the last keyboard macro defined.</span>
  (global-set-key (kbd <span class="org-string">"&lt;C-f8&gt;"</span>) 'kmacro-name-last-macro)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 17 ends here</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline74" class="outline-2">
<h2 id="orgheadline74">Files Handling</h2>
<div class="outline-text-2 org-src-container" id="text-orgheadline74">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 18 (info "(emacs)Files") Handling</span>

(leuven--chapter leuven-load-chapter-18-files <span class="org-string">"18 Files Handling"</span>
</pre></div>
<div id="outline-container-orgheadline75" class="outline-3">
<h3 id="orgheadline75">Visiting Files</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline75">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 18.2 (info "(emacs)Visiting") Files</span>

  (leuven--section <span class="org-string">"18.2 (emacs)Visiting Files"</span>)

  (<span class="org-keyword">defadvice</span> <span class="org-function-name">find-file</span> (around leuven-find-file activate)
    <span class="org-doc">"Open the file named FILENAME and report time spent."</span>
    (<span class="org-keyword">let</span> ((filename (ad-get-arg 0))
          (find-file-time-start (float-time)))
      (message <span class="org-string">"(Info) Finding file %s..."</span> filename)
      ad-do-it
      (message <span class="org-string">"(Info) Found file %s in %.2f s"</span> filename
               (- (float-time) find-file-time-start))))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Visit a file.</span>
  (global-set-key (kbd <span class="org-string">"&lt;f3&gt;"</span>) 'find-file)
</pre></div>
</div>
<div id="outline-container-orgheadline76" class="outline-3">
<h3 id="orgheadline76">Saving Files</h3>
<div class="outline-text-3" id="text-orgheadline76">
<p>You can define a <b>shadow file</b> group to automatically upload local files to a remote location.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 18.3 (info "(emacs)Saving") Files</span>

  (leuven--section <span class="org-string">"18.3 (emacs)Saving Files"</span>)

  (<span class="org-keyword">defadvice</span> <span class="org-function-name">save-buffer</span> (around leuven-save-buffer activate)
    <span class="org-doc">"Save the file named FILENAME and report time spent."</span>
    (<span class="org-keyword">let</span> ((filename (buffer-file-name))
          (save-buffer-time-start (float-time)))
      (message <span class="org-string">"(Info) Saving file %s..."</span> filename)
      ad-do-it
      (message <span class="org-string">"(Info) Saved file %s in %.2f s"</span> filename
               (- (float-time) save-buffer-time-start))))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Make your changes permanent.</span>
  (global-set-key (kbd <span class="org-string">"&lt;f2&gt;"</span>) 'save-buffer)
</pre></div>
<p>Builtin file version control of Emacs.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Make numbered backups.</span>
  (setq version-control t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Save backup files (i.e., `</span><span class="org-constant"><span class="org-comment">foo~</span></span><span class="org-comment">' or `</span><span class="org-constant"><span class="org-comment">foo.~i~</span></span><span class="org-comment">') in one central location</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(instead of in the local directory).</span>
  (GNUEmacs
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Filenames matching a regexp are backed up in the corresponding</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">directory.</span>
    (setq backup-directory-alist
          <span class="org-comment-delimiter">;; </span><span class="org-comment">Emacs will `</span><span class="org-constant"><span class="org-comment">make-directory</span></span><span class="org-comment">' it, if necessary.</span>
          '((<span class="org-string">".*"</span> . <span class="org-string">"~/.emacs.d/backups/"</span>)))) <span class="org-comment-delimiter">; </span><span class="org-comment">regexp =&gt; directory mappings</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Number of oldest versions to keep when a new numbeRed backup is made.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq kept-old-versions 0)            ; [default: 2]</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Number of newest versions to keep when a new numbered backup is made.</span>
  (setq kept-new-versions 5)            <span class="org-comment-delimiter">; </span><span class="org-comment">[default: 2]</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't ask me about deleting excess backup versions.</span>
  (setq delete-old-versions t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Always use copying to create backup files (don't clobber symlinks).</span>
  (setq backup-by-copying t)
</pre></div>
<p>Customize saving actions.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Ensure newline at the end of file when it is saved.</span>
  (setq require-final-newline t)
  <span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment"> Do this only for text and Fundamental modes, because I could</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">edit binary files (see `</span><span class="org-constant"><span class="org-comment">mode-require-final-newline</span></span><span class="org-comment">')</span>
</pre></div>
<p>Update time stamps (and copyright notice) automatically.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Update time stamps every time you save a buffer.</span>
  (add-hook 'before-save-hook 'time-stamp)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Maintain last change time stamps (`Time-stamp: &lt;&gt;' occurring within</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">the first 8 lines) in files edited by Emacs.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"time-stamp"</span>

   <span class="org-comment-delimiter">;; </span><span class="org-comment">Format of the string inserted by `M-x time-stamp':</span>
   <span class="org-comment-delimiter">;; </span><span class="org-comment">`YYYY-MM-DD Day HH:MM' (see `</span><span class="org-constant"><span class="org-comment">system-time-locale</span></span><span class="org-comment">' for non-numeric</span>
   <span class="org-comment-delimiter">;; </span><span class="org-comment">formatted items of time).</span>
   (setq-default time-stamp-format <span class="org-string">"%:y-%02m-%02d %3a %02H:%02M"</span>))

  (GNUEmacs
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Update the copyright notice to indicate the current year.</span>
    (add-hook 'before-save-hook
              (<span class="org-keyword">lambda</span> ()                <span class="org-comment-delimiter">; </span><span class="org-comment">Except for ...</span>
                (<span class="org-keyword">unless</span> (derived-mode-p 'diff-mode)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">... where the patch file can't be</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">changed!</span>
                  (copyright-update)))))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline77" class="outline-3">
<h3 id="orgheadline77">Reverting a Buffer</h3>
<div class="outline-text-3" id="text-orgheadline77">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 18.4 (info "(emacs)Reverting") a Buffer</span>

  (leuven--section <span class="org-string">"18.4 (emacs)Reverting a Buffer"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Replace current buffer text with the text of the visited file on disk.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-revert-buffer-without-query</span> ()
    <span class="org-doc">"Unconditionally revert current buffer."</span>
    (interactive)
    (revert-buffer t t)                 <span class="org-comment-delimiter">; </span><span class="org-comment">ignore-auto(-save), noconfirm</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Remove less important overlays</span>
    (<span class="org-keyword">dolist</span> (o (overlays-in (window-start) (window-end)))
      (<span class="org-keyword">when</span> (or (equal (overlay-get o 'face) 'recover-this-file)
                (equal (overlay-get o 'face) 'org-block-executing))
        (delete-overlay o)))            <span class="org-comment-delimiter">; </span><span class="org-comment">Useful when our advice of function</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">org-babel-execute-src-block</span></span><span class="org-comment">' fails to</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">remove the background color.</span>
    (message <span class="org-string">"Buffer is up to date with file on disk"</span>))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">key binding</span>
  (global-set-key (kbd <span class="org-string">"&lt;C-f12&gt;"</span>) 'leuven-revert-buffer-without-query)
</pre></div>
<p>Turn on auto-revert mode globally.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable Global Auto-Revert mode (auto refresh buffers).</span>
  (global-auto-revert-mode 1)           <span class="org-comment-delimiter">; </span><span class="org-comment">Can generate a lot of network traffic</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">if `</span><span class="org-constant"><span class="org-comment">auto-revert-remote-files</span></span><span class="org-comment">' is set</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">to non-nil.</span>
</pre></div>
<p>Auto-revert will automatically reload files that have changed outside of Emacs. It won't revert a buffer that you've edited inside Emacs, even if the file also changes outside.</p>
</div>
</div>
<div id="outline-container-orgheadline78" class="outline-3">
<h3 id="orgheadline78">Auto Reverting Non-File Buffers</h3>
<div class="outline-text-3" id="text-orgheadline78">
<p>XXX See if <code>dired-auto-revert-buffer</code> is sufficient or not.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Global Auto-Revert mode operates on all buffers (Dired, among others)</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq global-auto-revert-non-file-buffers t)</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Do not generate any messages (be quiet about refreshing Dired).</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq auto-revert-verbose nil)     ; Avoid "Reverting buffer `</span><span class="org-constant"><span class="org-comment">some-dir/</span></span><span class="org-comment">'.".</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline79" class="outline-3">
<h3 id="orgheadline79">Auto-Saving: Protection Against Disasters</h3>
<div class="outline-text-3" id="text-orgheadline79">
<p>How to get Emacs to auto-save to your local disk (<code>#file#</code>).</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 18.6 (info "(emacs)Auto Save"): Protection Against Disasters</span>

  (leuven--section <span class="org-string">"18.6 (emacs)Auto Save: Protection Against Disasters"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Auto-save every 100 input events.</span>
  (setq auto-save-interval 100)         <span class="org-comment-delimiter">; </span><span class="org-comment">[default: 300]</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Auto-save after 10 seconds idle time.</span>
  (setq auto-save-timeout 10)           <span class="org-comment-delimiter">; </span><span class="org-comment">[default: 30]</span>
</pre></div>
<p>Disable backups and auto-save only in the current buffer with <code>M-x sensitive-mode</code>:</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">define-minor-mode</span> <span class="org-function-name">sensitive-mode</span>
    <span class="org-doc">"For sensitive files like password lists.</span>
<span class="org-doc">  It disables backup creation and auto saving in the current buffer.</span>

<span class="org-doc">  With no argument, this command toggles the mode.  Non-null prefix argument</span>
<span class="org-doc">  turns on the mode.  Null prefix argument turns off the mode."</span>
    nil                                 <span class="org-comment-delimiter">; </span><span class="org-comment">Initial value.</span>
    <span class="org-string">" Sensitive"</span>                        <span class="org-comment-delimiter">; </span><span class="org-comment">Indicator for the mode line.</span>
    nil                                 <span class="org-comment-delimiter">; </span><span class="org-comment">Minor mode bindings.</span>
    (<span class="org-keyword">if</span> (symbol-value sensitive-mode)
        (<span class="org-keyword">progn</span>
          <span class="org-comment-delimiter">;; </span><span class="org-comment">Disable backups.</span>
          (set (make-local-variable 'backup-inhibited) t)
          <span class="org-comment-delimiter">;; </span><span class="org-comment">Disable auto-save.</span>
          (<span class="org-keyword">if</span> auto-save-default
              (auto-save-mode -1)))
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Resort to default value of backup-inhibited.</span>
      (kill-local-variable 'backup-inhibited)
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Resort to default auto save setting.</span>
      (<span class="org-keyword">if</span> auto-save-default
          (auto-save-mode 1))))
</pre></div>
<p>You should enable it for all <code>.vcf</code> and <code>.gpg</code> files.</p>
<p>Make the message "<i>FILENAME has auto save data</i>" unmissable:</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">defface</span> <span class="org-variable-name">recover-this-file</span>
    '((t (<span class="org-builtin">:weight</span> bold <span class="org-builtin">:background</span> <span class="org-string">"#FF3F3F"</span>)))
    <span class="org-doc">"Face for buffers visiting files with auto save data."</span>
    <span class="org-builtin">:group</span> 'files)

  (<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven--recover-this-file</span> nil
    <span class="org-doc">"If non-nil, an overlay indicating that the visited file has auto save data."</span>)

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--recover-this-file</span> ()
    (<span class="org-keyword">let</span> ((<span class="org-warning">warn</span> (not buffer-read-only)))
      (<span class="org-keyword">when</span> (and warn
                 <span class="org-comment-delimiter">;; </span><span class="org-comment">No need to warn if buffer is auto-saved under the name of</span>
                 <span class="org-comment-delimiter">;; </span><span class="org-comment">the visited file.</span>
                 (not (and buffer-file-name
                           auto-save-visited-file-name))
                 (file-newer-than-file-p (or buffer-auto-save-file-name
                                             (make-auto-save-file-name))
                                         buffer-file-name))
        (set (make-local-variable 'leuven--recover-this-file)
             (make-overlay (point-min) (point-max)))
        (overlay-put leuven--recover-this-file
                     'face 'recover-this-file))))

  (add-hook 'find-file-hook 'leuven--recover-this-file)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline80" class="outline-3">
<h3 id="orgheadline80">Comparing Files</h3>
<div class="outline-text-3" id="text-orgheadline80">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 18.9 (info "(emacs)Comparing Files")</span>

  (leuven--section <span class="org-string">"18.9 (emacs)Comparing Files"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Default to unified diffs.</span>
  (setq diff-switches <span class="org-string">"-u"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Compare text in current window with text in next window.</span>
  (global-set-key (kbd <span class="org-string">"C-="</span>) 'compare-windows)
</pre></div>
<p>You can use <code>M-x smerge-mode</code> to edit a file with conflict markers (output from the <code>diff3</code> program). Smerge does not automatically select regions but provides convenient key bindings to navigate between conflicts and to choose the A or B variant.</p>
</div>
</div>
<div id="outline-container-orgheadline81" class="outline-3">
<h3 id="orgheadline81">Diff mode</h3>
<div class="outline-text-3" id="text-orgheadline81">
<p>You can review the diff of all file changes, either:</p>
<ul class="org-ul">
<li>unified (Diff mode) or</li>
<li>split (Ediff mode).</li>
</ul>
<p>In Diff mode, I can <b>select a hunk and apply it (in reverse)</b>. Nice following <code>C-x v =</code> to show what's changed, and decide to reverse a change.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 18.10 (info "(emacs)Diff Mode")</span>

  (leuven--section <span class="org-string">"18.10 (emacs)Diff Mode"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Mode for viewing/editing context diffs.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"diff-mode"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Highlight the changes with better granularity.</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-diff-make-fine-diffs</span> ()
      <span class="org-doc">"Enable Diff Auto-Refine mode."</span>
      (interactive)
      (<span class="org-keyword">let</span> (diff-auto-refine-mode)      <span class="org-comment-delimiter">; </span><span class="org-comment">Avoid refining the hunks redundantly ...</span>
        (<span class="org-keyword">condition-case</span> nil
            (<span class="org-keyword">save-excursion</span>
              (goto-char (point-min))
              (<span class="org-keyword">while</span> (not (eobp))
                (diff-hunk-next)
                (diff-refine-hunk)))    <span class="org-comment-delimiter">; </span><span class="org-comment">... when this does it.</span>
          (<span class="org-warning">error</span> nil))
        (run-at-time 0.0 nil
                     (<span class="org-keyword">lambda</span> ()
                       (<span class="org-keyword">if</span> (derived-mode-p 'diff-mode)
                           <span class="org-comment-delimiter">;; </span><span class="org-comment">Put back the cursor only if still in a Diff buffer</span>
                           <span class="org-comment-delimiter">;; </span><span class="org-comment">after the delay.</span>
                           (goto-char (point-min)))))))

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--diff-make-fine-diffs-if-necessary</span> ()
      <span class="org-doc">"Auto-refine only the regions of 14,000 bytes or less."</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Check for auto-refine limit.</span>
      (<span class="org-keyword">unless</span> (&gt; (buffer-size) 14000)
        (leuven-diff-make-fine-diffs)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(when (fboundp 'advice-add)</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(advice-add 'vc-diff :after</span>
    <span class="org-comment-delimiter">;;    </span><span class="org-comment">(lambda (&amp;rest _)</span>
    <span class="org-comment-delimiter">;;      </span><span class="org-comment">(leuven--diff-make-fine-diffs-if-necessary))))</span>

    <span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment"> I tried this simpler form, but does not work.</span>
    (<span class="org-keyword">defadvice</span> <span class="org-function-name">vc-diff</span> (after leuven-vc-diff activate)
      <span class="org-doc">"Push the auto-refine function after `</span><span class="org-constant"><span class="org-doc">vc-diff</span></span><span class="org-doc">'."</span>
      (leuven--diff-make-fine-diffs-if-necessary))

    )
</pre></div>
<p>To compare 2 text files, you can also use Ediff if the following command works.</p>
<pre class="example">
M-: (executable-find "diff") RET
</pre>
<p>In Ediff, press:</p>
<ul class="org-ul">
<li><code>?</code> to get help</li>
<li><code>|</code> to change from vertical window layout to horizontal window layout, and vice versa</li>
<li><code>a</code> or <code>b</code> key to merge the code from A to B or from B to A</li>
<li><code>ra</code> or <code>rb</code> to revert your change</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Ediff, a comprehensive visual interface to diff &amp; patch</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; setup for Ediff's menus and autoloads</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(try-require 'ediff-hook)</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">already loaded (by Emacs?)</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ediff"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Ignore space.</span>
    (setq ediff-diff-options (concat ediff-diff-options <span class="org-string">" -w"</span>))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Add new options after the default ones.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Skip over difference regions that differ only in white space and line</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">breaks.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq-default ediff-ignore-similar-regions  t)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment"> Make another key binding (than `E') with that value in a let-bind</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Sometimes grab the mouse and put it in the control frame.</span>
    (setq ediff-grab-mouse 'maybe)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Do everything in one frame.</span>
    (setq ediff-window-setup-function 'ediff-setup-windows-plain)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">split the window (horizontally or vertically) depending on the frame</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">width</span>
    (setq ediff-split-window-function
          (<span class="org-keyword">lambda</span> (<span class="org-type">&amp;optional</span> arg)
            (<span class="org-keyword">if</span> (&gt; (frame-width) 160)
                (split-window-horizontally arg)
              (split-window-vertically arg))))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq ediff-merge-split-window-function 'split-window-vertically)</span>

    (<span class="org-keyword">defun</span> <span class="org-function-name">turn-on-visible-mode</span> ()
      <span class="org-doc">"Make all invisible text temporarily visible."</span>
      (visible-mode 1)
      (setq truncate-lines nil)
      (<span class="org-keyword">when</span> (derived-mode-p 'org-mode)
        (org-remove-inline-images)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Force the buffers to unhide (folded) text (in Org files).</span>
    (add-hook 'ediff-prepare-buffer-hook 'turn-on-visible-mode)

    (<span class="org-keyword">defun</span> <span class="org-function-name">turn-off-visible-mode</span> ()
      <span class="org-doc">"Disable Visible mode."</span>
      (visible-mode 0)
      (setq truncate-lines t)
      (<span class="org-keyword">when</span> (derived-mode-p 'org-mode)
        (org-display-inline-images)))

    (add-hook 'ediff-quit-hook 'turn-off-visible-mode)

    )
</pre></div>
<p>For <b>comparing two directories</b>, you can use <code>ediff-directories</code> or <a href="http://meldmerge.org/">Meld</a>.</p>
<p><code>ediff-directories</code> combined with the key sequence <code>= h x</code> <code>= h x</code> shows you only the files which differ.</p>
<p>It is not recursive, but it gives you also subdirectory pairs to compare. Just hit <code>RET</code> on such a pair.</p>
<p>As bonus, it even works for remote directories.</p>
<div class="warning">
<p><code>ediff-directories</code> does not list files in one directory with no corresponding files in the other directory.</p>
</div>
</div>
</div>
<div id="outline-container-orgheadline82" class="outline-3">
<h3 id="orgheadline82">Miscellaneous File Operations</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline82">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 18.11 (info "(emacs)Misc File Ops")</span>

  (leuven--section <span class="org-string">"18.11 (emacs)Misc File Ops"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">use the system's Trash (when it is available)</span>
  (setq delete-by-moving-to-trash t)
</pre></div>
</div>
<div id="outline-container-orgheadline83" class="outline-3">
<h3 id="orgheadline83">Accessing Compressed Files</h3>
<div class="outline-text-3" id="text-orgheadline83">
<ul class="org-ul">
<li>Display the <b>contents</b> of the archive</li>
<li><b>View or edit</b> the actual files contained withing the archive</li>
</ul>
<p>Using the Emacs Dired utility, you can compress or uncompress marked files (using <code>gzip</code>) by pressing <code>Z</code>.</p>
<p>If you want to create one <b>archive</b> file from marked files, you can use:</p>
<pre class="example">
! tar -cf out.tar *
</pre>
<p>And if you actually want to <b>compress</b> the resulting archive, use one of the two commands:</p>
<pre class="example">
! tar -cZf out.tar.Z
! tar -czf out.tar.gz
</pre></div>
</div>
<div id="outline-container-orgheadline84" class="outline-3">
<h3 id="orgheadline84">Auto Encryption</h3>
<div class="outline-text-3" id="text-orgheadline84">
<p>History:</p>
<ol class="org-ol">
<li>mailcrypt</li>
<li>PGG</li>
<li>
<p>EasyPG (= epg) is a GnuPG interface for Emacs.</p>
<p>It allows you to encrypt/decrypt files within Emacs. When you use <code>C-x C-f</code> to access an encrypted file, Emacs prompts you for the passphrase and then decrypts the file before displaying it. When you save the file, Emacs automatically encrypts it again with that same key.</p>
<p>It has two aspects:</p>
<ul class="org-ul">
<li>convenient tools which allow to use GnuPG from Emacs (EasyPG Assistant), and</li>
<li>
<p>a fully functional interface library to GnuPG (EasyPG Library).</p>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Fetch the key automatically</b><br />
<p>Set the <code>keyserver</code> entry in the <code>~/.gnupg/gpg.conf</code> file properly.</p>
</div>
</li>
</ul>
</li>
</ol>
<p>What is PGP/MIME, what is OpenPGP, and how Gnus handles them?</p>
<ul class="org-ul">
<li>PGP/MIME is a standard, which mml2015* implements using ep[ag]-*.</li>
<li>OpenPGP is a standard, which ep[ag]-* implements.</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">the EasyPG Assistant, transparent file encryption</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"epa-file"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">stop EasyPG from asking for the recipient used for encrypting files</span>
    (setq epa-file-encrypt-to <span class="org-string">"johndoe@example.com"</span>)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">if no one is selected (""), symmetric encryption will always be</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">performed</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">cache passphrase for symmetric encryption (VERY important)</span>
    (setq epa-file-cache-passphrase-for-symmetric-encryption t)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Not to sound paranoid.  But if you want caching, it's recommended to</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">use *public-key encryption* instead of symmetric encryption.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">gpg-agent</span></span><span class="org-comment">' is the preferred way to do this.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">prompt for the password in the Emacs minibuffer (instead of using a</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">graphical password prompt for GPG)</span>
    (setenv <span class="org-string">"GPG_AGENT_INFO"</span> nil))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline85" class="outline-3">
<h3 id="orgheadline85">Remote Files</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline85">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 18.14 (info "(emacs)Remote Files")</span>

  (leuven--section <span class="org-string">"18.14 (emacs)Remote Files"</span>)
</pre></div>
<div id="outline-container-orgheadline86" class="outline-4">
<h4 id="orgheadline86">Ange-FTP</h4>
<div class="outline-text-4" id="text-orgheadline86">
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Check out why network share aren't accessible</b><br />
<p>I should be able to open <i>/CAUCHY/fsd</i></p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">*** Ange-FTP</span>

  (leuven--section <span class="org-string">"Ange-FTP"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">transparent FTP support</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ange-ftp"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">try to use passive mode in ftp, if the client program supports it</span>
    (setq ange-ftp-try-passive-mode t)) <span class="org-comment-delimiter">; </span><span class="org-comment">needed for Ubuntu</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline87" class="outline-4">
<h4 id="orgheadline87">TRAMP</h4>
<div class="outline-text-4" id="text-orgheadline87">
<p>(other protocols than just FTP)</p>
<p><code>/method:user@host:/path/file</code></p>
<p>Examples:</p>
<ul class="org-ul">
<li><code>C-x C-f /ssh:user@host:/home/user/.bashrc</code></li>
<li><code>C-x C-f /plink:user@host:/home/user/.bashrc</code> (from Windows)</li>
<li><code>C-x C-f /sudo:root@localhost:/etc/group</code></li>
</ul>
<p>Also <code>M-x find-dired</code>, <code>rgrep</code>, <code>lgrep</code>, <code>compile -</code> properly work with TRAMP (run on remote server and show result in your Emacs).</p>
<div class="note">
<p><code>sshfs</code> can give me the same functionality as TRAMP: it is like a personal NFS (another mounted file system) over SSH. If you can SSH to a server, you can probably do <code>sshfs</code>.</p>
</div>
<p>&gt; I'm in shell mode, logged in on another machine over ssh, and I want to do &gt; some 'crontab -e' editing on that machine. But that will bring up a new &gt; editor, which is whatever you set in your EDITOR env variable, and both vi &gt; and emacs cannot be used in this dumb shell. How can I edit the crontab in &gt; my emacs session?</p>
<p>Create the crontab on the remote machine, open it using TRAMP from your machine, edit and save and then reinstall it. That or simply enable X forwarding so running emacs on the remote bring up Emacs gtk/x on your main machine editing your cron file on the remote.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">*** TRAMP - Transparent Remote Access, Multiple Protocols</span>

  (leuven--section <span class="org-string">"TRAMP"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"tramp"</span>         <span class="org-comment-delimiter">; </span><span class="org-comment">the autoloads are predefined</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">* 4 (info "(tramp)Configuration") of TRAMP for use</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 4.6 Selecting a (info "(tramp)Default Method")</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">default transfer method</span>
    (setq tramp-default-method          <span class="org-comment-delimiter">; </span><span class="org-comment">[default: "scp"]</span>
          (<span class="org-keyword">cond</span> (leuven--win32-p
                 <span class="org-comment-delimiter">;; </span><span class="org-comment">(issues with Cygwin `</span><span class="org-constant"><span class="org-comment">ssh</span></span><span class="org-comment">' which does not cooperate</span>
                 <span class="org-comment-delimiter">;; </span><span class="org-comment">with Emacs processes -&gt; use `</span><span class="org-constant"><span class="org-comment">plink</span></span><span class="org-comment">' from PuTTY, it</span>
                 <span class="org-comment-delimiter">;; </span><span class="org-comment">definitely does work under Windows)</span>
                 <span class="org-comment-delimiter">;;</span>
                 <span class="org-comment-delimiter">;; </span><span class="org-comment">`C-x C-f /plink:user@host:/some/directory/file'</span>
                 <span class="org-string">"plink"</span>)
                (t
                 <span class="org-string">"ssh"</span>)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">You might try out the `</span><span class="org-constant"><span class="org-comment">rsync</span></span><span class="org-comment">' method, which saves the remote</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">files quite a bit faster than SSH.  It's based on SSH, so it</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">works the same, just saves faster.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(nconc (cadr (assq 'tramp-login-args (assoc "ssh" tramp-methods)))</span>
    <span class="org-comment-delimiter">;;        </span><span class="org-comment">'(("bash" "-i")))</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setcdr (assq 'tramp-remote-sh (assoc "ssh" tramp-methods))</span>
    <span class="org-comment-delimiter">;;         </span><span class="org-comment">'("bash -i"))</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 4.9 Connecting to a remote host using (info "(tramp)Multi-hops")</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">new proxy system (introduced with Tramp 2.1, instead of the old</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">"multi-hop" filename syntax) to edit files on a remote server by</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">going via another server</span>
    (<span class="org-keyword">when</span> (boundp 'tramp-default-proxies-alist)
      (add-to-list 'tramp-default-proxies-alist
                   <span class="org-comment-delimiter">;; </span><span class="org-comment">"final host" "user" "proxy in the middle"</span>
                   '(<span class="org-string">"10.10.13.123"</span> <span class="org-string">"\\`root\\'"</span> <span class="org-string">"/ssh:%h:"</span>)))
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Opening `</span><span class="org-constant"><span class="org-comment">/sudo:10.10.13.123:</span></span><span class="org-comment">' would connect first `</span><span class="org-constant"><span class="org-comment">10.10.13.123</span></span><span class="org-comment">'</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">via `</span><span class="org-constant"><span class="org-comment">ssh</span></span><span class="org-comment">' under your account name, and perform `sudo -u root' on</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">that host afterwards.  It is important to know that the given</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">method is applied on the host which has been reached so far.  The</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">trick is to think from the end.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">/ssh:user1@host|sudo:user2@host:</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 4.12 (info "(tramp)Password handling") for several connections</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">how many seconds passwords are cached</span>
    (setq password-cache-expiry 60)     <span class="org-comment-delimiter">; </span><span class="org-comment">[default: 16]</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 4.15 (info "(tramp)Remote shell setup") hints</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">string used for end of line in rsh connections</span>
    (setq tramp-rsh-end-of-line         <span class="org-comment-delimiter">; </span><span class="org-comment">[default: "\n"]</span>
          (<span class="org-keyword">cond</span> (leuven--win32-p <span class="org-string">"\n"</span>)
                (t <span class="org-string">"\r"</span>)))

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 4.16 (info "(tramp)Auto-save and Backup") configuration</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">faster auto saves</span>
    (setq tramp-auto-save-directory temporary-file-directory)
</pre></div>
<p>The usual way to debug Tramp is to set <code>tramp-verbose</code> to 6. This will produce a debug buffer, which you can show at <code>tramp-devel@gnu.org</code>.</p>
<p>The best way to report a Tramp bug is to call <code>M-x tramp-bug</code>; this prepares an email, including several trace information for analysis.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 9 How to Customize (info "(tramp)Traces and Profiles")</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">debugging Tramp</span>
    (setq tramp-verbose 6)              <span class="org-comment-delimiter">; </span><span class="org-comment">[maximum: 10]</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">"turn off" the effect of `</span><span class="org-constant"><span class="org-comment">backup-directory-alist</span></span><span class="org-comment">' for TRAMP</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">files</span>
    (add-to-list 'backup-directory-alist
                 (cons tramp-file-name-regexp nil))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">make Emacs beep after reading from or writing to the remote host</span>
    (<span class="org-keyword">defadvice</span> <span class="org-function-name">tramp-handle-write-region</span> <span class="org-comment-delimiter">; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span>
      (after leuven-tramp-write-beep-advice activate)
      <span class="org-doc">"Make Tramp beep after writing a file."</span>
      (interactive)
      (beep))

    (<span class="org-keyword">defadvice</span> <span class="org-function-name">tramp-handle-do-copy-or-rename-file</span> <span class="org-comment-delimiter">; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span>
      (after leuven-tramp-copy-beep-advice activate)
      <span class="org-doc">"Make Tramp beep after copying a file."</span>
      (interactive)
      (beep))

    (<span class="org-keyword">defadvice</span> <span class="org-function-name">tramp-handle-insert-file-contents</span>
      (after leuven-tramp-insert-beep-advice activate)
      <span class="org-doc">"Make Tramp beep after inserting contents of a file."</span>
      (interactive)
      (beep))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline88" class="outline-4">
<h4 id="orgheadline88">TEST Find file as root</h4>
<div class="outline-text-4" id="text-orgheadline88">
<p>You can just do <code>C-x C-f /sudo:user@localhost:/foo/bar/baz.txt &lt;RET&gt;</code>.</p>
<p>Because I'm lazy, I have a hack (from Tassilo Horn): if I try to open a file for which I don't have permissions for, I'm queried if I want to open it as root using the <code>sudo</code> tramp method.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-find-file-sudo-header-warning</span> ()
      <span class="org-doc">"*Display a warning in header line of the current buffer."</span>
      (<span class="org-keyword">let*</span> ((warning <span class="org-string">"WARNING: EDITING FILE WITH ROOT PRIVILEGES!"</span>)
             (space (+ 6 (- (frame-width) (length warning))))
             (bracket (make-string (/ space 2) ?-))
             (warning (concat bracket warning bracket)))
        (setq header-line-format
              (propertize warning 'face 'header-line))))

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-find-file-sudo</span> (filename)
      <span class="org-doc">"Open FILENAME with root privileges."</span>
      (interactive <span class="org-string">"F"</span>)
      (set-buffer (find-file (concat <span class="org-string">"/sudo::"</span> filename)))
      (leuven-find-file-sudo-header-warning))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment"> already an existing defadvice around find-file!!</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(defadvice find-file (around leuven-find-file activate)</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">"Open FILENAME using tramp's sudo method if it's read-only."</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(if (and (file-exists-p (ad-get-arg 0))</span>
    <span class="org-comment-delimiter">;;            </span><span class="org-comment">(not (file-writable-p (ad-get-arg 0)))</span>
    <span class="org-comment-delimiter">;;            </span><span class="org-comment">(not (file-remote-p (ad-get-arg 0)))</span>
    <span class="org-comment-delimiter">;;            </span><span class="org-comment">(y-or-n-p (concat "File "</span>
    <span class="org-comment-delimiter">;;                              </span><span class="org-comment">(ad-get-arg 0)</span>
    <span class="org-comment-delimiter">;;                              </span><span class="org-comment">" is read-only.  Open it as root? ")))</span>
    <span class="org-comment-delimiter">;;       </span><span class="org-comment">(leuven-find-file-sudo (ad-get-arg 0))</span>
    <span class="org-comment-delimiter">;;     </span><span class="org-comment">ad-do-it))</span>

    )
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline89" class="outline-3">
<h3 id="orgheadline89">Convenience Features for Finding Files</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline89">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 18.17 (info "(emacs)File Conveniences")</span>

  (leuven--section <span class="org-string">"18.17 (emacs)File Conveniences"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">filenames excluded from the recent list</span>
  (setq recentf-exclude                 <span class="org-comment-delimiter">;</span><span class="org-comment">! has to be set before your require</span>
                                        <span class="org-comment-delimiter">;</span><span class="org-comment">! `</span><span class="org-constant"><span class="org-comment">recentf</span></span><span class="org-comment">'</span>
        '(
          <span class="org-string">"~$"</span>                          <span class="org-comment-delimiter">; </span><span class="org-comment">Emacs (and others) backup</span>
          <span class="org-string">"\\.aux$"</span> <span class="org-string">"\\.log$"</span> <span class="org-string">"\\.toc$"</span> <span class="org-comment-delimiter">; </span><span class="org-comment">LaTeX</span>
          <span class="org-string">"/tmp/"</span>
          ))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">setup a menu of recently opened files</span>
  (GNUEmacs
    (idle-require 'recentf))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"recentf"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">maximum number of items that will be saved</span>
    (setq recentf-max-saved-items 100)  <span class="org-comment-delimiter">; </span><span class="org-comment">just 20 is too recent</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">file to save the recent list into</span>
    (setq recentf-save-file (concat user-emacs-directory <span class="org-string">".recentf"</span>))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(when using Tramp) turn off the cleanup feature of `</span><span class="org-constant"><span class="org-comment">recentf</span></span><span class="org-comment">'</span>
    (setq recentf-auto-cleanup 'never)  <span class="org-comment-delimiter">; </span><span class="org-comment">disable before we start recentf!</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">save file names relative to my current home directory</span>
    (setq recentf-filename-handlers '(abbreviate-file-name))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">enable `</span><span class="org-constant"><span class="org-comment">recentf</span></span><span class="org-comment">' mode</span>
    (recentf-mode 1))
</pre></div>
<div id="outline-container-orgheadline38" class="outline-4">
<h4 id="orgheadline38"><a id="ID-59418189-b87e-45a2-b128-5cbdc8a16430" name="ID-59418189-b87e-45a2-b128-5cbdc8a16430"></a>Helm (successor of Anything)</h4>
<div class="outline-text-4" id="text-orgheadline38">
<p>Helm is a incremental completion and selection narrowing framework for emacs. It will help steer you in the right direction when you're looking for stuff in Emacs (like buffers, files, etc).</p>
<p>XXX Sort this section following <a href="https://github.com/emacs-helm/helm/wiki#generalhelmcommands">https://github.com/emacs-helm/helm/wiki#generalhelmcommands</a> and following.</p>
<p>Nice guide: <a href="http://tuhdo.github.io/helm-intro.html">http://tuhdo.github.io/helm-intro.html</a>.</p>
<p>For Helm documentation, see the <a href="https://github.com/emacs-helm/helm/wiki">Emacs-helm wiki</a> and the <a href="https://github.com/thierryvolpiatto/emacs-tv-config/blob/master/init-helm-thierry.el">Helm configuration file of Thierry Volpiatto</a>!</p>
<p>The <i>default</i> prefix for Helm commands is <code>C-x c</code>.</p>
<p>Since I use Helm, I never bother to remember the structure of my working directory. And that's the point: I don't have to remember such trivial details and I can focus my mind on other more important things.</p>
<p>Here is another example that make sure of Helm interface nicely: helm-semantic-or-imenu. Demo: <img src="http://tuhdo.github.io/static/part3/helm-semantic-or-imenu.gif" alt="helm-semantic-or-imenu.gif" /></p>
<p>You can think of it as an outline tree in regular IDE, but Helm makes it interactive, and fast. I can ask question like "is there something that is function and has int in it that the function name contains memory?".</p>
<p>Here is another demo on Helm's homepage: <a href="https://github.com/emacs-helm/helm#advanced-usage">https://github.com/emacs-helm/helm#advanced-usage</a></p>
<p>Finally, the strings in Helm are not just strings; they are regexp and I think they are more powerful then normal fuzzy matcher.</p>
<p>Helm allows you to do interesting things with its interactive interface. For example:</p>
<ul class="org-ul">
<li>interactive grep: <img src="http://tuhdo.github.io/static/live_grep.gif" alt="live_grep.gif" /></li>
<li>interactive occur: <img src="http://tuhdo.github.io/static/part3/helm-occur.gif" alt="helm-occur.gif" /></li>
<li>interactive kill ring: <img src="http://tuhdo.github.io/static/part3/helm-kill-ring.gif" alt="helm-kill-ring.gif" /></li>
<li>interactive mark ring: <a href="http://tuhdo.github.io/helm-intro.html#sec-15">http://tuhdo.github.io/helm-intro.html#sec-15</a></li>
</ul>
<p>I think helm-find-files is much better than stock ido-find-file or even ido-find-file because:</p>
<ul class="org-ul">
<li>It has fuzzy matching by default. You have to install flx to get fuzzy matching in ido.</li>
<li>Some people find that Ido horizontal listing is messy, so they create `ido-vertical-mode` for cleaner looking. With Helm, you get this by default with its interface. If you worry the Helm buffer is a bit big, you can always customize its size.</li>
<li>It has highlighting on candidates depend on types: directory has a color, plain file has a color, executable has a color, shell script has a color.</li>
<li>Depends on what file type your highlighting candidate is, Helm opens it appropriately. For example, if you RET on a directory, Helm opens dired; if you RET on a file, Helm opens that file. You can also customize the application to open the files. Stock find-file at least can open directory; Ido simply can't.</li>
<li>You can open multiple files with helm-find-files by marking with C-SPC and press RET. If you want to everything at current directory, you can use M-a to mark all then RET. You can even use wildcard expression like stock find-file</li>
<li>Helm has a list of actions to apply on your files: checksum file, open file externally, switch to eshell, grep, diff</li>
<li>Helm is compatible with both Linux and Windows path. Ido can't; you have to drop into stock find-file.</li>
</ul>
<p>In `helm-find-file', you may want to try using the left arrow to go to the parent directory!</p>
<p>You can reassign &lt;tab&gt; only during `helm-find-file'. The `helm-find-file' almost looks like Dired and I assign "^" for going up. Minor side effect is you cannot type in "^" without using C-q.</p>
<p>Sometimes you want to hit &lt;tab&gt; for `helm-selection-action'; however, you chose not to happen. Now look for substitute for &lt;tab&gt;. Something not &lt;tab&gt; can be "C-z", "C-&lt;tab&gt;", and "&lt;SPC&gt;.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(define-key helm-find-files-map (kbd <span class="org-string">"&lt;tab&gt;"</span>)    'helm-execute-persistent-action)
(define-key helm-find-files-map (kbd <span class="org-string">"C-&lt;tab&gt;"</span>)  'helm-select-action)
(define-key helm-find-files-map (kbd <span class="org-string">"C-z"</span>)      'helm-select-action)
(define-key helm-find-files-map (kbd <span class="org-string">"&lt;SPC&gt;"</span>)    'helm-select-action)
(define-key helm-find-files-map (kbd <span class="org-string">"&lt;return&gt;"</span>) 'helm-confirm-and-exit-minibuffer)
(define-key helm-find-files-map (kbd <span class="org-string">"^"</span>)        'helm-find-files-up-one-level)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(define-key helm-map (kbd <span class="org-string">"&lt;tab&gt;"</span>) 'helm-execute-persistent-action) <span class="org-comment-delimiter">; </span><span class="org-comment">rebihnd tab to do persistent action</span>
(define-key helm-map (kbd <span class="org-string">"C-i"</span>) 'helm-execute-persistent-action) <span class="org-comment-delimiter">; </span><span class="org-comment">make TAB works in terminal</span>
(define-key helm-map (kbd <span class="org-string">"C-z"</span>)  'helm-select-action) <span class="org-comment-delimiter">; </span><span class="org-comment">list actions using C-z</span>

(define-key helm-grep-mode-map (kbd <span class="org-string">"&lt;return&gt;"</span>)  'helm-grep-mode-jump-other-window)
(define-key helm-grep-mode-map (kbd <span class="org-string">"n"</span>)  'helm-grep-mode-jump-other-window-forward)
(define-key helm-grep-mode-map (kbd <span class="org-string">"p"</span>)  'helm-grep-mode-jump-other-window-backward)
</pre></div>
<p>In helm-find-files, you can alway invoke helm-ff-do-grep with C-s or C-u C-s for recursive searching. Probably helm-projectile can replace helm-find-files more if it has this feature? I think you can do this by reusing projectile-grep.</p>
<p>Grep in Helm is interactive, unlike the stock grep/rgrep. Demo: <img src="http://tuhdo.github.io/static/live_grep.gif" alt="live_grep.gif" /></p>
<p>No package does any of this:</p>
<ul class="org-ul">
<li>Live grep: <img src="http://tuhdo.github.io/static/live_grep.gif" alt="live_grep.gif" /></li>
<li>A live outline tree for jumping to function/variable in current file:</li>
<li>Demo 1: <img src="http://tuhdo.github.io/static/part3/helm-semantic-or-imenu.gif" alt="helm-semantic-or-imenu.gif" /></li>
<li>Demo 2:</li>
</ul>
<div class="figure">
<p><img src="https://cloud.githubusercontent.com/assets/4818719/4102208/cda8f392-311e-11e4-9c83-e68df38ef68e.gif" alt="cda8f392-311e-11e4-9c83-e68df38ef68e.gif" /></p>
</div>
<ul class="org-ul">
<li>Show local/global mark ring with nice highlighting of major modes:</li>
</ul>
<div class="figure">
<p><img src="http://tuhdo.github.io/static/part3/helm-all-mark-rings.gif" alt="helm-all-mark-rings.gif" /></p>
</div>
<ul class="org-ul">
<li>Interactively select color and faces: <img src="http://tuhdo.github.io/static/part3/helm-color.gif" alt="helm-color.gif" /></li>
<li>Interactive Eshell history, certainly superior to the stock C-c C-l:</li>
</ul>
<p><img src="http://tuhdo.github.io/static/part3/helm-eshell-history.gif" alt="helm-eshell-history.gif" /> . I store a large amount of eshell/shell history, so I want a quick way to narrow down.</p>
<p>helm-find-files can even find file at point. That is, you don't need to remember ffap as well. If you write Emacs lisp, move point over the required file and execute helm-find-files, it will prompt the file location and you simply RET to enter. All in once nice package.</p>
<p>Exploring large projects with Projectile and Helm Projectile: <a href="http://tuhdo.github.io/helm-projectile.html">http://tuhdo.github.io/helm-projectile.html</a></p>
<p>I wrote this guide after many new changes in Helm Projectile. The new Helm Projectile is not just a single command `helm-projectile` anymore; it can now replace many Projectile "core commands", such as `projectile-find-file`.</p>
<p>A few demos:</p>
<ul class="org-ul">
<li>Select and open multiple files,</li>
</ul>
<p><img src="http://tuhdo.github.io/static/helm-projectile/helm-projectile-find-files-1.gif" alt="helm-projectile-find-files-1.gif" /> : Now we can open multiple files at once with `helm-projectile`. It outweighs Ido</p>
<ul class="org-ul">
<li>flx for finding files, since you can only open one file in Ido. Yes, you can</li>
</ul>
<p>open one file faster in Helm, but when you need to open two or more files, Helm is more suitable for the large.</p>
<ul class="org-ul">
<li>Jump to any file depends on context, even if the file path is in a text file,</li>
</ul>
<div class="figure">
<p><img src="http://tuhdo.github.io/static/helm-projectile/helm-projectile-find-files-dwim-1.gif" alt="helm-projectile-find-files-dwim-1.gif" /></p>
</div>
<ul class="org-ul">
<li>Switch between other files with same names but different extensions,</li>
</ul>
<p><img src="http://tuhdo.github.io/static/helm-projectile/helm-projectile-find-other-file.gif" alt="helm-projectile-find-other-file.gif" /> . Work not only for C/C++ but other languages, and is customizable. You don't have to configure anything, like adding include paths for the command to search. Everything is automatic. Just use it as it is.</p>
<ul class="org-ul">
<li>Ediff two selected files from helm-projectile-find-file,</li>
</ul>
<p><img src="http://tuhdo.github.io/static/helm-projectile/helm-projectile-find-file-ediff.gif" alt="helm-projectile-find-file-ediff.gif" />.</p>
<ul class="org-ul">
<li>Invoke Etags while in helm-projectile-find-file session; when in Etags</li>
</ul>
<p>session, you can switch back later to helm-projectile-find-file, <img src="http://tuhdo.github.io/static/helm-projectile/helm-projectile-etags.gif" alt="helm-projectile-etags.gif" />.</p>
<ul class="org-ul">
<li>You can invoke `helm-do-grep` on any project directory when using a `helm-projectile` command.</li>
</ul>
<p>In Helm, generally, look at the mode line; you will see <code>C-c ?:Help</code>, it is your friend: hit it for more info.</p>
<ul class="org-ul">
<li>Narrow the list by typing some patterns (use the <b>space as separator</b> for multiple patterns),</li>
<li>Select an element with <code>&lt;Up&gt;</code> / <code>&lt;Down&gt;</code> / <code>&lt;PageUp&gt;</code> / <code>&lt;PageDown&gt;</code> / <code>C-p</code> / <code>C-n</code> / <code>C-v</code> / <code>M-v</code>,</li>
<li>Choose with <code>&lt;RET&gt;</code>.</li>
<li>
<p><code>C-z</code> executes an action without quitting the Helm session (persistent action):</p>
<p>For <code>helm-find-files</code>:</p>
<ul class="org-ul">
<li>On a regular file,
<ol class="org-ol">
<li>First hit on <code>C-z</code> expands the file name</li>
<li>Second hit opens the file and displays its contents in the other window</li>
<li>Third hit kills the buffer (unless it was already open before starting helm session).</li>
</ol>
</li>
<li>On image files (<code>.jpg</code>, etc..)
<ol class="org-ol">
<li>Second hit (or <code>C-u C-z</code>) displays the image in the other window</li>
<li>If you then turn on <code>helm-follow-mode</code> (<code>C-c C-f</code>), you turn on Helm in <b>image browser</b> (i.e., use <code>C-n/p</code> or <code>arrows/down/up</code>).</li>
<li>You can rotate image with <code>M-l/r</code> (these are persistent actions too).</li>
</ol>
</li>
</ul>
</li>
</ul>
<p>Kill your buffers with <code>C-u C-z</code> one by one.</p>
<p>To go back to the <b>previous element</b> of the minibuffer history, use <code>M-p</code>.</p>
<p>As a starting point for all <b>searches in buffers and files</b>, use <code>helm-buffers-list</code> and <code>helm-find-files</code>: you can launch <code>helm-multi-occur</code> and <code>helm-do-grep</code> from there.</p>
<p>You can also use the <code>@</code> prefix to <b>search buffer contents</b>.</p>
<p>To mark all candidates in a Helm buffer, use <code>M-a</code> (<code>helm-mark-all</code>) or <code>M-m</code> (<code>helm-toggle-all-marks</code>).</p>
<p>Switch to <code>*Helm Log*</code> buffer with <code>M-x helm-open-last-log</code>.</p>
<ul class="org-ul">
<li><code>volatile</code> means your candidates are recomputed each time you enter a character in pattern (cached candidates are not reused). Async sources are by essence volatile.</li>
<li><code>delayed</code> means your candidates are computed after <code>helm-input-idle-delay</code> seconds.</li>
<li><code>no-matchplugin</code> means to not use the multi regexp matching provided by <code>helm-match-plugin.el</code>.</li>
</ul>
<p>XXX Helm is also very useful to look up Elisp variable/function documentation and for finding stuff in the Info Manuals (e.g. helm-info-elisp or helm-info-emacs).</p>
<p>XXX Look at helm-dictionary.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (GNUEmacs

    (leuven--section <span class="org-string">"Helm"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Change `</span><span class="org-constant"><span class="org-comment">helm-command-prefix-key</span></span><span class="org-comment">'</span>
    (global-set-key (kbd <span class="org-string">"C-c h"</span>) 'helm-command-prefix)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Open Helm (QuickSilver-like candidate-selection framework).</span>
    (<span class="org-keyword">when</span> (try-require 'helm-config)    <span class="org-comment-delimiter">; </span><span class="org-comment">[default `</span><span class="org-constant"><span class="org-comment">helm-command-prefix-key</span></span><span class="org-comment">']</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Explicitly loads `</span><span class="org-constant"><span class="org-comment">helm-autoloads</span></span><span class="org-comment">'!</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">CAUTION for recursive loads...</span>

      (global-unset-key (kbd <span class="org-string">"C-x c"</span>))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Better version of `</span><span class="org-constant"><span class="org-comment">occur</span></span><span class="org-comment">'.</span>
      (global-set-key (kbd <span class="org-string">"C-o"</span>) 'helm-occur)
</pre></div>
<p>See <a href="http://stackoverflow.com/questions/14726601/sublime-text-2s-goto-anything-or-instant-search-for-emacs">Sublime Text 2's "Goto Anything" (or instant search) for Emacs?</a></p>
<ul class="org-ul">
<li><a href="https://github.com/xiaohanyu/oh-my-emacs/blob/master/core/ome-completion.org">https://github.com/xiaohanyu/oh-my-emacs/blob/master/core/ome-completion.org</a></li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
      (global-set-key (kbd <span class="org-string">"&lt;f3&gt;"</span>) 'helm-for-files)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-x C-f") 'helm-find-files)</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Buffer list.</span>
      (global-set-key (kbd <span class="org-string">"C-x b"</span>) 'helm-mini) <span class="org-comment-delimiter">; </span><span class="org-comment">OK.</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">= `</span><span class="org-constant"><span class="org-comment">helm-buffers-list</span></span><span class="org-comment">' + recents.</span>
      (global-set-key (kbd <span class="org-string">"C-x C-b"</span>) 'helm-buffers-list) <span class="org-comment-delimiter">; </span><span class="org-comment">OK.</span>

      (global-set-key (kbd <span class="org-string">"C-x r l"</span>) 'helm-bookmarks)
      (global-set-key (kbd <span class="org-string">"C-x r l"</span>) 'helm-filtered-bookmarks) <span class="org-comment-delimiter">; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment">?</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Install from https://github.com/thierryvolpiatto/emacs-bmk-ext.</span>
      (global-set-key (kbd <span class="org-string">"C-x r b"</span>) 'helm-bookmark-ext)

      (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-helm-org-prog-menu</span> ()
        <span class="org-doc">"Jump to a place in the buffer using an Index menu.</span>
<span class="org-doc">      For Org mode buffers, show Org headlines.</span>
<span class="org-doc">      For programming mode buffers, show functions, variables, etc."</span>
        (interactive)
        (<span class="org-keyword">if</span> (derived-mode-p 'org-mode)
            (helm-org-in-buffer-headings)
          (helm-imenu)))

      (global-set-key (kbd <span class="org-string">"&lt;f4&gt;"</span>) 'leuven-helm-org-prog-menu) <span class="org-comment-delimiter">; </span><span class="org-comment">awesome</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">and `C-c =' (like in RefTeX)?</span>

      (global-set-key (kbd <span class="org-string">"M-y"</span>) 'helm-show-kill-ring) <span class="org-comment-delimiter">; </span><span class="org-comment">OK.</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "M-5") 'helm-etags-select)</span>
      (global-set-key (kbd <span class="org-string">"C-h a"</span>) 'helm-apropos)
      (global-set-key (kbd <span class="org-string">"C-h i"</span>) 'helm-info-emacs)
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-h d") 'helm-info-at-point)</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-h 4") 'helm-info-elisp)</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-h SPC") 'helm-all-mark-rings)</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-S-h C-c") 'helm-wikipedia-suggest)</span>
</pre></div>
<p>Use the separate Helm Descbinds to get a quick <b>key bindings</b> overview. It will make your life much easier with million Emacs keys.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
      (global-set-key (kbd <span class="org-string">"C-h b"</span>) 'helm-descbinds)
    )
</pre></div>
<p>Try out <code>helm-google-suggest</code>, because it's very efficient when you get completions from google (so you can type only a few characters to get relevant completions) and then you can send this completion to various services (e.g. wiki lookup), so you don't have to start a separate wikipedia lookup, youtube lookup, etc. command, because you can use the same command for any of them. It's very convenient and you can easily add actions for other sites you usually search for info on.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (global-set-key (kbd <span class="org-string">"C-c h g"</span>) 'helm-google)
    (global-set-key (kbd <span class="org-string">"C-c h s"</span>) 'helm-google-suggest)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Emacs Helm Interface for quick Google searches</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "helm-google"</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; (when (executable-find "curl")</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">;;   (setq helm-google-suggest-use-curl-p t))</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">)</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"helm"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">various functions for Helm (Shell history, etc.)</span>
      (<span class="org-keyword">require</span> '<span class="org-constant">helm-misc</span>)
      <span class="org-comment-delimiter">;; </span><span class="org-comment">for multi-line items in e.g. minibuffer history, match entire items,</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">not individual lines within items.</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">(try-require 'helm-ls-git)</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(try-require 'helm-dictionary)</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">use the *current window* (no popup) to show the candidates</span>
      (setq helm-full-frame nil)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">open `</span><span class="org-constant"><span class="org-comment">helm-buffer</span></span><span class="org-comment">' in another window</span>
      (setq helm-split-window-default-side 'other)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">default function used for splitting window</span>
      (setq helm-split-window-preferred-function
            (<span class="org-keyword">lambda</span> (window)
              (split-window-sensibly)))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">;; move to end or beginning of source when reaching top or bottom of</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">;; source</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq helm-move-to-line-cycle-in-source t)</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">candidates separator of `</span><span class="org-constant"><span class="org-comment">multiline</span></span><span class="org-comment">' source (such as</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">helm-show-kill-ring</span></span><span class="org-comment">')</span>
      (setq helm-candidate-separator
            <span class="org-string">"--8&lt;-----------------------separator------------------------&gt;8---"</span>)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">suppress displaying sources which are out of screen at first</span>
      (setq helm-quick-update t)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">;; time that the user has to be idle for, before candidates from</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">;; DELAYED sources are collected</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq helm-idle-delay 0.01)</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">time that the user has to be idle for, before ALL candidates are</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">collected (&gt;= `</span><span class="org-constant"><span class="org-comment">helm-idle-delay</span></span><span class="org-comment">') -- also effective for NON-DELAYED</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">sources</span>
      (setq helm-input-idle-delay 0.1)  <span class="org-comment-delimiter">; </span><span class="org-comment">0.06 OK</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">;; enable adaptive sorting in all sources</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(helm-adaptive-mode 1)</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">;; enable generic Helm completion (for all functions in Emacs that use</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">;; `</span><span class="org-constant"><span class="org-comment">completing-read</span></span><span class="org-comment">' or `</span><span class="org-constant"><span class="org-comment">read-file-name</span></span><span class="org-comment">' and friends)</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(helm-mode 1)</span>
      )
</pre></div>
</div>
<div id="outline-container-orgheadline90" class="outline-5">
<h5 id="orgheadline90">Helm find files</h5>
<div class="outline-text-5" id="text-orgheadline90">
<dl class="org-dl">
<dt><code>C-l</code></dt>
<dd>Delete the last segment of a file name (in the minibuffer).</dd>
</dl>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"helm-files"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't show only basename of candidates in `</span><span class="org-constant"><span class="org-comment">helm-find-files</span></span><span class="org-comment">'.</span>
      (setq helm-ff-transformer-show-only-basename nil)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Search for library in `</span><span class="org-constant"><span class="org-comment">require</span></span><span class="org-comment">' and `</span><span class="org-constant"><span class="org-comment">declare-function</span></span><span class="org-comment">' sexp.</span>
      (setq helm-ff-search-library-in-sexp t)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Use `</span><span class="org-constant"><span class="org-comment">recentf-list</span></span><span class="org-comment">' instead of `</span><span class="org-constant"><span class="org-comment">file-name-history</span></span><span class="org-comment">' in `</span><span class="org-constant"><span class="org-comment">helm-find-files</span></span><span class="org-comment">'.</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq helm-ff-file-name-history-use-recentf t)</span>
      )
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline91" class="outline-5">
<h5 id="orgheadline91">Grep</h5>
<div class="outline-text-5 org-src-container" id="text-orgheadline91">
<pre class="src src-emacs-lisp">
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"helm-grep"</span>

      (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-helm-grep-org-files</span> ()
        <span class="org-doc">"Launch grep on Org files in `</span><span class="org-constant"><span class="org-doc">~/org</span></span><span class="org-doc">'."</span>
        (interactive)
        (<span class="org-keyword">let</span> ((files (helm-walk-directory <span class="org-string">"~/org"</span>
                                          <span class="org-builtin">:path</span> 'full
                                          <span class="org-builtin">:directories</span> nil
                                          <span class="org-builtin">:match</span> <span class="org-string">".*\\.</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">(</span></span><span class="org-string">org</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">|</span></span><span class="org-string">txt</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">)</span></span><span class="org-string">$"</span>
                                          <span class="org-builtin">:skip-subdirs</span> t)))
          (helm-do-grep-1 files))))
</pre></div>
</div>
<div id="outline-container-orgheadline92" class="outline-5">
<h5 id="orgheadline92">Helm M-x</h5>
<div class="outline-text-5" id="text-orgheadline92">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (global-set-key (kbd <span class="org-string">"M-x"</span>) 'helm-M-x)
</pre></div>
<div class="note">
<p>With <code>helm-M-x</code>, to pass prefix arguments to the command you want to run, you have to type <code>C-u</code> <b>after</b> typing <code>M-x</code> and selecting the command - that is, <b>before</b> pressing <code>RET</code>.</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"helm-command"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Save command even when it fails.</span>
      (setq helm-M-x-always-save-history t))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline93" class="outline-5">
<h5 id="orgheadline93">Helm locate</h5>
<div class="outline-text-5" id="text-orgheadline93">
<p>Use Helm to <b>quickly navigate between files</b>, even in the largest projects.</p>
<div class="note">
<p>Locate for <b>Windows</b> users: you have to install <a href="http://www.voidtools.com/download.php">Everything</a> with its command line interface <code>es.exe</code>.</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"helm-locate"</span>

      (<span class="org-keyword">when</span> (and (or leuven--win32-p
                     leuven--cygwin-p)
                 (executable-find <span class="org-string">"es"</span>))<span class="org-comment-delimiter">; </span><span class="org-comment">we could check for it in</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">(concat (getenv "USERPROFILE") "/Downloads")</span>

        <span class="org-comment-delimiter">;; </span><span class="org-comment">sort locate results by full path</span>
        (setq helm-locate-command <span class="org-string">"es -s %s %s"</span>)))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline94" class="outline-5">
<h5 id="orgheadline94">Helm for buffers</h5>
<div class="outline-text-5" id="text-orgheadline94">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"helm-buffers"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't truncate buffer names.</span>
      (setq helm-buffer-max-length nil)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Never show details in buffer list.</span>
      (setq helm-buffer-details-flag nil))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "helm-adaptive"</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; don't save history information to file</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(remove-hook 'kill-emacs-hook 'helm-adaptive-save-history))</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline95" class="outline-5">
<h5 id="orgheadline95">Helm show kill ring</h5>
<div class="outline-text-5" id="text-orgheadline95">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">kill-ring, mark-ring, and register browsers for Helm.</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"helm-ring"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Max number of lines displayed per candidate in kill-ring browser.</span>
      (setq helm-kill-ring-max-lines-number 20))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "helm-utils"</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(setq helm-yank-symbol-first t)</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline96" class="outline-5">
<h5 id="orgheadline96">Lisp completion</h5>
<div class="outline-text-5" id="text-orgheadline96">
<div class="warning">
<p>This (from Thierry Volpiatto) seems good, except that it changes the behavior of TAB when done in a word. Instead of indenting, it completes the word at point, changing the buffer's contents!</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Lisp complete or indent</span>
  (define-key lisp-interaction-mode-map
    [remap indent-for-tab-command] 'helm-lisp-completion-at-point-or-indent)
  (define-key emacs-lisp-mode-map
    [remap indent-for-tab-command] 'helm-lisp-completion-at-point-or-indent)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Lisp complete</span>
  (define-key lisp-interaction-mode-map
    [remap completion-at-point] 'helm-lisp-completion-at-point)
  (define-key emacs-lisp-mode-map
    [remap completion-at-point] 'helm-lisp-completion-at-point)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline97" class="outline-5">
<h5 id="orgheadline97">Helm swoop</h5>
<div class="outline-text-5 org-src-container" id="text-orgheadline97">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">efficiently hopping squeezed lines powered by Helm interface</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(= Helm occur + Follow mode!)</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"helm-swoop-autoloads"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">better version of `</span><span class="org-constant"><span class="org-comment">occur</span></span><span class="org-comment">'</span>
      (global-set-key (kbd <span class="org-string">"C-o"</span>) 'helm-swoop)
      (global-set-key (kbd <span class="org-string">"M-s o"</span>) 'helm-swoop)
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "M-i") 'helm-swoop)</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "M-I") 'helm-swoop-back-to-last-point)</span>

      (global-set-key (kbd <span class="org-string">"M-s O"</span>) 'helm-multi-swoop)
      (global-set-key (kbd <span class="org-string">"M-s /"</span>) 'helm-multi-swoop)
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-c M-i") 'helm-multi-swoop)</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-x M-i") 'helm-multi-swoop-all)</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">when doing Isearch, hand the word over to `</span><span class="org-constant"><span class="org-comment">helm-swoop</span></span><span class="org-comment">'</span>
      (define-key isearch-mode-map (kbd <span class="org-string">"C-o"</span>) 'helm-swoop-from-isearch)
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key isearch-mode-map (kbd "M-i") 'helm-swoop-from-isearch)</span>

      (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"dired"</span>
        (define-key dired-mode-map (kbd <span class="org-string">"C-o"</span>) 'helm-swoop)
        <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key dired-mode-map (kbd "M-i") 'helm-swoop)</span>
        ))

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"helm-swoop"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">from `</span><span class="org-constant"><span class="org-comment">helm-swoop</span></span><span class="org-comment">' to `</span><span class="org-constant"><span class="org-comment">helm-multi-swoop-all</span></span><span class="org-comment">'</span>
      (define-key helm-swoop-map (kbd <span class="org-string">"C-o"</span>) 'helm-multi-swoop-all-from-helm-swoop)
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key helm-swoop-map (kbd "M-i") 'helm-multi-swoop-all-from-helm-swoop)</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">don't slightly boost invoke speed in exchange for text color</span>
      (setq helm-swoop-speed-or-color t)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">split direction</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq helm-swoop-split-direction 'split-window-horizontally)</span>
      (setq helm-swoop-split-direction 'split-window-sensibly)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">don't save each buffer you edit when editing is complete</span>
      (setq helm-multi-swoop-edit-save nil)))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline98" class="outline-4">
<h4 id="orgheadline98">Image mode</h4>
<div class="outline-text-4" id="text-orgheadline98">
<p>AFAICT you need to eval something like</p>
<p>(setq image-type-header-regexps '((".*" . imagemagick)))</p>
<p>to be able to resize images in image-mode with imagemagick (for example, from the "Image" menu). If resizing works for you when visiting an image file, I guess your imagemagick support is ok.</p>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> auto-image-file-mode in find-file-hook for performance reasons!?</b><br />
nil</div>
<p>New commands since Emacs 24.4:</p>
<ul class="org-ul">
<li><code>n</code> (<code>image-next-file</code>) and</li>
<li><code>p</code> (<code>image-previous-file</code>)</li>
</ul>
<p>visit the next image file and the previous image file in the same directory, respectively.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (leuven--section <span class="org-string">"Image mode"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Show image files as images (not as semi-random bits).</span>
  (GNUEmacs
    (add-hook 'find-file-hook 'auto-image-file-mode))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 18 ends here</span>
</pre></div>
</div>
</div>
</div>
</div>
<div id="outline-container-orgheadline99" class="outline-2">
<h2 id="orgheadline99">Using Multiple Buffers</h2>
<div class="outline-text-2 org-src-container" id="text-orgheadline99">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 19 Using Multiple (info "(emacs)Buffers")</span>

(leuven--chapter leuven-load-chapter-19-buffers <span class="org-string">"19 Using Multiple Buffers"</span>
</pre></div>
<div id="outline-container-orgheadline100" class="outline-3">
<h3 id="orgheadline100">Listing Existing Buffers</h3>
<div class="outline-text-3" id="text-orgheadline100">
<ul class="org-ul">
<li>The <code>C</code> (current) column has a <code>.</code> for the buffer from which you came.</li>
<li>The <code>R</code> (read-only) column has a <code>%</code> if the buffer is read-only.</li>
<li>The <code>M</code> (modified) column has a <code>*</code> if it is modified.</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 19.2 (info "(emacs)List Buffers")</span>

  (leuven--section <span class="org-string">"19.2 (emacs)List Buffers"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">rebind `C-x C-b'</span>
  (global-set-key (kbd <span class="org-string">"C-x C-b"</span>) 'electric-buffer-list)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">buffer-menu</span></span><span class="org-comment">' moves point in the</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">window which lists your buffers</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">electric-buffer-list</span></span><span class="org-comment">' pops up</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">a buffer describing the set of buffers</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">operate on buffers like Dired</span>
  (global-set-key (kbd <span class="org-string">"C-x C-b"</span>) 'ibuffer)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ibuffer"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">completely replaces `</span><span class="org-constant"><span class="org-comment">list-buffer</span></span><span class="org-comment">'</span>
    (<span class="org-keyword">defalias</span> '<span class="org-function-name">ibuffer-list-buffers</span> 'list-buffer)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">don't show the names of filter groups which are empty</span>
    (setq ibuffer-show-empty-filter-groups nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">filtering groups</span>
    (setq ibuffer-saved-filter-groups
          '((<span class="org-string">"default"</span>
             (<span class="org-string">"Chat"</span>
              (mode . circe-mode))
             (<span class="org-string">"Org"</span>
              (or
               (mode . diary-mode)
               (mode . org-mode)
               (mode . org-agenda-mode)))
             (<span class="org-string">"LaTeX"</span>
              (or
               (mode . latex-mode)
               (mode . LaTeX-mode)
               (mode . bibtex-mode)
               (mode . reftex-mode)))
             (<span class="org-string">"Gnus &amp; News"</span>
              (or
               (mode . message-mode)
               (mode . bbdb-mode)
               (mode . mail-mode)
               (mode . gnus-group-mode)
               (mode . gnus-summary-mode)
               (mode . gnus-article-mode)
               (name . <span class="org-string">"^</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">(</span></span><span class="org-string">\\.bbdb</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">|</span></span><span class="org-string">dot-bbdb</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">)</span></span><span class="org-string">$"</span>)
               (name . <span class="org-string">"^\\.newsrc-dribble$"</span>)
               (mode . newsticker-mode)))
             (<span class="org-string">"Files"</span>
              (filename . <span class="org-string">".*"</span>))
             (<span class="org-string">"Dired"</span>
              (mode . dired-mode))
             (<span class="org-string">"Shell"</span>
              (mode . shell-mode))
             (<span class="org-string">"Version Control"</span>
              (or
               (mode . svn-status-mode)
               (mode . svn-log-edit-mode)
               (name . <span class="org-string">"^\\*svn-"</span>)
               (name . <span class="org-string">"^\\*vc\\*$"</span>)
               (name . <span class="org-string">"^\\*Annotate"</span>)
               (name . <span class="org-string">"^\\*git-"</span>)
               (name . <span class="org-string">"^\\*vc-"</span>)))
             (<span class="org-string">"Emacs"</span>
              (or
               (name . <span class="org-string">"^\\*scratch\\*$"</span>)
               (name . <span class="org-string">"^\\*Messages\\*$"</span>)
               (name . <span class="org-string">"^TAGS</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">(</span></span><span class="org-string">&lt;[0-9]+&gt;</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">)</span></span><span class="org-string">?$"</span>)
               (name . <span class="org-string">"^\\*Occur\\*$"</span>)
               (name . <span class="org-string">"^\\*grep\\*$"</span>)
               (name . <span class="org-string">"^\\*Compile-Log\\*$"</span>)
               (name . <span class="org-string">"^\\*Backtrace\\*$"</span>)
               (name . <span class="org-string">"^\\*Process List\\*$"</span>)
               (name . <span class="org-string">"^\\*gud\\*$"</span>)
               (name . <span class="org-string">"^\\*Kill Ring\\*$"</span>)
               (name . <span class="org-string">"^\\*Completions\\*$"</span>)
               (name . <span class="org-string">"^\\*tramp"</span>)
               (name . <span class="org-string">"^\\*compilation\\*$"</span>)))
             (<span class="org-string">"Emacs Source"</span>
              (mode . emacs-lisp-mode))
             (<span class="org-string">"Documentation"</span>
              (or
               (mode . Info-mode)
               (mode . apropos-mode)
               (mode . woman-mode)
               (mode . help-mode)
               (mode . Man-mode))))))

    (add-hook 'ibuffer-mode-hook
              (<span class="org-keyword">lambda</span> ()
                (ibuffer-switch-to-saved-filter-groups <span class="org-string">"default"</span>)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">order the groups so the order is: [Default], [agenda], [emacs]</span>
    (<span class="org-keyword">defadvice</span> <span class="org-function-name">ibuffer-generate-filter-groups</span>
      (after leuven-reverse-ibuffer-groups activate)
      (setq ad-return-value (nreverse ad-return-value))))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline101" class="outline-3">
<h3 id="orgheadline101">Killing Buffers</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline101">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 19.4 (info "(emacs)Kill Buffer")</span>

  (leuven--section <span class="org-string">"19.4 (emacs)Kill Buffer"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">kill this buffer without confirmation (if not modified)</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-kill-this-buffer-without-query</span> ()
    <span class="org-doc">"Kill the current buffer without confirmation (if not modified)."</span>
    (interactive)
    (kill-buffer nil))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">key binding</span>
  (global-set-key (kbd <span class="org-string">"&lt;S-f12&gt;"</span>) 'leuven-kill-this-buffer-without-query)
</pre></div>
</div>
<div id="outline-container-orgheadline102" class="outline-3">
<h3 id="orgheadline102">Operating on Several Buffers</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline102">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 19.5 (info "(emacs)Several Buffers")</span>

  (leuven--section <span class="org-string">"19.5 (emacs)Several Buffers"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">put the current buffer at the end of the list of all buffers</span>
  (global-set-key (kbd <span class="org-string">"&lt;f12&gt;"</span>) 'bury-buffer)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">conflict when GDB'ing Emacs under</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Win32</span>
</pre></div>
</div>
<div id="outline-container-orgheadline103" class="outline-3">
<h3 id="orgheadline103">Convenience Features and Customization of Buffer Handling</h3>
<div class="outline-text-3" id="text-orgheadline103">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 19.7 (info "(emacs)Buffer Convenience") and Customization of Buffer Handling</span>

  (leuven--section <span class="org-string">"19.7 (emacs)Buffer Convenience and Customization of Buffer Handling"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">unique buffer names dependent on file name</span>
  (try-require 'uniquify)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"uniquify"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">distinguish directories by adding extra separator</span>
    (setq uniquify-trailing-separator-p t))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 19 ends here</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline104" class="outline-2">
<h2 id="orgheadline104">Multiple Windows</h2>
<div class="outline-text-2 org-src-container" id="text-orgheadline104">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 20 Multiple (info "(emacs)Windows")</span>

(leuven--chapter leuven-load-chapter-20-windows <span class="org-string">"20 Multiple Windows"</span>
</pre></div>
<div id="outline-container-orgheadline105" class="outline-3">
<h3 id="orgheadline105">Concepts of Emacs Windows</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline105">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 20.1 (info "(emacs)Basic Window")</span>

  (leuven--section <span class="org-string">"20.1 (emacs)Basic Window"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">turn off this horrible tab thingy in XEmacs</span>
  (XEmacs
    (<span class="org-keyword">when</span> (boundp 'default-gutter-visible-p)
      (set-specifier default-gutter-visible-p nil)))
</pre></div>
</div>
<div id="outline-container-orgheadline106" class="outline-3">
<h3 id="orgheadline106">Using Other Windows</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline106">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 20.3 (info "(emacs)Other Window")</span>

  (leuven--section <span class="org-string">"20.3 (emacs)Other Window"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">cycle through all windows on current frame</span>
  (global-set-key (kbd <span class="org-string">"&lt;f6&gt;"</span>) 'other-window)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">reverse operation of `C-x o' (or `</span><span class="org-constant"><span class="org-comment">f6</span></span><span class="org-comment">')</span>
  (global-set-key (kbd <span class="org-string">"&lt;S-f6&gt;"</span>)
    (<span class="org-keyword">lambda</span> ()
      (interactive)
      (other-window -1)))
</pre></div>
</div>
<div id="outline-container-orgheadline107" class="outline-3">
<h3 id="orgheadline107">Deleting and Rearranging Windows</h3>
<div class="outline-text-3" id="text-orgheadline107">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 20.5 (info "(emacs)Change Window")</span>

  (leuven--section <span class="org-string">"20.5 (emacs)Change Window"</span>)

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-delete-or-split-window</span> ()
    <span class="org-doc">"Cycle between 1 window and 2 windows.</span>

<span class="org-doc">  When splitting the window, the cursor is moved to the other</span>
<span class="org-doc">  window, as it makes more sense to do something there first.</span>

<span class="org-doc">  The window's contents is unchanged by default.</span>

<span class="org-doc">  Do you want to see another part of the same file, you've</span>
<span class="org-doc">  nothing to do.</span>

<span class="org-doc">  Do you want to see the last file you were visiting,</span>
<span class="org-doc">  simply bury the current buffer (f12).</span>

<span class="org-doc">  Do you want to go back to the first window, switch to it (f6)."</span>
    (interactive)
    (<span class="org-keyword">cond</span> ((= (count-windows) 1)
           (delete-other-windows)
           (<span class="org-keyword">if</span> (&gt; (frame-width) 160)
               (split-window-horizontally)
             (split-window-vertically))
           <span class="org-comment-delimiter">;; </span><span class="org-comment">(set-window-buffer (next-window) (other-buffer))</span>
           (other-window 1))
          (t
           (delete-other-windows))))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">delete all windows in the selected frame except the selected window</span>
  (global-set-key (kbd <span class="org-string">"&lt;f5&gt;"</span>) 'leuven-delete-or-split-window)
</pre></div>
<p>The following code flips a two-window frame, so that left is right, or up is down.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">swap 2 windows</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-swap-windows</span> ()
    <span class="org-doc">"If you have 2 windows, swap them."</span>
    (interactive)
    (<span class="org-keyword">cond</span> ((not (= (count-windows) 2))
           (message <span class="org-string">"You need exactly 2 windows to swap them."</span>))
          (t
           (<span class="org-keyword">let*</span> ((wind-1 (first (window-list)))
                  (wind-2 (second (window-list)))
                  (buf-1 (window-buffer wind-1))
                  (buf-2 (window-buffer wind-2))
                  (start-1 (window-start wind-1))
                  (start-2 (window-start wind-2)))
             (set-window-buffer wind-1 buf-2)
             (set-window-buffer wind-2 buf-1)
             (set-window-start wind-1 start-2)
             (set-window-start wind-2 start-1)))))

  (global-set-key (kbd <span class="org-string">"C-c ~"</span>) 'leuven-swap-windows)
</pre></div>
<p>The following code toggles between horizontal and vertical layout of two windows. Useful when Emacs opens the window below instead at the side.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-toggle-window-split</span> ()
    <span class="org-doc">"Toggle between vertical and horizontal split.</span>
<span class="org-doc">  Vertical split shows more of each line, horizontal split shows more lines.</span>
<span class="org-doc">  This code only works for frames with exactly two windows."</span>
    (interactive)
    (<span class="org-keyword">cond</span> ((not (= (count-windows) 2))
           (message <span class="org-string">"You need exactly 2 windows to toggle the window split."</span>))
          (t
           (<span class="org-keyword">let*</span> ((this-win-buffer (window-buffer))
                  (next-win-buffer (window-buffer (next-window)))
                  (this-win-edges (window-edges (selected-window)))
                  (next-win-edges (window-edges (next-window)))
                  (this-win-2nd (not (and (&lt;= (car this-win-edges)
                                              (car next-win-edges))
                                          (&lt;= (cadr this-win-edges)
                                              (cadr next-win-edges)))))
                  (splitter
                   (<span class="org-keyword">if</span> (= (car this-win-edges)
                          (car (window-edges (next-window))))
                       'split-window-horizontally
                     'split-window-vertically)))
             (delete-other-windows)
             (<span class="org-keyword">let</span> ((first-win (selected-window)))
               (funcall splitter)
               (<span class="org-keyword">if</span> this-win-2nd (other-window 1))
               (set-window-buffer (selected-window) this-win-buffer)
               (set-window-buffer (next-window) next-win-buffer)
               (select-window first-win)
               (<span class="org-keyword">if</span> this-win-2nd (other-window 1)))))))

  (global-set-key (kbd <span class="org-string">"C-c |"</span>) 'leuven-toggle-window-split)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline108" class="outline-3">
<h3 id="orgheadline108">Displaying a Buffer in a Window</h3>
<div class="outline-text-3" id="text-orgheadline108">
<p>Splits screen vertically if the width of the window is large enough.</p>
<p>See <a href="http://stackoverflow.com/questions/1381794/too-many-split-screens-opening-in-emacs">http://stackoverflow.com/questions/1381794/too-many-split-screens-opening-in-emacs</a> for alternative code</p>
<p>See as well <code>split-window-preferred-function</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 20.6 (info "(emacs)Displaying Buffers")</span>

  (leuven--section <span class="org-string">"20.6 (emacs)Pop Up Window"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">don't allow splitting windows vertically</span>
  (setq split-height-threshold nil)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">minimum width for splitting windows horizontally</span>
  (setq split-width-threshold 160)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline109" class="outline-3">
<h3 id="orgheadline109">Window Handling Convenience Features and Customization</h3>
<div class="outline-text-3" id="text-orgheadline109">
<p>Use <code>M-x scroll-all-mode</code> to scroll all visible windows together in parallel.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 20 ends here</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline110" class="outline-2">
<h2 id="orgheadline110">Frames and Graphical Displays</h2>
<div class="outline-text-2 org-src-container" id="text-orgheadline110">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 21 (info "(emacs)Frames") and Graphical Displays</span>

(leuven--chapter leuven-load-chapter-21-frames <span class="org-string">"21 Frames and Graphical Displays"</span>
</pre></div>
<div id="outline-container-orgheadline111" class="outline-3">
<h3 id="orgheadline111">Mouse Commands for Editing</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline111">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 21.1 (info "(emacs)Mouse Commands")</span>

  (leuven--section <span class="org-string">"21.1 (emacs)Mouse Commands"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Scroll one line at a time.</span>
  (setq mouse-wheel-scroll-amount
        '(1
          ((shift) . 1)))
</pre></div>
</div>
<div id="outline-container-orgheadline112" class="outline-3">
<h3 id="orgheadline112">Creating Frames</h3>
<div class="outline-text-3" id="text-orgheadline112">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 21.6 (info "(emacs)Creating Frames")</span>

  (leuven--section <span class="org-string">"21.6 (emacs)Creating Frames"</span>)
</pre></div>
<ol class="org-ol">
<li>Resize the frame to the size you want</li>
<li>Enter <code>(frame-parameters)</code> in the <code>*scratch*</code> buffer</li>
<li>Evaluate the form: place the cursor after the closing paren, and type <code>C-j</code>, so that the output goes right into the <code>*scratch*</code> buffer</li>
</ol>
<p>By putting customizations <code>default-frame-alist</code> in your init file, you can control the appearance of <b>all the frames</b> Emacs creates, including the initial one.</p>
<p><code>initial-frame-alist</code> is just for overriding properties for the first frame.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">when</span> (display-graphic-p)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Put Emacs exactly where you want it, every time it starts up.</span>
    (setq initial-frame-alist
          '((top . 0)
            (left . 0)))

    (GNUEmacs
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Auto-detect the screen dimensions and compute the height of Emacs.</span>
      (add-to-list 'default-frame-alist
                   (cons 'height
                         (/ (-
                             <span class="org-comment-delimiter">;; </span><span class="org-comment">Height of Display 1.</span>
                             (nth 4
                                  (assq 'geometry
                                        (car (display-monitor-attributes-list)))) <span class="org-comment-delimiter">; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment"> Emacs 24.4 needed!</span>
                             106)       <span class="org-comment-delimiter">; </span><span class="org-comment">Allow for Emacs' title bar and taskbar</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">(from the OS).</span>
                            (frame-char-height)))))

    (XEmacs
      (set-frame-position (buffer-dedicated-frame) 0 0)
      (set-frame-width (buffer-dedicated-frame) 80)
      (set-frame-height (buffer-dedicated-frame) 42)))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Title bar display of visible frames.</span>
  (setq frame-title-format
        (format <span class="org-string">"%s Emacs %s%s of %s - PID: %d"</span>
                (capitalize (symbol-name system-type))
                emacs-version
                (<span class="org-keyword">if</span> (and (boundp 'emacs-repository-version)
                         emacs-repository-version)
                    (concat <span class="org-string">" (r"</span>
                            (replace-regexp-in-string <span class="org-string">" .*"</span> <span class="org-string">""</span>
                                                      emacs-repository-version)
                            <span class="org-string">")"</span>)
                  <span class="org-string">""</span>)
                (format-time-string <span class="org-string">"%Y-%m-%d"</span> emacs-build-time)
                (emacs-pid)))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-detach-window</span> ()
    <span class="org-doc">"Close current window and re-open it in new frame."</span>
    (interactive)
    (<span class="org-keyword">let</span> ((current-buffer (window-buffer)))
      (delete-window)
      (select-frame (make-frame))
      (set-window-buffer (selected-window) current-buffer)))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline113" class="outline-3">
<h3 id="orgheadline113">Frame Commands</h3>
<div class="outline-text-3" id="text-orgheadline113">
<dl class="org-dl">
<dt><code>toggle-frame-fullscreen</code> (f11 by default)</dt>
<dd>Toggle fullscreen mode of the selected frame. <b>Ignore window manager screen decorations.</b></dd>
<dt><code>toggle-frame-maximized</code> (M-f10 by default)</dt>
<dd>Toggle maximization state of the selected frame. Respect window manager screen decorations.</dd>
</dl>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 21.7 (info "(emacs)Frame Commands")</span>

  (leuven--section <span class="org-string">"21.7 (emacs)Frame Commands"</span>)

  (<span class="org-keyword">when</span> leuven--x-window-p
    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-toggle-fullscreen</span> ()
      <span class="org-doc">"Toggle between full screen and partial screen display in X servers."</span>
      (interactive)
      (x-send-client-message nil 0 nil <span class="org-string">"_NET_WM_STATE"</span> 32
                             '(2 <span class="org-string">"_NET_WM_STATE_FULLSCREEN"</span> 0)))

    (global-set-key (kbd <span class="org-string">"C-c z"</span>) 'leuven-toggle-fullscreen))

  (GNUEmacs
    (<span class="org-keyword">when</span> (or leuven--win32-p
              leuven--cygwin-p)
      (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-w32-maximize-frame</span> ()
        <span class="org-doc">"Maximize the current frame."</span>
        (interactive)
        (w32-send-sys-command 61488)
        (global-set-key (kbd <span class="org-string">"C-c z"</span>) 'leuven-w32-restore-frame))

      (global-set-key (kbd <span class="org-string">"C-c z"</span>) 'leuven-w32-maximize-frame)

      (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-w32-restore-frame</span> ()
        <span class="org-doc">"Restore a minimized frame."</span>
        (interactive)
        (w32-send-sys-command 61728)
        (global-set-key (kbd <span class="org-string">"C-c z"</span>) 'leuven-w32-maximize-frame))))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Maximize Emacs frame by default.</span>
  (modify-all-frames-parameters '((fullscreen . maximized)))
</pre></div>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Try to use the name <code>leuven-toggle-fullscreen</code> for Windows as well</b><br />
nil</div>
</div>
</div>
<div id="outline-container-orgheadline114" class="outline-3">
<h3 id="orgheadline114">Speedbar Frames</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline114">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 21.9 (info "(emacs)Speedbar")</span>

  (leuven--section <span class="org-string">"21.9 (emacs)Speedbar Frames"</span>)

  (<span class="org-keyword">unless</span> (<span class="org-keyword">featurep</span> '<span class="org-constant">helm-config</span>)       <span class="org-comment-delimiter">; </span><span class="org-comment">Helm is better than speedbar!</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Jump to speedbar frame.</span>
    (global-set-key (kbd <span class="org-string">"&lt;f4&gt;"</span>) 'speedbar-get-focus))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Everything browser (into individual source files), or Dired on steroids.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"speedbar"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Number of spaces used for indentation.</span>
    (setq speedbar-indentation-width 2)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add new extensions for speedbar tagging (allow to expand/collapse</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">sections, etc.) -- do this BEFORE firing up speedbar?</span>
    (speedbar-add-supported-extension
     '(<span class="org-string">".bib"</span> <span class="org-string">".css"</span> <span class="org-string">".jpg"</span> <span class="org-string">".js"</span> <span class="org-string">".nw"</span> <span class="org-string">".org"</span> <span class="org-string">".php"</span> <span class="org-string">".png"</span> <span class="org-string">".R"</span> <span class="org-string">".tex"</span> <span class="org-string">".txt"</span>
       <span class="org-string">".w"</span> <span class="org-string">"README"</span>))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Bind the arrow keys in the speedbar tree.</span>
    (define-key speedbar-mode-map (kbd <span class="org-string">"&lt;right&gt;"</span>) 'speedbar-expand-line)
    (define-key speedbar-mode-map (kbd <span class="org-string">"&lt;left&gt;"</span>) 'speedbar-contract-line)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Parameters to use when creating the speedbar frame in Emacs.</span>
    (setq speedbar-frame-parameters '((width . 30)
                                      (height . 45)
                                      (foreground-color . <span class="org-string">"blue"</span>)
                                      (background-color . <span class="org-string">"white"</span>)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Speedbar in the current frame (vs in a new frame).</span>
    (<span class="org-keyword">when</span> (and (not (locate-library <span class="org-string">"helm-config"</span>))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">helm is better than speedbar!</span>
               (locate-library <span class="org-string">"sr-speedbar"</span>))

      (autoload 'sr-speedbar-toggle <span class="org-string">"sr-speedbar"</span> nil t)
      (global-set-key (kbd <span class="org-string">"&lt;f4&gt;"</span>) 'sr-speedbar-toggle)))
</pre></div>
</div>
<div id="outline-container-orgheadline115" class="outline-3">
<h3 id="orgheadline115">Scroll Bars</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline115">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 21.12 (info "(emacs)Scroll Bars")</span>

  (leuven--section <span class="org-string">"21.12 (emacs)Scroll Bars"</span>)

  (<span class="org-keyword">if</span> (and (display-graphic-p)
           <span class="org-comment-delimiter">;; </span><span class="org-comment">(featurep 'powerline)</span>
           )

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Turn scroll bar off.</span>
      (scroll-bar-mode -1)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Position of the vertical scroll bar.</span>
    (setq-default vertical-scroll-bar 'right))
</pre></div>
</div>
<div id="outline-container-orgheadline116" class="outline-3">
<h3 id="orgheadline116">Tool Bars</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline116">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 21.15 (info "(emacs)Tool Bars")</span>

  (leuven--section <span class="org-string">"21.15 (emacs)Tool Bars"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Turn tool bar off.</span>
  (<span class="org-keyword">when</span> (display-graphic-p)
    (GNUEmacs
      (tool-bar-mode -1))
    (XEmacs
      (set-specifier default-toolbar-visible-p nil)))
</pre></div>
</div>
<div id="outline-container-orgheadline117" class="outline-3">
<h3 id="orgheadline117">Using Dialog Boxes</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline117">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 21.16 Using (info "(emacs)Dialog Boxes")</span>

  (leuven--section <span class="org-string">"21.16 (emacs)Using Dialog Boxes"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't use dialog boxes to ask questions.</span>
  (setq use-dialog-box nil)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't use a file dialog to ask for files.</span>
  (setq use-file-dialog nil)
</pre></div>
</div>
<div id="outline-container-orgheadline118" class="outline-3">
<h3 id="orgheadline118">Tooltips</h3>
<div class="outline-text-3" id="text-orgheadline118">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 21.17 (info "(emacs)Tooltips")</span>

  (leuven--section <span class="org-string">"21.17 (emacs)Tooltips"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Disable Tooltip mode (use the echo area for help and GUD tooltips).</span>
  (<span class="org-keyword">unless</span> leuven--console-p (tooltip-mode -1))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 21 ends here</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline119" class="outline-2">
<h2 id="orgheadline119">International Character Set Support</h2>
<div class="outline-text-2" id="text-orgheadline119">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 22 (info "(emacs)International") Character Set Support</span>

(leuven--chapter leuven-load-chapter-22-international <span class="org-string">"22 International Character Set Support"</span>
</pre></div>
<p>For any user who needs symbols that are not in the 7-bit ASCII set, our recommendation is to move to Unicode UTF-8. That is the only encoding that is the same across all platforms and operating systems that support it.</p>
<p>To open (or save) a file in UTF-8, you can press <code>C-x &lt;RET&gt; c utf-8 &lt;RET&gt;</code> (<code>universal-coding-system-argument</code>) before the <code>C-x C-f</code> (or <code>C-x C-s</code>).</p>
<p>To help you find all the chars you need to replace by escape sequences, you can use <code>C-u C-s [^[:ascii:]]</code>.</p>
<p>To check your locale settings, you can have a look to what Emacs produce (in a mail buffer) under "Important settings" when you type <code>M-x report-emacs-bug &lt;RET&gt; foo &lt;RET&gt;</code>:</p>
<p><b>Important settings</b>:</p>
<ul class="org-ul">
<li>value of <code>$LC_ALL</code>: <code>nil</code></li>
<li>value of <code>$LC_COLLATE</code>: <code>nil</code></li>
<li>value of <code>$LC_CTYPE</code>: <code>nil</code></li>
<li>value of <code>$LC_MESSAGES</code>: <code>nil</code></li>
<li>value of <code>$LC_MONETARY</code>: <code>nil</code></li>
<li>value of <code>$LC_NUMERIC</code>: <code>nil</code></li>
<li>value of <code>$LC_TIME</code>: <code>nil</code></li>
<li>value of <code>$LANG</code>: <code>en_US.UTF-8</code></li>
<li>value of <code>$XMODIFIERS</code>: <code>nil</code></li>
<li><code>locale-coding-system</code>: <code>utf-8-unix</code></li>
<li><code>default-enable-multibyte-characters</code>: <code>t</code></li>
</ul>
</div>
<div id="outline-container-orgheadline120" class="outline-3">
<h3 id="orgheadline120">Language Environments</h3>
<div class="outline-text-3" id="text-orgheadline120">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 22.3 (info "(emacs)Language Environments")</span>

  (leuven--section <span class="org-string">"22.3 (emacs)Language Environments"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Specify your character-set locale.</span>
  (setenv <span class="org-string">"LANG"</span> <span class="org-string">"en_US.utf8"</span>)          <span class="org-comment-delimiter">; </span><span class="org-comment">For svn not to report warnings.</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">System locale to use for formatting time values.</span>
  (setq system-time-locale <span class="org-string">"C"</span>)         <span class="org-comment-delimiter">; </span><span class="org-comment">Make sure that the weekdays in the</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">time stamps of your Org mode files and</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">in the agenda appear in English.</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq system-time-locale (getenv "LANG"))</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">For weekdays in your locale settings.</span>
</pre></div>
<p>One could use:</p>
<ul class="org-ul">
<li><code>LC_ALL</code>,</li>
<li><code>LC_COLLATE=C</code> (or <code>LC_COLLATE=POSIX</code>),</li>
<li><code>LC_CTYPE</code>,</li>
<li><code>LC_ALL</code> or</li>
<li><code>LANG</code></li>
</ul>
<p>but this won't work for a Windows binary (well for the Cygwin version of Emacs).</p>
</div>
</div>
<div id="outline-container-orgheadline121" class="outline-3">
<h3 id="orgheadline121">Input Methods</h3>
<div class="outline-text-3" id="text-orgheadline121">
<p><code>M-x describe-coding-system &lt;RET&gt; &lt;RET&gt;</code></p>
<p>To see all the non-ASCII characters you can type with the <code>C-x 8</code> prefix, type <code>C-x 8 C-h</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 22.4 (info "(emacs)Input Methods")</span>

  (leuven--section <span class="org-string">"22.4 (emacs)Input Methods"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Get 8-bit characters in terminal mode (Cygwin Emacs).</span>
  (set-input-mode (car (current-input-mode))
                  (nth 1 (current-input-mode))
                  0)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-list-unicode-display</span> (<span class="org-type">&amp;optional</span> regexp)
    <span class="org-doc">"Display a list of unicode characters and their names in a buffer."</span>
    (interactive <span class="org-string">"sRegexp (default \".*\"): "</span>)
    (<span class="org-keyword">let*</span> ((regexp (or regexp <span class="org-string">".*"</span>))
           (case-fold-search t)
           (cmp (<span class="org-keyword">lambda</span> (x y) (&lt; (cdr x) (cdr y))))
           <span class="org-comment-delimiter">;; </span><span class="org-comment">alist like ("name" . code-point).</span>
           (char-alist (sort (cl-remove-if-not (<span class="org-keyword">lambda</span> (x) (string-match regexp (car x)))
                                               (ucs-names))
                             cmp)))
      (with-help-window <span class="org-string">"*Unicode characters*"</span>
        (<span class="org-keyword">with-current-buffer</span> standard-output
          (<span class="org-keyword">dolist</span> (c char-alist)
            (insert (format <span class="org-string">"0x%06X\t"</span> (cdr c)))
            (insert (cdr c))
            (insert (format <span class="org-string">"\t%s\n"</span> (car c))))))))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline122" class="outline-3">
<h3 id="orgheadline122">Recognizing Coding Systems</h3>
<div class="outline-text-3" id="text-orgheadline122">
<p>In GNU Emacs, when you specify the coding explicitly in the file via an explicit <code>coding:</code> cookie, that overrides <code>file-coding-system-alist</code>.</p>
<p>XXX Declare PDF files as binary</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 22.7 (info "(emacs)Recognize Coding") Systems</span>

  (leuven--section <span class="org-string">"22.7 (emacs)Recognize Coding Systems"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Default coding system (for new files), also moved to the front of the</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">priority list for automatic detection.</span>
  (GNUEmacs
   (prefer-coding-system 'utf-8-unix))  <span class="org-comment-delimiter">; </span><span class="org-comment">Unix flavor for code blocks executed</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">via Org-babel.</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline123" class="outline-3">
<h3 id="orgheadline123">Specifying a File's Coding System</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline123">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 22.8 (info "(emacs)Specify Coding") System of a File</span>

  (leuven--section <span class="org-string">"22.8 (emacs)Specify Coding System of a File"</span>)

  (GNUEmacs
    <span class="org-comment-delimiter">;; </span><span class="org-comment">To copy and paste to and from Emacs through the clipboard (with coding</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">system conversion).</span>
    (<span class="org-keyword">cond</span> (leuven--win32-p
           (set-selection-coding-system 'compound-text-with-extensions))
          (t
           (set-selection-coding-system 'utf-8))))
</pre></div>
</div>
<div id="outline-container-orgheadline124" class="outline-3">
<h3 id="orgheadline124">Bidirectional Editing</h3>
<div class="outline-text-3" id="text-orgheadline124">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 22.20 (info "(emacs)Bidirectional Editing")</span>

  (leuven--section <span class="org-string">"22.20 (emacs)Bidirectional Editing"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Faster scrolling (if you never expect to have to display bidirectional</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">scripts, such as Arabic and Hebrew).</span>
  (setq-default bidi-paragraph-direction 'left-to-right)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 22 ends here</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline125" class="outline-2">
<h2 id="orgheadline125">Major and Minor Modes</h2>
<div class="outline-text-2 org-src-container" id="text-orgheadline125">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 23 (info "(emacs)Modes")</span>

(leuven--chapter leuven-load-chapter-23-major-and-minor-modes <span class="org-string">"23 Major and Minor Modes"</span>
</pre></div>
<div id="outline-container-orgheadline126" class="outline-3">
<h3 id="orgheadline126">How Major Modes are Chosen</h3>
<div class="outline-text-3" id="text-orgheadline126">
<p>See "Syntax of Regexps":</p>
<ul class="org-ul">
<li><code>\'</code> matches end of string</li>
<li><code>$</code> matches end of line</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 23.3 (info "(emacs)Choosing Modes")</span>

  (leuven--section <span class="org-string">"23.3 (emacs)Choosing File Modes"</span>)
</pre></div>
</div>
<div id="outline-container-orgheadline127" class="outline-4">
<h4 id="orgheadline127">Choice based on the file name</h4>
<div class="outline-text-4" id="text-orgheadline127">
<p>Instead of superseding the binding in <code>auto-mode-alist</code>, you can replace it (brute force) with <code>(setcdr (rassq 'old-mode auto-mode-alist) 'new-mode)</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">List of filename patterns.</span>
  (setq auto-mode-alist
        (append '((<span class="org-string">"\\.log\\'"</span>       . text-mode)
                  <span class="org-comment-delimiter">;; </span><span class="org-comment">("\\.[tT]e[xX]\\'" . latex-mode)</span>
                  <span class="org-comment-delimiter">;; </span><span class="org-comment">("\\.cls\\'"       . LaTeX-mode)</span>
                  (<span class="org-string">"\\.cgi\\'"</span>       . perl-mode)
                  <span class="org-comment-delimiter">;; </span><span class="org-comment">("[mM]akefile"     . makefile-mode)</span>
                  (<span class="org-string">".ssh/config\\'"</span>  . ssh-config-mode)
                  (<span class="org-string">"sshd?_config\\'"</span> . ssh-config-mode)
                  ) auto-mode-alist))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Major mode for fontifiying ssh config files.</span>
  (autoload 'ssh-config-mode <span class="org-string">"ssh-config-mode"</span>
    <span class="org-doc">"Major mode for fontifiying ssh config files."</span> t)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Helper code for use with the "ledger" command-line tool.</span>
  (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.dat\\'"</span> . ledger-mode))
  (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.journal\\'"</span> . ledger-mode))
  (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.ledger\\'"</span> . ledger-mode))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ledger-commodities"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Default commodity for use in target calculations in ledger reconcile.</span>
    (setq ledger-reconcile-default-commodity <span class="org-string">"EUR"</span>)) <span class="org-comment-delimiter">; </span><span class="org-comment">""</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Provide custom fontification for ledger-mode.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ledger-fontify"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">If t, the highlight entire xact with state.</span>
    (setq ledger-fontify-xact-state-overrides nil))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Don't override the highlighting of</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">each posted item in a xact if it is</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">cleared/pending. </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ledger-init"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq ledger-default-date-format "%Y-%m-%d")</span>
    (setq ledger-default-date-format <span class="org-string">"%Y/%m/%d"</span>)
    )

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"flycheck"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Flycheck integration for ledger files.</span>
    (try-require 'flycheck-ledger))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">major mode for editing comma-separated value files</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"csv-mode-autoloads"</span>

    (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.csv\\'"</span> . csv-mode)))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"csv-mode"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">field separators: a list of *single-character* strings</span>
    (setq csv-separators '(<span class="org-string">","</span> <span class="org-string">";"</span>)))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline128" class="outline-4">
<h4 id="orgheadline128">Choice based on the interpreter name</h4>
<div class="outline-text-4 org-src-container" id="text-orgheadline128">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">list of interpreters specified in the first line (starts with `#!')</span>
  (push '(<span class="org-string">"expect"</span> . tcl-mode) interpreter-mode-alist)
</pre></div>
</div>
<div id="outline-container-orgheadline129" class="outline-4">
<h4 id="orgheadline129">Choice based on the text at the start of the buffer</h4>
<div class="outline-text-4" id="text-orgheadline129">
<p>For a list of buffer beginnings, see <code>magic-mode-alist</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; load generic modes which support e.g. batch files</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(try-require 'generic-x)</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 23 ends here</span>
</pre></div>
</div>
</div>
</div>
</div>
<div id="outline-container-orgheadline130" class="outline-2">
<h2 id="orgheadline130">Indentation</h2>
<div class="outline-text-2 org-src-container" id="text-orgheadline130">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 24 (info "(emacs)Indentation")</span>

(leuven--chapter leuven-load-chapter-24-indentation <span class="org-string">"24 Indentation"</span>
</pre></div>
<div id="outline-container-orgheadline131" class="outline-3">
<h3 id="orgheadline131">Indentation Commands</h3>
<div class="outline-text-3" id="text-orgheadline131">
<dl class="org-dl">
<dt><code>M-m</code></dt>
<dd><code>back-to-indentation</code>.</dd>
<dt><code>C-M-\</code></dt>
<dd>Run the command <code>indent-region</code> (which does the job of the imaginary command <code>unsuck-html-layout</code> in <code>html-mode</code>).</dd>
</dl>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 24.1 (info "(emacs)Indentation Commands") and Techniques</span>

  (leuven--section <span class="org-string">"24.1 (emacs)Indentation Commands and Techniques"</span>)

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-indent-buffer</span> ()
    <span class="org-doc">"Indent each non-blank line in the buffer."</span>
    (interactive)
    (<span class="org-keyword">save-excursion</span>
      (indent-region (point-min) (point-max) nil)))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (global-set-key (kbd <span class="org-string">"C-x \\"</span>) 'align-regexp)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Minor mode to aggressively keep your code always indented.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"aggressive-indent-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable aggressive indent mode everywhere.</span>
    (aggressive-indent-global-mode))
</pre></div>
<div class="warning">
<p>If we enable <code>aggressive-indent-mode</code>, then the tangled Emacs Lisp code (from this file) is beginning at column 0.</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Show vertical lines to guide indentation.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"indent-guide-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable indent-guide-mode automatically.</span>
    (add-hook 'prog-mode-hook #'indent-guide-mode))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"indent-guide"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Character used as vertical line.</span>
    (setq indent-guide-char <span class="org-string">""</span>)
    (setq indent-guide-char <span class="org-string">""</span>)
    (setq indent-guide-char <span class="org-string">""</span>)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq indent-guide-char ":")</span>
    )
</pre></div>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Look at the `dtrt-indent' and `aggressive-indent' packages</b><br />
<p>Aggressive-indent-mode seems very, very nice.</p>
</div>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Look at the `indent-guide'</b><br />
nil</div>
</div>
</div>
<div id="outline-container-orgheadline132" class="outline-3">
<h3 id="orgheadline132">Tabs vs. Spaces</h3>
<div class="outline-text-3" id="text-orgheadline132">
<p>Don't tabify. Instead, <span class="underline">reindent</span> everything, e.g. with C-M-\.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 24.3 TABs vs. (info "(emacs)Just Spaces")</span>

  (leuven--section <span class="org-string">"24.3 TABs vs. (emacs)Just Spaces"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Indentation can't insert TABs.</span>
  (setq-default indent-tabs-mode nil)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 24 ends here</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline133" class="outline-2">
<h2 id="orgheadline133">Commands for Human Languages</h2>
<div class="outline-text-2 org-src-container" id="text-orgheadline133">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 25 Commands for (info "(emacs)Text") Human Languages</span>

(leuven--chapter leuven-load-chapter-25-text <span class="org-string">"25 Commands for Human Languages"</span>
</pre></div>
<div id="outline-container-orgheadline134" class="outline-3">
<h3 id="orgheadline134">Words</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline134">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 25.1 (info "(emacs)Words")</span>

  (leuven--section <span class="org-string">"25.1 (emacs)Words"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">GNU Emacs default for killing back to the beginning of a word.</span>
  (XEmacs
    (global-set-key (kbd <span class="org-string">"&lt;C-backspace&gt;"</span>) 'backward-kill-word))
</pre></div>
</div>
<div id="outline-container-orgheadline135" class="outline-3">
<h3 id="orgheadline135">Sentences</h3>
<div class="outline-text-3" id="text-orgheadline135">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 25.2 (info "(emacs)Sentences")</span>

  (leuven--section <span class="org-string">"25.2 (emacs)Sentences"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; A single space does end a sentence.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq-default sentence-end-double-space nil) ; see `</span><span class="org-constant"><span class="org-comment">ispell-dictionary</span></span><span class="org-comment">'</span>
</pre></div>
<p>The default value of <code>sentence-end-double-space</code> is good for French as well, as we put two spaces after a interrogation/question mark. That way, those two spaces won't be transformed into one</p>
</div>
</div>
<div id="outline-container-orgheadline136" class="outline-3">
<h3 id="orgheadline136">Filling Text</h3>
<div class="outline-text-3" id="text-orgheadline136">
<p>There are several <b>no-break space</b> characters required for French punctuation:</p>
<ul class="org-ul">
<li><b>No-break thin space</b> (<code>202F</code>), known in Unicode as "narrow no-break space", required before <code>?</code>, <code>!</code> and <code>;</code>.</li>
<li>
<p><b>No-break space</b> (<code>00A0</code>), required before <code>:</code> and <code></code>, and required after <code></code>.</p>
<p>It can be inserted with <code>S-SPC</code>:</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">defun</span> <span class="org-function-name">leuven-nbsp-command</span> ()
  <span class="org-doc">"Insert the no-break space character 00A0."</span>
  (interactive)
  (insert-char ?\u00A0))

(global-set-key (kbd <span class="org-string">"S-SPC"</span>) 'leuven-nbsp-command)
</pre></div>
</li>
</ul>
<p>They could be used to avoid breaking at certain bad places.</p>
<p>Another solution to avoid that is to add <code>fill-french-nobreak-p</code> to <code>fill-nobreak-predicate</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 25.5 (info "(emacs)Filling") Text</span>

  (leuven--section <span class="org-string">"25.5 (emacs)Filling Text"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Line-wrapping beyond that column (when pressing `</span><span class="org-constant"><span class="org-comment">M-q</span></span><span class="org-comment">').</span>
  (setq-default fill-column 80)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">(Un-)fill paragraph.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-fill-paragraph</span> (<span class="org-type">&amp;optional</span> arg)
    <span class="org-doc">"`</span><span class="org-constant"><span class="org-doc">M-q</span></span><span class="org-doc">' runs the command `</span><span class="org-constant"><span class="org-doc">fill-paragraph</span></span><span class="org-doc">'.</span>
<span class="org-doc">  `C-u M-q' runs \"unfill-paragraph\": it takes a multi-line paragraph and</span>
<span class="org-doc">  converts it into a single line of text."</span>
    (interactive <span class="org-string">"P"</span>)
    (<span class="org-keyword">let</span> ((fill-column (<span class="org-keyword">if</span> arg
                           (point-max)
                         fill-column)))
      (fill-paragraph nil)))

  (global-set-key (kbd <span class="org-string">"M-q"</span>) 'leuven-fill-paragraph)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Prevent breaking lines just before a punctuation mark such as `?' or `:'.</span>
  (add-hook 'fill-nobreak-predicate 'fill-french-nobreak-p)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Activate Auto Fill for all text mode buffers.</span>
  (add-hook 'text-mode-hook 'auto-fill-mode)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Graphically indicate the fill column.</span>
  (try-require 'fill-column-indicator)
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"fill-column-indicator"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Color used to draw the fill-column rule.</span>
    (setq fci-rule-color <span class="org-string">"#FFE0E0"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Show the fill-column rule as dashes.</span>
    (setq fci-rule-use-dashes t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Ratio of dash length to line height.</span>
    (setq fci-dash-pattern 0.5)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable fci-mode in programming, message and Org modes.</span>
    (add-hook 'prog-mode-hook 'fci-mode)
    (add-hook 'message-mode-hook 'fci-mode)
    (add-hook 'org-mode-hook 'fci-mode)
</pre></div>
<div class="note">
<p>Enabling <code>fci-mode</code> as a global minor mode slows down the tangling of this file by a factor 2</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Avoid fci-mode and auto-complete popups.</span>
    (<span class="org-keyword">defvar</span> <span class="org-variable-name">sanityinc/fci-mode-suppressed</span> nil)
    (<span class="org-keyword">defadvice</span> <span class="org-function-name">popup-create</span> (before suppress-fci-mode activate)
      <span class="org-doc">"Suspend fci-mode while popups are visible"</span>
      (set (make-local-variable 'sanityinc/fci-mode-suppressed) fci-mode)
      (<span class="org-keyword">when</span> fci-mode
        (turn-off-fci-mode)))
    (<span class="org-keyword">defadvice</span> <span class="org-function-name">popup-delete</span> (after restore-fci-mode activate)
      <span class="org-doc">"Restore fci-mode when all popups have closed"</span>
      (<span class="org-keyword">when</span> (and (not popup-instances) sanityinc/fci-mode-suppressed)
        (setq sanityinc/fci-mode-suppressed nil)
        (turn-on-fci-mode))))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-replace-nbsp-by-spc</span> ()
    <span class="org-doc">"Replace all nbsp by normal spaces."</span>
    (interactive <span class="org-string">"*"</span>)
    (<span class="org-keyword">save-excursion</span>
      (<span class="org-keyword">save-restriction</span>
        (<span class="org-keyword">save-match-data</span>
          (<span class="org-keyword">progn</span>
            (goto-char (point-min))
            (<span class="org-keyword">while</span> (re-search-forward <span class="org-string">"[ ]"</span> nil t)
              (replace-match <span class="org-string">" "</span> nil nil)))))))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-good-old-fill-paragraph</span> ()
    (interactive)
    (<span class="org-keyword">let</span> ((fill-paragraph-function nil)
          (adaptive-fill-function nil))
      (fill-paragraph)))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-smart-punctuation-apostrophe</span> ()
    <span class="org-doc">"Replace second apostrophe by backquote in front of symbol."</span>
    (interactive)
    (<span class="org-keyword">cond</span>
     ((or (bolp) (not (looking-back <span class="org-string">"'"</span>)))
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Insert just one '.</span>
      (self-insert-command 1))
     ((<span class="org-keyword">save-excursion</span>
        (backward-char)
        <span class="org-comment-delimiter">;; </span><span class="org-comment">Skip symbol backwards.</span>
        (and (not (zerop (skip-syntax-backward <span class="org-string">"w_"</span>)))
             (not (looking-back <span class="org-string">"`"</span>))
             (or (insert-and-inherit <span class="org-string">"`"</span>) t))))
     (t
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Insert `' around following symbol.</span>
      (delete-char -1)
      (<span class="org-keyword">unless</span> (looking-back <span class="org-string">"`"</span>) (insert-and-inherit <span class="org-string">"`"</span>))
      (<span class="org-keyword">save-excursion</span>
        (skip-syntax-forward <span class="org-string">"w_"</span>)
        (<span class="org-keyword">unless</span> (looking-at <span class="org-string">"'"</span>) (insert-and-inherit <span class="org-string">"'"</span>))))))

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-smart-punctuation-quotation-mark</span> ()
    <span class="org-doc">"Replace two following double quotes by French quotes."</span>
    (interactive)
    (<span class="org-keyword">let</span> ((dict (or (<span class="org-keyword">when</span> (boundp 'ispell-local-dictionary)
                      ispell-local-dictionary)
                    (<span class="org-keyword">when</span> (boundp 'ispell-dictionary)
                      ispell-dictionary))))
(message <span class="org-string">"&gt;&gt;&gt; %s"</span> major-mode)
      (<span class="org-keyword">cond</span>
       ((and (string= dict <span class="org-string">"francais"</span>)
             (eq (char-before) ?\")
             (or (not (equal mode-name <span class="org-string">"Org"</span>))
                 (not (member (org-element-type (org-element-at-point))
                              '(src-block keyword table dynamic-block)))))
        (backward-delete-char 1)
        (insert <span class="org-string">"  "</span>)
        (backward-char 2))
       ((and (eq (char-before) ?\")
             (derived-mode-p 'latex-mode))
        (backward-delete-char 1)
        (insert <span class="org-string">"\\enquote{}"</span>)
        (backward-char 1))
       (t
        (insert <span class="org-string">"\""</span>)))))

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-smart-punctuation</span> ()
    <span class="org-doc">"Replace second apostrophe or quotation mark."</span>
    (interactive)
    (local-set-key [39] 'leuven-smart-punctuation-apostrophe)
    (local-set-key <span class="org-string">"\""</span> 'leuven-smart-punctuation-quotation-mark))

  (add-hook 'text-mode-hook 'leuven-smart-punctuation)
  (add-hook 'message-mode-hook 'leuven-smart-punctuation)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"key-chord-autoloads"</span>
    (key-chord-mode 1))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Map pairs of simultaneously pressed keys to commands.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"key-chord"</span>

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"hideshow"</span>    <span class="org-comment-delimiter">; </span><span class="org-comment">Package.</span>
      (key-chord-define hs-minor-mode-map <span class="org-string">"',"</span> 'hs-hide-block) <span class="org-comment-delimiter">; </span><span class="org-comment">Not autoloaded.</span>
      (key-chord-define hs-minor-mode-map <span class="org-string">"'."</span> 'hs-show-block)) <span class="org-comment-delimiter">; </span><span class="org-comment">Not autoloaded.</span>

    (key-chord-define-global <span class="org-string">"&lt;&lt;"</span> (<span class="org-keyword">lambda</span> () (interactive) (insert <span class="org-string">""</span>)))
    (key-chord-define-global <span class="org-string">"&gt;&gt;"</span> (<span class="org-keyword">lambda</span> () (interactive) (insert <span class="org-string">""</span>)))

    (key-chord-define-global <span class="org-string">"hb"</span> 'describe-bindings)
    (key-chord-define-global <span class="org-string">"hf"</span> 'describe-function)
    (key-chord-define-global <span class="org-string">"hv"</span> 'describe-variable)

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"expand-region-autoloads"</span> <span class="org-comment-delimiter">; </span><span class="org-comment">Autoloads file.</span>
      (key-chord-define-global <span class="org-string">"hh"</span> 'er/expand-region)) <span class="org-comment-delimiter">; </span><span class="org-comment">Autoloaded.</span>

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ace-window-autoloads"</span> <span class="org-comment-delimiter">; </span><span class="org-comment">Autoloads file.</span>
      (key-chord-define-global <span class="org-string">"jj"</span> 'ace-jump-word-mode) <span class="org-comment-delimiter">; </span><span class="org-comment">Autoloaded.</span>
      (key-chord-define-global <span class="org-string">"jk"</span> 'ace-jump-mode-pop-mark) <span class="org-comment-delimiter">; </span><span class="org-comment">Autoloaded.</span>
      (key-chord-define-global <span class="org-string">"jl"</span> 'ace-jump-line-mode)) <span class="org-comment-delimiter">; </span><span class="org-comment">Autoloaded.</span>

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ace-window"</span>
      (key-chord-define-global <span class="org-string">"jw"</span> 'ace-window))

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"dired-x"</span>
      (key-chord-define-global <span class="org-string">"xj"</span> 'dired-jump)) <span class="org-comment-delimiter">; </span><span class="org-comment">Autoloaded?</span>

    (key-chord-define-global <span class="org-string">"vb"</span> 'eval-buffer)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define-global "vg" 'eval-region)</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">2015-02-17 Crash Gnus `C-u g'</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define-global "x0" 'delete-window)</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">2015-02-09 Crash Gnus `C-u 3'</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define-global "x1" 'delete-other-windows)</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">2015-02-05 Crash Gnus `C-u 1'</span>
    (key-chord-define-global <span class="org-string">"xh"</span> 'mark-whole-buffer)
    (key-chord-define-global <span class="org-string">"xk"</span> 'kill-buffer) <span class="org-comment-delimiter">; </span><span class="org-comment">leuven-kill-this-buffer-without-query?</span>
    (key-chord-define-global <span class="org-string">"xo"</span> 'other-window)

    (key-chord-define-global <span class="org-string">"yy"</span> 'browse-kill-ring)
    (key-chord-define-global <span class="org-string">"zk"</span> 'zap-to-char)

    (key-chord-define-global <span class="org-string">";s"</span> 'set-mark-command)

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"diff-hl"</span>     <span class="org-comment-delimiter">; </span><span class="org-comment">Package.</span>
      (key-chord-define diff-hl-mode-map <span class="org-string">"v,"</span> 'diff-hl-previous-hunk)
      (key-chord-define diff-hl-mode-map <span class="org-string">"v."</span> 'diff-hl-next-hunk)
      (key-chord-define diff-hl-mode-map <span class="org-string">"v;"</span> 'diff-hl-next-hunk))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">For Azerty keyboards</span>

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-loaddefs"</span> <span class="org-comment-delimiter">; </span><span class="org-comment">Autoloads file?</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define-global ",a" 'org-agenda) ; Autoloaded.</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">2015-02-18 Crash Gnus `C-u a'</span>
      (key-chord-define-global <span class="org-string">",c"</span> 'org-capture)) <span class="org-comment-delimiter">; </span><span class="org-comment">Autoloaded.</span>

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>         <span class="org-comment-delimiter">; </span><span class="org-comment">Package.</span>
      (key-chord-define org-mode-map <span class="org-string">",u"</span> 'outline-up-heading)
      (key-chord-define org-mode-map <span class="org-string">",w"</span> 'org-refile) <span class="org-comment-delimiter">; </span><span class="org-comment">Not autoloaded.</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define org-mode-map ",," 'org-mark-ring-goto)           ;; Return to previous location before link.</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define org-mode-map ",." 'org-time-stamp)               ;; Create new timestamp.</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define org-mode-map ",b" 'org-tree-to-indirect-buffer)  ;; Show complete tree in dedicated buffer.</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define org-mode-map ",d" 'org-todo)                     ;; Toggle todo for headline.</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define org-mode-map ",e" 'org-insert-link)              ;; Edit current link.</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define org-mode-map ",f" 'org-footnote-action)          ;; Create new footnote link.</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define org-mode-map ",g" 'er/open-org-calendar)         ;; Open calendar integration. :Functions.el:</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define org-mode-map ",h" 'org-toggle-heading)           ;; Toggle heading for current line/list item.</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define org-mode-map ",k" 'org-cut-subtree)              ;; Kill subtree.</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define org-mode-map ",l" 'org-store-link)               ;; Store link (useful for agenda ref).</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define org-mode-map ",n" 'er/org-narrow-and-reveal)     ;; Narrow region and reveal. :Functions.el:</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define org-mode-map ",o" 'org-open-at-point)            ;; Open link at point.</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define org-mode-map ",p" 'org-priority)                 ;; Toggle priority.</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define org-mode-map ",t" 'org-set-tags-command)         ;; Choose tags.</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define org-mode-map ",v" 'org-paste-subtree)            ;; Paste subtree.</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define org-mode-map ",w" 'er/org-widen-and-outline)     ;; Widen and outline. :Functions.el:</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define org-mode-map ",y" 'org-copy-subtree)             ;; Copy subtree.</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define org-mode-map "&lt;H" 'org-list-make-subtree)        ;; Toggle headings for all list items in subtree.</span>
      )

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define-global "ac" 'align-current)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define-global "fc" 'flycheck-mode)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define-global "fv" (lambda () (interactive) (kill-buffer (buffer-name))))</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define-global "sv" 'save-buffer)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "M-2") 'highlight-symbol-occur)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "M-3") (lambda () (interactive) (highlight-symbol-jump -1)))</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "M-4") (lambda () (interactive) (highlight-symbol-jump 1)))</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define-global "vg" 'vc-git-grep)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define-global "''" "`'\C-b")</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define-global "dq" "\"\"\C-b")</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define-global ";d" 'dired-jump-other-window)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define-global "jk" 'dabbrev-expand)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define-global "JJ" 'find-tag)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define-global ",." "&lt;&gt;\C-b")</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define-global "''" "`'\C-b")</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define-global ",," 'indent-for-comment)</span>
    )
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline137" class="outline-3">
<h3 id="orgheadline137">Case Conversion Commands</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline137">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 25.6 (info "(emacs)Case") Conversion Commands</span>

  (leuven--section <span class="org-string">"25.6 (emacs)Case Conversion Commands"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable the use of the commands `</span><span class="org-constant"><span class="org-comment">downcase-region</span></span><span class="org-comment">' and `</span><span class="org-constant"><span class="org-comment">upcase-region</span></span><span class="org-comment">'</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">without confirmation.</span>
  (put 'downcase-region 'disabled nil)
  (put 'upcase-region 'disabled nil)
</pre></div>
</div>
<div id="outline-container-orgheadline138" class="outline-3">
<h3 id="orgheadline138"><a id="ID-42ad895e-c049-4710-a877-5014a7f6acfc" name="ID-42ad895e-c049-4710-a877-5014a7f6acfc"></a>Outline Mode</h3>
<div class="outline-text-3" id="text-orgheadline138">
<p>Outline is line-oriented and does not distinguish end-of-block.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 25.8 (info "(emacs)Outline Mode")</span>

  (leuven--section <span class="org-string">"25.8 (emacs)Outline Mode"</span>)
</pre></div>
</div>
<div id="outline-container-orgheadline140" class="outline-4">
<h4 id="orgheadline140"><span class="todo TODO">TODO</span> outline-minor-mode (inside plain latex-mode as well)</h4>
<div class="outline-text-4" id="text-orgheadline140">
<p>Though Outline minor mode has NOTHING to do with folding of code as such, some people have the following code in their <code>ruby-mode-hook</code> to enable code folding using <code>outline-minor-mode</code> + <code>outline-magic</code>.</p>
<pre class="example">
(outline-minor-mode 1)
(set (make-local-variable 'outline-regexp) "^[ \t]*\\(?:def\\|class\\|module\\)\\|^[ \t]*###==")
</pre>
<p>Outline minor mode is also used to collapse Lisp code (i.e., to see in the buffer just the definition of a function instead of the whole body).</p>
<p>See also the library <a href="#orgheadline139">hs-minor-mode</a>.</p>
<p>You can use <code>org-cycle</code> in other modes, with <code>outline-minor-mode</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Outline mode commands for Emacs.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"outline"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Bind the outline minor mode functions to an easy to remember prefix</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">key (more accessible than the horrible prefix `C-c @').</span>
    (setq outline-minor-mode-prefix (kbd <span class="org-string">"C-c C-o"</span>)) <span class="org-comment-delimiter">; </span><span class="org-comment">like in nXML mode</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Make other `</span><span class="org-constant"><span class="org-comment">outline-minor-mode</span></span><span class="org-comment">' files (LaTeX, etc.) feel the Org</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; mode outline navigation (written by Carsten Dominik).</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(try-require 'outline-magic)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "outline-magic"</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(add-hook 'outline-minor-mode-hook</span>
    <span class="org-comment-delimiter">;;             </span><span class="org-comment">(lambda ()</span>
    <span class="org-comment-delimiter">;;               </span><span class="org-comment">(define-key outline-minor-mode-map</span>
    <span class="org-comment-delimiter">;;                 </span><span class="org-comment">(kbd "&lt;S-tab&gt;") 'outline-cycle)</span>
    <span class="org-comment-delimiter">;;               </span><span class="org-comment">(define-key outline-minor-mode-map</span>
    <span class="org-comment-delimiter">;;                 </span><span class="org-comment">(kbd "&lt;M-left&gt;") 'outline-promote)</span>
    <span class="org-comment-delimiter">;;               </span><span class="org-comment">(define-key outline-minor-mode-map</span>
    <span class="org-comment-delimiter">;;                 </span><span class="org-comment">(kbd "&lt;M-right&gt;") 'outline-demote)</span>
    <span class="org-comment-delimiter">;;               </span><span class="org-comment">(define-key outline-minor-mode-map</span>
    <span class="org-comment-delimiter">;;                 </span><span class="org-comment">(kbd "&lt;M-up&gt;") 'outline-move-subtree-up)</span>
    <span class="org-comment-delimiter">;;               </span><span class="org-comment">(define-key outline-minor-mode-map</span>
    <span class="org-comment-delimiter">;;                 </span><span class="org-comment">(kbd "&lt;M-down&gt;") 'outline-move-subtree-down))))</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Extra support for outline minor mode.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(try-require 'out-xtra)</span>


    <span class="org-comment-delimiter">;; </span><span class="org-comment">Org-style folding for a `</span><span class="org-constant"><span class="org-comment">.emacs</span></span><span class="org-comment">' (and much more).</span>

    <span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">FIXME</span></span><span class="org-comment"> This should be in an `</span><span class="org-constant"><span class="org-comment">eval-after-load</span></span><span class="org-comment">' of Org, so that</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">org-level-N</span></span><span class="org-comment">' are defined when used</span>

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--outline-regexp</span> ()
      <span class="org-doc">"Calculate the outline regexp for the current mode."</span>
      (<span class="org-keyword">let</span> ((comment-starter (replace-regexp-in-string
                              <span class="org-string">"[[:space:]]+"</span> <span class="org-string">""</span> comment-start)))
        (<span class="org-keyword">when</span> (string= comment-start <span class="org-string">";"</span>)
          (setq comment-starter <span class="org-string">";;"</span>))
        <span class="org-comment-delimiter">;; </span><span class="org-comment">(concat "^" comment-starter "\\*+")))</span>
        (concat <span class="org-string">"^"</span> comment-starter <span class="org-string">"[*]+ "</span>)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Fontify the whole line for headings (with a background color).</span>
    (setq org-fontify-whole-heading-line t)

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--outline-minor-mode-hook</span> ()
      (setq outline-regexp (leuven--outline-regexp))
      (<span class="org-keyword">let*</span> ((org-fontify-whole-headline-regexp <span class="org-string">""</span>) <span class="org-comment-delimiter">; </span><span class="org-comment">"\n?")</span>
             (heading-1-regexp
              (concat (substring outline-regexp 0 -1)
                      <span class="org-string">"\\{1\\} </span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">(</span></span><span class="org-string">.*"</span> org-fontify-whole-headline-regexp <span class="org-string">"</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">)</span></span><span class="org-string">"</span>))
             (heading-2-regexp
              (concat (substring outline-regexp 0 -1)
                      <span class="org-string">"\\{2\\} </span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">(</span></span><span class="org-string">.*"</span> org-fontify-whole-headline-regexp <span class="org-string">"</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">)</span></span><span class="org-string">"</span>))
             (heading-3-regexp
              (concat (substring outline-regexp 0 -1)
                      <span class="org-string">"\\{3\\} </span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">(</span></span><span class="org-string">.*"</span> org-fontify-whole-headline-regexp <span class="org-string">"</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">)</span></span><span class="org-string">"</span>))
             (heading-4-regexp
              (concat (substring outline-regexp 0 -1)
                      <span class="org-string">"\\{4,\\} </span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">(</span></span><span class="org-string">.*"</span> org-fontify-whole-headline-regexp <span class="org-string">"</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">)</span></span><span class="org-string">"</span>)))
        (font-lock-add-keywords nil
         `((,heading-1-regexp 1 'org-level-1 t)
           (,heading-2-regexp 1 'org-level-2 t)
           (,heading-3-regexp 1 'org-level-3 t)
           (,heading-4-regexp 1 'org-level-4 t)))))

    (add-hook 'outline-minor-mode-hook
              'leuven--outline-minor-mode-hook)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add the following as the top line of your `</span><span class="org-constant"><span class="org-comment">.emacs</span></span><span class="org-comment">':</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">; -*- mode: emacs-lisp; eval: (outline-minor-mode 1); -*-</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Now you can add `;;' and `;;*', etc. as headings in your `</span><span class="org-constant"><span class="org-comment">.emacs</span></span><span class="org-comment">'</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">and cycle using `</span><span class="org-constant"><span class="org-comment">&lt;S-tab&gt;</span></span><span class="org-comment">', `</span><span class="org-constant"><span class="org-comment">&lt;M-left&gt;</span></span><span class="org-comment">' and `</span><span class="org-constant"><span class="org-comment">&lt;M-right&gt;</span></span><span class="org-comment">' will collapse</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">or expand all headings respectively.  I am guessing you mean to make</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">segments such as `;; SHORTCUTS' and `;; VARIABLES', this will do</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">that, but not too much more.</span>
    )
</pre></div>
<p>For Emacs Lisp, Stefan Monnier additionally uses:</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (add-hook 'outline-minor-mode-hook
              (<span class="org-keyword">lambda</span> ()
                (<span class="org-keyword">when</span> (and outline-minor-mode (derived-mode-p 'emacs-lisp-mode))
                  (hide-sublevels 1000))))
</pre></div>
<p>which starts outline-minor-mode by hiding all the bodies of functions. He also uses <code>reveal-mode</code> which automatically unhides the bodies when you try to move the cursor into them (so you don't need to remember the key sequences to use for opening/closing elements).</p>
</div>
</div>
<div id="outline-container-orgheadline141" class="outline-4">
<h4 id="orgheadline141">org-global-cycle + outline-magic</h4>
<div class="outline-text-4" id="text-orgheadline141">
<p>The visibility-cycling features are written in a way that they are independent of the outline setup. The following setup provides standard Org mode functionality (headline folding and unfolding) in <code>outline-minor-mode</code> on <code>&lt;C-tab&gt;</code> and <code>&lt;S-tab&gt;</code>. We use <code>&lt;C-tab&gt;</code> instead of <code>&lt;tab&gt;</code>, because <code>&lt;tab&gt;</code> usually has mode-specific tasks.</p>
<p>Note that for <code>&lt;C-tab&gt;</code> to work, the cursor needs to be on a headline (the line where the ellipsis shows).</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'outline-minor-mode-hook</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(lambda ()</span>
  <span class="org-comment-delimiter">;;     </span><span class="org-comment">(define-key outline-minor-mode-map [(control tab)] 'org-cycle)</span>
  <span class="org-comment-delimiter">;;     </span><span class="org-comment">(define-key outline-minor-mode-map [(shift tab)] 'org-global-cycle))) ; backtab?</span>
</pre></div>
<p>Now doing</p>
<p>M-x find-library RET ox.el RET</p>
<p>S-TAB (one or more times)</p>
<p>will give you a give quick overview of all the function names.</p>
<p>Or check out <code>outline-magic.el</code>, which does this and also provides <b>promotion and demotion</b> functionality.</p>
</div>
</div>
<div id="outline-container-orgheadline142" class="outline-4">
<h4 id="orgheadline142">org</h4>
<div class="outline-text-4 org-src-container" id="text-orgheadline142">
<pre class="src src-emacs-lisp">
  (global-set-key (kbd <span class="org-string">"&lt;S-tab&gt;"</span>) 'org-cycle) <span class="org-comment-delimiter">; </span><span class="org-comment">that works (but on level 1+)</span>
  <span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment"> Look at org-cycle-global and local below, they work better, but</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">still on level 1+</span>
  <span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment"> Replace it by a function which alternatively does `</span><span class="org-constant"><span class="org-comment">hide-body</span></span><span class="org-comment">' and</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">show-all</span></span><span class="org-comment">'</span>
</pre></div>
</div>
<div id="outline-container-orgheadline143" class="outline-4">
<h4 id="orgheadline143">org-struct-mode</h4>
<div class="outline-text-4" id="text-orgheadline143">
<p>&gt; Experienced users use outline-minor-mode - It takes time to getting used to &gt; it.</p>
<p>You can also use <code>orgstruct-mode</code>, a minor mode that comes with <code>org-mode</code>.</p>
<p><code>org-global-cycle</code> (!= <code>org-cycle-global</code>) now works fine in buffers using <code>orgstruct-mode</code>.</p>
<p>As for handling "large" files, I use this:</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">from Bastien</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment"> 2010-06-21 Conflicts with outline-minor-mode bindings</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; add a hook to use `</span><span class="org-constant"><span class="org-comment">orgstruct-mode</span></span><span class="org-comment">' in Emacs Lisp buffers</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'emacs-lisp-mode-hook 'orgstruct-mode)</span>

  (<span class="org-keyword">defun</span> <span class="org-function-name">org-cycle-global</span> ()
    (interactive)
    (org-cycle t))

  (global-set-key (kbd <span class="org-string">"C-M-]"</span>) 'org-cycle-global)
                                        <span class="org-comment-delimiter">; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment"> ok on Emacs Lisp, not on LaTeX</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">&lt;S-tab&gt;?</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">(defun org-cycle-local ()</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(interactive)</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(save-excursion</span>
  <span class="org-comment-delimiter">;;     </span><span class="org-comment">(move-beginning-of-line nil)</span>
  <span class="org-comment-delimiter">;;     </span><span class="org-comment">(org-cycle)))</span>

  (<span class="org-keyword">defun</span> <span class="org-function-name">org-cycle-local</span> ()
    (interactive)
    (<span class="org-keyword">ignore-errors</span>
      (end-of-defun)
      (beginning-of-defun))
    (org-cycle))

  (global-set-key (kbd <span class="org-string">"M-]"</span>) 'org-cycle-local)
                                        <span class="org-comment-delimiter">; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment"> ok on Emacs Lisp, not on LaTeX</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">C-M-] and M-] fold the whole buffer or the current defun.</span>
</pre></div>
<p>I made a video to demonstrate it quickly: <a href="https://vimeo.com/55570133">navigating-emacs</a>.</p>
<p>This helps me survive in files like <code>org.el</code> and <code>org-agenda.el</code>.</p>
</div>
</div>
<div id="outline-container-orgheadline144" class="outline-4">
<h4 id="orgheadline144">fold-dwim</h4>
</div>
<div id="outline-container-orgheadline145" class="outline-4">
<h4 id="orgheadline145">fold-dwim-org</h4>
<div class="outline-text-4" id="text-orgheadline145">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Unified user interface for Emacs folding modes, bound to Org key-strokes.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(GNUEmacs</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(try-require 'fold-dwim-org))</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">25.8.2</span>
  (global-set-key (kbd <span class="org-string">"&lt;M-f6&gt;"</span>) 'visible-mode)
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline146" class="outline-3">
<h3 id="orgheadline146">Boxquote</h3>
<div class="outline-text-3" id="text-orgheadline146">
<p>Use Unicode characters.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(emacs-goodies-el)boxquote")</span>

  (leuven--section <span class="org-string">"(emacs-goodies-el)boxquote"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"boxquote-autoloads"</span>
    (global-set-key (kbd <span class="org-string">"C-c q"</span>) 'boxquote-region))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"boxquote"</span>
    (setq boxquote-top-and-tail  <span class="org-string">""</span>)
    (setq boxquote-title-format  <span class="org-string">" %s"</span>)
    (setq boxquote-top-corner    <span class="org-string">"  "</span>)
    (setq boxquote-side          <span class="org-string">"   "</span>)
    (setq boxquote-bottom-corner <span class="org-string">"  "</span>))
</pre></div>
<p>In Gnus, you can mark some region with enclosing tags by pressing <code>C-c M-m</code> (<code>message-mark-inserted-region</code>) or by clicking on <code>&lt;menu-bar&gt; &lt;Message&gt; &lt;Insert Region Marked&gt;</code>.</p>
<pre class="example">
--8&lt;---------------cut here---------------start-------------&gt;8---
...
...
...
--8&lt;---------------cut here---------------end---------------&gt;8---
</pre></div>
</div>
<div id="outline-container-orgheadline147" class="outline-3">
<h3 id="orgheadline147">Phonetic</h3>
<div class="outline-text-3" id="text-orgheadline147">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "phonetic")</span>

  (leuven--section <span class="org-string">"phonetic"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Phonetic spelling.</span>
  (<span class="org-keyword">when</span> (locate-library <span class="org-string">"phonetic"</span>)
    (autoload 'phonetize-region <span class="org-string">"phonetic"</span>
      <span class="org-doc">"Translate the region according to the phonetic alphabet."</span> t))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 25 ends here</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline148" class="outline-2">
<h2 id="orgheadline148"><a id="ID-737b836b-ac1f-4120-94ca-c9e0282268f0" name="ID-737b836b-ac1f-4120-94ca-c9e0282268f0"></a>Org Mode (Getting Things Done)</h2>
<div class="outline-text-2" id="text-orgheadline148">
<ul class="org-ul">
<li>40 variables most frequently customized in Org <a href="http://orgmode.org/worg/org-configs/org-customization-survey.html">http://orgmode.org/worg/org-configs/org-customization-survey.html</a></li>
<li>Org config examples <a href="http://repo.or.cz/w/Worg.git/tree/HEAD:/org-configs">http://repo.or.cz/w/Worg.git/tree/HEAD:/org-configs</a></li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 25.9 Org Mode</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">(info "(org)Top") outline-based notes management and organizer</span>

(leuven--chapter leuven-load-chapter-25.9-org-mode <span class="org-string">"25.9 Getting Things Done (with Org mode)"</span>
</pre></div>
<p>After all the configuration has been done, you can easily manage your daily work and tasks with Org mode.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 1 (info "(org)Introduction")</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 1.2 (info "(org)Installation")</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Autoload functions.</span>
  (GNUEmacs
    (try-require 'org-loaddefs))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Getting started.</span>
  (GNUEmacs
    (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.txt\\'"</span> . org-mode))
    (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.org\\'"</span> . org-mode))
    (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.org_archive\\'"</span> . org-mode)))

  (define-key global-map (kbd <span class="org-string">"C-c l"</span>) 'org-store-link)
  (define-key global-map (kbd <span class="org-string">"C-c c"</span>) 'org-capture)
  (define-key global-map (kbd <span class="org-string">"C-c a"</span>) 'org-agenda)
  (define-key global-map (kbd <span class="org-string">"C-c b"</span>) 'org-switchb)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Using links outside Org.</span>
  (global-set-key (kbd <span class="org-string">"C-c L"</span>) 'org-insert-link-global)
  (global-set-key (kbd <span class="org-string">"C-c O"</span>) 'org-open-at-point-global)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Display the Org mode manual in Info mode.</span>
    (define-key global-map (kbd <span class="org-string">"C-h o"</span>) 'org-info))
                                        <span class="org-comment-delimiter">; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment"> not autoloaded</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Unbind `</span><span class="org-constant"><span class="org-comment">C-j</span></span><span class="org-comment">'.</span>
    (define-key org-mode-map (kbd <span class="org-string">"C-j"</span>) nil))
</pre></div>
<p>These variables need to be set before Org mode is loaded.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">These variables need to be set before org.el is loaded...</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Face to be used by `</span><span class="org-constant"><span class="org-comment">font-lock</span></span><span class="org-comment">' for highlighting in Org mode Emacs</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; buffers, and tags to be used to convert emphasis fontifiers for HTML</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; export. </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment"> Format changed! </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-emphasis-alist              ; Remove the strike-through emphasis.</span>
  <span class="org-comment-delimiter">;;       </span><span class="org-comment">'(("*" bold "&lt;b&gt;" "&lt;/b&gt;")</span>
  <span class="org-comment-delimiter">;;         </span><span class="org-comment">("/" italic "&lt;i&gt;" "&lt;/i&gt;")</span>
  <span class="org-comment-delimiter">;;         </span><span class="org-comment">("_" underline "&lt;span style=\"text-decoration:underline;\"&gt;" "&lt;/span&gt;")</span>
  <span class="org-comment-delimiter">;;         </span><span class="org-comment">("=" org-verbatim "&lt;code&gt;" "&lt;/code&gt;" verbatim)</span>
  <span class="org-comment-delimiter">;;         </span><span class="org-comment">("~" org-code "&lt;code&gt;" "&lt;/code&gt;" verbatim)))</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-emphasis-alist</span>
  <span class="org-comment-delimiter">;;       </span><span class="org-comment">'(("&amp;" (:weight ultra-bold :foreground "#000000" :background "#FBFF00"))</span>
  <span class="org-comment-delimiter">;;         </span><span class="org-comment">;; ("?" (:box t))</span>
  <span class="org-comment-delimiter">;;         </span><span class="org-comment">("!" (:weight ultra-bold :foreground "#B40000")) ; = alert in some Wikis</span>
</pre></div>
<p><code>org-emphasis-alist</code> has a <code>:set</code> handler <code>org-set-emph-re</code> which will do the job of setting up the regexps. I don't want to call <code>org-set-emph-re</code> directly, instead I set <code>org-emphasis-alist</code> to itself and let the customize interface call the handler for me.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Allow both single and double quotes in the border.</span>
    (setcar (nthcdr 2 org-emphasis-regexp-components) <span class="org-string">" \t\r\n,"</span>)
    (custom-set-variables `(org-emphasis-alist ',org-emphasis-alist)))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Single character alphabetical bullets (a, b, c, ..., X, Y, Z) are allowed.</span>
  (setq org-list-allow-alphabetical t)
</pre></div>
<p>If you use <code>org-emphasis-alist</code> to do simple highlighting, you should better use <a href="http://www.emacswiki.org/emacs/AddKeywords">font-lock-add-keywords</a>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Libraries that should (always) be loaded along with `</span><span class="org-constant"><span class="org-comment">org.el</span></span><span class="org-comment">'</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(loaded when opening the first Org file).</span>
  (setq org-modules nil)
</pre></div>
<p>Original value was:</p>
<ul class="org-ul">
<li><code>org-bbdb</code></li>
<li><code>org-bibtex</code></li>
<li><code>org-docview</code></li>
<li><code>org-gnus</code></li>
<li><code>org-info</code></li>
<li><code>org-jsinfo</code></li>
<li><code>org-irc</code></li>
<li><code>org-mew</code></li>
<li><code>org-mhe</code></li>
<li><code>org-rmail</code></li>
<li><code>org-vm</code></li>
<li><code>org-w3m</code></li>
<li><code>org-wl</code></li>
</ul>
<p>When you have <code>org-id</code> in <code>org-modules</code>, unique <b>ID's</b> are generated when you link to a task (using <code>org-id-get-create</code>) - instead of links containing <b>headline text</b>.</p>
<p>ID's are saved in <code>~/.emacs.d/.org-id-locations</code> on my system (see <code>org-id-locations-file</code>).</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Set the RESET_CHECK_BOXES and LIST_EXPORT_BASENAME properties in items as</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">needed.</span>
  (add-to-list 'org-modules 'org-checklist) <span class="org-comment-delimiter">; </span><span class="org-comment">From org-contrib.</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Globally unique ID for Org mode entries (see `</span><span class="org-constant"><span class="org-comment">org-store-link</span></span><span class="org-comment">')</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(takes care of automatically creating unique targets for internal</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">links, see `C-h v org-id-link-to-org-use-id &lt;RET&gt;').</span>
  (add-to-list 'org-modules 'org-id)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Support for links to Gnus groups and messages from within Org mode.</span>
  (add-to-list 'org-modules 'org-gnus)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Habit tracking code for Org mode.</span>
  (add-to-list 'org-modules 'org-habit)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Make sure to turn `</span><span class="org-constant"><span class="org-comment">org-info</span></span><span class="org-comment">' on in order to link to info nodes.</span>
  (add-to-list 'org-modules 'org-info)
</pre></div>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Look at other modules</b><br />
<ul class="org-ul">
<li><code>org-eval</code></li>
<li><code>org-eval-light</code></li>
<li><code>org-exp-bibtex</code></li>
<li><code>org-exp-blocks</code> (supported by the new exporter out of the box)</li>
<li><code>org-man</code></li>
<li><code>org-mouse</code></li>
<li><code>org-mtags</code></li>
<li><code>org-panel</code></li>
<li><code>org-R</code></li>
</ul>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (add-hook 'org-mode-hook
            (<span class="org-keyword">lambda</span> ()
              <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Create a binding for `</span><span class="org-constant"><span class="org-comment">org-show-subtree</span></span><span class="org-comment">'.</span>
              <span class="org-comment-delimiter">;; </span><span class="org-comment">(local-set-key (kbd "C-c C-S-s") 'org-show-subtree)</span>
              <span class="org-comment-delimiter">;; </span><span class="org-comment">(local-set-key (kbd "C-c s") 'org-show-subtree)</span>

              <span class="org-comment-delimiter">;; </span><span class="org-comment">(local-set-key (kbd "C-c h") 'hide-other) ; I should use it!!</span>

              <span class="org-comment-delimiter">;; </span><span class="org-comment">Table.</span>
              (local-set-key (kbd <span class="org-string">"C-M-w"</span>) 'org-table-copy-region)
              (local-set-key (kbd <span class="org-string">"C-M-y"</span>) 'org-table-paste-rectangle)

              <span class="org-comment-delimiter">;; </span><span class="org-comment">Remove some bindings.</span>
              (local-unset-key (kbd <span class="org-string">"C-c SPC"</span>)) <span class="org-comment-delimiter">; </span><span class="org-comment">Used by Ace Jump.</span>
              (local-unset-key (kbd <span class="org-string">"C-c C-&lt;"</span>)) <span class="org-comment-delimiter">; </span><span class="org-comment">Used by Multiple Cursors.</span>
              (local-unset-key (kbd <span class="org-string">"C-c *"</span>)) <span class="org-comment-delimiter">; </span><span class="org-comment">Used by Multiple Cursors.</span>
              <span class="org-comment-delimiter">;; </span><span class="org-comment">(local-unset-key (kbd "C-c %")) ; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span>
              <span class="org-comment-delimiter">;; </span><span class="org-comment">(local-unset-key (kbd "C-c &amp;")) ; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span>

              ))
</pre></div>
<div class="note">
<p>See <code>(define-key flyspell-mode-map (kbd "C-;") nil))</code> for an alternative manner of unsetting local keys?</p>
</div>
</div>
<div id="outline-container-orgheadline149" class="outline-4">
<h4 id="orgheadline149">Activation</h4>
<div class="outline-text-4 org-src-container" id="text-orgheadline149">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"... Org Introduction"</span>)

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 1.3 (info "(org)Activation")</span>

    (leuven--section <span class="org-string">"1.3 (org)Activation"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Insert the first line setting Org mode in empty files.</span>
    (setq org-insert-mode-line-in-empty-file t))
</pre></div>
</div>
<div id="outline-container-orgheadline150" class="outline-3">
<h3 id="orgheadline150">Document Structure</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline150">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 2 (info "(org)Document Structure")</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"... Org Document Structure"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Improve display of the ellipsis.</span>
    (set-face-attribute 'org-ellipsis nil
                        <span class="org-builtin">:box</span> '(<span class="org-builtin">:line-width</span> 1 <span class="org-builtin">:color</span> <span class="org-string">"#999999"</span>)
                        <span class="org-builtin">:foreground</span> <span class="org-string">"#999999"</span> <span class="org-builtin">:background</span> <span class="org-string">"#FFF8C0"</span>
                        <span class="org-builtin">:underline</span> nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Ellipsis to use in the Org mode outline.</span>
    (setq org-ellipsis
          (<span class="org-keyword">if</span> (char-displayable-p ?\u25BA) <span class="org-comment-delimiter">; </span><span class="org-comment">This test takes ~ 0.40s hence,</span>
                                           <span class="org-comment-delimiter">; </span><span class="org-comment">wrapped in `</span><span class="org-constant"><span class="org-comment">with-eval-after-load</span></span><span class="org-comment">'.</span>
              <span class="org-string">" \u25BA"</span>                 <span class="org-comment-delimiter">; </span><span class="org-comment">String (black right-pointing pointer) </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment"> #929490</span>
            'org-ellipsis)))            <span class="org-comment-delimiter">; </span><span class="org-comment">Face.</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">&lt;RET&gt; follows links (except in tables, where you must use `C-c C-o').</span>
  (setq org-return-follows-link t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Blank lines.</span>
  (setq org-blank-before-new-entry
        '(<span class="org-comment-delimiter">;; </span><span class="org-comment">Insert  a blank line before new heading.</span>
          (heading . t)

          <span class="org-comment-delimiter">;; </span><span class="org-comment">Try to make an intelligent decision whether to insert a</span>
          <span class="org-comment-delimiter">;; </span><span class="org-comment">blank line or not before a new item.</span>
          (plain-list-item . auto)))
</pre></div>
<div id="outline-container-orgheadline151" class="outline-4">
<h4 id="orgheadline151">Headlines</h4>
<div class="outline-text-4" id="text-orgheadline151">
<p><code>C-e</code> goes <b>right before</b> the end of the invisible region and <code>TAB</code> will unfold as expected, both in a folded subtree or in a folded drawer.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(org)Headlines")</span>

  (leuven--section <span class="org-string">"2.2 (org)Headlines"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; `</span><span class="org-constant"><span class="org-comment">C-a</span></span><span class="org-comment">' and `</span><span class="org-constant"><span class="org-comment">C-e</span></span><span class="org-comment">' behave specially in headlines and items.</span>
  (setq org-special-ctrl-a/e 'reversed)
</pre></div>
<p>The package <code>org-inlinetask.el</code> (for <b>tasks independent of outline hierarchy</b>) installs the key binding <code>C-c C-x t</code> to insert a new <b>inline task</b>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"... Org Headlines"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Insert an inline task (independent of outline hierarchy).</span>
    (try-require 'org-inlinetask))      <span class="org-comment-delimiter">; </span><span class="org-comment">Needed.</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-inlinetask"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Initial state (</span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment"> keyword) of inline tasks.</span>
    (setq org-inlinetask-default-state <span class="org-string">"</span><span class="org-leuven-highlight"><span class="org-string">TODO</span></span><span class="org-string">"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Template for inline tasks in HTML exporter.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(defun leuven--org-html-format-inlinetask</span>
    <span class="org-comment-delimiter">;;     </span><span class="org-comment">(todo todo-type priority text tags contents &amp;optional info)</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">"Format an inline task element for HTML export."</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(let ((todo-kw</span>
    <span class="org-comment-delimiter">;;          </span><span class="org-comment">(if todo</span>
    <span class="org-comment-delimiter">;;              </span><span class="org-comment">(format "&lt;span class=\"%s %s\"&gt;%s&lt;/span&gt; " todo-type todo todo)</span>
    <span class="org-comment-delimiter">;;            </span><span class="org-comment">""))</span>
    <span class="org-comment-delimiter">;;         </span><span class="org-comment">(full-headline-w/o-todo-kw</span>
    <span class="org-comment-delimiter">;;          </span><span class="org-comment">(concat</span>
    <span class="org-comment-delimiter">;;           </span><span class="org-comment">(when priority (format "[#%c] " priority))</span>
    <span class="org-comment-delimiter">;;           </span><span class="org-comment">text</span>
    <span class="org-comment-delimiter">;;           </span><span class="org-comment">(when tags</span>
    <span class="org-comment-delimiter">;;             </span><span class="org-comment">(concat "&amp;nbsp;&amp;nbsp;&amp;nbsp;"</span>
    <span class="org-comment-delimiter">;;                     </span><span class="org-comment">"&lt;span class=\"tag\"&gt;"</span>
    <span class="org-comment-delimiter">;;                     </span><span class="org-comment">(mapconcat (lambda (tag)</span>
    <span class="org-comment-delimiter">;;                                  </span><span class="org-comment">(concat "&lt;span class= \"" tag "\"&gt;" tag</span>
    <span class="org-comment-delimiter">;;                                          </span><span class="org-comment">"&lt;/span&gt;"))</span>
    <span class="org-comment-delimiter">;;                                </span><span class="org-comment">tags</span>
    <span class="org-comment-delimiter">;;                                </span><span class="org-comment">"&amp;nbsp;")</span>
    <span class="org-comment-delimiter">;;                     </span><span class="org-comment">"&lt;/span&gt;")))))</span>
    <span class="org-comment-delimiter">;;     </span><span class="org-comment">(concat "&lt;table class=\"inlinetask\" width=\"100%\"&gt;"</span>
    <span class="org-comment-delimiter">;;               </span><span class="org-comment">"&lt;tr&gt;"</span>
    <span class="org-comment-delimiter">;;                 </span><span class="org-comment">"&lt;td valign=\"top\"&gt;&lt;b&gt;" todo-kw "&lt;/b&gt;&lt;/td&gt;"</span>
    <span class="org-comment-delimiter">;;                 </span><span class="org-comment">"&lt;td width=\"100%\"&gt;&lt;b&gt;" full-headline-w/o-todo-kw "&lt;/b&gt;&lt;br /&gt;"</span>
    <span class="org-comment-delimiter">;;                   </span><span class="org-comment">(or contents "") "&lt;/td&gt;"</span>
    <span class="org-comment-delimiter">;;               </span><span class="org-comment">"&lt;/tr&gt;"</span>
    <span class="org-comment-delimiter">;;             </span><span class="org-comment">"&lt;/table&gt;")))</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Function called to format an inlinetask in HTML code.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-html-format-inlinetask-function</span>
    <span class="org-comment-delimiter">;;       </span><span class="org-comment">'leuven--org-html-format-inlinetask)</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Template for inline tasks in LaTeX exporter.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(defun leuven--org-latex-format-inlinetask</span>
    <span class="org-comment-delimiter">;;     </span><span class="org-comment">(todo todo-type priority text tags contents &amp;optional info)</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">"Format an inline task element for LaTeX export."</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(let* ((tags-string (format ":%s:" (mapconcat 'identity tags ":")))</span>
    <span class="org-comment-delimiter">;;          </span><span class="org-comment">(opt-color</span>
    <span class="org-comment-delimiter">;;           </span><span class="org-comment">(if tags</span>
    <span class="org-comment-delimiter">;;               </span><span class="org-comment">(cond ((string-match ":info:" tags-string)</span>
    <span class="org-comment-delimiter">;;                      </span><span class="org-comment">"color=yellow!40")</span>
    <span class="org-comment-delimiter">;;                     </span><span class="org-comment">((string-match ":warning:" tags-string)</span>
    <span class="org-comment-delimiter">;;                      </span><span class="org-comment">"color=orange!40")</span>
    <span class="org-comment-delimiter">;;                     </span><span class="org-comment">((string-match ":error:" tags-string)</span>
    <span class="org-comment-delimiter">;;                      </span><span class="org-comment">"color=red!40")</span>
    <span class="org-comment-delimiter">;;                     </span><span class="org-comment">(t ""))</span>
    <span class="org-comment-delimiter">;;             </span><span class="org-comment">""))</span>
    <span class="org-comment-delimiter">;;          </span><span class="org-comment">(full-headline</span>
    <span class="org-comment-delimiter">;;           </span><span class="org-comment">(concat</span>
    <span class="org-comment-delimiter">;;            </span><span class="org-comment">(when todo</span>
    <span class="org-comment-delimiter">;;              </span><span class="org-comment">(format "{\\color{red}\\textbf{\\textsf{\\textsc{%s}}}} "</span>
    <span class="org-comment-delimiter">;;                      </span><span class="org-comment">todo))</span>
    <span class="org-comment-delimiter">;;            </span><span class="org-comment">(when priority</span>
    <span class="org-comment-delimiter">;;              </span><span class="org-comment">(format "\\textsf{\\framebox{\\#%c}} " priority))</span>
    <span class="org-comment-delimiter">;;            </span><span class="org-comment">text</span>
    <span class="org-comment-delimiter">;;            </span><span class="org-comment">(when tags</span>
    <span class="org-comment-delimiter">;;              </span><span class="org-comment">(format "\\hfill{}:%s:"</span>
    <span class="org-comment-delimiter">;;                      </span><span class="org-comment">(mapconcat 'identity tags ":")))))</span>
    <span class="org-comment-delimiter">;;          </span><span class="org-comment">(opt-rule</span>
    <span class="org-comment-delimiter">;;           </span><span class="org-comment">(if contents</span>
    <span class="org-comment-delimiter">;;               </span><span class="org-comment">"\\\\ \\rule[.3em]{\\textwidth}{0.2pt}\n"</span>
    <span class="org-comment-delimiter">;;             </span><span class="org-comment">""))</span>
    <span class="org-comment-delimiter">;;          </span><span class="org-comment">(opt-contents</span>
    <span class="org-comment-delimiter">;;           </span><span class="org-comment">(or contents "")))</span>
    <span class="org-comment-delimiter">;;     </span><span class="org-comment">;; This requires the `</span><span class="org-constant"><span class="org-comment">todonotes</span></span><span class="org-comment">' package.</span>
    <span class="org-comment-delimiter">;;     </span><span class="org-comment">(format (concat "\\todo[inline,caption={},%s]{\n"</span>
    <span class="org-comment-delimiter">;;                     </span><span class="org-comment">"  %s\n"</span>
    <span class="org-comment-delimiter">;;                     </span><span class="org-comment">"  %s"</span>
    <span class="org-comment-delimiter">;;                     </span><span class="org-comment">"  %s"</span>
    <span class="org-comment-delimiter">;;                     </span><span class="org-comment">"}")</span>
    <span class="org-comment-delimiter">;;             </span><span class="org-comment">opt-color</span>
    <span class="org-comment-delimiter">;;             </span><span class="org-comment">full-headline</span>
    <span class="org-comment-delimiter">;;             </span><span class="org-comment">opt-rule</span>
    <span class="org-comment-delimiter">;;             </span><span class="org-comment">opt-contents)))</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Function called to format an inlinetask in LaTeX code.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-latex-format-inlinetask-function</span>
    <span class="org-comment-delimiter">;;       </span><span class="org-comment">'leuven--org-latex-format-inlinetask)</span>
    )                                   <span class="org-comment-delimiter">; </span><span class="org-comment">with-eval-after-load "org-inlinetask" ends here</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (setq org-inlinetask-export-templates
        '((latex <span class="org-string">"%s\\footnote{%s\\\\ %s}\\marginpar{\\fbox{\\thefootnote}}"</span>
                 '((<span class="org-keyword">unless</span>
                       (eq todo <span class="org-string">""</span>)
                     (format <span class="org-string">"\\fbox{\\textsc{%s%s}}"</span> todo priority))
                   heading content))))
</pre></div>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Use todonotes</b><br />
<p>Why use footnotes when you can use <code>todonotes</code> (<a href="https://www.ctan.org/pkg/todonotes">https://www.ctan.org/pkg/todonotes</a>)?</p>
<p>It can even make a <code>list-of-todo-notes</code>. See also <a href="http://tex.stackexchange.com/questions/9796/how-to-add-todo-notes">http://tex.stackexchange.com/questions/9796/how-to-add-todo-notes</a> for more options.</p>
</div>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Have a solution for base article, report, book (w/o todonotes)</b><br />
nil</div>
</div>
</div>
<div id="outline-container-orgheadline152" class="outline-4">
<h4 id="orgheadline152">Visibility cycling</h4>
<div class="outline-text-4" id="text-orgheadline152">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(org)Visibility cycling")</span>

  (leuven--section <span class="org-string">"2.3 (org)Visibility cycling"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Do not switch to OVERVIEW at startup.</span>
  (setq org-startup-folded nil)         <span class="org-comment-delimiter">; </span><span class="org-comment">Emacs hangs when editing a 5-line Org</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">file (with Company auto-starting after</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">2 characters and 0 s delay)</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Inhibit startup when preparing agenda buffers -- agenda optimization.</span>
  (setq org-agenda-inhibit-startup t)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (setq w32-pass-apps-to-system nil)
  (setq w32-apps-modifier 'hyper)       <span class="org-comment-delimiter">; </span><span class="org-comment">Apps key.</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Create indirect buffer and narrow it to current subtree.</span>
    (define-key org-mode-map (kbd <span class="org-string">"&lt;H-return&gt;"</span>) 'org-tree-to-indirect-buffer))
</pre></div>
<p>Note that <b>Imenu</b> does display the current <b>Org subtree</b> in the mode line, not the full outline path.</p>
</div>
</div>
<div id="outline-container-orgheadline154" class="outline-4">
<h4 id="orgheadline154">2.4 Motion</h4>
<div class="outline-text-4" id="text-orgheadline154">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(org)Motion")</span>

  (leuven--section <span class="org-string">"2.4 (org)Motion"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Outline-node based navigation similar to the behavior of paredit-mode in</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Lisp files.</span>
  (add-hook 'org-mode-hook
            (<span class="org-keyword">lambda</span> ()
              <span class="org-comment-delimiter">;; </span><span class="org-comment">(local-set-key (kbd "M-n") 'outline-next-visible-heading)</span>
              <span class="org-comment-delimiter">;; </span><span class="org-comment">(local-set-key (kbd "M-p") 'outline-previous-visible-heading)</span>
              <span class="org-comment-delimiter">;;</span>
              (local-set-key (kbd <span class="org-string">"C-M-n"</span>) 'outline-next-visible-heading)
              (local-set-key (kbd <span class="org-string">"C-M-p"</span>) 'outline-previous-visible-heading)
              (local-set-key (kbd <span class="org-string">"C-M-u"</span>) 'outline-up-heading)))
</pre></div>
<p>Move through an Org file like <code>cd</code> on a file system with <code>org-goto</code>: <code>C-c C-j /foo/bar/baz &lt;RET&gt;</code></p>
<p>vs <code>C-u C-c C-j</code></p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Headlines in the current buffer are offered via completion</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(interface also used by the `</span><span class="org-constant"><span class="org-comment">refile</span></span><span class="org-comment">' command).</span>
  (setq org-goto-interface 'outline-path-completion)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-org-reveal</span> (<span class="org-type">&amp;optional</span> all-siblings)
      <span class="org-doc">"Show all siblings of current level.</span>
<span class="org-doc">    `C-u C-c C-r' does the same as default Org mode: show all hidden siblings."</span>
      (interactive <span class="org-string">"P"</span>)
      (<span class="org-keyword">if</span> all-siblings
          (org-reveal t)
        (org-show-siblings)))

    (define-key org-mode-map (kbd <span class="org-string">"C-c C-r"</span>) 'leuven-org-reveal))
</pre></div>
<p>See also <a href="#orgheadline153">Sparse trees</a> for behavior when revealing a location.</p>
</div>
</div>
<div id="outline-container-orgheadline155" class="outline-4">
<h4 id="orgheadline155">Structure editing</h4>
<div class="outline-text-4 org-src-container" id="text-orgheadline155">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(org)Structure editing")</span>

  (leuven--section <span class="org-string">"2.5 (org)Structure editing"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't adapt indentation to outline node level.</span>
  (setq org-adapt-indentation nil)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; </span><span class="org-leuven-highlight"><span class="org-comment">FIXME</span></span><span class="org-comment"> Choose the right value!</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-M-RET-may-split-line nil)</span>
</pre></div>
</div>
<div id="outline-container-orgheadline153" class="outline-4">
<h4 id="orgheadline153"><a id="ID-a9fe61b7-cdbd-478e-a4af-da9e122fb2d9" name="ID-a9fe61b7-cdbd-478e-a4af-da9e122fb2d9"></a>Sparse trees</h4>
<div class="outline-text-4" id="text-orgheadline153">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(org)Sparse trees")</span>

  (leuven--section <span class="org-string">"2.6 (org)Sparse trees"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Show full hierarchy when revealing a location.</span>
    (setq org-show-hierarchy-above t)     <span class="org-comment-delimiter">; </span><span class="org-comment">OBSOLETE</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't show following heading when revealing a location.</span>
    (setq org-show-following-heading nil) <span class="org-comment-delimiter">; </span><span class="org-comment">OBSOLETE</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't show all sibling headings when revealing a location.</span>
    (setq org-show-siblings nil)          <span class="org-comment-delimiter">; </span><span class="org-comment">OBSOLETE</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Show the entry below a headline when revealing a location.</span>
    (setq org-show-entry-below t)         <span class="org-comment-delimiter">; </span><span class="org-comment">OBSOLETE</span>
    (setq org-show-entry-below '((org-goto . t)))
</pre></div>
<p>If you're using development version, see <code>org-show-context-detail</code> instead:</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (<span class="org-keyword">when</span> (boundp 'org-show-context-detail)
      (add-to-list 'org-show-context-detail '(tags-tree . minimal))
      (add-to-list 'org-show-context-detail '(occur-tree . minimal))))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline156" class="outline-4">
<h4 id="orgheadline156">Plain lists</h4>
<div class="outline-text-4" id="text-orgheadline156">
<p>An empty line does not end all plain list levels: if you need to separate consecutive lists with blank lines, always use two of them.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(org)Plain lists")</span>

  (leuven--section <span class="org-string">"2.7 (org)Plain lists"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Maximum indentation for the second line of a description list.</span>
  (setq org-description-max-indent 3)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't make tab cycle visibility on plain list items.</span>
  (setq org-cycle-include-plain-lists nil) <span class="org-comment-delimiter">;; </span><span class="org-comment">'integrate?</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline157" class="outline-4">
<h4 id="orgheadline157">Footnotes </h4>
<div class="outline-text-4 org-src-container" id="text-orgheadline157">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(org)Footnotes")</span>

  (leuven--section <span class="org-string">"2.10 (org)Footnotes"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Use `C-c C-x f' to add a footnote, to go back to the message</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">*and* to go to a footnote.</span>
  (global-set-key (kbd <span class="org-string">"C-c C-x f"</span>) 'org-footnote-action)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline158" class="outline-3">
<h3 id="orgheadline158">Tables</h3>
<div class="outline-text-3" id="text-orgheadline158">
<p>See <a href="http://orgmode.org/worg/org-tutorials/org-spreadsheet-intro.html">Org as a spreadsheet system: a short introduction</a>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 3 (info "(org)Tables")</span>

  (setq org-table-use-standard-references 'from)

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 3.1 The (info "(org)Built-in table editor")</span>

  (leuven--section <span class="org-string">"3.1 The (org)Built-in table editor"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Default export parameters for `</span><span class="org-constant"><span class="org-comment">org-table-export</span></span><span class="org-comment">'.</span>
  (setq org-table-export-default-format <span class="org-string">"orgtbl-to-csv"</span>)

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 3.5 (info "(org)The spreadsheet")</span>

  (leuven--section <span class="org-string">"3.5 (org)The spreadsheet"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-table"</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Some Calc mode settings for use in `</span><span class="org-constant"><span class="org-comment">calc-eval</span></span><span class="org-comment">' for table formulas.</span>
    (setcar (cdr (memq 'calc-float-format org-calc-default-modes))
            '(float 12)))               <span class="org-comment-delimiter">; </span><span class="org-comment">[Default: 8]</span>
</pre></div>
<p>To <b>update all tables</b> in a file, use <code>org-table-recalculate-buffer-tables</code> if the dependencies are only backwards.</p>
<p>If you have dependencies in both directions, to iterate all tables in a file, in order to converge table-to-table dependencies, use <code>org-table-iterate-buffer-tables</code>.</p>
</div>
</div>
<div id="outline-container-orgheadline159" class="outline-3">
<h3 id="orgheadline159">Hyperlinks</h3>
<div class="outline-text-3" id="text-orgheadline159">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 4 (info "(org)Hyperlinks")</span>
</pre></div>
<p>If you insert a <a href="http:///">http:///</a> link containing equal signs (such as <a href="http://test/test?name=me">http://test/test?name=me</a>), the verbatim link being inserted in the Org document has the equal signs escaped, unless you have:</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't hexify URL when creating a link.</span>
  (setq org-url-hexify-p nil)
</pre></div>
</div>
<div id="outline-container-orgheadline160" class="outline-4">
<h4 id="orgheadline160">External links</h4>
<div class="outline-text-4" id="text-orgheadline160">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"... Hyperlinks"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Open non-existing files.</span>
    (setq org-open-non-existing-files t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Function and arguments to call for following `</span><span class="org-constant"><span class="org-comment">mailto</span></span><span class="org-comment">' links.</span>
    (setq org-link-mailto-program '(compose-mail <span class="org-string">"%a"</span> <span class="org-string">"%s"</span>)))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Support for links to Gnus groups and messages from within Org mode.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-gnus"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Create web links to Google groups or Gmane (instead of Gnus messages).</span>
    (setq org-gnus-prefer-web-links t))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline161" class="outline-4">
<h4 id="orgheadline161">Handling links</h4>
<div class="outline-text-4" id="text-orgheadline161">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Global identifiers for Org-mode entries.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-id"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Storing a link to an Org file will use entry IDs.</span>
    (setq org-id-link-to-org-use-id
          'create-if-interactive-and-no-custom-id))
</pre></div>
<p>PDF viewer? See <code>org-file-apps</code>. Just change to your favorite viewer. And make sure that you're calling <code>org-return</code> to open (it's bound to <code>C-m</code>).</p>
<p>If I inline an image in an Org file, I can toggle its display with <code>C-c C-x C-v</code> and resize it to a specific width.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"... Handling links"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">4.4 Show inline images when loading a new Org file.</span>
    (setq org-startup-with-inline-images t) <span class="org-comment-delimiter">; </span><span class="org-comment">Invokes org-display-inline-images.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">4.4 Try to get the width from an #+ATTR.* keyword and fall back on 320px</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">width if none is found.</span>
    (setq org-image-actual-width '(320))
</pre></div>
<p>Search for backlinks:</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-org-search-backlinks</span> ()
      <span class="org-doc">"Show all entries that point to the current node.  Also show the current</span>
<span class="org-doc">    node itself.</span>

<span class="org-doc">    This makes ID links quasi-bidirectional."</span>
      (interactive)
      (<span class="org-keyword">let</span> ((org-agenda-files
             (add-to-list 'org-agenda-files (buffer-file-name))))
        (org-search-view nil (org-entry-get nil <span class="org-string">"ID"</span> t))))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline162" class="outline-4">
<h4 id="orgheadline162">Link abbreviations</h4>
<div class="outline-text-4" id="text-orgheadline162">
<p>Link abbreviations provide a quick way of linking to resources that are frequently referenced, so that you can type just the key term instead of the complete URL.</p>
<p>Here is an example: every time you need to use <a href="http://www.google.com/search?q=searchterms">http://www.google.com/search?q=searchterms</a>, you can just type <code>[[google:searchterms]]</code> or <code>[[google:searchterms][description]]</code> instead.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Shortcut links.</span>
    (setq org-link-abbrev-alist
          '((<span class="org-string">"cache"</span> .
             <span class="org-string">"http://www.google.com/search?q=cache:%s"</span>)
            (<span class="org-string">"dictionary"</span> .
             <span class="org-string">"http://www.dict.org/bin/Dict?Database=*&amp;Form=Dict1&amp;Strategy=*&amp;Query=%s"</span>)
            (<span class="org-string">"google"</span> .
             <span class="org-string">"http://www.google.com/search?q=%s"</span>)
            (<span class="org-string">"googlegroups"</span> .
             <span class="org-string">"http://groups.google.com/groups?q=%s"</span>)
            (<span class="org-string">"googlemaps"</span> .
             <span class="org-string">"http://maps.google.com/maps?q=%s"</span>)
            (<span class="org-string">"imdb"</span> .
             <span class="org-string">"http://us.imdb.com/Title?%s"</span>)
            (<span class="org-string">"openstreetmap"</span> .
             <span class="org-string">"http://nominatim.openstreetmap.org/search?q=%s&amp;polygon=1"</span>)
            (<span class="org-string">"wpen"</span> .
             <span class="org-string">"http://en.wikipedia.org/wiki/%s"</span>)
            (<span class="org-string">"wpfr"</span> .
             <span class="org-string">"http://fr.wikipedia.org/wiki/%s"</span>))))
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline163" class="outline-3">
<h3 id="orgheadline163">"TODO" Items</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline163">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 5 (info "(org)</span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment"> Items")</span>
</pre></div>
<div id="outline-container-orgheadline164" class="outline-4">
<h4 id="orgheadline164">Basic TODO functionality</h4>
<div class="outline-text-4 org-src-container" id="text-orgheadline164">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 5.1 (info "(org)</span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment"> basics") functionality</span>

  (leuven--section <span class="org-string">"5.1 (org)</span><span class="org-leuven-highlight"><span class="org-string">TODO</span></span><span class="org-string"> basics functionality"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">5.1 Select a </span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment"> state and bypass any logging associated with that.</span>
  (setq org-treat-S-cursor-todo-selection-as-state-change nil)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Some commands act upon headlines in the active region.</span>
  (setq org-loop-over-headlines-in-active-region 'start-level)
</pre></div>
</div>
<div id="outline-container-orgheadline165" class="outline-4">
<h4 id="orgheadline165">Extended use of TODO keywords</h4>
<div class="outline-text-4" id="text-orgheadline165">
<p>We use statuses to <b>create a workflow</b> for tasks.</p>
<p>The statuses we use are a simple as possible to work well in the context of work.</p>
<p>We use the following 4-letter status keywords:</p>
<dl class="org-dl">
<dt><code>TODO</code></dt>
<dd>Approved task, to be done.</dd>
<dt><code>STRT</code></dt>
<dd>Some progress has already been done on the task.</dd>
<dt><code>WAIT</code></dt>
<dd>Task delegated to someone else. Or waiting for some external event to be able to work on the task.</dd>
<dt><code>SDAY</code></dt>
<dd>Task to be approved (and eventually done) in the future.</dd>
<dt><code>DONE</code></dt>
<dd>Task is completed.</dd>
<dt><code>CANX</code></dt>
<dd>Task is declined (but kept documented, instead of being deleted).</dd>
</dl>
<p>There is just 1 exception (made on purpose) to the 4-letter scheme:</p>
<dl class="org-dl">
<dt><code>NEW</code></dt>
<dd>Proposed task, idea or wish, <b>not approved yet</b>. Draft.</dd>
</dl>
<p>One could add a <code>CLSD</code> or <code>VRFD</code> state for bug fixes, for example, which need to be verified before really closing the task.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 5.2 Use of (info "(org)</span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment"> extensions")</span>

  (leuven--section <span class="org-string">"5.2 Use of (org)</span><span class="org-leuven-highlight"><span class="org-string">TODO</span></span><span class="org-string"> extensions"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">List of </span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment"> entry keyword sequences (+ fast access keys and specifiers</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">for state change logging).</span>
  (setq org-todo-keywords
        '((sequence <span class="org-string">"NEW(n!)"</span>           <span class="org-comment-delimiter">; </span><span class="org-comment">proposal, idea (under review)</span>
                    <span class="org-string">"</span><span class="org-leuven-highlight"><span class="org-string">TODO</span></span><span class="org-string">(t!)"</span>          <span class="org-comment-delimiter">; </span><span class="org-comment">open, not (yet) started</span>
                    <span class="org-string">"STRT(s!)"</span>          <span class="org-comment-delimiter">; </span><span class="org-comment">in progress, working on, doing</span>
                    <span class="org-string">"WAIT(w!)"</span>          <span class="org-comment-delimiter">; </span><span class="org-comment">on hold, assigned, feedback</span>
                    <span class="org-string">"SDAY(y!)"</span>          <span class="org-comment-delimiter">; </span><span class="org-comment">someday, maybe, perhaps, wish</span>
                    <span class="org-string">"|"</span>
                    <span class="org-string">"DONE(d!)"</span>          <span class="org-comment-delimiter">; </span><span class="org-comment">completed, closed, resolved</span>
                    <span class="org-string">"CANX(x!)"</span>)         <span class="org-comment-delimiter">; </span><span class="org-comment">wontfix, rejected</span>

          (sequence <span class="org-string">"QTE(q!)"</span>           <span class="org-comment-delimiter">; </span><span class="org-comment">planning</span>
                    <span class="org-string">"QTD(Q!)"</span>           <span class="org-comment-delimiter">; </span><span class="org-comment">awaiting approval</span>
                    <span class="org-string">"|"</span>
                    <span class="org-string">"APP(A!)"</span>           <span class="org-comment-delimiter">; </span><span class="org-comment">approved</span>
                    <span class="org-string">"REJ(R!)"</span>)          <span class="org-comment-delimiter">; </span><span class="org-comment">rejected</span>

          (sequence <span class="org-string">"OPENPO(O!)"</span>
                    <span class="org-string">"|"</span>
                    <span class="org-string">"CLSDPO(C!)"</span>)))
</pre></div>
<p><code>SDAY</code> is <b>not</b> a completion state (in order not to be struck through).</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-faces"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Faces for specific </span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment"> keywords.</span>
    (setq org-todo-keyword-faces
          '((<span class="org-string">"NEW"</span>  . leuven-org-created-kwd)
            (<span class="org-string">"</span><span class="org-leuven-highlight"><span class="org-string">TODO</span></span><span class="org-string">"</span> . org-todo)
            (<span class="org-string">"STRT"</span> . leuven-org-in-progress-kwd)
            (<span class="org-string">"WAIT"</span> . leuven-org-waiting-for-kwd)
            (<span class="org-string">"SDAY"</span> . leuven-org-someday-kwd)
            (<span class="org-string">"DONE"</span> . org-done)
            (<span class="org-string">"CANX"</span> . org-done)

            (<span class="org-string">"QTE"</span> . leuven-org-quote-kwd)
            (<span class="org-string">"QTD"</span> . leuven-org-quoted-kwd)
            (<span class="org-string">"APP"</span> . leuven-org-approved-kwd)
            (<span class="org-string">"REJ"</span> . leuven-org-rejected-kwd)

            (<span class="org-string">"OPENPO"</span> . leuven-org-openpo-kwd)
            (<span class="org-string">"CLSDPO"</span> . leuven-org-closedpo-kwd)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Org standard faces.</span>
    (set-face-attribute 'org-todo nil
                        <span class="org-builtin">:weight</span> 'bold <span class="org-builtin">:box</span> '(<span class="org-builtin">:line-width</span> 1 <span class="org-builtin">:color</span> <span class="org-string">"#D8ABA7"</span>)
                        <span class="org-builtin">:foreground</span> <span class="org-string">"#D8ABA7"</span> <span class="org-builtin">:background</span> <span class="org-string">"#FFE6E4"</span>)

    (set-face-attribute 'org-done nil
                        <span class="org-builtin">:weight</span> 'bold <span class="org-builtin">:box</span> '(<span class="org-builtin">:line-width</span> 1 <span class="org-builtin">:color</span> <span class="org-string">"#BBBBBB"</span>)
                        <span class="org-builtin">:foreground</span> <span class="org-string">"#BBBBBB"</span> <span class="org-builtin">:background</span> <span class="org-string">"#F0F0F0"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Org non-standard faces.</span>
    (<span class="org-keyword">defface</span> <span class="org-variable-name">leuven-org-created-kwd</span>
      '((t (<span class="org-builtin">:weight</span> normal <span class="org-builtin">:box</span> (<span class="org-builtin">:line-width</span> 1 <span class="org-builtin">:color</span> <span class="org-string">"#EEE9C3"</span>)
            <span class="org-builtin">:foreground</span> <span class="org-string">"#1A1A1A"</span> <span class="org-builtin">:background</span> <span class="org-string">"#FDFCD8"</span>)))
      <span class="org-doc">"Face used to display state NEW."</span>)
    (<span class="org-keyword">defface</span> <span class="org-variable-name">leuven-org-in-progress-kwd</span>
      '((t (<span class="org-builtin">:weight</span> bold <span class="org-builtin">:box</span> (<span class="org-builtin">:line-width</span> 1 <span class="org-builtin">:color</span> <span class="org-string">"#D9D14A"</span>)
            <span class="org-builtin">:foreground</span> <span class="org-string">"#D9D14A"</span> <span class="org-builtin">:background</span> <span class="org-string">"#FCFCDC"</span>)))
      <span class="org-doc">"Face used to display state STRT."</span>)
    (<span class="org-keyword">defface</span> <span class="org-variable-name">leuven-org-waiting-for-kwd</span>
      '((t (<span class="org-builtin">:weight</span> bold <span class="org-builtin">:box</span> (<span class="org-builtin">:line-width</span> 1 <span class="org-builtin">:color</span> <span class="org-string">"#89C58F"</span>)
            <span class="org-builtin">:foreground</span> <span class="org-string">"#89C58F"</span> <span class="org-builtin">:background</span> <span class="org-string">"#E2FEDE"</span>)))
      <span class="org-doc">"Face used to display state WAIT."</span>)
    (<span class="org-keyword">defface</span> <span class="org-variable-name">leuven-org-someday-kwd</span>
      '((t (<span class="org-builtin">:weight</span> bold <span class="org-builtin">:box</span> (<span class="org-builtin">:line-width</span> 1 <span class="org-builtin">:color</span> <span class="org-string">"#9EB6D4"</span>)
            <span class="org-builtin">:foreground</span> <span class="org-string">"#9EB6D4"</span> <span class="org-builtin">:background</span> <span class="org-string">"#E0EFFF"</span>)))
      <span class="org-doc">"Face used to display state SDAY."</span>)

    (<span class="org-keyword">defface</span> <span class="org-variable-name">leuven-org-quote-kwd</span>
      '((t (<span class="org-builtin">:weight</span> bold <span class="org-builtin">:box</span> (<span class="org-builtin">:line-width</span> 1 <span class="org-builtin">:color</span> <span class="org-string">"#FC5158"</span>)
            <span class="org-builtin">:foreground</span> <span class="org-string">"#FC5158"</span> <span class="org-builtin">:background</span> <span class="org-string">"#FED5D7"</span>)))
      <span class="org-doc">"Face used to display ."</span>)
    (<span class="org-keyword">defface</span> <span class="org-variable-name">leuven-org-quoted-kwd</span>
      '((t (<span class="org-builtin">:weight</span> bold <span class="org-builtin">:box</span> (<span class="org-builtin">:line-width</span> 1 <span class="org-builtin">:color</span> <span class="org-string">"#55BA80"</span>)
            <span class="org-builtin">:foreground</span> <span class="org-string">"#55BA80"</span> <span class="org-builtin">:background</span> <span class="org-string">"#DFFFDF"</span>)))
      <span class="org-doc">"Face used to display ."</span>)
    (<span class="org-keyword">defface</span> <span class="org-variable-name">leuven-org-approved-kwd</span>
      '((t (<span class="org-builtin">:weight</span> bold <span class="org-builtin">:box</span> (<span class="org-builtin">:line-width</span> 1 <span class="org-builtin">:color</span> <span class="org-string">"#969696"</span>)
            <span class="org-builtin">:foreground</span> <span class="org-string">"#969696"</span> <span class="org-builtin">:background</span> <span class="org-string">"#F2F2EE"</span>)))
      <span class="org-doc">"Face used to display ."</span>)
    (<span class="org-keyword">defface</span> <span class="org-variable-name">leuven-org-rejected-kwd</span>
      '((t (<span class="org-builtin">:weight</span> bold <span class="org-builtin">:box</span> (<span class="org-builtin">:line-width</span> 1 <span class="org-builtin">:color</span> <span class="org-string">"#42B5FF"</span>)
            <span class="org-builtin">:foreground</span> <span class="org-string">"#42B5FF"</span> <span class="org-builtin">:background</span> <span class="org-string">"#D3EEFF"</span>)))
      <span class="org-doc">"Face used to display state REJECTED."</span>)

    (<span class="org-keyword">defface</span> <span class="org-variable-name">leuven-org-openpo-kwd</span>
      '((t (<span class="org-builtin">:weight</span> bold <span class="org-builtin">:box</span> (<span class="org-builtin">:line-width</span> 1 <span class="org-builtin">:color</span> <span class="org-string">"#FC5158"</span>)
            <span class="org-builtin">:foreground</span> <span class="org-string">"#FC5158"</span> <span class="org-builtin">:background</span> <span class="org-string">"#FED5D7"</span>)))
      <span class="org-doc">"Face used to display OPEN purchase order."</span>)
    (<span class="org-keyword">defface</span> <span class="org-variable-name">leuven-org-closedpo-kwd</span>
      '((t (<span class="org-builtin">:weight</span> bold <span class="org-builtin">:box</span> (<span class="org-builtin">:line-width</span> 1 <span class="org-builtin">:color</span> <span class="org-string">"#969696"</span>)
            <span class="org-builtin">:foreground</span> <span class="org-string">"#969696"</span> <span class="org-builtin">:background</span> <span class="org-string">"#F2F2EE"</span>)))
      <span class="org-doc">"Face used to display CLOSED purchase order."</span>))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Block switching entries to DONE if</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">1) there are undone child entries, or</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">2) the parent has an `</span><span class="org-constant"><span class="org-comment">:ORDERED:</span></span><span class="org-comment">' property and there are prior</span>
  <span class="org-comment-delimiter">;;    </span><span class="org-comment">siblings not yet done.</span>
  (setq org-enforce-todo-dependencies t)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">5.2.7 Don't dim blocked tasks in the agenda display -- agenda optimization.</span>
  (setq org-agenda-dim-blocked-tasks nil) <span class="org-comment-delimiter">; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment"> not sure about this one</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Block switching the parent to DONE if there are unchecked checkboxes.</span>
  (setq org-enforce-todo-checkbox-dependencies t)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline166" class="outline-4">
<h4 id="orgheadline166">Progress logging</h4>
<div class="outline-text-4" id="text-orgheadline166">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 5.3 (info "(org)Progress logging")</span>

  (leuven--section <span class="org-string">"5.3 (org)Progress logging"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; 5.3.1 Don't insert a CLOSED time stamp each time a </span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment"> entry is marked DONE.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-log-done nil)</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">5.3.2 The notes will be ordered according to time.</span>
  (setq org-log-states-order-reversed nil)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">5.3.2 Insert state change notes and time stamps into a LOGBOOK drawer.</span>
  (setq org-log-into-drawer t)          <span class="org-comment-delimiter">; </span><span class="org-comment">should be the DEFAULT!</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">~5.3.2 Heading for state change added to entries.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"... Progress logging"</span>)

    (setcdr (assq 'state org-log-note-headings)
            <span class="org-string">"State %-12S  -&gt;  %-12s %t"</span>)) <span class="org-comment-delimiter">; </span><span class="org-comment">"State old -&gt; new + timestamp".</span>
</pre></div>
<p>Warning! The docstring of <code>org-log-note-headings</code> mentions that "in fact, it is <b>not a good idea to change the `state' entry</b>, because agenda log mode depends on the format of these entries."</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-habit"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Show habits for future days.</span>
    (setq org-habit-show-habits-only-for-today nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Use character "heavy check mark" to show completed days on which a task</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">was done.</span>
    (setq org-habit-completed-glyph ?\u2714)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Use character "heavy quadruple dash vertical" to identify today.</span>
    (setq org-habit-today-glyph ?\u250B))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline167" class="outline-4">
<h4 id="orgheadline167">Breaking down tasks</h4>
<div class="outline-text-4 org-src-container" id="text-orgheadline167">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 5.5 (info "(org)Breaking down tasks")</span>

  (leuven--section <span class="org-string">"5.5 (org)Breaking down tasks"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Automatically change a </span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment"> entry to DONE when all children are done.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--org-summary-todo</span> (n-done n-not-done)
    <span class="org-doc">"Switch entry to DONE when all subentries are done, to </span><span class="org-leuven-highlight"><span class="org-doc">TODO</span></span><span class="org-doc"> otherwise."</span>
    (<span class="org-keyword">let</span> (org-log-done org-log-states)  <span class="org-comment-delimiter">; </span><span class="org-comment">turn off logging</span>
      (org-todo (<span class="org-keyword">if</span> (= n-not-done 0) <span class="org-string">"DONE"</span> <span class="org-string">"</span><span class="org-leuven-highlight"><span class="org-string">TODO</span></span><span class="org-string">"</span>))))

  (add-hook 'org-after-todo-statistics-hook 'leuven--org-summary-todo)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline168" class="outline-3">
<h3 id="orgheadline168">Tags</h3>
<div class="outline-text-3" id="text-orgheadline168">
<p>Context (place, time or particular resources for doing a task) and people are something best implemented with tags.</p>
<p>By convention, <b>user-defined tags are written in lowercase</b>; built-in tags with special meaning are written with all capitals.</p>
<p><code>org-use-tag-inheritance</code> can be setup to a regular expression, for example so that all tags starting with <code>@</code> or <code>#</code> will be excluded from inheritance with:</p>
<pre class="example">
(setq org-use-tag-inheritance "^[^@#]")
</pre>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 6 (info "(org)Tags")</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Column to which tags should be indented in a headline.</span>
  (setq org-tags-column -80)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">6.2 List of tags ("contexts") allowed in Org mode files.</span>
  (setq org-tag-alist '((<span class="org-builtin">:startgroup</span> . nil)
                         (<span class="org-string">"personal"</span>  . ?p)
                         (<span class="org-string">"work"</span>      . ?w)
                        (<span class="org-builtin">:endgroup</span> . nil)
                        (<span class="org-string">"call"</span>        . ?c)
                        (<span class="org-string">"errands"</span>     . ?e)
                        (<span class="org-string">"finance"</span>     . ?f)
                        (<span class="org-string">"mail"</span>        . ?m)

                        (<span class="org-string">"notbillable"</span> . ?B)
                        <span class="org-comment-delimiter">;; </span><span class="org-comment">("reading" . ?r)</span>
                        <span class="org-comment-delimiter">;; </span><span class="org-comment">("proj" . ?P)</span>

                        (<span class="org-string">"ARCHIVE"</span>     . ?a) <span class="org-comment-delimiter">; </span><span class="org-comment">speed command + action in task list</span>
                        (<span class="org-string">"crypt"</span>       . ?C)
                        (<span class="org-string">"FLAGGED"</span>     . ??) <span class="org-comment-delimiter">; </span><span class="org-comment">= ASAP</span>
                        ))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Faces for specific tags.</span>
  (setq org-tag-faces
        '((<span class="org-string">"refile"</span>
           (<span class="org-builtin">:slant</span> italic
            <span class="org-builtin">:foreground</span> <span class="org-string">"#A9876E"</span>))     <span class="org-comment-delimiter">; </span><span class="org-comment">:background "#FCEEB3"</span>
          (<span class="org-string">"personal"</span>
           (<span class="org-builtin">:slant</span> italic
            <span class="org-builtin">:foreground</span> <span class="org-string">"#5C88D3"</span>))     <span class="org-comment-delimiter">; </span><span class="org-comment">:background "#BBDDFF"</span>
          (<span class="org-string">"work"</span>
           (<span class="org-builtin">:slant</span> italic
            <span class="org-builtin">:foreground</span> <span class="org-string">"#699761"</span>))     <span class="org-comment-delimiter">; </span><span class="org-comment">:background "#C1D996"</span>
          (<span class="org-string">"FLAGGED"</span>
           (<span class="org-builtin">:weight</span> bold <span class="org-builtin">:slant</span> italic
            <span class="org-builtin">:foreground</span> <span class="org-string">"white"</span> <span class="org-builtin">:background</span> <span class="org-string">"#DB2D27"</span>)) <span class="org-comment-delimiter">; </span><span class="org-comment">:background "#EDC6C8"</span>
          (<span class="org-string">"now"</span>
           (<span class="org-builtin">:slant</span> italic
            <span class="org-builtin">:foreground</span> <span class="org-string">"#000000"</span>))     <span class="org-comment-delimiter">; </span><span class="org-comment">:background "#FFEA80"</span>
          (<span class="org-string">"notbillable"</span>
           (<span class="org-builtin">:slant</span> italic
            <span class="org-builtin">:foreground</span> <span class="org-string">"#8774AF"</span>))     <span class="org-comment-delimiter">; </span><span class="org-comment">:background "#DED0EA"</span>
          ))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">6.2 Exit fast tag selection after first change (toggle this with `</span><span class="org-constant"><span class="org-comment">C-c</span></span><span class="org-comment">').</span>
  (setq org-fast-tag-selection-single-key t)
</pre></div>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Extend the following function to take <code>filetags</code> into account</b><br />
nil</div>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Check whether this function removes tags of DIRECT parent</b><br />
nil</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Remove redundant tags of headlines (from David Maus).</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-org-remove-redundant-tags</span> ()
    <span class="org-doc">"Remove redundant tags of headlines in current buffer.</span>
<span class="org-doc">  A tag is considered redundant if it is local to a headline and inherited by</span>
<span class="org-doc">  a parent headline."</span>
    (interactive)
    (<span class="org-keyword">when</span> (derived-mode-p 'org-mode)
      (<span class="org-keyword">save-excursion</span>
        (org-map-entries
         (<span class="org-keyword">lambda</span> ()
           (<span class="org-keyword">let</span> ((alltags (split-string
                           (or (org-entry-get (point) <span class="org-string">"ALLTAGS"</span>) <span class="org-string">""</span>)
                           <span class="org-string">":"</span>))
                 local inherited tag)
             (<span class="org-keyword">dolist</span> (tag alltags)
               (<span class="org-keyword">if</span> (get-text-property 0 'inherited tag)
                   (push tag inherited)
                 (push tag local)))
             (<span class="org-keyword">dolist</span> (tag local)
               (<span class="org-keyword">when</span> (member tag inherited)
                 (org-toggle-tag tag 'off)))))
         t nil))))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Always offer completion for all tags of all agenda files.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-complete-tags-always-offer-all-agenda-tags t)</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline169" class="outline-3">
<h3 id="orgheadline169">Properties and Columns</h3>
<div class="outline-text-3" id="text-orgheadline169">
<p>By convention, <b>user-defined properties are capitalized</b>; built-in properties with special meaning are written with all capitals.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 7 (info "(org)Properties and Columns")</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 7.1 (info "(org)Property syntax")</span>

  (leuven--section <span class="org-string">"7.1 (org)Property syntax"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">List of property/value pairs that can be inherited by any entry.</span>
  (setq org-global-properties
        '((<span class="org-string">"Effort_ALL"</span> .
           <span class="org-string">"0 0:10 0:30 1:00 2:00 3:00 4:00 5:00 6:00 8:00"</span>
           <span class="org-comment-delimiter">;; </span><span class="org-comment">"0d 1d 2d 3d 4d 5d 6d 7d 8d 10d"</span>
           <span class="org-comment-delimiter">;; </span><span class="org-comment">"0 1:00 4:00 1d 2d 1w 2w"</span>
           )))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline170" class="outline-3">
<h3 id="orgheadline170">Dates and Times</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline170">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 8 (info "(org)Dates and Times")</span>

  (leuven--section <span class="org-string">"8 (org)Dates and Times"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Insinuate appt if Org mode is loaded.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"... Org Dates and Times"</span>)

    (try-require 'appt))
</pre></div>
<div id="outline-container-orgheadline171" class="outline-4">
<h4 id="orgheadline171">Creating time stamps</h4>
<div class="outline-text-4 org-src-container" id="text-orgheadline171">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 8.2 (info "(org)Creating timestamps")</span>

  (leuven--section <span class="org-string">"8.2 (org)Creating time stamps"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Prefer the future for incomplete dates.</span>
  (setq org-read-date-prefer-future 'time)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Advise `</span><span class="org-constant"><span class="org-comment">org-read-date</span></span><span class="org-comment">' to bury the calendar buffer after selecting a date,</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; so it is out of the way.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(defadvice org-read-date</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(after leuven-bury-calendar-after-org-read-date</span>
  <span class="org-comment-delimiter">;;          </span><span class="org-comment">(&amp;optional with-time to-time from-string prompt</span>
  <span class="org-comment-delimiter">;;          </span><span class="org-comment">default-time default-input) protect)</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">"Bury the *Calendar* buffer after reading a date."</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(bury-buffer "*Calendar*"))</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(ad-activate 'org-read-date)</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Number of minutes to round time stamps to.</span>
  (setq org-time-stamp-rounding-minutes '(1 1))
</pre></div>
</div>
<div id="outline-container-orgheadline172" class="outline-4">
<h4 id="orgheadline172">Deadlines and scheduling</h4>
<div class="outline-text-4" id="text-orgheadline172">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 8.3 (info "(org)Deadlines and scheduling")</span>

  (leuven--section <span class="org-string">"8.3 (org)Deadlines and scheduling"</span>)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Information to record when the scheduling date is modified.</span>
  (setq org-log-reschedule nil)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Information to record when the deadline date is modified.</span>
  (setq org-log-redeadline 'time)
</pre></div>
</div>
<div id="outline-container-orgheadline173" class="outline-5">
<h5 id="orgheadline173">Inserting deadline/schedule</h5>
<div class="outline-text-5" id="text-orgheadline173">
<p>Schedule it with <code>C-c C-s</code>:</p>
<dl class="org-dl">
<dt><code>RET</code></dt>
<dd>Today.</dd>
<dt><code>+1d RET</code></dt>
<dd>Tomorrow.</dd>
<dt><code>+1w RET</code></dt>
<dd>Next week.</dd>
<dt><code>+4w RET</code></dt>
<dd>Next "month".</dd>
</dl>
<p>Remove scheduling date with <code>C-u C-c C-s</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Number of days before expiration during which a deadline becomes active.</span>
  (setq org-deadline-warning-days 7)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Skip deadline prewarning (up to 7 days before the actual deadline) when</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">entry is also scheduled.</span>
  (setq org-agenda-skip-deadline-prewarning-if-scheduled 7)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't show deadlines when the corresponding item is done.</span>
  (setq org-agenda-skip-deadline-if-done t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Skip scheduling line if same entry shows because of deadline.</span>
  (setq org-agenda-skip-scheduled-if-deadline-is-shown t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't show scheduled items in agenda when they are done.</span>
  (setq org-agenda-skip-scheduled-if-done t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">~8.3 Don't select item by time stamp or -range if it is DONE.</span>
  (setq org-agenda-skip-timestamp-if-done t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Show all days between the first and the last date.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-timeline-show-empty-dates t)</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline174" class="outline-5">
<h5 id="orgheadline174">Repeated tasks</h5>
<div class="outline-text-5 org-src-container" id="text-orgheadline174">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment"> state to which a repeater should return the repeating task.</span>
  (setq org-todo-repeat-to-state <span class="org-string">"</span><span class="org-leuven-highlight"><span class="org-string">TODO</span></span><span class="org-string">"</span>)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline175" class="outline-4">
<h4 id="orgheadline175">Clocking work time</h4>
<div class="outline-text-4" id="text-orgheadline175">
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Resume clocks when opening the first Org file</b><br />
<p>Alternative to requiring org-clock in every Emacs session.</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 8.4 (info "(org)Clocking work time")</span>

  (leuven--section <span class="org-string">"8.4 (org)Clocking work time"</span>)

  (global-set-key (kbd <span class="org-string">"C-c C-x C-i"</span>) 'org-clock-in)
  (global-set-key (kbd <span class="org-string">"C-c C-x C-j"</span>) 'org-clock-goto)
  (global-set-key (kbd <span class="org-string">"C-c C-x C-o"</span>) 'org-clock-out)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">The time clocking code for Org mode.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(require 'org-clock)               ;! needed for trying to automatically</span>
                                        <span class="org-comment-delimiter">;</span><span class="org-comment">! re-clock at Emacs startup</span>

  <span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment"> Under test!</span>
  (add-hook 'org-mode-hook
            (<span class="org-keyword">lambda</span> ()
              (<span class="org-keyword">require</span> '<span class="org-constant">org-clock</span>)
              (setq org-clock-persist t)
              (org-clock-persistence-insinuate)))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-clock"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; 8.4 Save both the running clock and the entire clock history when Emacs</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; is closed, and resume it next time Emacs is started up.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-clock-persist t)</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; 8.4 Set up hooks for clock persistence.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(org-clock-persistence-insinuate)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Resume clocking task on clock-in if the clock is open.</span>
    (setq org-clock-in-resume t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Number of clock tasks to remember in history.</span>
    (setq org-clock-history-length 35)  <span class="org-comment-delimiter">; </span><span class="org-comment">1-9A-Z</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">8.4.2 Include the current clocking task time in clock reports.</span>
    (setq org-clock-report-include-clocking-task t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">8.4.2 Format string used when creating CLOCKSUM lines and when generating</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">a time duration (avoid showing days).</span>
    (setq org-time-clocksum-format      <span class="org-comment-delimiter">;</span><span class="org-comment">! works with Org 8 only</span>
          '(<span class="org-builtin">:hours</span> <span class="org-string">"%d"</span> <span class="org-builtin">:require-hours</span> t <span class="org-builtin">:minutes</span> <span class="org-string">":%02d"</span> <span class="org-builtin">:require-minutes</span> t))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">some clocktable functions cannot</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">digest day formats (e.g.,</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">org-clock-time%)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; 8.4.2 Use fractional times.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-time-clocksum-use-fractional t)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Format string for the total time cells.</span>
    (setq org-clock-total-time-cell-format <span class="org-string">"%s"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Format string for the file time cells.</span>
    (setq org-clock-file-time-cell-format <span class="org-string">"%s"</span>)

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-org-clock-in-interrupted-task</span> ()
      <span class="org-doc">"Clock back into the task that has been interrupted, if there is one."</span>
      (interactive)
      (<span class="org-keyword">if</span> (and (not org-clock-resolving-clocks-due-to-idleness)
               (marker-buffer org-clock-marker)
               (marker-buffer org-clock-interrupted-task))
          (org-with-point-at org-clock-interrupted-task
            (org-clock-in nil))
        (org-clock-out)))

    (global-set-key (kbd <span class="org-string">"C-c C-x C-q"</span>) 'leuven-org-clock-in-interrupted-task)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">8.4.3 Resolve open clocks if the user is idle more than 120 minutes.</span>
    (setq org-clock-idle-time 120)

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--org-switch-to-started</span> (kwd)
      <span class="org-doc">"Switch task state to STRT.</span>
<span class="org-doc">    Skip normal headlines and capture tasks."</span>
      (<span class="org-keyword">if</span> (and kwd
               (not (string-equal kwd <span class="org-string">"STRT"</span>))
               (not (and (boundp 'org-capture-mode) org-capture-mode)))
          <span class="org-string">"STRT"</span>
        nil))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">8.4.3 Set task to todo state STRT while clocking it.</span>
    (setq org-clock-in-switch-to-state 'leuven--org-switch-to-started)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Clock won't be stopped when the clocked entry is marked DONE.</span>
    (setq org-clock-out-when-done nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Time included for the mode line clock is all time clocked into this task</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">today.</span>
    (setq org-clock-mode-line-total 'today)
    (setq org-clock-mode-line-total 'all)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Get an alert (notification) when your planned time is over.</span>
    (setq org-clock-sound <span class="org-string">"~/Public/Music/Sounds/alarm.wav"</span>)
    <span class="org-comment-delimiter">;;</span><span class="org-comment">! Use start-process to have an external program play the sound to</span>
    <span class="org-comment-delimiter">;;</span><span class="org-comment">! avoid ignored keystrokes until after the sound plays (start-process</span>
    <span class="org-comment-delimiter">;;</span><span class="org-comment">! "ding" nil "play" "~/Public/Music/Sounds/alarm.wav")</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Remove the clock line when the resulting time is 0:00.</span>
    (setq org-clock-out-remove-zero-time-clocks t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; When clocking into a task with a clock entry which has not been</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; closed, resume the clock from that point.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-clock-in-resume t)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Ask the user if they wish to clock out before killing Emacs.</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--org-query-clock-out</span> ()
      <span class="org-doc">"Ask the user before clocking out.</span>
<span class="org-doc">    This is a useful function for adding to `</span><span class="org-constant"><span class="org-doc">kill-emacs-query-functions</span></span><span class="org-doc">'."</span>
      (<span class="org-keyword">if</span> (and (<span class="org-keyword">featurep</span> '<span class="org-constant">org-clock</span>)
               (funcall 'org-clocking-p)
               (y-or-n-p <span class="org-string">"You are currently clocking time, clock out? "</span>))
          (org-clock-out)
        t))                             <span class="org-comment-delimiter">; </span><span class="org-comment">Only fails on keyboard quit or error.</span>

    (add-hook 'kill-emacs-query-functions 'leuven--org-query-clock-out)

    )                                   <span class="org-comment-delimiter">; </span><span class="org-comment">with-eval-after-load "org-clock" ends here</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline176" class="outline-4">
<h4 id="orgheadline176">Effort estimates</h4>
<div class="outline-text-4" id="text-orgheadline176">
<p>If you have an <code>Effort</code> property defined, the <b>estimated time</b> is also shown in the mode line, against the <b>actual time</b> spent (reported through <b>time clocking</b>).</p>
<p>When clocking in, ask for a time estimate if the property is not yet defined.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 8.5 (info "(org)Effort estimates")</span>

  (leuven--section <span class="org-string">"8.5 (org)Effort estimates"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Add an effort estimate on the fly when clocking in.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--org-ask-effort</span> ()
    <span class="org-doc">"Ask for an effort estimate when clocking in."</span>
    (<span class="org-keyword">unless</span> (org-entry-get (point) <span class="org-string">"Effort"</span>)
      (<span class="org-keyword">let</span> ((effort
             (completing-read
              <span class="org-string">"Estimated time (H:MM): "</span>
              (org-entry-get-multivalued-property (point) <span class="org-string">"Effort"</span>))))
        (<span class="org-keyword">unless</span> (equal effort <span class="org-string">""</span>)
          (org-set-property <span class="org-string">"Effort"</span> effort)))))

  (add-hook 'org-clock-in-prepare-hook 'leuven--org-ask-effort)
</pre></div>
<p>XXX We could forbid an empty answer to the effort estimate question!</p>
<p>XXX We could ask for a ranged estimate (best case - worst case).</p>
<p>XXX When clocking out, show the remaining effort (allows to re-estimate for a better schedule).</p>
</div>
</div>
</div>
<div id="outline-container-orgheadline185" class="outline-3">
<h3 id="orgheadline185">Capture - Refile - Archive</h3>
<div class="outline-text-3" id="text-orgheadline185"></div>
<div id="outline-container-orgheadline177" class="outline-4">
<h4 id="orgheadline177">Capture</h4>
<div class="outline-text-4" id="text-orgheadline177">
<p>The ultimate capture tool to <b>quickly add</b> tasks or notes.</p>
<p>Structure:</p>
<ul class="org-ul">
<li>Contacts</li>
<li>Calendar</li>
<li>Tasks</li>
<li>Notes</li>
<li>Journal</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 9 (info "(org)Capture - Refile - Archive")</span>

  (leuven--section <span class="org-string">"9.1 (org)Capture"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">9.1.2 Directory with Org files.</span>
  (setq org-directory
        (directory-file-name            <span class="org-comment-delimiter">; </span><span class="org-comment">This function removes the final slash.</span>
         (<span class="org-keyword">cond</span> ((file-directory-p <span class="org-string">"~/org/"</span>) <span class="org-string">"~/org/"</span>)
               (t <span class="org-string">"~/"</span>))))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">9.1.2 Default target for storing notes.</span>
  (setq org-default-notes-file          <span class="org-comment-delimiter">; </span><span class="org-comment">Inbox for collecting</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">[Default: "~/.notes"].</span>
        (concat org-directory <span class="org-string">"/notes.org"</span>))
</pre></div>
<p><code>%</code>-escapes:</p>
<dl class="org-dl">
<dt>%a</dt>
<dd>Annotation (<b>link</b>).</dd>
<dt>%i</dt>
<dd>Initial content (<b>selected text</b>).</dd>
<dt>%?</dt>
<dd>Cursor position.</dd>
<dt>%^T</dt>
<dd>Prompt for a date and time.</dd>
<dt>%^G</dt>
<dd>Prompt for tags with completion on tags in all agenda files.</dd>
<dt>%t</dt>
<dd>Time stamp (date only).</dd>
<dt>%<sup>prompt</sup></dt>
<dd>Prompt the user for a string.</dd>
<dt>%[file]</dt>
<dd>Insert the contents of the file.</dd>
<dt>%U</dt>
<dd>Inactive time stamp with date and time.</dd>
</dl>
<p>Looking at the info manual I found the documentation for "immediate-finish", but not for "jump-to-captured". I found it in the code and it seems to be exactly what I want.</p>
<p>Use <code>:jump-to-captured</code> to tell capture to jump to the note after storing it.</p>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Look at <code>:kill-buffer</code></b><br />
nil</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">9.1.2 templates for the creation of capture buffers</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">("Receipt"   ?r "** %^{BriefDesc} %U %^g\n%?"   "~/Personal/finances.org")</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Fast note taking in Org mode (the ultimate capture tool).</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-capture"</span>

    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"t"</span> <span class="org-string">"Task"</span> entry
                   (file+headline ,(concat org-directory <span class="org-string">"/refile.org"</span>) <span class="org-string">"Tasks"</span>)
                   <span class="org-string">"* NEW %^{Task}%?</span>

<span class="org-string">%i"</span>
                   <span class="org-builtin">:empty-lines</span> 1) t)

    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"T"</span> <span class="org-string">"Task in current file"</span> entry
                   (file+headline
                    (buffer-file-name (org-capture-get <span class="org-builtin">:original-buffer</span>))
                    <span class="org-string">"Tasks"</span>)
                   <span class="org-string">"* </span><span class="org-leuven-highlight"><span class="org-string">TODO</span></span><span class="org-string"> %?</span>
<span class="org-string">  %U %a %n"</span>
                   <span class="org-builtin">:prepend</span> t) t)

    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"a"</span> <span class="org-string">"Appt"</span> entry
                   (file+headline ,(concat org-directory <span class="org-string">"/refile.org"</span>) <span class="org-string">"Events"</span>)
                   <span class="org-string">"* %^{Appointment}%?</span>
<span class="org-string">%^T</span>

<span class="org-string">%i"</span>
                   <span class="org-builtin">:empty-lines</span> 1) t)
                   <span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment"> Prompt only for date, not time...</span>
</pre></div>
</div>
<div id="outline-container-orgheadline178" class="outline-5">
<h5 id="orgheadline178"><span class="todo TODO">TODO</span> Ask for refile location</h5>
<div class="outline-text-5" id="text-orgheadline178">
<p>Find a location for refiling on capture.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"Z"</span> <span class="org-string">"Refile me!"</span> entry
                   (function leuven-find-location)
                   <span class="org-string">"** </span><span class="org-leuven-highlight"><span class="org-string">TODO</span></span><span class="org-string"> Put this in some other file\n\n"</span>
                   <span class="org-builtin">:prepend</span> t) t)

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-find-location</span> ()
      <span class="org-doc">"Find my CollectBox file and some headline in the current buffer."</span>
      (find-file org-default-notes-file)
      (goto-char (point-min))
      (helm-org-in-buffer-headings)
      (org-forward-heading-same-level 1))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline179" class="outline-5">
<h5 id="orgheadline179"><span class="todo TODO">TODO</span> Email-to-task</h5>
<div class="outline-text-5" id="text-orgheadline179">
<p>Instantly <b>create tasks</b> and notes <b>from emails</b>, with a <b>link</b> back <b>to the emails</b>.</p>
<p>The following rules will apply to interpret an email to a task:</p>
<dl class="org-dl">
<dt>Email subject</dt>
<dd>Task name.</dd>
<dt>Person in the <code>From:</code> field</dt>
<dd>Task creator.</dd>
<dt>Person(s) in the <code>To:</code> field</dt>
<dd>Task assignee(s).</dd>
<dt>Email body (or selected region)</dt>
<dd>Inserted into the task's description.</dd>
<dt>Email attachment(s)</dt>
<dd>
<p>Inserted as task's attachment(s).</p>
<p>XXX Wouldn't it be great if files attached to email can be quickly added to the tasks or projects you create?</p>
</dd>
</dl>
<p>Additional parameters can be included via the commands you use:</p>
<dl class="org-dl">
<dt>Create a <code>TODO</code> Action</dt>
<dd>Create a new action.</dd>
<dt>Create a <code>TODO</code> Action Remind 3</dt>
<dd>Create a new action. Set reminder in 3 days.</dd>
<dt>Create a <code>TODO</code> Action Due Date 7</dt>
<dd>Create a new action. Set due date in 7 days.</dd>
<dt>Create a <code>TODO</code> Action of an existing Project</dt>
<dd>Attach it to something that we're already working on.</dd>
<dt>Create a <code>WAIT</code> Item</dt>
<dd>Create a new "Waiting For" item, eventually with an "Assignee" property.</dd>
<dt>Create a <code>SDAY</code> Item</dt>
<dd>Create a new "Someday" item.</dd>
<dt>Create a Reference Item</dt>
<dd>Create a new "Reference" item.</dd>
</dl>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"m"</span> <span class="org-string">"Email processing..."</span>) t)

    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"mT"</span> <span class="org-string">"Create a </span><span class="org-leuven-highlight"><span class="org-string">TODO</span></span><span class="org-string"> Action + edit"</span> entry
                   (file+headline ,(concat org-directory <span class="org-string">"/refile.org"</span>) <span class="org-string">"Email"</span>) <span class="org-comment-delimiter">; </span><span class="org-comment">#+FILETAGS: :mail:</span>
                   <span class="org-string">"* </span><span class="org-leuven-highlight"><span class="org-string">TODO</span></span><span class="org-string"> %^{Creating action}%? (from %:fromname)</span>
<span class="org-string">   %:date-timestamp-inactive</span>

<span class="org-string">#+begin_verse</span>
<span class="org-string">%i</span>
<span class="org-string">#+end_verse</span>

<span class="org-string">From %a"</span>
                   <span class="org-builtin">:empty-lines</span> 1) t)

    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"mt"</span> <span class="org-string">"Create a </span><span class="org-leuven-highlight"><span class="org-string">TODO</span></span><span class="org-string"> Action"</span> entry
                   (file+headline ,(concat org-directory <span class="org-string">"/refile.org"</span>) <span class="org-string">"Email"</span>) <span class="org-comment-delimiter">; </span><span class="org-comment">#+FILETAGS: :mail:</span>
                   <span class="org-string">"* </span><span class="org-leuven-highlight"><span class="org-string">TODO</span></span><span class="org-string"> %:subject%? (from %:fromname)</span>
<span class="org-string">   %:date-timestamp-inactive</span>

<span class="org-string">#+begin_verse</span>
<span class="org-string">%i</span>
<span class="org-string">#+end_verse</span>

<span class="org-string">From %a"</span>
                   <span class="org-builtin">:empty-lines</span> 1
                   <span class="org-builtin">:immediate-finish</span> t) t)
</pre></div>
<p>The property <code>:immediate-finish</code>, when set, immediately files the item without further prompt (skipping <code>C-c C-c</code>); very handy for quick storing of emails.</p>
<p>With the clock options, <code>org-capture</code> automatically clocks in. When pressing <code>C-c C-c</code>, it clocks out.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"p"</span> <span class="org-string">"Phone call"</span> entry
                   (file+headline ,(concat org-directory <span class="org-string">"/refile.org"</span>) <span class="org-string">"Phone calls"</span>)
                   <span class="org-string">"* %?"</span>
                   <span class="org-builtin">:clock-in</span> t
                   <span class="org-builtin">:clock-resume</span> t
                   <span class="org-builtin">:empty-lines</span> 1) t)

    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"i"</span> <span class="org-string">"interruption"</span> entry
                   (file ,(concat org-directory <span class="org-string">"/refile.org"</span>))
                   <span class="org-string">"A TEMPLATE HERE"</span>
                   <span class="org-builtin">:clock-in</span> t
                   <span class="org-builtin">:clock-resume</span> t) t)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Thought.</span>
    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"n"</span> <span class="org-string">"Note"</span> entry
                   (file+headline ,org-default-notes-file <span class="org-string">"Notes"</span>)
                   <span class="org-string">"* %^{Thought}%?</span>

<span class="org-string">%i"</span>
                   <span class="org-builtin">:empty-lines</span> 1) t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Shopping list (stuff to buy).</span>
    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"b"</span> <span class="org-string">"Buy"</span> checkitem
                   (file+headline ,(concat org-directory <span class="org-string">"/refile.org"</span>) <span class="org-string">"Shopping"</span>)) t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add a note to the currently clocked task.</span>
    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"c"</span> <span class="org-string">"Clock sibling"</span> entry
                   (clock)
                   <span class="org-string">"* %^{Title}</span>
<span class="org-string">  %U</span>
<span class="org-string">%a</span>

<span class="org-string">%i"</span>) t)

    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"j"</span> <span class="org-string">"Journal"</span> entry
                   (file+datetree ,(concat org-directory <span class="org-string">"/journal.org"</span>))
                   <span class="org-string">"* %T %?</span>

<span class="org-string">  %U</span>

<span class="org-string">%i</span>

<span class="org-string">From %a"</span>
                   <span class="org-comment-delimiter">;; </span><span class="org-comment">"* %^{Title}\n  :PROPERTIES:\n  :on: %T\n  :END:\n  %?\n  %x"</span>
                   <span class="org-builtin">:empty-lines</span> 1) t)

    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"S"</span> <span class="org-string">"secure"</span> entry
                   (file+datetree+prompt <span class="org-string">"~/org/notes/secure.org.gpg"</span>)
                   <span class="org-string">"* %(format-time-string \"%H:%M\") %^{Entry} %^G</span>
<span class="org-string">%i%?"</span>) t)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;;          </span><span class="org-comment">("w" "org-protocol" entry</span>
    <span class="org-comment-delimiter">;;           </span><span class="org-comment">(file ,(concat org-directory "/refile.org"))</span>
    <span class="org-comment-delimiter">;;           </span><span class="org-comment">"* </span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment"> Review %c</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">%U"</span>
    <span class="org-comment-delimiter">;;           </span><span class="org-comment">:clock-in t</span>
    <span class="org-comment-delimiter">;;           </span><span class="org-comment">:clock-resume t</span>
    <span class="org-comment-delimiter">;;           </span><span class="org-comment">:immediate-finish t)</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">("web-clippings" ?w</span>
    <span class="org-comment-delimiter">;;  </span><span class="org-comment">"* %^{Title} %^g \n  :PROPERTIES:\n  :date: %^t\n  :link: %^{link}\n  :END:\n\n %x %?"</span>
    <span class="org-comment-delimiter">;;  </span><span class="org-comment">"~/org/data.org" "Web Clippings")</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"w"</span> <span class="org-string">"Default template"</span> entry
                   <span class="org-comment-delimiter">;; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">org-protocol-default-template-key</span></span><span class="org-comment">'</span>
                   (file+headline ,(concat org-directory <span class="org-string">"/capture.org"</span>) <span class="org-string">"Notes"</span>)
                   <span class="org-string">"* %^{Title}%?</span>
<span class="org-string">  %u</span>

<span class="org-string">%i</span>

<span class="org-string">From %c"</span>
                   <span class="org-builtin">:empty-lines</span> 1
                   <span class="org-builtin">:immediate-finish</span> t) t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Default `</span><span class="org-constant"><span class="org-comment">org-capture-templates</span></span><span class="org-comment">' key to use.</span>
    (setq org-protocol-default-template-key <span class="org-string">"w"</span>)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline180" class="outline-5">
<h5 id="orgheadline180">Capture from command line</h5>
<div class="outline-text-5" id="text-orgheadline180">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-make-capture-frame</span> ()
      <span class="org-doc">"Create a new frame and run `</span><span class="org-constant"><span class="org-doc">org-capture</span></span><span class="org-doc">'."</span>
      (interactive)
      (make-frame '((name . <span class="org-string">"capture"</span>)
                    (width . 80)
                    (height . 10)))
      (select-frame-by-name <span class="org-string">"capture"</span>)
      <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Setup buffer to wrap.</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq truncate-lines nil)</span>
      (org-capture))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Make the frame contain a single window (by default, `</span><span class="org-constant"><span class="org-comment">org-capture</span></span><span class="org-comment">' splits</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">the window).</span>
    (add-hook 'org-capture-mode-hook 'delete-other-windows)

    (<span class="org-keyword">defadvice</span> <span class="org-function-name">org-capture-finalize</span>
      (after leuven-delete-capture-finalize-frame activate)
      <span class="org-doc">"Advise org-capture-finalize to close the frame (if it is the capture frame)."</span>
      (<span class="org-keyword">if</span> (equal <span class="org-string">"capture"</span> (frame-parameter nil 'name))
          (delete-frame)))

    (<span class="org-keyword">defadvice</span> <span class="org-function-name">org-capture-destroy</span>      <span class="org-comment-delimiter">; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span>
      (after leuven-delete-capture-destroy-frame activate)
      <span class="org-doc">"Advise capture-destroy to close the frame (if it is the capture frame)."</span>
      (<span class="org-keyword">if</span> (equal <span class="org-string">"capture"</span> (frame-parameter nil 'name))
          (delete-frame)))

    )                                   <span class="org-comment-delimiter">; </span><span class="org-comment">with-eval-after-load "org-capture" ends here</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-shell">
emacsclient -n -e <span class="org-string">'(leuven-make-capture-frame)'</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline181" class="outline-4">
<h4 id="orgheadline181">Attachments</h4>
<div class="outline-text-4" id="text-orgheadline181">
<p>Use the following for conveniently accessing your data.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;; </span><span class="org-comment">bug when C-c C-l</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; 4.6 Shortcut links.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-to-list 'org-link-abbrev-alist '(("att" . org-attach-expand-link)))</span>
</pre></div>
<p>Instead of modifying <code>org-link-abbrev-alist</code>, you can also use</p>
<pre class="example">
#+LINK: att %(org-attach-expand-link)
</pre>
<p>in your Org buffers.</p>
</div>
</div>
<div id="outline-container-orgheadline182" class="outline-4">
<h4 id="orgheadline182">Protocols for external access</h4>
<div class="outline-text-4" id="text-orgheadline182">
<p>Open Org source (and Capture) from Firefox.</p>
<p>Have a look at <a href="http://vimeo.com/5662410">Store links in Emacs Org using org-protocol.el</a>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (leuven--section <span class="org-string">"9.4 (org)Protocols"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">9.4 Capture from Firefox (to store links and text).</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-protocol"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Map online URL to an existing working file.</span>
    (add-to-list 'org-protocol-project-alist
                 '(<span class="org-string">"Worg at http://orgmode.org/worg/"</span>
                   <span class="org-builtin">:online-suffix</span> <span class="org-string">".html"</span>
                   <span class="org-builtin">:working-suffix</span> <span class="org-string">".org"</span>
                   <span class="org-builtin">:base-url</span> <span class="org-string">"http://orgmode.org/worg/"</span>
                   <span class="org-builtin">:working-directory</span> <span class="org-string">"~/Public/Repositories/worg/"</span>) t))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline183" class="outline-4">
<h4 id="orgheadline183">Refile and copy</h4>
<div class="outline-text-4" id="text-orgheadline183">
<p>Once a date has been scheduled, <b>move the task to the appropriate project</b>, by using the <b>refile</b> command <code>C-c C-w</code>. This lets me select (with completion) the header under which the entry will be placed.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"... Org Refile"</span>)

    (<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-org-refile-extra-files</span>
      (<span class="org-keyword">if</span> (file-exists-p <span class="org-string">"~/org/notes/"</span>)
          (directory-files <span class="org-string">"~/org/notes/"</span> t <span class="org-string">"^[</span><span class="org-negation-char"><span class="org-string">^</span></span><span class="org-string">\\.#].*\\.</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">(</span></span><span class="org-string">txt</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">|</span></span><span class="org-string">org</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">)</span></span><span class="org-string">$"</span>)
        nil)
      <span class="org-doc">"List of extra files to be used as targets for refile commands."</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">9.5 Any headline with level &lt;= 3 is a target.</span>
    (setq org-refile-targets
          `((nil
             <span class="org-builtin">:maxlevel</span> . 4)             <span class="org-comment-delimiter">; </span><span class="org-comment">Current file.</span>
            (,(append org-agenda-files leuven-org-refile-extra-files)
             <span class="org-builtin">:maxlevel</span> . 2)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Cache refile targets to speed up the process.</span>
    (setq org-refile-use-cache t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">9.5 Provide refile targets as paths, including the file name (without</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">directory) as level 1 of the path.</span>
    (setq org-refile-use-outline-path 'file)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">9.5 Allow to create new nodes (must be confirmed by the user) as refile</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">targets.</span>
    (setq org-refile-allow-creating-parent-nodes 'confirm)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Refile only within the current buffer.</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-org-refile-within-current-buffer</span> ()
      <span class="org-doc">"Move the entry at point to another heading in the current buffer."</span>
      (interactive)
      (<span class="org-keyword">let</span> ((org-refile-targets '((nil <span class="org-builtin">:maxlevel</span> . 4))))
        (org-refile)))
    <span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">FIXME</span></span><span class="org-comment"> Add a smart key binding</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Exclude DONE state tasks from refile targets.</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">bh/verify-refile-target</span> ()
      <span class="org-doc">"Exclude </span><span class="org-leuven-highlight"><span class="org-doc">TODO</span></span><span class="org-doc"> keywords with a DONE state from refile targets."</span>
      (not (member (nth 2 (org-heading-components)) org-done-keywords)))

    (setq org-refile-target-verify-function 'bh/verify-refile-target)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline184" class="outline-4">
<h4 id="orgheadline184">Archiving</h4>
<div class="outline-text-4 org-src-container" id="text-orgheadline184">
<pre class="src src-emacs-lisp">
    (leuven--section <span class="org-string">"9.6 (org)Archiving"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">9.6.1 Subtrees should be archived in the current file.</span>
    (setq org-archive-location <span class="org-string">"::* Archive"</span>)

    )
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline186" class="outline-3">
<h3 id="orgheadline186">Agenda Views</h3>
<div class="outline-text-3" id="text-orgheadline186">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (leuven--section <span class="org-string">"10 (org)Agenda Views"</span>)

<span class="org-comment-delimiter">;;</span><span class="org-comment">* 10 (info "(org)Agenda Views")</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-agenda"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Multiple same-day time stamps in entry make multiple agenda lines.</span>
    (setq org-agenda-skip-additional-timestamps-same-entry nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Show outline path in echo area after line motion (though, may bring some</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">slowness).</span>
    (setq org-agenda-show-outline-path t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">10.0 Restore the window configuration when exiting the agenda.</span>
    (setq org-agenda-restore-windows-after-quit t)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Speed up agenda by avoiding to update some text properties.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-agenda-ignore-drawer-properties '(effort category)) ; org.el</span>
</pre></div>
</div>
<div id="outline-container-orgheadline187" class="outline-4">
<h4 id="orgheadline187">Agenda files</h4>
<div class="outline-text-4" id="text-orgheadline187">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 10.1 (info "(org)Agenda files")</span>

    (leuven--section <span class="org-string">"10.1 (org)Agenda files"</span>)

    (<span class="org-keyword">when</span> (boundp 'org-agenda-files)
      (message <span class="org-string">"(Info) Found %s entries in `</span><span class="org-constant"><span class="org-string">org-agenda-files</span></span><span class="org-string">'"</span>
               (length org-agenda-files))
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(sit-for 0.5)</span>
      )
</pre></div>
<p>Avoid any possibility of getting a customized version of <code>org-agenda-files</code> added at the end of your <code>.emacs</code> file.</p>
<pre class="example">
(add-hook 'org-mode-hook
          (lambda ()
            (local-set-key (kbd "C-c [") 'undefined)
            (local-set-key (kbd "C-c ]") 'undefined)))
</pre></div>
</div>
<div id="outline-container-orgheadline188" class="outline-4">
<h4 id="orgheadline188">The agenda dispatcher</h4>
<div class="outline-text-4 org-src-container" id="text-orgheadline188">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 10.2 (info "(org)Agenda dispatcher")</span>

    (leuven--section <span class="org-string">"10.2 (org)Agenda dispatcher"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable sticky agenda: `q' key will bury agenda buffers (instead of</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">killing).</span>
    (setq org-agenda-sticky t)
</pre></div>
</div>
<div id="outline-container-orgheadline189" class="outline-4">
<h4 id="orgheadline189">The Built-in agenda views</h4>
<div class="outline-text-4" id="text-orgheadline189">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 10.3 The (info "(org)Built-in agenda views")</span>

    (leuven--section <span class="org-string">"10.3 (org)Built-in agenda views"</span>)
</pre></div>
<p>Press <code>C-c a a</code> to jump you to this week's task page from anywhere.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Default duration for appointments that only have a starting time.</span>
    (setq org-agenda-default-appointment-duration nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Duration of an appointment will add to day effort.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-agenda-columns-add-appointments-to-effort-sum t)</span>
</pre></div>
<p><code>C-c a t</code> should show <b>all</b> the <code>TODO</code> items but</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Show dated entries in the global `</span><span class="org-constant"><span class="org-comment">todo</span></span><span class="org-comment">' list.</span>
    (setq org-agenda-todo-ignore-with-date nil)
                                        <span class="org-comment-delimiter">;</span><span class="org-comment">!! tricky setting</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Show entries with a time stamp in the global `</span><span class="org-constant"><span class="org-comment">todo</span></span><span class="org-comment">' list.</span>
    (setq org-agenda-todo-ignore-timestamp nil)
</pre></div>
<p>Don't tell me about stuff that isn't due yet: tasks scheduled in the future should no longer show up in global todo or tags searches until that date arrives - at which point it will be in all lists.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">10.3.2 Don't show scheduled entries in the global `</span><span class="org-constant"><span class="org-comment">todo</span></span><span class="org-comment">' list.</span>
    (setq org-agenda-todo-ignore-scheduled 'future)
                                        <span class="org-comment-delimiter">;</span><span class="org-comment">!! Tricky setting.</span>
    (setq org-agenda-todo-ignore-scheduled nil)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">10.3.2 Don't show entries scheduled in the future in the global</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">todo</span></span><span class="org-comment">' list (until they are within the warning period).</span>
    (setq org-agenda-todo-ignore-deadlines 'near)
                                        <span class="org-comment-delimiter">;</span><span class="org-comment">!! Tricky setting.</span>
    (setq org-agenda-todo-ignore-deadlines nil)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">10.3.2 Check also the sublevels of a </span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment"> entry for </span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment"> entries,</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">resulting in potentially much longer `</span><span class="org-constant"><span class="org-comment">todo</span></span><span class="org-comment">' lists.</span>
    (setq org-agenda-todo-list-sublevels t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">10.3.3 Honor `</span><span class="org-constant"><span class="org-comment">todo</span></span><span class="org-comment">' list `</span><span class="org-constant"><span class="org-comment">org-agenda-todo-ignore...</span></span><span class="org-comment">' options also</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">in the `</span><span class="org-constant"><span class="org-comment">tags-todo</span></span><span class="org-comment">' list.</span>
    (setq org-agenda-tags-todo-honor-ignore-options t)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Highlight current line (may bring some slowness).</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'org-agenda-mode-hook 'hl-line-mode)</span>
</pre></div>
</div>
<div id="outline-container-orgheadline190" class="outline-5">
<h5 id="orgheadline190">Advanced Search</h5>
<div class="outline-text-5" id="text-orgheadline190">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">10.3.5 List of extra files to be searched by text search commands</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(C-c a s).</span>
    (setq org-agenda-text-search-extra-files nil) <span class="org-comment-delimiter">; </span><span class="org-comment">org.el</span>

    (<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-org-search-extra-files</span> nil
      <span class="org-doc">"List of extra files to be searched by custom search commands (`R s' and `R S')."</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Turn on individual word search (for Google addicts).</span>
    (setq org-agenda-search-view-always-boolean t
          org-agenda-search-view-search-words-only t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Match part of a word.</span>
    (setq org-agenda-search-view-force-full-words nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't search headline for a time-of-day.</span>
    (setq org-agenda-search-headline-for-time nil)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">10.3.6 How to identify stuck projects.</span>
    (setq org-stuck-projects
          '(<span class="org-string">"+LEVEL=2/-DONE"</span>            <span class="org-comment-delimiter">; </span><span class="org-comment">Identify a project.</span>
            (<span class="org-string">"</span><span class="org-leuven-highlight"><span class="org-string">TODO</span></span><span class="org-string">"</span> <span class="org-string">"STRT"</span>)             <span class="org-comment-delimiter">; </span><span class="org-comment">Todo keywords.</span>
            nil <span class="org-string">""</span>))                    <span class="org-comment-delimiter">; </span><span class="org-comment">Tags, regexp.</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline191" class="outline-4">
<h4 id="orgheadline191">Presentation and sorting</h4>
<div class="outline-text-4" id="text-orgheadline191">
<p>See <a href="http://www.dgtale.ch/index.php?option=com_content&amp;view=article&amp;id=52&amp;Itemid=61">http://www.dgtale.ch/index.php?option=com_content&amp;view=article&amp;id=52&amp;Itemid=61</a></p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 10.4 (info "(org)Presentation and sorting")</span>

    (leuven--section <span class="org-string">"10.4 (org)Presentation and sorting"</span>)
</pre></div>
<p>You can modify <code>org-agenda-prefix-format</code> to show extra information in the lists.</p>
<div class="note">
<p>If none of the built-in format specifiers are sufficient, you can use <code>%(my-function-here)</code> as a specifier and <code>my-function-here</code> will be called on each headline (to return any kind of string you want).</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">10.4 Format specifications for the prefix of items in the agenda views.</span>
    (setq org-agenda-prefix-format
          '((agenda   . <span class="org-string">" %-11s%i %?-12t"</span>) <span class="org-comment-delimiter">; </span><span class="org-comment">Agenda.</span>
            (timeline . <span class="org-string">" % s"</span>)         <span class="org-comment-delimiter">; </span><span class="org-comment">Timeline.</span>
            (todo     . <span class="org-string">" %i %-12:c"</span>)   <span class="org-comment-delimiter">; </span><span class="org-comment">Todo, alltodo.</span>
            (tags     . <span class="org-string">" %i %-12:c"</span>)   <span class="org-comment-delimiter">; </span><span class="org-comment">Tags, tags-todo, stuck.</span>
            (search   . <span class="org-string">" %i %-12:c"</span>))) <span class="org-comment-delimiter">; </span><span class="org-comment">Search.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Type "(" in agenda and todo buffers to show category name and task</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">length for each task.</span>
    (<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven--org-agenda-show-tasks-details</span> nil)
    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-org-agenda-toggle-tasks-details</span> ()
      <span class="org-doc">"Hide/show tasks details (category and time estimate) in agenda views."</span>
      (interactive)
      (<span class="org-keyword">if</span> leuven--org-agenda-show-tasks-details
          (<span class="org-keyword">progn</span>
            (setq leuven--org-agenda-show-tasks-details nil)
            (setq org-agenda-prefix-format
                  '((agenda    . <span class="org-string">" %-11s%i %?-12t"</span>)
                    (timeline  . <span class="org-string">" % s"</span>)
                    (todo      . <span class="org-string">" "</span>)
                    (search    . <span class="org-string">" "</span>)
                    (tags      . <span class="org-string">" "</span>))))
        (setq leuven--org-agenda-show-tasks-details t)
        (setq org-agenda-prefix-format
              '((agenda   . <span class="org-string">" %-11s%i %-12:c%?-12t%7e "</span>)
                (timeline . <span class="org-string">" % s"</span>)
                (todo     . <span class="org-string">" %i %-12:c"</span>)
                (search   . <span class="org-string">" %i %-12:c"</span>)
                (tags     . <span class="org-string">" %i %-12:c"</span>))))
      (org-agenda-redo))

    (define-key org-agenda-mode-map
      (kbd <span class="org-string">"("</span>) 'leuven-org-agenda-toggle-tasks-details)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Text preceding scheduled items in the agenda view.</span>
    (setq org-agenda-scheduled-leaders
          '(<span class="org-string">"Scheduled  "</span>
            <span class="org-string">"           "</span>))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Text preceding item pulled into the agenda by inactive time stamps.</span>
    (setq org-agenda-inactive-leader <span class="org-string">"["</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Text preceding deadline items in the agenda view.</span>
    (setq org-agenda-deadline-leaders
          '(<span class="org-string">"Deadline   "</span>
            <span class="org-string">"In %d d"</span>                   <span class="org-comment-delimiter">; </span><span class="org-comment">or "%d d left"</span>
            <span class="org-string">"%d d ago"</span>))

    )                                   <span class="org-comment-delimiter">; </span><span class="org-comment">with-eval-after-load "org-agenda" ends here</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-faces"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Faces for showing deadlines in the agenda.</span>
    (setq org-agenda-deadline-faces
          '((1.0001 . leuven-org-deadline-overdue)
            (0.9999 . leuven-org-deadline-today)
            (0.8571 . leuven-org-deadline-tomorrow) <span class="org-comment-delimiter">; </span><span class="org-comment">= 6/7, see `</span><span class="org-constant"><span class="org-comment">org-deadline-warning-days</span></span><span class="org-comment">'</span>
            (0.0000 . leuven-org-deadline-future)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">see http://www.dgtale.ch/index.php?option=com_content&amp;view=article&amp;id=52&amp;Itemid=61</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Org non-standard faces.</span>
    (<span class="org-keyword">defface</span> <span class="org-variable-name">leuven-org-deadline-overdue</span>
      '((t (<span class="org-builtin">:foreground</span> <span class="org-string">"#F22659"</span>)))
      <span class="org-doc">"Face used to highlight tasks whose due date is in the past."</span>)

    (<span class="org-keyword">defface</span> <span class="org-variable-name">leuven-org-deadline-today</span>
      '((t (<span class="org-builtin">:weight</span> bold <span class="org-builtin">:foreground</span> <span class="org-string">"#4F4A3D"</span> <span class="org-builtin">:background</span> <span class="org-string">"#FFFFCC"</span>)))
      <span class="org-doc">"Face used to highlight tasks whose due date is today."</span>)

    (<span class="org-keyword">defface</span> <span class="org-variable-name">leuven-org-deadline-tomorrow</span>
      '((t (<span class="org-builtin">:foreground</span> <span class="org-string">"#34AD00"</span>)))
      <span class="org-doc">"Face used to highlight tasks whose due date is tomorrow."</span>)

    (<span class="org-keyword">defface</span> <span class="org-variable-name">leuven-org-deadline-future</span>
      '((t (<span class="org-builtin">:foreground</span> <span class="org-string">"#34AD00"</span>)))
      <span class="org-doc">"Face used to highlight tasks whose due date is for later."</span>))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-agenda"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; 10.4 Column to shift tags to (in agenda items).</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-agenda-tags-column -132)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Right-justify tags in the agenda buffer.</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--org-agenda-right-justify-tags</span> ()
      <span class="org-doc">"Justify the tags to the right border of the agenda window."</span>
      (<span class="org-keyword">let</span> ((org-agenda-tags-column (- 2 (window-width))))
        (org-agenda-align-tags)))
    (add-hook 'org-agenda-finalize-hook 'leuven--org-agenda-right-justify-tags))
</pre></div>
<p>Show the time grid in the daily agenda but not in the weekly agenda, except for today's date:</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">10.4.2 Settings for time grid for agenda display.</span>
  (setq org-agenda-time-grid '((daily remove-match)
                               <span class="org-string">""</span>
                               (0800 1000 1200 1400 1600 1800 2000)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">String for the current time marker in the agenda.</span>
  (setq org-agenda-current-time-string <span class="org-string">"Right now"</span>)
</pre></div>
<p><code>time-up</code> will only be applied to those items have a time stamp for the day in question, so that other sorting parameters will not be outranked by <code>time-up</code> for the rest of the entries.</p>
<div class="note">
<p>The file <code>refile.org</code> should come first. My current workaround is to add <code>:CATEGORY: @refile</code> in its subtrees, as the <code>@</code> symbol is alphabetically before the letters.</p>
</div>
<p>Agenda view: put related tasks together, then by priority.</p>
<div class="note">
<p>Not sure about that anymore: the agenda view is to work on tasks, hence prior tasks (then grouped by project) should arrive ahead; on the opposite, when doing a review, it's good to have all tasks grouped by project.</p>
</div>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Sort agenda by prior, then categ, then date</b><br />
<p>Inverting <code>category-up</code> and <code>priority-down</code> in the agenda does unexpected sorting: first by priority (OK), but then by scheduled time (while it should be grouped by category)!</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">10.4.3 Sorting structure for the agenda items of a single day.</span>
  (setq org-agenda-sorting-strategy   <span class="org-comment-delimiter">; </span><span class="org-comment">custom value</span>
        '((agenda time-up category-up priority-down effort-down)
          (todo category-up priority-down effort-down)
          (tags category-up priority-down effort-down)
          (search category-up)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Show agenda in the current window, keeping all other windows.</span>
  (setq org-agenda-window-setup 'current-window)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline192" class="outline-4">
<h4 id="orgheadline192">Agenda commands</h4>
<div class="outline-text-4" id="text-orgheadline192">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 10.5 (info "(org)Agenda commands")</span>

  (leuven--section <span class="org-string">"10.5 (org)Agenda commands"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Get a compact view during follow mode in the agenda.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--compact-follow</span> ()
    <span class="org-doc">"Make the view compact, then show the necessary minimum."</span>
    (<span class="org-keyword">ignore-errors</span>
      (<span class="org-keyword">save-excursion</span>
        (<span class="org-keyword">while</span> (org-up-heading-safe))
        (hide-subtree)))
    (<span class="org-keyword">let</span> ((org-show-siblings nil)
          (org-show-hierarchy-above t))
      (org-reveal))
    (<span class="org-keyword">save-excursion</span>
      (org-back-to-heading t)
      (show-children)))

  <span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">FIXME</span></span><span class="org-comment"> When this is enabled, clicking on a clock line from `v c'</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(log check) does not jump to the right line</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'org-agenda-after-show-hook 'leuven--compact-follow)</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">10.5 Number of days to include in overview display.</span>
  (setq org-agenda-span 'day)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Always start the overview on the current day.</span>
  (setq org-agenda-start-on-weekday nil)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Format string for displaying dates in the daily/weekly agenda</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">and in the timeline.</span>
  (setq org-agenda-format-date
        (concat                         <span class="org-comment-delimiter">; </span><span class="org-comment">"\n"</span>
                <span class="org-string">"%Y-%m-%d"</span> <span class="org-string">" %a "</span>
                <span class="org-comment-delimiter">;; </span><span class="org-comment">(make-string (1- (window-width)) (string-to-char "_"))))</span>
                (make-string 65 (string-to-char <span class="org-string">" "</span>))
                <span class="org-string">"_"</span>
                <span class="org-comment-delimiter">;; </span><span class="org-comment">(make-string 1 ?\u25AE)</span>
                ))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">10.5 Only show clocked entries in agenda log mode (no closed</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">entries, no state changes).</span>
  (setq org-agenda-log-mode-items '(clock))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">10.5 Parameters for the clocktable in clockreport mode.</span>
  (setq org-agenda-clockreport-parameter-plist
        '(<span class="org-builtin">:link</span> nil <span class="org-builtin">:maxlevel</span> 3 <span class="org-builtin">:fileskip0</span> t))
  (setq org-agenda-clockreport-parameter-plist
        '(<span class="org-builtin">:link</span> t <span class="org-builtin">:maxlevel</span> 3 <span class="org-builtin">:fileskip0</span> t))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">10.5 Definition of what constitutes a clocking problem (overlapping</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">clock entries, clocking gaps).</span>
  (setq org-agenda-clock-consistency-checks
        '(<span class="org-builtin">:max-duration</span> <span class="org-string">"10:00"</span>
          <span class="org-builtin">:min-duration</span> 0
          <span class="org-builtin">:max-gap</span> <span class="org-string">"0:00"</span>
          <span class="org-builtin">:gap-ok-around</span> (<span class="org-string">"4:00"</span>)
          <span class="org-builtin">:default-face</span>
          ((<span class="org-builtin">:weight</span> bold
            <span class="org-builtin">:box</span> (<span class="org-builtin">:line-width</span> 1 <span class="org-builtin">:color</span> <span class="org-string">"#AAEE77"</span>)
            <span class="org-builtin">:foreground</span> <span class="org-string">"black"</span> <span class="org-builtin">:background</span> <span class="org-string">"#BFFA9E"</span>))
          <span class="org-builtin">:gap-face</span>
          ((<span class="org-builtin">:weight</span> bold
            <span class="org-builtin">:box</span> (<span class="org-builtin">:line-width</span> 1 <span class="org-builtin">:color</span> <span class="org-string">"#BBDDFF"</span>)
            <span class="org-builtin">:foreground</span> <span class="org-string">"black"</span> <span class="org-builtin">:background</span> <span class="org-string">"#D0EDFF"</span>))))
</pre></div>
<p>If you press <code>E</code>, it will <b>show</b> the <b>first notes</b> about the tasks.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">10.5 Text prepended to the entry text in agenda buffers.</span>
  (setq org-agenda-entry-text-leaders <span class="org-string">"                "</span>)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">10.5 File to which to add new entries with the `i' key in agenda and</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">calendar (org.el).</span>
  (setq org-agenda-diary-file <span class="org-string">"~/org/diary.org"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">10.5? Keep filters from one agenda view to the next.</span>
  (setq org-agenda-persistent-filter t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Faces for specific Priorities (#A, #B and #C).</span>
  (setq org-priority-faces
        '((?A . (<span class="org-builtin">:weight</span> bold <span class="org-builtin">:foreground</span> <span class="org-string">"#5F3731"</span> <span class="org-builtin">:background</span> <span class="org-string">"#EFC4C0"</span>))
          (?B . (<span class="org-builtin">:foreground</span> <span class="org-string">"#475443"</span> <span class="org-builtin">:background</span> <span class="org-string">"#D5E1D0"</span>))
          (?C . (<span class="org-builtin">:foreground</span> <span class="org-string">"#2D373F"</span> <span class="org-builtin">:background</span> <span class="org-string">"#C9DBE3"</span>))))
</pre></div>
<p>Contextual auto-exclusion for tags in the Agenda view. For example, I use the following tags for <code>TODO</code>:</p>
<dl class="org-dl">
<dt>Phone</dt>
<dd>Needs a phone.</dd>
<dt>Errands</dt>
<dd>Done in town.</dd>
<dt>Home</dt>
<dd>Done at home.</dd>
</dl>
<p>Now, it's quite easy for my computer to figure out which of these are possible, based on my location:</p>
<dl class="org-dl">
<dt>Phone</dt>
<dd>Am I outside of normal calling hours?</dd>
<dt>Errands</dt>
<dd>Am I outside of business hours?</dd>
<dt>Home</dt>
<dd>Does my IP address begin with 192.168?</dd>
</dl>
<p>I can now define the function <code>leuven--org-auto-exclude-function</code> to auto-exclude based on this type of context information.</p>
<p>All I have to do is type <code>/ &lt;RET&gt;</code> in the agenda view now, and it excludes based on my machine's current temporal and physical context.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">10.5 Commands in the agenda buffer.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--weekday-p</span> ()
    <span class="org-doc">"Return t if current day is between Monday and Friday."</span>
    (<span class="org-keyword">let</span> ((dow (nth 6 (decode-time))))
      (and (&gt; dow 0)
           (&lt; dow 6))))

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--working-p</span> ()
    <span class="org-doc">"Return t if current time is inside normal working hours.</span>
<span class="org-doc">  Currently: 08:30-12:30 and 13:30-17:30."</span>
    (<span class="org-keyword">let*</span> ((time (decode-time))
           (hour (nth 2 time))
           (mins (nth 1 time)))
      (and (leuven--weekday-p)
           (or (or (and (= hour 8) (&gt;= mins 30))
                   (and (&lt; 8 hour) (&lt; hour 12))
                   (and (= hour 12) (&lt;= mins 30)))
               (or (and (= hour 13) (&gt;= mins 30))
                   (and (&lt; 13 hour) (&lt; hour 17))
                   (and (= hour 17) (&lt;= mins 30)))))))

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--calling-hours-p</span> ()
    <span class="org-doc">"Return t if current time is inside normal calling hours.</span>
<span class="org-doc">  Currently: 08:00-21:59."</span>
    (<span class="org-keyword">let*</span> ((hour (nth 2 (decode-time))))
      (and (&lt;= 8 hour) (&lt;= hour 21))))

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--org-auto-exclude-function</span> (tag)
    (and (<span class="org-keyword">cond</span>
          ((string= tag <span class="org-string">"personal"</span>)
           (<span class="org-keyword">with-temp-buffer</span>
             (call-process <span class="org-string">"/sbin/ifconfig"</span> nil t nil <span class="org-string">"en0"</span> <span class="org-string">"inet"</span>)
             (goto-char (point-min))
             (not (re-search-forward <span class="org-string">"inet 192\\.168\\.9\\."</span> nil t))))
          ((or (string= tag <span class="org-string">"errands"</span>)
               (string= tag <span class="org-string">"call"</span>))
           (<span class="org-keyword">let</span> ((hour (nth 2 (decode-time))))
             (or (&lt; hour 8) (&gt; hour 21)))))
         (concat <span class="org-string">"-"</span> tag)))

  <span class="org-comment-delimiter">;;</span><span class="org-comment">! Ensure that `</span><span class="org-constant"><span class="org-comment">:refile:</span></span><span class="org-comment">' tags never will be excluded!</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--org-auto-exclude-function</span> (tag)
    (and (<span class="org-keyword">cond</span>
          ((string= tag <span class="org-string">"personal"</span>)
           (leuven--working-p))
          ((string= tag <span class="org-string">"work"</span>)
           (not (leuven--working-p)))
          ((or (string= tag <span class="org-string">"errands"</span>)
               (string= tag <span class="org-string">"call"</span>))
           (not (leuven--calling-hours-p))))
         (concat <span class="org-string">"-"</span> tag)))

  (setq org-agenda-auto-exclude-function 'leuven--org-auto-exclude-function)
</pre></div>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> We should ensure that appointments don't disappear when filtering late at nite</b><br />
<ul class="org-ul">
<li>Look at appointments tagged <code>errands</code></li>
<li>Filter at 23:00 with <code>/ &lt;RET&gt;</code></li>
<li>Appointments such as "going to the doctor" will be removed from the agenda view</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgheadline193" class="outline-4">
<h4 id="orgheadline193">Custom agenda views</h4>
<div class="outline-text-4" id="text-orgheadline193">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Make the block agenda more compact (no agenda span name, no week number, no</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">separator line).</span>
  (setq org-agenda-compact-blocks t)
  (setq org-agenda-compact-blocks nil)

  (setq org-agenda-block-separator
        (propertize (make-string 132 (string-to-char <span class="org-string">"_"</span>))
                    'face '(<span class="org-builtin">:foreground</span> <span class="org-string">"#59ACE2"</span>))) <span class="org-comment-delimiter">; </span><span class="org-comment">lighter version with #C0E2F4</span>
</pre></div>
<p>Links to common agenda views:</p>
<ul class="org-ul">
<li><a href="(org-agenda%20nil">(org-agenda nil "a")</a></li>
<li><a href="(org-agenda%20nil">Show Waiting Tasks</a></li>
<li><a href="(org-agenda%20nil">Show Projects</a></li>
</ul>
<p>You can as well use your agenda and use <code>/</code> to limit the view to what you want (<code>C-c a a / TAG</code>).</p>
<p>Commands:</p>
<ul class="org-ul">
<li><a href="ls%20-l">ls -l</a></li>
<li><a href="pwd">pwd</a></li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 10.6 (info "(org)Custom agenda views")</span>

  (leuven--section <span class="org-string">"10.6 (org)Custom agenda views"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-agenda"</span>
    (<span class="org-keyword">let</span> ((leuven-org-agenda-views
           <span class="org-string">"~/src/emacs-leuven/org-custom-agenda-views.el"</span>))
      (<span class="org-keyword">when</span> (file-exists-p leuven-org-agenda-views)
        (load-file leuven-org-agenda-views))))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">with-eval-after-load "org-agenda" ends here</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline194" class="outline-4">
<h4 id="orgheadline194">Display all active tasks from the current directory</h4>
<div class="outline-text-4" id="text-orgheadline194">
<p>The function <code>leuven-org-todo-list-current-dir</code> will display your tasks from the current directory (including from local files <code>TODO.org</code> and <code>BUGS.org</code>, for example).</p>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Add recursive option to show all tasks from subdir</b><br />
nil</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-org-todo-list-current-dir</span> ()
    <span class="org-doc">"Produce a view from all Org files in the current directory."</span>
    (interactive)
    (<span class="org-keyword">let*</span> ((fname (buffer-file-name))
           (dname (<span class="org-keyword">if</span> fname
                      (<span class="org-keyword">if</span> (file-directory-p fname)
                          fname
                        (file-name-directory fname))
                    default-directory))
           (org-agenda-files (directory-files dname t <span class="org-string">"\\.</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">(</span></span><span class="org-string">org</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">|</span></span><span class="org-string">txt</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">)</span></span><span class="org-string">$"</span>))
           (org-agenda-sorting-strategy '(todo-state-up priority-down))
           (org-agenda-overriding-header
            (format <span class="org-string">"List of </span><span class="org-leuven-highlight"><span class="org-string">TODO</span></span><span class="org-string"> items restricted to directory\n%s"</span> dname))
           (org-agenda-sticky nil))
      (message <span class="org-string">"%s..."</span> org-agenda-overriding-header)
      (org-todo-list)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">"</span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment"> list" without asking for a directory.</span>
  (global-set-key (kbd <span class="org-string">"&lt;C-f3&gt;"</span>) 'leuven-org-todo-list-current-dir)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline195" class="outline-4">
<h4 id="orgheadline195">Exporting Agenda Views</h4>
<div class="outline-text-4" id="text-orgheadline195">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 10.7 (info "(org)Exporting Agenda Views")</span>

  (leuven--section <span class="org-string">"10.7 (org)Exporting Agenda Views"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">10.7 Alist of variable/value pairs that should be active during agenda</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">export.</span>
  (setq org-agenda-exporter-settings
        '((ps-number-of-columns 1)      <span class="org-comment-delimiter">; </span><span class="org-comment">2?</span>
          (ps-landscape-mode t)
          <span class="org-comment-delimiter">;; </span><span class="org-comment">(org-agenda-add-entry-text-maxlines 5)</span>
          (htmlize-output-type 'css)))
</pre></div>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> htmlize-output-type is duplicated lots of times!</b><br />
nil</div>
</div>
</div>
<div id="outline-container-orgheadline196" class="outline-4">
<h4 id="orgheadline196">Agenda column view</h4>
<div class="outline-text-4 org-src-container" id="text-orgheadline196">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 10.8 (info "(org)Agenda column view")</span>

  (leuven--section <span class="org-string">"10.8 (org)Agenda column view"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">10.8 Default column format, if no other format has been defined.</span>
  (setq org-columns-default-format
        <span class="org-comment-delimiter">;; </span><span class="org-comment">"%65ITEM(Task) %DEADLINE(Due Date) %PRIORITY %6CLOCKSUM(Spent) %6Effort(Estim.){:}")</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">"%1BLOCKED %4</span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment"> %CATEGORY %5Effort{:} %50ITEM %20TAGS %21ALLTAGS")</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">"%65ITEM(Task) %4</span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment"> %PRIORITY %6Effort(Estim.) %14SCHEDULED %14DEADLINE(Due Date)")</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">"%65ITEM(Task) %4</span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment"> %PRIORITY %20TAGS %6Effort(Estim.) %14SCHEDULED %14DEADLINE(Due Date)")</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">"%40ITEM(Task) %17Effort(Estimated Effort){:} %CLOCKSUM"</span>
        <span class="org-string">"%60ITEM(Details) %5PRIORITY(Prio) %14SCHEDULED(Scheduled) %15TAGS(Context) %7</span><span class="org-leuven-highlight"><span class="org-string">TODO</span></span><span class="org-string">(To Do) %6CLOCKSUM(Clock) %5Effort(Effort){:} "</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">DUPLICATE Obey `</span><span class="org-constant"><span class="org-comment">eval</span></span><span class="org-comment">' variables -- RISKY!</span>
  (setq enable-local-eval t)
</pre></div>
</div>
<div id="outline-container-orgheadline201" class="outline-4">
<h4 id="orgheadline201">Not sorted</h4>
<div class="outline-text-4" id="text-orgheadline201"></div>
<div id="outline-container-orgheadline197" class="outline-5">
<h5 id="orgheadline197">Mouse cursor doesn't highlight agenda lines</h5>
<div class="outline-text-5" id="text-orgheadline197">
<p>XXX Does this work?</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (add-hook 'org-agenda-finalize-hook
            (<span class="org-keyword">lambda</span> ()
              (remove-text-properties (point-min) (point-max)
                                      '(mouse-face t))))
</pre></div>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Adding ":tangle yes" on the above code block results in partial tangling!</b><br />
nil</div>
</div>
</div>
<div id="outline-container-orgheadline198" class="outline-5">
<h5 id="orgheadline198">Emphasize items in agenda</h5>
<div class="outline-text-5 org-src-container" id="text-orgheadline198">
<pre class="src src-emacs-lisp">
(add-hook 'org-agenda-finalize-hook
          (<span class="org-keyword">lambda</span> () (<span class="org-keyword">let</span> ((inhibit-read-only t))
               (goto-char (point-min))
               (org-do-emphasis-faces (point-max)))))
</pre></div>
</div>
<div id="outline-container-orgheadline199" class="outline-5">
<h5 id="orgheadline199">Mark a task as DONE and create a follow-up task</h5>
<div class="outline-text-5" id="text-orgheadline199">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-agenda"</span>

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-org-agenda-mark-done-and-add-followup</span> ()
      <span class="org-doc">"Mark the current </span><span class="org-leuven-highlight"><span class="org-doc">TODO</span></span><span class="org-doc"> as done and add another task after it.</span>
<span class="org-doc">Creates it at the same level as the previous task, so it's better to use</span>
<span class="org-doc">this with to-do items than with projects or headings."</span>
      (interactive)
      (org-agenda-todo <span class="org-string">"DONE"</span>)
      (org-agenda-switch-to)
      (org-capture 0 <span class="org-string">"t"</span>))

    (define-key org-agenda-mode-map
      <span class="org-string">"Z"</span> 'leuven-org-agenda-mark-done-and-add-followup)
</pre></div>
<p>Source: Sacha Chua.</p>
</div>
</div>
<div id="outline-container-orgheadline200" class="outline-5">
<h5 id="orgheadline200">Capture something based on the agenda</h5>
<div class="outline-text-5" id="text-orgheadline200">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-org-agenda-new</span> ()
      <span class="org-doc">"Create a new note or task at the current agenda item.</span>
<span class="org-doc">Creates it at the same level as the previous task, so it's better to use</span>
<span class="org-doc">this with to-do items than with projects or headings."</span>
      (interactive)
      (org-agenda-switch-to)
      (org-capture 0))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; New key assignment (overrides `</span><span class="org-constant"><span class="org-comment">org-agenda-next-item</span></span><span class="org-comment">').</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key org-agenda-mode-map "N" 'leuven-org-agenda-new)</span>
  )
</pre></div>
<p>Source: Sacha Chua.</p>
</div>
</div>
</div>
</div>
<div id="outline-container-orgheadline202" class="outline-3">
<h3 id="orgheadline202">Markup for rich export</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline202">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 11 (info "(org)Markup")</span>

  (leuven--section <span class="org-string">"11 (org)Markup"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-faces"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add a face to #+begin_quote and #+begin_verse blocks.</span>
    (setq org-fontify-quote-and-verse-blocks t))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"... Org Markup"</span>)

    <span class="org-comment-delimiter">;;</span><span class="org-comment">??? Change the face of a headline (as an additional information) if it is</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">marked DONE (to face `</span><span class="org-constant"><span class="org-comment">org-headline-done</span></span><span class="org-comment">').</span>
    (setq org-fontify-done-headline t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">11.1 Hide the emphasis marker characters.</span>
    (setq org-hide-emphasis-markers t)  <span class="org-comment-delimiter">; </span><span class="org-comment">Impact on table alignment!</span>
</pre></div>
<div id="outline-container-orgheadline203" class="outline-4">
<h4 id="orgheadline203">Images and Tables</h4>
<div class="outline-text-4" id="text-orgheadline203">
<p>Automatic screenshot insertion.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-org-insert-image-or-take-screenshot</span> (name)
      <span class="org-doc">"Insert a link to an already existing image, or else to a screenshot.</span>
<span class="org-doc">    The screenshot is either taken to the given non-existing file name,</span>
<span class="org-doc">    or added into the given directory, defaulting to the current one."</span>
      <span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">FIXME</span></span><span class="org-comment">: Should limit to '("pdf" "jpeg" "jpg" "png" "ps" "eps")</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">which is org-export-latex-inline-image-extensions.</span>
      (interactive <span class="org-string">"GImage name? "</span>)
      (<span class="org-keyword">when</span> (file-directory-p name)
        (setq name (concat
                    (make-temp-name
                     (expand-file-name
                      (concat (file-name-as-directory name)
                              (subst-char-in-string
                               <span class="org-string">"."</span> <span class="org-string">"-"</span>
                               (file-name-sans-extension
                                (file-name-nondirectory
                                 (buffer-file-name)))))))
                    <span class="org-string">".png"</span>)))
      (<span class="org-keyword">unless</span> (file-exists-p name)
        (<span class="org-keyword">if</span> (file-writable-p name)
            (<span class="org-keyword">progn</span>
              (message <span class="org-string">"Taking screenshot into %s"</span> name)
              (call-process <span class="org-string">"import"</span> nil nil nil name)
              (message <span class="org-string">"Taking screenshot...done"</span>))
          (<span class="org-warning">error</span> <span class="org-string">"Cannot create image file"</span>)))
      (insert (concat <span class="org-string">"[["</span> name <span class="org-string">"]]"</span>))
      (org-display-inline-images))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline204" class="outline-4">
<h4 id="orgheadline204">Macro replacement</h4>
<div class="outline-text-4 org-src-container" id="text-orgheadline204">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Hide the brackets marking macro calls.</span>
    (setq org-hide-macro-markers t)

    (<span class="org-keyword">defun</span> <span class="org-function-name">org-macro-insert</span> ()
      (interactive)
      (<span class="org-keyword">let*</span> ((macros (org-macro--collect-macros))
             (macro (completing-read <span class="org-string">"Insert macro: "</span> (mapcar 'car macros)))
             (args (string-match <span class="org-string">"$[[:digit:]]"</span> (cdr (assoc macro macros))))
             pos)
        (insert (format  <span class="org-string">"{{{%s"</span> macro))
        (<span class="org-keyword">when</span> args (insert <span class="org-string">"("</span>) (setq pos (point)) (insert <span class="org-string">")"</span>))
        (insert <span class="org-string">"}}}"</span>)
        (<span class="org-keyword">when</span> pos (goto-char pos)))))
</pre></div>
</div>
<div id="outline-container-orgheadline205" class="outline-4">
<h4 id="orgheadline205">Embedded LaTeX</h4>
<div class="outline-text-4" id="text-orgheadline205">
<p>To get one entity in the middle of a word, use <code>{}</code>, i.e. some <code>w\entity{}rd</code> (new exporter only).</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">11.7.1 Define user entities to produce special characters.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-entities"</span>

    (add-to-list 'org-entities-user
                 '(<span class="org-string">"ok"</span>
                   <span class="org-comment-delimiter">;; </span><span class="org-comment">\definecolor{checkmark}{HTML}{1FAC21}</span>
                   <span class="org-string">"{\\color{checkmark}\\ding{51}}"</span> nil
                   <span class="org-string">"&lt;font color='green'&gt;&amp;#x2714;&lt;/font&gt;"</span>
                   <span class="org-string">"OK"</span>
                   <span class="org-string">"OK"</span> <span class="org-string">""</span>))

    (add-to-list 'org-entities-user
                 '(<span class="org-string">"nok"</span>
                   <span class="org-comment-delimiter">;; </span><span class="org-comment">\usepackage{pifont}</span>
                   <span class="org-string">"{\\color{red}\\ding{55}}"</span> nil
                   <span class="org-string">"&lt;font color='red'&gt;&amp;#x2718;&lt;/font&gt;"</span>
                   <span class="org-string">"NOK"</span>
                   <span class="org-string">"NOK"</span> <span class="org-string">""</span>)))
</pre></div>
<p>To list all available entities, run <code>M-x org-entities-help</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">11.7.2 Interpret "_" and "^" for display when braces are used.</span>
  (setq org-use-sub-superscripts '{})

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; 11.7.3 Convert LaTeX fragments to images when exporting to HTML (using MathJax).</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-export-with-latex t)</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Highlight LaTeX and related syntax.</span>
  (setq org-highlight-latex-and-related '(latex script entities))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Show entities as UTF8 characters.</span>
  (setq org-pretty-entities t)          <span class="org-comment-delimiter">; </span><span class="org-comment">emsp, etc.</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Pretty entity display doesn't include formatting sub/superscripts.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-pretty-entities-include-sub-superscripts nil)</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline206" class="outline-3">
<h3 id="orgheadline206">Exporting</h3>
<div class="outline-text-3" id="text-orgheadline206">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 12 (info "(org)Exporting")</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Bind the exporter dispatcher to a key sequence.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"... Org Exporting"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Libraries in this list will be loaded once the export framework is needed.</span>
    (setq org-export-backends '(ascii html icalendar latex odt))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key org-mode-map (kbd "C-c C-e") 'org-export-dispatch)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment"> temporary (until Org 8 is bundled within Emacs)</span>
    (define-key org-mode-map (kbd <span class="org-string">"C-c C-e"</span>)
      (<span class="org-keyword">lambda</span> (<span class="org-type">&amp;optional</span> arg)
        (interactive <span class="org-string">"P"</span>)
        (<span class="org-keyword">if</span> (fboundp 'org-export-dispatch)
            (funcall 'org-export-dispatch arg)
          (message (concat <span class="org-string">"This version of Org mode is no longer supported.  "</span>
                           <span class="org-string">"Please upgrade to 8 or later"</span>))
          (sit-for 1.5)))))
</pre></div>
<p>For Org buffers, add an enhanced version of <code>save-buffer</code> which does:</p>
<ol class="org-ol">
<li>Save buffer (updating dynamic blocks and tables)</li>
<li>Execute the code blocks, and save once again</li>
<li>Tangle code blocks, if any to be tangled</li>
<li>Export to HTML and PDF, if such files already exist</li>
<li>Call <code>send-patch</code>?</li>
</ol>
<p>Notes:</p>
<ul class="org-ul">
<li>Use the asynchronous export (if possible, so that I don't loose time, or let it open to the value of that var)?</li>
<li>Different behaviors can be obtained with <code>C-u</code> (or <code>C-u C-u</code>)</li>
</ul>
<p>Why not adding a recursive functionality as well (in Emacs Lisp too), to be launched from Dired?</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>

    (<span class="org-keyword">defun</span> <span class="org-function-name">org-save-buffer-and-do-related</span> ()
      <span class="org-doc">"Save buffer, execute/tangle code blocks, and export to HTML/PDF."</span>
      (interactive)
      (<span class="org-keyword">let*</span> ((orgfile (buffer-file-name))
             (base-name (file-name-base orgfile))
             (htmlfile (concat base-name <span class="org-string">".html"</span>))
             (texfile (concat base-name <span class="org-string">".tex"</span>))
             (pdffile (concat base-name <span class="org-string">".pdf"</span>)))
        (save-buffer)                   <span class="org-comment-delimiter">; </span><span class="org-comment">See other commands in</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">before-save-hook</span></span><span class="org-comment">':</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">org-update-all-dblocks</span></span><span class="org-comment">'</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">org-table-iterate-buffer-tables</span></span><span class="org-comment">'.</span>
        (<span class="org-keyword">when</span> (derived-mode-p 'org-mode)
          (measure-time <span class="org-string">"Restarted Org mode"</span> (org-mode-restart))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Update information from one of the</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">special #+KEYWORD lines</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">(like `C-c C-c')</span>

          <span class="org-comment-delimiter">;; </span><span class="org-comment">(when (locate-library "org-lint")</span>
          <span class="org-comment-delimiter">;;   </span><span class="org-comment">(measure-time "Linted Org mode" (org-lint)))</span>

          <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Update the results in the Org buffer</span>
          <span class="org-comment-delimiter">;; </span><span class="org-comment">(org-babel-execute-buffer)    ; In this case, better than</span>
          <span class="org-comment-delimiter">;;                               </span><span class="org-comment">; (add-hook 'org-export-first-hook</span>
          <span class="org-comment-delimiter">;;                               </span><span class="org-comment">;           'org-babel-execute-buffer):</span>
          <span class="org-comment-delimiter">;;                               </span><span class="org-comment">; excuted only once for both exports.</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">It'd make sense to eval all code blocks which have :cache yes or :exports</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">results or both... And, before that, to delete all code block results!?</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Well, almost all code blocks: not the ones of "cached" blocks (they may have</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">taken a long time to be computed, or may not be computable another time), nor</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">the ones with a caption on the results block...</span>
          (measure-time
           <span class="org-string">"Buffer saved"</span>
           (<span class="org-keyword">let</span> ((before-save-hook nil))
             (save-buffer)))
          (measure-time <span class="org-string">"Buffer tangled"</span> (org-babel-tangle))
          (measure-time
           <span class="org-string">"Buffer exported to HTML"</span>
           (<span class="org-keyword">when</span> (file-exists-p htmlfile)
             (<span class="org-keyword">if</span> (file-newer-than-file-p orgfile htmlfile)
                 (org-html-export-to-html)
               (message <span class="org-string">"HTML is up to date with Org file"</span>))))
          (measure-time
           <span class="org-string">"Buffer exported to PDF LaTeX"</span>
           (<span class="org-keyword">when</span> (or (file-exists-p texfile) (file-exists-p pdffile))
             (<span class="org-keyword">if</span> (or (and (file-exists-p pdffile)
                          (file-newer-than-file-p orgfile pdffile))
                     (and (file-exists-p texfile)
                          (not (file-exists-p pdffile)))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Previous PDF export failed.</span>
                     )
                 (<span class="org-keyword">if</span> (string-match <span class="org-string">"^#\\+BEAMER_THEME: "</span> (buffer-string))
                     (org-beamer-export-to-pdf)
                   (org-latex-export-to-pdf))
               (message <span class="org-string">"PDF is up to date with Org file"</span>))))
           (beep))))

    (define-key org-mode-map (kbd <span class="org-string">"&lt;f9&gt;"</span>) 'org-save-buffer-and-do-related))
</pre></div>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Execute all code blocks in buffer</b><br />
<p>Ce qui serait mieux :</p>
<ul class="org-ul">
<li>executer tout dans le buffer (sauf les never, videmment)</li>
<li>exporter en let-bind'ant eval  never SAUF POUR DES BLOCKS DONT ON NE VOULAIT PAS LE RSULTAT (TROP LONG, PAR EXEMPLE) DANS LE BUFFER MAIS QUE L'ON VEUT  L'EXPORT !!</li>
</ul>
<p>Ansi, on aurait les valeurs  jour dans le buffer Org, et les deux exports (HTML et PDF) seraient identiques entre eux, et avec le buffer Org.</p>
</div>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Check that SETUPFILES (like for Bigblow) or INCLUDE files exist</b><br />
<p>Before exporting</p>
</div>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Map through inline code blocks to remove inline results</b><br />
<p><code>(org-babel-map-inline-src-blocks nil (org-babel-remove-inline-result))</code></p>
</div>
</div>
<div id="outline-container-orgheadline207" class="outline-4">
<h4 id="orgheadline207">Export options</h4>
<div class="outline-text-4" id="text-orgheadline207">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 12.2 (info "(org)Export options")</span>

  (leuven--section <span class="org-string">"12.2 (org)Export options"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Org generic export engine.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ox"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">12.3 Don't insert a time stamp into the exported file.</span>
    (setq org-export-time-stamp-file nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">13.1.5 Export all drawers (including properties).</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-export-with-drawers t)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Default language of HTML export (see `</span><span class="org-constant"><span class="org-comment">org-export-language-setup</span></span><span class="org-comment">' </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment">).</span>
    (setq org-export-default-language <span class="org-string">"en"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Include priority cookies in export.</span>
    (setq org-export-with-priority t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Activate smart quotes during export (convert " to \og, \fg in French).</span>
    (setq org-export-with-smart-quotes t) <span class="org-comment-delimiter">; </span><span class="org-comment">curly quotes in HTML</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Interpret "_" and "^" for export when braces are used.</span>
    (setq org-export-with-sub-superscripts '{})

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Allow #+BIND to define local variable values for export.</span>
    (setq org-export-allow-bind-keywords t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Exported stuff will not be pushed onto the kill ring.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-export-copy-to-kill-ring nil) ; new default since 2014-04-17</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Export and publishing commands will run in background.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-export-in-background t)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Use a non-intrusive export dispatcher.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-export-dispatch-use-expert-ui t)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Export snippet translations.</span>
    (add-to-list 'org-export-snippet-translation-alist
                 '(<span class="org-string">"h"</span> . <span class="org-string">"html"</span>))
    (add-to-list 'org-export-snippet-translation-alist
                 '(<span class="org-string">"l"</span> . <span class="org-string">"latex"</span>))
    (add-to-list 'org-export-snippet-translation-alist
                 '(<span class="org-string">"b"</span> . <span class="org-string">"beamer"</span>))

    )                                   <span class="org-comment-delimiter">; </span><span class="org-comment">with-eval-after-load "ox" ends here</span>
</pre></div>
<p>Eric Schulte has proposed the <code>by-backend</code> function for <b>backend-dependent execution</b> (for example, conditionally export TikZ to an SVG image on HTML export and insert TikZ "as is" on PDF export):</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">defmacro</span> <span class="org-function-name">by-backend</span> (<span class="org-type">&amp;rest</span> body)
    `(case (<span class="org-keyword">if</span> (boundp 'backend) (org-export-backend-name backend) nil) ,@body))
</pre></div>
<p>See <a href="http://orgmode.org/worg/org-contrib/babel/languages/ob-doc-LaTeX.html#sec-4-3">Backend dependent execution - conditionally export tikz to SVG on HTML export</a> for more information.</p>
</div>
</div>
<div id="outline-container-orgheadline208" class="outline-4">
<h4 id="orgheadline208">HTML export</h4>
<div class="outline-text-4" id="text-orgheadline208">
<p>To get a start for your CSS file, use the command <code>M-x org-export-htmlize-generate-css</code> to extract class definitions.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 12.5 (info "(org)HTML export")</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Org HTML export engine.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ox-html"</span>

    (setq org-html-checkbox-type 'unicode)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Output type to be used by htmlize when formatting code snippets.</span>
    (setq org-html-htmlize-output-type 'css)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; URL pointing to a CSS file defining text colors for htmlized Emacs</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; buffers.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-org-htmlized-css-url "style.css")</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; XML declaration.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-html-xml-declaration</span>
    <span class="org-comment-delimiter">;;       </span><span class="org-comment">'(("html" . "&lt;!-- &lt;xml version=\"1.0\" encoding=\"%s\"&gt; --&gt;")</span>
    <span class="org-comment-delimiter">;;         </span><span class="org-comment">("was-html" . "&lt;?xml version=\"1.0\" encoding=\"%s\"?&gt;")</span>
    <span class="org-comment-delimiter">;;         </span><span class="org-comment">("php" . "&lt;?php echo \"&lt;?xml version=\\\"1.0\\\" encoding=\\\"%s\\\" ?&gt;\"; ?&gt;")))</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Coding system for HTML export.</span>
    (setq org-html-coding-system 'utf-8)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Format for the HTML postamble.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-html-postamble</span>
    <span class="org-comment-delimiter">;;       </span><span class="org-comment">"  &lt;div id=\"footer\"&gt;&lt;div id=\"copyright\"&gt;\n    &amp;copy; %d %a\n  &lt;/div&gt;&lt;/div&gt;")</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">13.1.5 Don't include the JavaScript snippets in exported HTML files.</span>
    (setq org-html-head-include-scripts nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">12.5.9 Turn inclusion of the default CSS style off.</span>
    (setq org-html-head-include-default-style nil)
</pre></div>
<p><a href="http://tidy.sourceforge.net/">HTML Tidy</a> is a HTML linter. Please see <a href="http://www.htmlpedia.org/wiki/HTML_Tidy">List of the Tidy errors</a>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Check that `</span><span class="org-constant"><span class="org-comment">tidy</span></span><span class="org-comment">' is in PATH, and that configuration file exists.</span>
    (<span class="org-keyword">when</span> (and (executable-find <span class="org-string">"tidy"</span>)
               (file-exists-p <span class="org-string">"~/.tidyrc"</span>)) <span class="org-comment-delimiter">; </span><span class="org-comment">tidy-config</span>

      (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--export-html-final-filter</span> (contents backend info)
        (<span class="org-keyword">if</span> (not (eq backend 'html)) contents
          (message <span class="org-string">"Tidy'fying..."</span>)
          (<span class="org-keyword">let*</span> ((new-contents
                  (<span class="org-keyword">with-temp-buffer</span>
                    (insert contents)
                    (shell-command-on-region (point-min) (point-max)
                                             <span class="org-string">"tidy -config ~/.tidyrc"</span>
                                             t t <span class="org-string">"*Tidy errors*"</span>)
                    (buffer-string))))
            (message <span class="org-string">"Tidy'fying... Done"</span>)
            new-contents)))

      (add-to-list 'org-export-filter-final-output-functions
                   'leuven--export-html-final-filter))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
      <span class="org-comment-delimiter">;; </span><span class="org-comment">HTML checkbox output.</span>
      (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--checkbox-filter</span> (item backend info)
        (<span class="org-keyword">when</span> (org-export-derived-backend-p backend 'html)
          (replace-regexp-in-string
           <span class="org-string">"\\`.*</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">(</span></span><span class="org-string">&lt;code&gt;\\[</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">(</span></span><span class="org-string">X</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">|</span></span><span class="org-string">&amp;#xa0;</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">|</span></span><span class="org-string">-</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">)</span></span><span class="org-string">\\]&lt;/code&gt;</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">)</span></span><span class="org-string">.*$"</span>
           (<span class="org-keyword">lambda</span> (rep)
             (<span class="org-keyword">let</span> ((check (match-string 2 rep)))
               (<span class="org-keyword">cond</span> ((equal check <span class="org-string">"X"</span>) <span class="org-string">"&amp;#x2611;"</span>)
                     ((equal check <span class="org-string">"-"</span>) <span class="org-string">"&amp;#x2610;"</span>)
                     (t <span class="org-string">"&amp;#x2610;"</span>))))
           item
           nil nil 1)))
      (add-to-list 'org-export-filter-item-functions
                   'leuven--checkbox-filter)

    )                                   <span class="org-comment-delimiter">; </span><span class="org-comment">with-eval-after-load "ox-html" ends here</span>
</pre></div>
<p>Emacs 23+ users: in order to avoid "Invalid face" errors, you need to use the version of <code>htmlize</code> made available by Carsten Dominik in <code>org-mode/contrib/lisp</code> directory.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(emacs-goodies-el)htmlize")</span>

  (leuven--section <span class="org-string">"(emacs-goodies-el)htmlize"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">HTML-ize font-lock buffers.</span>
  (autoload 'htmlize-buffer <span class="org-string">"htmlize"</span>
    <span class="org-doc">"Convert BUFFER to HTML, preserving colors and decorations."</span> t)
  (autoload 'htmlize-region <span class="org-string">"htmlize"</span>
    <span class="org-doc">"Convert the region to HTML, preserving colors and decorations."</span> t)
  (autoload 'htmlize-file <span class="org-string">"htmlize"</span>
    <span class="org-doc">"Load FILE, fontify it, convert it to HTML, and save the result."</span> t)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"htmlize"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Output type of generated HTML.</span>
    (setq htmlize-output-type 'css)

    <span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment"> Override output type `</span><span class="org-constant"><span class="org-comment">inline-css</span></span><span class="org-comment">' used for htmlizing a region.</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">htmlize-region-for-paste</span> (beg end)
      <span class="org-doc">"Htmlize the region and return just the HTML as a string.</span>
<span class="org-doc">    This forces the `</span><span class="org-constant"><span class="org-doc">css</span></span><span class="org-doc">' style and only returns the HTML body, but without the</span>
<span class="org-doc">    BODY tag.  This should make it useful for inserting the text to another HTML</span>
<span class="org-doc">    buffer."</span>
      (<span class="org-keyword">let*</span> ((htmlize-output-type 'css)  <span class="org-comment-delimiter">; </span><span class="org-comment">was `</span><span class="org-constant"><span class="org-comment">inline-css</span></span><span class="org-comment">'</span>
             (htmlbuf (htmlize-region beg end)))
        (<span class="org-keyword">unwind-protect</span>
            (<span class="org-keyword">with-current-buffer</span> htmlbuf
              (buffer-substring
               (plist-get htmlize-buffer-places 'content-start)
               (plist-get htmlize-buffer-places 'content-end)))
          (kill-buffer htmlbuf))))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Charset declared by the resulting HTML documents.</span>
    (setq htmlize-html-charset <span class="org-string">"utf-8"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Non-ASCII characters (codes in the 128-255 range) are copied to</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">HTML without modification -- if your HTML is in Unicode.</span>
    (setq htmlize-convert-nonascii-to-entities nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Key binding.</span>
    (global-set-key (kbd <span class="org-string">"M-P"</span>) 'htmlize-buffer)

    )                                   <span class="org-comment-delimiter">; </span><span class="org-comment">with-eval-after-load "htmlize" ends here</span>
</pre></div>
<p>To get around PostScript problems, you can write the buffer to your browser and then print from there, and in color.</p>
<p>This adds a Quick Print option to your menu bar (under File).</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Quick print preview (to Web browser) with `</span><span class="org-constant"><span class="org-comment">htmlize-view-buffer</span></span><span class="org-comment">'.</span>
  (GNUEmacs
    (autoload 'htmlize-view-buffer <span class="org-string">"htmlize-view"</span>
      <span class="org-doc">"Convert buffer to html preserving faces and view in web browser."</span> t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Same key binding as Org export to HTML (open in browser).</span>
    (global-set-key (kbd <span class="org-string">"C-c C-e h o"</span>) 'htmlize-view-buffer)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">View current buffer as html in web browser.</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"htmlize-view"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Add "Quick Print" entry to file menu.</span>
      (htmlize-view-add-to-files-menu)))
</pre></div>
<p>Now, you can print from the browser in (complete) Unicode, using your system's capabilities.</p>
</div>
</div>
<div id="outline-container-orgheadline209" class="outline-4">
<h4 id="orgheadline209">LaTeX and PDF export</h4>
<div class="outline-text-4" id="text-orgheadline209">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 12.6 (info "(org)LaTeX and PDF export")</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (leuven--section <span class="org-string">"12.6 (org)LaTeX and PDF export"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">LaTeX back-end.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ox-latex"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Markup for </span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment"> keywords and for tags, as a printf format.</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--org-latex-format-headline</span>
        (todo todo-type priority text tags <span class="org-type">&amp;optional</span> info)
      <span class="org-doc">"Default function for formatting the headline's text."</span>
      (concat (<span class="org-keyword">when</span> todo
                (format <span class="org-string">"{%s\\textbf{\\textsc{\\textsf{%s}}}} "</span>
                        (<span class="org-keyword">cond</span> ((equal todo-type 'todo) <span class="org-string">"\\color{red}"</span>)
                              ((equal todo-type 'done) <span class="org-string">"\\color{teal}"</span>)
                              (t <span class="org-string">"\\color{gray}"</span>))
                        todo))
              (<span class="org-keyword">when</span> priority
                (format <span class="org-string">"\\framebox{\\#%c} "</span> priority))
              text
              (<span class="org-keyword">when</span> tags
                (format <span class="org-string">"\\hfill{}\\fbox{\\textsc{%s}}"</span>
                <span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment"> source of "undefined control sequence"?</span>
                  (mapconcat 'identity tags <span class="org-string">":"</span>)))))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Function for formatting the headline's text.</span>
    (setq org-latex-format-headline-function
          'leuven--org-latex-format-headline)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Default width for images.</span>
    (setq org-latex-image-default-width <span class="org-string">".75\\linewidth"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Format string for links with unknown path type.</span>
    (setq org-latex-link-with-unknown-path-format <span class="org-string">"\\colorbox{red}{%s}"</span>)
</pre></div>
<p>Look at the variable <code>org-latex-remove-logfiles</code>, which controls whether some of the files produced by LaTeX (<code>org-latex-logfiles-extensions</code>) are removed.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--change-pdflatex-program</span> (backend)
      <span class="org-doc">"Automatically run XeLaTeX, if asked, when exporting to LaTeX."</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Default (in Windows binary).</span>
      (setq org-latex-pdf-process
            (<span class="org-keyword">cond</span>
             ((and leuven--win32-p (executable-find <span class="org-string">"latexmk"</span>))
              '(<span class="org-string">"latexmk -CF -pdf %f &amp;&amp; latexmk -c"</span>))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Must clean .fdb_latexmk, .fls, .ilg,</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">.ind, etc.</span>
             ((and leuven--cygwin-p (executable-find <span class="org-string">"latexmk"</span>))
              '(<span class="org-string">"latexmk -CF -pdf $(cygpath -m %f) &amp;&amp; latexmk -c"</span>))
             (leuven--win32-p
              '(<span class="org-string">"pdflatex -interaction=nonstopmode -output-directory=%o %f"</span>
                <span class="org-string">"pdflatex -interaction=nonstopmode -output-directory=%o %f"</span>
                <span class="org-string">"pdflatex -interaction=nonstopmode -output-directory=%o %f"</span>))
             (leuven--cygwin-p
              '(<span class="org-string">"pdflatex -interaction=nonstopmode -output-directory=%o $(cygpath -m %f)"</span>
                <span class="org-string">"pdflatex -interaction=nonstopmode -output-directory=%o $(cygpath -m %f)"</span>
                <span class="org-string">"pdflatex -interaction=nonstopmode -output-directory=%o $(cygpath -m %f)"</span>))))

      (<span class="org-keyword">when</span> (string-match <span class="org-string">"^#\\+LATEX_CMD: xelatex"</span> (buffer-string))
        (setq org-latex-pdf-process
              (<span class="org-keyword">cond</span>
               ((and leuven--win32-p (executable-find <span class="org-string">"latexmk"</span>))
                '(<span class="org-string">"latexmk -CF -pdf -pdflatex=xelatex %f &amp;&amp; latexmk -c"</span>))
               ((and leuven--cygwin-p (executable-find <span class="org-string">"latexmk"</span>))
                '(<span class="org-string">"latexmk -CF -pdf -pdflatex=xelatex $(cygpath -m %f) &amp;&amp; latexmk -c"</span>))
               (leuven--win32-p
                '(<span class="org-string">"xelatex -interaction=nonstopmode -output-directory=%o %f"</span>
                  <span class="org-string">"xelatex -interaction=nonstopmode -output-directory=%o %f"</span>
                  <span class="org-string">"xelatex -interaction=nonstopmode -output-directory=%o %f"</span>))
               (leuven--cygwin-p
                '(<span class="org-string">"xelatex -interaction=nonstopmode -output-directory=%o $(cygpath -m %f)"</span>
                  <span class="org-string">"xelatex -interaction=nonstopmode -output-directory=%o $(cygpath -m %f)"</span>
                  <span class="org-string">"xelatex -interaction=nonstopmode -output-directory=%o $(cygpath -m %f)"</span>))))))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Hook run before parsing an export buffer.</span>
    (add-hook 'org-export-before-parsing-hook 'leuven--change-pdflatex-program)
</pre></div>
<p>You can easily customize this variable on a per file basis. If you seldom use <code>bibtex</code>, have the default be to run <code>pdflatex</code> just once or twice. Then, for any Org file that needs <code>bibtex</code>, simply put in the following line (or a variation thereof):</p>
<div class="org-src-container">
<pre class="src src-org">
<span class="org-org-meta-line">#+BIND: org-latex-pdf-process ("pdflatex %b" "bibtex %b" "pdflatex %b" "pdflatex %b")</span>
</pre></div>
<p>Also, you can use <code>latexmk</code> (in TeX Live) which can save you some time when it is not necessary to rebuild index and/or bibliography.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Export source code using `</span><span class="org-constant"><span class="org-comment">listings</span></span><span class="org-comment">' (instead of `</span><span class="org-constant"><span class="org-comment">verbatim</span></span><span class="org-comment">').</span>
    (setq org-latex-listings t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">12.6.2 Default packages to be inserted in the header.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Include the `</span><span class="org-constant"><span class="org-comment">listings</span></span><span class="org-comment">' package for fontified source code.</span>
    (add-to-list 'org-latex-packages-alist '(<span class="org-string">""</span> <span class="org-string">"listings"</span>) t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Include the `</span><span class="org-constant"><span class="org-comment">xcolor</span></span><span class="org-comment">' package for colored source code.</span>
    (add-to-list 'org-latex-packages-alist '(<span class="org-string">""</span> <span class="org-string">"xcolor"</span>) t)
</pre></div>
<p>When using the <code>utf8</code> option to <code>inputenc</code> (and not <code>utf8x</code> which should be avoided, as it uses <code>ucs</code> which is no longer maintained), we have 2 solutions to support the UTF-8 <b>no-break space</b>:</p>
<ul class="org-ul">
<li>
<p>Convert it in Org mode, when exporting (via a filter), or</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Filter for no-break spaces.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--latex-filter-nbsp</span> (text backend info)
    <span class="org-doc">"Convert no-break spaces when exporting to LaTeX/Beamer."</span>
    (<span class="org-keyword">when</span> (memq backend '(latex beamer))
      (replace-regexp-in-string <span class="org-string">" "</span> <span class="org-string">"~"</span> text)))

  (add-to-list 'org-export-filter-plain-text-functions
               'leuven--latex-filter-nbsp)
</pre></div>
</li>
<li>
<p>Convert it in LaTeX:</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Convert `</span><span class="org-constant"><span class="org-comment">nbsp</span></span><span class="org-comment">' to its LaTeX equivalent.</span>
  (add-to-list 'org-latex-packages-alist
               (concat <span class="org-string">"\\ifdefined\\DeclareUnicodeCharacter{"</span>
                       <span class="org-string">"\\DeclareUnicodeCharacter{00A0}{~}"</span>
                       <span class="org-string">"}\\fi"</span>) t)
</pre></div>
</li>
</ul>
<p>XXX The first one is better because  (see mail of Daniel Flipo)</p>
<p>The exporter will <b>add</b> a language option to the LaTeX <code>babel</code> package according to the <code>#+LANGUAGE:</code> keyword (only) if:</p>
<ul class="org-ul">
<li>The <code>babel</code> package is explicitly loaded (in preamble), <span class="underline">and</span></li>
<li>The language is different from the one set by the user.</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Include the `</span><span class="org-constant"><span class="org-comment">babel</span></span><span class="org-comment">' package for language-specific hyphenation and</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">typography.</span>
    (add-to-list 'org-latex-packages-alist '(<span class="org-string">"french"</span> <span class="org-string">"babel"</span>) t)
</pre></div>
<p>What about <code>apacite</code> and <code>tikz</code> in <code>org-latex-packages-alist</code>?</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--change-pdflatex-packages</span> (backend)
      <span class="org-doc">"Automatically select the LaTeX packages to include (depending on PDFLaTeX</span>
<span class="org-doc">    vs. XeLaTeX) when exporting When exporting to LaTeX."</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Unconditionally remove `</span><span class="org-constant"><span class="org-comment">inputenc</span></span><span class="org-comment">' from all the default packages.</span>
      (setq org-latex-packages-alist
            (delete '(<span class="org-string">"AUTO"</span> <span class="org-string">"inputenc"</span> t)
                    org-latex-packages-alist))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Unconditionally remove `</span><span class="org-constant"><span class="org-comment">fontenc</span></span><span class="org-comment">' from all the default packages.</span>
      (setq org-latex-packages-alist
            (delete '(<span class="org-string">"T1"</span> <span class="org-string">"fontenc"</span> t)
                    org-latex-packages-alist))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Unconditionally remove `</span><span class="org-constant"><span class="org-comment">textcomp</span></span><span class="org-comment">' from all the default packages.</span>
      (setq org-latex-packages-alist
            (delete '(<span class="org-string">""</span> <span class="org-string">"textcomp"</span> t)
                    org-latex-packages-alist))

      (<span class="org-keyword">if</span> (string-match <span class="org-string">"^#\\+LATEX_CMD: xelatex"</span> (buffer-string))
          <span class="org-comment-delimiter">;; </span><span class="org-comment">Packages to include when XeLaTeX is used.</span>
          (setq org-export-latex-packages-alist
                '((<span class="org-string">""</span> <span class="org-string">"fontspec"</span> t)
                  (<span class="org-string">""</span> <span class="org-string">"xunicode"</span> t)
                  <span class="org-comment-delimiter">;; </span><span class="org-comment">Add here things like `\setmainfont{Georgia}'.</span>
                  ))

        <span class="org-comment-delimiter">;; </span><span class="org-comment">Packages to include when PDFLaTeX is used.</span>
        (setq org-export-latex-packages-alist
              '((<span class="org-string">"AUTO"</span> <span class="org-string">"inputenc"</span> t)
                (<span class="org-string">"T1"</span> <span class="org-string">"fontenc"</span> t)
                (<span class="org-string">""</span> <span class="org-string">"textcomp"</span> t))))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Packages to always include.</span>
      (add-to-list 'org-export-latex-packages-alist
                   '(<span class="org-string">"frenchb"</span> <span class="org-string">"babel"</span>) t))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Hook run before parsing an export buffer.</span>
    (add-hook 'org-export-before-parsing-hook 'leuven--change-pdflatex-packages)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">12.6.5 Default position for LaTeX figures.</span>
    (setq org-latex-default-figure-position <span class="org-string">"!htbp"</span>)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline210" class="outline-4">
<h4 id="orgheadline210">"Ignore heading + promote children" tag</h4>
<div class="outline-text-4" id="text-orgheadline210">
<p>The actual contents of an abstract can be rather large.</p>
<p>To be able to put it into a collapsable headline <b>without exporting the headline</b>, but <b>well its contents</b>, you can add a <code>ignore</code> tag to remove the headline:</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--org-export-ignore-headlines</span> (data backend info)
      <span class="org-doc">"Remove headlines tagged \"ignore\" retaining contents and promoting children.</span>
<span class="org-doc">    Each headline tagged \"ignore\" will be removed retaining its</span>
<span class="org-doc">    contents and promoting any children headlines to the level of the</span>
<span class="org-doc">    parent."</span>
      (org-element-map data 'headline
        (<span class="org-keyword">lambda</span> (object)
          (<span class="org-keyword">when</span> (member <span class="org-string">"ignore"</span> (org-element-property <span class="org-builtin">:tags</span> object))
            (<span class="org-keyword">let</span> ((level-top (org-element-property <span class="org-builtin">:level</span> object))
                  level-diff)
              (mapc (<span class="org-keyword">lambda</span> (el)
                      <span class="org-comment-delimiter">;; </span><span class="org-comment">Recursively promote all nested headlines.</span>
                      (org-element-map el 'headline
                        (<span class="org-keyword">lambda</span> (el)
                          (<span class="org-keyword">when</span> (equal 'headline (org-element-type el))
                            (<span class="org-keyword">unless</span> level-diff
                              (setq level-diff (- (org-element-property <span class="org-builtin">:level</span> el)
                                                  level-top)))
                            (org-element-put-property el
                              <span class="org-builtin">:level</span> (- (org-element-property <span class="org-builtin">:level</span> el)
                                        level-diff)))))
                      <span class="org-comment-delimiter">;; </span><span class="org-comment">Insert back into parse tree.</span>
                      (org-element-insert-before el object))
                    (org-element-contents object)))
            (org-element-extract-element object)))
        info nil)
      data)

    (add-hook 'org-export-filter-parse-tree-functions
              'leuven--org-export-ignore-headlines)
</pre></div>
<p>In addition, it promotes all headlines under the removed <code>ignore</code>-tagged headline. This is useful to support structures like the following:</p>
<div class="org-src-container">
<pre class="src src-org">
<span class="org-comment"># Wrapping an abstract in a headline</span>

<span class="org-org-level-1">* Abstract                                                             </span><span class="org-org-tag"><span class="org-org-level-1">:ignore:</span></span>
<span class="org-org-meta-line">#+LaTeX: \begin{abstract}</span>
<span class="org-org-meta-line">#+HTML: &lt;div id="abstract"&gt;</span>
...
<span class="org-org-meta-line">#+HTML: &lt;/div&gt;</span>
<span class="org-org-meta-line">#+LaTeX: \end{abstract}</span>

<span class="org-comment"># Placing References under a headline (using ox-bibtex in contrib)</span>

<span class="org-org-level-1">* References                                                           </span><span class="org-org-tag"><span class="org-org-level-1">:ignore:</span></span>
<span class="org-org-meta-line">#+BIBLIOGRAPHY: dissertation plain</span>

<span class="org-comment"># Inserting an appendix for LaTeX using the appendix package.</span>

<span class="org-org-level-1">* Appendix                                                             </span><span class="org-org-tag"><span class="org-org-level-1">:ignore:</span></span>
<span class="org-org-meta-line">#+LaTeX: \begin{appendices}</span>
<span class="org-org-level-2">** Reproduction</span>
<span class="org-org-level-2">** Data Sets</span>
<span class="org-org-level-2">** Tooling</span>
<span class="org-org-level-2">** Definitions</span>
<span class="org-org-meta-line">#+LaTeX: \end{appendices}</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    )                                   <span class="org-comment-delimiter">; </span><span class="org-comment">with-eval-after-load "ox-latex" ends here</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline211" class="outline-4">
<h4 id="orgheadline211">LaTeX Beamer and PDF export</h4>
<div class="outline-text-4 org-src-container" id="text-orgheadline211">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">12.6.6 Beamer class export.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(require 'ox-beamer)</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ox-beamer"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Default title of a frame containing an outline.</span>
    (setq org-beamer-outline-frame-title <span class="org-string">"Plan"</span>)) <span class="org-comment-delimiter">; </span><span class="org-comment">[default: "Outline"]</span>
</pre></div>
</div>
<div id="outline-container-orgheadline212" class="outline-4">
<h4 id="orgheadline212">OpenDocument Text (ODT)</h4>
<div class="outline-text-4" id="text-orgheadline212">
<p>ODT export is not loaded by default. You will have to load it explicitly or to add it to <code>org-export-backends</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ox-odt"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Convert "odt" format to "doc" format.</span>
    (setq org-odt-preferred-output-format <span class="org-string">"doc"</span>)

    (<span class="org-keyword">when</span> leuven--cygwin-p
      (setcdr (assoc <span class="org-string">"LibreOffice"</span> org-odt-convert-processes)
              <span class="org-string">"soffice --headless --convert-to %f%x --outdir \"$(cygpath -m %d)\" \"$(cygpath -m %i)\""</span>)))
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline213" class="outline-3">
<h3 id="orgheadline213">Publishing</h3>
<div class="outline-text-3" id="text-orgheadline213">
<p>Publish related Org mode files as a website.</p>
<div class="warning">
<p>It can be used for generating different PDF files from the same source file See <a href="http://orgmode.org/worg/org-tutorials/org-latex-export.html#sec-9-2">9.2 The Multiple Export Case</a>.</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 13 (info "(org)Publishing")</span>

  (leuven--section <span class="org-string">"13 (org)Publishing"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ox-publish"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Show message about files *not* published.</span>
    (setq org-publish-list-skipped-files nil)
</pre></div>
</div>
<div id="outline-container-orgheadline214" class="outline-4">
<h4 id="orgheadline214">Uploading files</h4>
<div class="outline-text-4 org-src-container" id="text-orgheadline214">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; 13.2 Always publish all files.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; (do not use time stamp checking for skipping unmodified files)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-publish-use-timestamps-flag nil)</span>
</pre></div>
</div>
<div id="outline-container-orgheadline215" class="outline-4">
<h4 id="orgheadline215">Triggering publication</h4>
<div class="outline-text-4 org-src-container" id="text-orgheadline215">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">13.4 Force publishing all files.</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-org-publish-all-force</span> ()
      (interactive)
      (org-publish-all t)))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline216" class="outline-3">
<h3 id="orgheadline216">Working With Source Code</h3>
<div class="outline-text-3" id="text-orgheadline216">
<p>Literate programming and reproducible research.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 14 (info "(org)Working With Source Code")</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ob-core"</span>
</pre></div>
<p>Automate the redisplay of inline images, so that the images are always up-to-date.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Make the images in the Emacs buffer automatically refresh after</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">execution.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'org-babel-after-execute-hook</span>
    <span class="org-comment-delimiter">;;           </span><span class="org-comment">(lambda ()</span>
    <span class="org-comment-delimiter">;;             </span><span class="org-comment">(org-display-inline-images nil t))) ; DOESN'T WORK!</span>
    <span class="org-comment-delimiter">;;                                     </span><span class="org-comment">; More efficient with refresh == t.</span>

    (add-hook 'org-babel-after-execute-hook 'org-display-inline-images)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (<span class="org-keyword">defadvice</span> <span class="org-function-name">org-babel-next-src-block</span>
      (after leuven-org-babel-next-src-block activate)
      <span class="org-doc">"Recenter after jumping to the next source block."</span>
      (recenter))

    (<span class="org-keyword">defadvice</span> <span class="org-function-name">org-babel-previous-src-block</span>
      (after leuven-org-babel-previous-src-block activate)
      <span class="org-doc">"Recenter after jumping to the previous source block."</span>
      (recenter))
    )
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (<span class="org-keyword">defadvice</span> <span class="org-function-name">org-agenda-switch-to</span>
      (after leuven-org-agenda-switch-to activate)
      <span class="org-doc">"Recenter after jumping to the file which contains the item at point."</span>
      (recenter))
</pre></div>
</div>
<div id="outline-container-orgheadline217" class="outline-4">
<h4 id="orgheadline217">Editing source code</h4>
<div class="outline-text-4" id="text-orgheadline217">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 14.2 (info "(org)Editing source code")</span>

  (leuven--section <span class="org-string">"14.2 (org)Editing source code"</span>)
</pre></div>
<p>Mapping between languages (listings in LaTeX) and their major mode (in Emacs).</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-src"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Mapping languages to their major mode (for editing the source code block</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">with `C-c '').</span>
    (add-to-list 'org-src-lang-modes    <span class="org-comment-delimiter">; </span><span class="org-comment">Add new languages.</span>
                 '(<span class="org-string">"dot"</span> . graphviz-dot)))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Display the source code edit buffer in the current window, keeping all</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">other windows.</span>
  (setq org-src-window-setup 'current-window)

  <span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">FIXME</span></span><span class="org-comment"> Bind this to the correct keys.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-org-babel-expand-src-block</span> ()
    (interactive)
    (<span class="org-keyword">let</span> ((org-src-window-setup 'reorganize-frame))
      (org-babel-expand-src-block)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Indent the content of a source code block.</span>
  (setq org-edit-src-content-indentation 2)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Fontify code in code blocks (highlight syntax in the Org buffer).</span>
  (setq org-src-fontify-natively t)     <span class="org-comment-delimiter">;</span><span class="org-comment">! Create overlay</span>
                                        <span class="org-comment-delimiter">;</span><span class="org-comment">! `</span><span class="org-constant"><span class="org-comment">org-block-background</span></span><span class="org-comment">' and remove</span>
                                        <span class="org-comment-delimiter">;</span><span class="org-comment">! text property `</span><span class="org-constant"><span class="org-comment">org-block</span></span><span class="org-comment">'.</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Preserve spaces and `</span><span class="org-constant"><span class="org-comment">tab</span></span><span class="org-comment">' characters in source code blocks.</span>
  (setq org-src-preserve-indentation t) <span class="org-comment-delimiter">; </span><span class="org-comment">Or add a `</span><span class="org-constant"><span class="org-comment">-i</span></span><span class="org-comment">' flag to you source block.</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Same effect for `</span><span class="org-constant"><span class="org-comment">tab</span></span><span class="org-comment">' as in the language major mode buffer (indenting</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">properly when hitting the `</span><span class="org-constant"><span class="org-comment">tab</span></span><span class="org-comment">' key).</span>
  (setq org-src-tab-acts-natively t)


  <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "org"</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(message "... Org Editing source code")</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; Allow indent region in the code edit buffer (according to language).</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(defun leuven-org-indent-region (&amp;optional arg)</span>
  <span class="org-comment-delimiter">;;     </span><span class="org-comment">(interactive "P")</span>
  <span class="org-comment-delimiter">;;     </span><span class="org-comment">(or (org-babel-do-key-sequence-in-edit-buffer (kbd "C-M-\\"))</span>
  <span class="org-comment-delimiter">;;         </span><span class="org-comment">(indent-region arg)))</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; Make `C-c C-v C-x C-M-\' more convenient.</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(define-key org-mode-map (kbd "C-M-\\") 'leuven-org-indent-region))</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Prevent auto-filling in src blocks.</span>
  (setq org-src-prevent-auto-filling t)
</pre></div>
<p>C-c TAB Toggle the visibility of existing tags in the buffer. This can be used as a cheap preview (sgml-tags-invisible).</p>
<p>View just the source-code blocks within the current Org-babel file (something logically equivalent to "tangle", but without creating a separate file).</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">defvar</span> <span class="org-variable-name">only-code-overlays</span> nil
    <span class="org-doc">"Overlays hiding non-code blocks."</span>)
  (make-variable-buffer-local 'only-code-overlays)

  (<span class="org-keyword">defun</span> <span class="org-function-name">hide-non-code</span> ()
    <span class="org-doc">"Hide non-code-block content of the current Org mode buffer."</span>
    (interactive)
    (add-to-invisibility-spec '(non-code))
    (<span class="org-keyword">let</span> (begs ends)
      (<span class="org-keyword">save-excursion</span>
        (goto-char (point-min))
        (<span class="org-keyword">while</span> (re-search-forward org-babel-src-block-regexp nil t)
          (push (match-beginning 5) begs)
          (push (match-end 5)       ends))
        (map 'list (<span class="org-keyword">lambda</span> (beg end)
                     (<span class="org-keyword">let</span> ((ov (make-overlay beg end)))
                       (push ov only-code-overlays)
                       (overlay-put ov 'invisible 'non-code)))
             (cons (point-min) (reverse ends))
             (append (reverse begs) (list (point-max)))))))

  (<span class="org-keyword">defun</span> <span class="org-function-name">show-non-code</span> ()
    <span class="org-doc">"Show non-code-block content of the current Org mode buffer."</span>
    (interactive)
    (mapc 'delete-overlay only-code-overlays))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline218" class="outline-4">
<h4 id="orgheadline218">Evaluating code blocks</h4>
<div class="outline-text-4" id="text-orgheadline218">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 14.5 (info "(org)Evaluating code blocks")</span>

  (leuven--section <span class="org-string">"14.5 (org)Evaluating code blocks"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">I don't want to execute code blocks with `C-c C-c' (evaluate code</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">block only with `C-c C-v e').</span>
  (setq org-babel-no-eval-on-ctrl-c-ctrl-c t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Languages for which Org-babel will raise literate programming errors when</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">noweb references can not be resolved.</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ob-core"</span>
    (add-to-list 'org-babel-noweb-error-langs <span class="org-string">"emacs-lisp"</span>))
</pre></div>
<p>Write error messages to the Messages buffer for invalid <code>org-sbe</code> calls.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Debugging org-sbe calls.</span>
  (<span class="org-keyword">defadvice</span> <span class="org-function-name">org-sbe</span> (around get-err-msg activate)
    <span class="org-doc">"Issue messages at errors."</span>
    (<span class="org-keyword">condition-case</span> err
        (<span class="org-keyword">progn</span>
      ad-do-it)
      (<span class="org-warning">error</span>
       (message <span class="org-string">"Error in org-sbe: %S"</span> err)
       (<span class="org-warning">signal</span> (car err) (cdr err)))))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline219" class="outline-4">
<h4 id="orgheadline219">Languages</h4>
<div class="outline-text-4" id="text-orgheadline219">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ob-exp"</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Template used to export the body of code blocks.</span>
    (setq org-babel-exp-code-template
          <span class="org-comment-delimiter">;; </span><span class="org-comment">(concat "\n==:\n"</span>
                  org-babel-exp-code-template)
          <span class="org-comment-delimiter">;; </span><span class="org-comment">)</span>
    )

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Keep lower-case.</span>
  (setq org-babel-results-keyword <span class="org-string">"results"</span>)
</pre></div>
<p>Customize the <code>org-babel-load-languages</code> variable to enable support for languages which can be evaluated in Org mode buffers.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 14.7 (info "(org)Languages")</span>

  (leuven--section <span class="org-string">"14.7 (org)Languages"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">FIXME</span></span><span class="org-comment"> Test executable-find (of Rterm, gnuplot, ruby, etc.) before</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">setting language to yes...</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"... Org Languages"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Configure Babel to support most languages.</span>
    (add-to-list 'org-babel-load-languages '(R . t)) <span class="org-comment-delimiter">; </span><span class="org-comment">Requires R and ess-mode.</span>
    (add-to-list 'org-babel-load-languages '(awk . t))
    (add-to-list 'org-babel-load-languages '(ditaa . t)) <span class="org-comment-delimiter">; </span><span class="org-comment">Sudo aptitude install openjdk-6-jre.</span>
    (add-to-list 'org-babel-load-languages '(dot . t))
    (add-to-list 'org-babel-load-languages '(java . t))
    (add-to-list 'org-babel-load-languages '(latex . t)) <span class="org-comment-delimiter">; </span><span class="org-comment">Shouldn't you use #+begin/end_latex blocks instead?</span>
    (add-to-list 'org-babel-load-languages '(ledger . t)) <span class="org-comment-delimiter">; </span><span class="org-comment">Requires ledger.</span>
    (add-to-list 'org-babel-load-languages '(makefile . t))
    (add-to-list 'org-babel-load-languages '(org . t))
    (<span class="org-keyword">if</span> (locate-library <span class="org-string">"ob-shell"</span>)     <span class="org-comment-delimiter">; </span><span class="org-comment">ob-sh renamed on 2013-12-13</span>
        (add-to-list 'org-babel-load-languages '(shell . t))
      (add-to-list 'org-babel-load-languages '(sh . t)))
    (add-to-list 'org-babel-load-languages '(sql . t))

    (org-babel-do-load-languages        <span class="org-comment-delimiter">; </span><span class="org-comment">Loads org, gnus-sum, etc...</span>
     'org-babel-load-languages org-babel-load-languages)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Accented characters on graphics.</span>
    (setq org-babel-R-command
          (concat org-babel-R-command <span class="org-string">" --encoding=UTF-8"</span>))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">R commands are displayed in the process buffer.</span>
    (setq org-babel-R-eval-visibly t)   <span class="org-comment-delimiter">; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment"> Under test</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Check for the support of (inline) source block languages.</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">org-src-block-check</span> ()
      (interactive)
      (org-element-map (org-element-parse-buffer)
        '(src-block inline-src-block)
        (<span class="org-keyword">lambda</span> (sb)
          (<span class="org-keyword">let</span> ((language (org-element-property <span class="org-builtin">:language</span> sb)))
            (<span class="org-keyword">cond</span> ((null language)
                   (<span class="org-warning">error</span> <span class="org-string">"Missing language at line %d in %s"</span>
                          (line-number-at-pos
                           (org-element-property <span class="org-builtin">:post-affiliated</span> sb))
                          (buffer-name)))
                  ((and (not (assoc-string language org-babel-load-languages))
                        (not (assoc-string language org-src-lang-modes))
                        <span class="org-comment-delimiter">;; </span><span class="org-comment">(locate-library (concat language "-mode")) ; would allow `</span><span class="org-constant"><span class="org-comment">sh-mode</span></span><span class="org-comment">'</span>
                        )
                                        <span class="org-comment-delimiter">; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment"> This should be stricter: must be</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">in org-babel-load-languages for</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">evaluated code blocks. Must be in both</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">other cases for edited code blocks.</span>
                   (<span class="org-warning">error</span> <span class="org-string">"Unknown language `</span><span class="org-constant"><span class="org-string">%s</span></span><span class="org-string">' at line %d in `</span><span class="org-constant"><span class="org-string">%s</span></span><span class="org-string">'"</span>
                          language
                          (line-number-at-pos
                           (org-element-property <span class="org-builtin">:post-affiliated</span> sb))
                          (buffer-name)))))))
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(message "Source blocks checked in %s."</span>
      <span class="org-comment-delimiter">;;          </span><span class="org-comment">(buffer-name (buffer-base-buffer)))</span>
      )

    (add-hook 'org-mode-hook 'org-src-block-check t))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Place this at the end to ensure that</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">errors do not stop applying other</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">functions in the `</span><span class="org-constant"><span class="org-comment">org-mode-hook</span></span><span class="org-comment">' (such</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">as switching the dictionary).</span>
</pre></div>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Why isn't diff-mode.el found?</b><br />
<p><a href="file://d:/Users/fni/org/personal/Org-for-dummies.html">file://d:/Users/fni/org/personal/Org-for-dummies.html</a></p>
</div>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Check src blocks in</b> temp buffers?<br />
nil</div>
<p><code>screen</code> offers support for interactive terminals. Mostly shell scripts. Heavily inspired by <code>eev</code>.</p>
<p>Eric Schulte believes <code>screen</code> has more of a focus on sustained interaction with an interactive terminal.</p>
</div>
</div>
<div id="outline-container-orgheadline220" class="outline-4">
<h4 id="orgheadline220">Prettier (or at least fancier) code block delimiters</h4>
<div class="outline-text-4 org-src-container" id="text-orgheadline220">
<pre class="src src-emacs-lisp">
    (<span class="org-keyword">defun</span> <span class="org-function-name">prettier-org-code-blocks</span> ()
      (interactive)
      (font-lock-add-keywords nil
        '((<span class="org-string">"</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">(</span></span><span class="org-string">\+begin_src</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">)</span></span><span class="org-string">"</span>
           (0 (<span class="org-keyword">progn</span> (compose-region (match-beginning 1) (match-end 1) ?)
                     nil)))
          (<span class="org-string">"</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">(</span></span><span class="org-string">\+end_src</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">)</span></span><span class="org-string">"</span>
           (0 (<span class="org-keyword">progn</span> (compose-region (match-beginning 1) (match-end 1) ?)
                     nil))))))

    (add-hook 'org-mode-hook 'prettier-org-code-blocks)
</pre></div>
</div>
<div id="outline-container-orgheadline221" class="outline-4">
<h4 id="orgheadline221">Library of Babel</h4>
<div class="outline-text-4" id="text-orgheadline221">
<p>As the LOB contains code blocks of different languages, and as we now <b>check that languages are known</b>, this section 14.6 has been moved <b>after</b> the section 14.7 where we <b>load languages</b> such as R, etc.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 14.6 (info "(org)Library of Babel")</span>

  (leuven--section <span class="org-string">"14.6 (org)Library of Babel"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Load the NAMED code blocks defined in Org mode files into the library of</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Babel (global `</span><span class="org-constant"><span class="org-comment">org-babel-library-of-babel</span></span><span class="org-comment">' variable).</span>
    (<span class="org-keyword">let</span> ((lob-file (concat (file-name-directory (locate-library <span class="org-string">"org"</span>))
                            <span class="org-string">"../doc/library-of-babel.org"</span>)))
      (<span class="org-keyword">when</span> (file-exists-p lob-file)
        (org-babel-lob-ingest lob-file))))
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline222" class="outline-3">
<h3 id="orgheadline222">Miscellaneous</h3>
<div class="outline-text-3" id="text-orgheadline222">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 15 (info "(org)Miscellaneous")</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">From Dan Davison.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-switch-to-org-scratch</span> ()
    <span class="org-doc">"Switch to a temp Org buffer.  If the region is active, insert it."</span>
    (interactive)
    (<span class="org-keyword">let</span> ((contents (and (use-region-p)
                         (buffer-substring (region-beginning)
                                           (region-end)))))
      (find-file <span class="org-string">"/tmp/org-scratch.org"</span>)
      (<span class="org-keyword">if</span> contents (insert contents))))
</pre></div>
</div>
<div id="outline-container-orgheadline223" class="outline-4">
<h4 id="orgheadline223">Change PROPERTY drawer location</h4>
<div class="outline-text-4" id="text-orgheadline223">
<p><span class="timestamp-wrapper"><span class="timestamp">[2014-10-28 Tue]</span></span></p>
<p>Find all entries where :PROPERTIES: is not the first item listed.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class="org-function-name">org-check-property-drawers</span> ()
    (interactive)
    (org-element-map (org-element-parse-buffer 'element) 'headline
      (<span class="org-keyword">lambda</span> (h)
        (and (org-element-map h 'drawer
               (<span class="org-keyword">lambda</span> (d) (equal (org-element-property <span class="org-builtin">:name</span> d) <span class="org-string">"PROPERTIES"</span>))
               nil t 'headline)
             (<span class="org-keyword">let</span> ((begin (org-element-property <span class="org-builtin">:begin</span> h)))
               (message <span class="org-string">"Entry with erroneous properties drawer at %d"</span> begin)
               begin)))))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class="org-function-name">org-repair-property-drawers</span> ()
    <span class="org-doc">"Fix properties drawers in current buffer.</span>
<span class="org-doc">  Ignore non Org buffers."</span>
    (<span class="org-keyword">when</span> (derived-mode-p 'org-mode)
      (org-with-wide-buffer
       (goto-char (point-min))
       (<span class="org-keyword">let</span> ((case-fold-search t)
             (inline-re (and (<span class="org-keyword">featurep</span> '<span class="org-constant">org-inlinetask</span>)
                             (concat (org-inlinetask-outline-regexp)
                                     <span class="org-string">"END[ \t]*$"</span>))))
         (org-map-entries
          (<span class="org-keyword">lambda</span> ()
            (<span class="org-keyword">unless</span> (and inline-re (org-looking-at-p inline-re))
              (<span class="org-keyword">save-excursion</span>
                (<span class="org-keyword">let</span> ((end (<span class="org-keyword">save-excursion</span> (outline-next-heading) (point))))
                  (forward-line)
                  (<span class="org-keyword">when</span> (org-looking-at-p org-planning-line-re) <span class="org-comment-delimiter">; </span><span class="org-comment">Org-8.3.</span>
                    (forward-line))
                  (<span class="org-keyword">when</span> (and (&lt; (point) end)
                             (not (org-looking-at-p org-property-drawer-re))
                             (<span class="org-keyword">save-excursion</span>
                               (and (re-search-forward org-property-drawer-re end t)
                                    (eq (org-element-type
                                         (<span class="org-keyword">save-match-data</span> (org-element-at-point)))
                                        'drawer))))
                    (insert (delete-and-extract-region
                             (match-beginning 0)
                             (min (1+ (match-end 0)) end)))
                    (<span class="org-keyword">unless</span> (bolp) (insert <span class="org-string">"\n"</span>))))))))))))

  (<span class="org-keyword">when</span> (boundp 'org-planning-line-re)
    (add-hook 'org-mode-hook 'org-repair-property-drawers))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline224" class="outline-4">
<h4 id="orgheadline224">Ispell</h4>
<div class="outline-text-4" id="text-orgheadline224">
<div class="note">
<p>The <code>leuven--org-switch-dictionary</code> function is called as well on each code block (at least, in emails that are being read), in buffers called <code>*fontification*</code>.</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--org-switch-dictionary</span> ()
    <span class="org-doc">"Set language if Flyspell is enabled and `#+LANGUAGE:' is on top 8 lines."</span>
    (<span class="org-keyword">when</span> (and (boundp 'ispell-dictionary-alist)
               ispell-dictionary-alist)
      (<span class="org-keyword">save-excursion</span>
        (goto-char (point-min))
        (forward-line 8)
        (<span class="org-keyword">let</span> (lang dict
              (dict-alist '((<span class="org-string">"en"</span> . <span class="org-string">"american"</span>)
                            (<span class="org-string">"fr"</span> . <span class="org-string">"francais"</span>))))
          (<span class="org-keyword">when</span> (re-search-backward <span class="org-string">"#\\+LANGUAGE: +</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">(</span></span><span class="org-string">[[:alpha:]_]*</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">)</span></span><span class="org-string">"</span> 1 t)
            (setq lang (match-string 1))
            (setq dict (cdr (assoc lang dict-alist)))
            (<span class="org-keyword">if</span> dict
                (<span class="org-keyword">progn</span>
                  (ispell-change-dictionary dict)
                  (force-mode-line-update))
              (message <span class="org-string">"No Ispell dictionary for language `</span><span class="org-constant"><span class="org-string">%s</span></span><span class="org-string">' (see file `</span><span class="org-constant"><span class="org-string">%s</span></span><span class="org-string">')"</span>
                       lang (file-name-base))
              (sit-for 1.5)))))))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Guess dictionary.</span>
  (add-hook 'org-mode-hook 'leuven--org-switch-dictionary)
</pre></div>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Avoid (error "Undefined dictionary: american")</b><br />
<p>when dictionaries are not installed. IN FACT, ISPELL IS NOT AT ALL INSTALLED!</p>
<p>Check out for valid dictionaries: (append ispell-local-dictionary-alist ispell-dictionary-alist)</p>
</div>
</div>
</div>
<div id="outline-container-orgheadline225" class="outline-4">
<h4 id="orgheadline225">Easy templates</h4>
<div class="outline-text-4 org-src-container" id="text-orgheadline225">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 15.2 (info "(org)Easy Templates")</span>

  (leuven--section <span class="org-string">"15.2 (org)Easy Templates"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"... Org Easy Templates"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Modify `</span><span class="org-constant"><span class="org-comment">org-structure-template-alist</span></span><span class="org-comment">' to keep lower-case easy templates.</span>
    (mapc (<span class="org-keyword">lambda</span> (asc)
            (<span class="org-keyword">let</span> ((org-sce-dc (downcase (nth 1 asc))))
              (setf (nth 1 asc) org-sce-dc)))
          org-structure-template-alist)

    (add-to-list 'org-structure-template-alist
                 '(<span class="org-string">"n"</span> <span class="org-string">"#+begin_note\n?\n#+end_note"</span>))

    (add-to-list 'org-structure-template-alist
                 '(<span class="org-string">"w"</span> <span class="org-string">"#+begin_warning\n?\n#+end_warning"</span>))

    (add-to-list 'org-structure-template-alist
                 '(<span class="org-string">"t"</span> <span class="org-string">"#+begin_tip\n?\n#+end_tip"</span>))

    (add-to-list 'org-structure-template-alist
                 '(<span class="org-string">"C"</span> <span class="org-string">"#+begin_comment\n?\n#+end_comment"</span>))

    (add-to-list 'org-structure-template-alist
                 '(<span class="org-string">"E"</span> <span class="org-string">"\\begin\{equation\}\n?\n\\end\{equation\}"</span> <span class="org-string">""</span>)))
</pre></div>
</div>
<div id="outline-container-orgheadline226" class="outline-4">
<h4 id="orgheadline226">Speed keys</h4>
<div class="outline-text-4" id="text-orgheadline226">
<p>Activate single letter commands (for example, outline navigation with <code>f</code>, <code>b</code>, <code>n</code>, and <code>p</code>) at beginning of a headline:</p>
<dl class="org-dl">
<dt><code>f</code></dt>
<dd><code>org-forward-same-level</code>.</dd>
<dt><code>b</code></dt>
<dd><code>org-backward-same-level</code>.</dd>
<dt><code>n</code></dt>
<dd><code>outline-next-visible-heading</code>.</dd>
<dt><code>p</code></dt>
<dd><code>outline-previous-visible-heading</code>.</dd>
</dl>
<p>For navigating blocks:</p>
<dl class="org-dl">
<dt>F</dt>
<dd><code>org-next-block</code>.</dd>
<dt>B</dt>
<dd><code>org-previous-block</code>.</dd>
</dl>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 15.3 (info "(org)Speed keys")</span>

  (leuven--section <span class="org-string">"15.3 (org)Speed keys"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"... Org Speek keys"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Activate single letter commands at beginning of a headline.</span>
    (setq org-use-speed-commands t)

    (add-to-list 'org-speed-commands-user '(<span class="org-string">"d"</span> org-todo <span class="org-string">"DONE"</span>))
    (add-to-list 'org-speed-commands-user '(<span class="org-string">"y"</span> org-todo-yesterday <span class="org-string">"DONE"</span>))
</pre></div>
</div>
<div id="outline-container-orgheadline227" class="outline-5">
<h5 id="orgheadline227">Convert Windows Apps key to Hyper</h5>
<div class="outline-text-5" id="text-orgheadline227">
<p>Here are more obvious key bindings to <b>execute</b> (than <code>C-c C-v C-e</code> and company) using "hyper":</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Run current line (mapped to H-r).</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Run from beginning of code block to current line (mapped to H-a?).</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Run from current line to end of code block (mapped to H-e?).</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Run current code block.</span>
    (define-key org-mode-map (kbd <span class="org-string">"H-e"</span>) 'org-babel-execute-maybe)

    (<span class="org-keyword">defun</span> <span class="org-function-name">org-babel-force-execute-src-block</span> ()
      <span class="org-doc">"Force execution of the current source code block."</span>
      (interactive)
      (org-babel-execute-src-block nil nil '((<span class="org-builtin">:eval</span> . <span class="org-string">"yes"</span>))))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Run current code block (force execution).</span>
    (define-key org-mode-map (kbd <span class="org-string">"H-f"</span>) 'org-babel-force-execute-src-block)
</pre></div>
<p>To <b>tangle</b>:</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (define-key org-mode-map (kbd <span class="org-string">"H-t"</span>) 'org-babel-tangle)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  )
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline228" class="outline-4">
<h4 id="orgheadline228">Code evaluation and security issues</h4>
<div class="outline-text-4" id="text-orgheadline228">
<p>For security resons, evaluation is not turned on by default.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 15.4 (info "(org)Code evaluation security") issues</span>

  (leuven--section <span class="org-string">"15.4 (org)Code evaluation security issues"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ob-core"</span>

    <span class="org-comment-delimiter">;;</span><span class="org-comment">!! Don't be prompted on every code block evaluation.</span>
    (setq org-confirm-babel-evaluate nil)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (<span class="org-keyword">defface</span> <span class="org-variable-name">org-block-executing</span>
      '((t (<span class="org-builtin">:background</span> <span class="org-string">"#FFE0FF"</span>)))
      <span class="org-doc">"Face used for the source block background when executed."</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Change the color of code blocks while they are being executed.</span>
    (<span class="org-keyword">defadvice</span> <span class="org-function-name">org-babel-execute-src-block</span> (around progress nil activate)
      <span class="org-doc">"Create an overlay indicating when code block is running."</span>
      (<span class="org-keyword">let</span> ((o (make-overlay (org-element-property <span class="org-builtin">:begin</span> (org-element-at-point))
                             (1- (org-element-property <span class="org-builtin">:end</span> (org-element-at-point))))))
        (recenter)
        (overlay-put o 'face 'org-block-executing)
        (measure-time <span class="org-string">"Executed code block"</span> ad-do-it)
        (delete-overlay o))))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline229" class="outline-4">
<h4 id="orgheadline229">A cleaner outline view</h4>
<div class="outline-text-4 org-src-container" id="text-orgheadline229">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 15.8 A (info "(org)Clean view")</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"... Org Clean view"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">15.8 Don't skip even levels for the outline.</span>
    (setq org-odd-levels-only nil))
</pre></div>
</div>
<div id="outline-container-orgheadline230" class="outline-4">
<h4 id="orgheadline230">Interaction with other packages</h4>
<div class="outline-text-4" id="text-orgheadline230">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 15.10 (info "(org)Interaction")</span>

  (leuven--section <span class="org-string">"15.10 (org)Interaction"</span>)
</pre></div>
<div class="note">
<p>On <span class="timestamp-wrapper"><span class="timestamp">[2015-05-01 Fri]</span></span>, in commit <code>49a656a</code>, Nicolas Goaziou has removed <code>org-babel-src-name-w-name-regexp</code>, and replaced it by the function call <code>(org-babel-named-src-block-regexp-for-name)</code>.</p>
<p>Until modification of the following code, it has been disabled, as it breaks Org</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Support shift-selection for making and enlarging regions when the cursor</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">is not in a special context.</span>
    (setq org-support-shift-select t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Maximum level for Imenu access to Org-mode headlines.</span>
    (setq org-imenu-depth 3)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Extension of Imenu.</span>
    (<span class="org-keyword">when</span> (and (<span class="org-keyword">featurep</span> '<span class="org-constant">ob-core</span>)      <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">org-babel</span></span><span class="org-comment">' has been loaded.</span>
               (<span class="org-keyword">featurep</span> '<span class="org-constant">imenu</span>))       <span class="org-comment-delimiter">; </span><span class="org-comment">Imenu has been loaded.</span>

      (setq org-src-blocks-imenu-generic-expression
            `((<span class="org-string">"Snippets"</span> ,org-babel-src-name-w-name-regexp 2)))

      (add-hook 'org-mode-hook
                (<span class="org-keyword">lambda</span> ()
                  (setq imenu-generic-expression
                        org-src-blocks-imenu-generic-expression))))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Alternative to Imenu.</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">dan/find-in-buffer</span> ()
      (interactive)
      (<span class="org-keyword">let</span> ((targets
             `((<span class="org-string">"&lt;named src blocks&gt;"</span> . ,org-babel-src-name-regexp)
               (<span class="org-string">"&lt;src block results&gt;"</span> . ,org-babel-result-regexp))))
        (occur
         (cdr
          (assoc
           (completing-read <span class="org-string">"Find: "</span> (mapcar #'car targets)) targets)))
        (other-window 1))))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline231" class="outline-4">
<h4 id="orgheadline231">Org-crypt</h4>
<div class="outline-text-4" id="text-orgheadline231">
<p>Org-crypt provides for encrypting individual entries in an otherwise non-encrypted file.</p>
<p>To later decrypt an entry that's encrypted, use <code>M-x org-decrypt-entry</code> or <code>C-c C-r</code> (fits nicely with the meaning of "reveal").</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Keep my encrypted data (like account passwords) in my Org mode files with</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">a special tag instead.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"... Org Crypt"</span>)

    (try-require 'org-crypt))           <span class="org-comment-delimiter">; </span><span class="org-comment">loads org, gnus-sum, etc...</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-crypt"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Encrypt all entries before saving.</span>
    (org-crypt-use-before-save-magic)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Which tag is used to mark headings to be encrypted.</span>
    (setq org-tags-exclude-from-inheritance '(<span class="org-string">"crypt"</span>)))
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline232" class="outline-3">
<h3 id="orgheadline232">Other</h3>
<div class="outline-text-3" id="text-orgheadline232">
<p>Anonymize Org contents (sanitize the sensitive data).</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-org-scramble-contents</span> ()
    (interactive)
    (<span class="org-keyword">let</span> ((tree (org-element-parse-buffer)))
      (org-element-map tree
          '(code comment comment-block example-block fixed-width keyword link
            node-property plain-text verbatim)
        (<span class="org-keyword">lambda</span> (obj)
          (<span class="org-keyword">cl-case</span> (org-element-type obj)
            ((code comment comment-block example-block fixed-width keyword
              node-property verbatim)
             (<span class="org-keyword">let</span> ((value (org-element-property <span class="org-builtin">:value</span> obj)))
               (org-element-put-property
                obj <span class="org-builtin">:value</span> (replace-regexp-in-string <span class="org-string">"[[:alnum:]]"</span> <span class="org-string">"x"</span> value))))
            (link
             (<span class="org-keyword">unless</span> (string= (org-element-property <span class="org-builtin">:type</span> obj) <span class="org-string">"radio"</span>)
               (org-element-put-property obj <span class="org-builtin">:raw-link</span> <span class="org-string">"http://orgmode.org"</span>)))
            (plain-text
             (org-element-set-element
              obj (replace-regexp-in-string <span class="org-string">"[[:alnum:]]"</span> <span class="org-string">"x"</span> obj)))))
        nil nil nil t)
      (<span class="org-keyword">let</span> ((buffer (get-buffer-create <span class="org-string">"*Scrambled text*"</span>)))
        (<span class="org-keyword">with-current-buffer</span> buffer
          (insert (org-element-interpret-data tree))
          (goto-char (point-min)))
        (switch-to-buffer buffer))))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't pad tangled code with newlines.</span>
  (setq org-babel-tangle-pad-newline nil)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">How to combine blocks of the same name during tangling.</span>
  (setq org-babel-tangle-named-block-combination 'append)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Speed up tangling dramatically (a couple of orders of magnitude).</span>
  (setq org-babel-use-quick-and-dirty-noweb-expansion t)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">:noweb-ref feature must NOT be used!</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Minimum number of lines for output *block* (placed in a</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">#+begin_example...#+end_example) vs. output marked as literal by</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">inserting a *colon* at the beginning of the lines.</span>
  (setq org-babel-min-lines-for-block-output 2)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; </span><span class="org-leuven-highlight"><span class="org-comment">FIXME</span></span><span class="org-comment"> Make this the default behavior</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Grab the last line too, when selecting a subtree.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(org-end-of-subtree nil t)</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Backend aware export preprocess hook.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--org-export-preprocess-hook</span> ()
    <span class="org-doc">"Backend-aware export preprocess hook."</span>
    (<span class="org-keyword">save-excursion</span>
      (<span class="org-keyword">when</span> (eq org-export-current-backend 'latex)
        <span class="org-comment-delimiter">;; </span><span class="org-comment">ignoreheading tag for bibliographies and appendices.</span>
        (<span class="org-keyword">let*</span> ((tag <span class="org-string">"ignoreheading"</span>))
          <span class="org-comment-delimiter">;; </span><span class="org-comment">(goto-char (point-min))</span>
          <span class="org-comment-delimiter">;; </span><span class="org-comment">(while (re-search-forward (concat ":" tag ":") nil t)</span>
          <span class="org-comment-delimiter">;; </span><span class="org-comment">(delete-region (point-at-bol) (point-at-eol)))</span>
          (org-map-entries
           (<span class="org-keyword">lambda</span> ()
             (delete-region (point-at-bol) (point-at-eol)))
           (concat <span class="org-string">":"</span> tag <span class="org-string">":"</span>))))
      (<span class="org-keyword">when</span> (eq org-export-current-backend 'html)
        <span class="org-comment-delimiter">;; </span><span class="org-comment">set custom css style class based on matched tag</span>
        (<span class="org-keyword">let*</span> ((match <span class="org-string">"Qn"</span>))
          (org-map-entries
           (<span class="org-keyword">lambda</span> ()
             (org-set-property <span class="org-string">"HTML_CONTAINER_CLASS"</span> <span class="org-string">"inlinetask"</span>))
           match)))))

  (add-hook 'org-export-preprocess-hook 'leuven--org-export-preprocess-hook)
</pre></div>
<p>Promote ignoreheading. Works in ASCII backend too:</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class="org-function-name">yz/org-export-ignore-headline</span> (backend)
    <span class="org-doc">"Ignore headlines with tag `</span><span class="org-constant"><span class="org-doc">ignoreheading</span></span><span class="org-doc">'."</span>
    (<span class="org-keyword">save-excursion</span>
      (<span class="org-keyword">let</span> ((org-allow-promoting-top-level-subtree t))
        (org-map-entries
         (<span class="org-keyword">lambda</span> ()
           (<span class="org-keyword">when</span> (member <span class="org-string">"ignoreheading"</span> (org-get-tags-at nil 'local))
             (org-promote-subtree)
             (delete-region (line-beginning-position) (line-end-position))))))))

  (add-hook 'org-export-before-parsing-hook 'yz/org-export-ignore-headline)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class="org-function-name">insert-one-equal-or-two</span> ()
    (interactive)
    (<span class="org-keyword">cond</span>
     ((or (bolp) (not (looking-back <span class="org-string">"="</span>)))
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Insert just one =.</span>
      (self-insert-command 1))
     ((<span class="org-keyword">save-excursion</span>
        (backward-char)
        <span class="org-comment-delimiter">;; </span><span class="org-comment">Skip symbol backwards.</span>
        (and (not (zerop (skip-syntax-backward <span class="org-string">"w_"</span>)))
             (not (looking-back <span class="org-string">"="</span>))
             (or (insert-and-inherit <span class="org-string">"="</span>) t))))
     (t
      <span class="org-comment-delimiter">;; </span><span class="org-comment">insert == around following symbol.</span>
      (delete-char -1)
      (<span class="org-keyword">unless</span> (looking-back <span class="org-string">"="</span>) (insert-and-inherit <span class="org-string">"="</span>))
      (<span class="org-keyword">save-excursion</span>
        (skip-syntax-forward <span class="org-string">"w_"</span>)
        (<span class="org-keyword">unless</span> (looking-at <span class="org-string">"="</span>) (insert-and-inherit <span class="org-string">"="</span>))))))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Must be in eval-after-load "org"?</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key org-mode-map (kbd "=") 'insert-one-equal-or-two)</span>
</pre></div>
<p>Export the current subtree into an email body, using <b>properties</b> to populate the mail message:</p>
<ul class="org-ul">
<li><code>MAIL_SUBJECT</code> or subtree heading -&gt; "Subject"</li>
<li><code>MAIL_TO</code> -&gt; "To"</li>
<li><code>MAIL_CC</code> -&gt; "Cc</li>
<li><code>MAIL_BCC</code> -&gt; "BCc"</li>
<li><code>MAIL_FMT</code> -&gt; determines the format of the email (e.g., <code>org</code> by default, <code>ascii</code> or <code>html</code>)</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"... Org Mime"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Using Org mode to send buffer/subtree per mail.</span>
    (try-require 'org-mime))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-mime"</span>

    (add-hook 'org-mode-hook
              (<span class="org-keyword">lambda</span> ()
                (local-set-key (kbd <span class="org-string">"C-c m"</span>) 'org-mime-subtree)))

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-mail-subtree</span> ()
      (interactive)
      (org-agenda-goto)
      (org-mime-subtree))

    (add-hook 'org-agenda-mode-hook
              (<span class="org-keyword">lambda</span> ()
                (local-set-key (kbd <span class="org-string">"C-c m"</span>) 'leuven-mail-subtree)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add a `</span><span class="org-constant"><span class="org-comment">mail_composed</span></span><span class="org-comment">' property with the current time when</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">org-mime-subtree</span></span><span class="org-comment">' is called.</span>
    (add-hook 'org-mime-send-subtree-hook
              (<span class="org-keyword">lambda</span> ()
                (org-entry-put (point) <span class="org-string">"mail_composed"</span>
                               (current-time-string)))))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline233" class="outline-3">
<h3 id="orgheadline233">A.3 Adding hyperlink types</h3>
<div class="outline-text-3" id="text-orgheadline233">
<p>For more flexibility, you can use a URL-like syntax which could then export conditionally on the output format.</p>
<p>See <a href="http://orgmode.org/worg/org-tutorials/org-latex-export.html#sec-10-3">http://orgmode.org/worg/org-tutorials/org-latex-export.html#sec-10-3</a></p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** A.3 (info "(org)Adding hyperlink types")</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"... Org Adding hyperlink types"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Define a new link type (`</span><span class="org-constant"><span class="org-comment">latex</span></span><span class="org-comment">') whose path argument can hold the name of</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">any LaTeX command.</span>
    (org-add-link-type
     <span class="org-string">"latex"</span> nil
     (<span class="org-keyword">lambda</span> (path desc format)
       (<span class="org-keyword">cond</span>
        ((eq format 'html)
         (format <span class="org-string">"&lt;span class=\"%s\"&gt;%s&lt;/span&gt;"</span> path desc))
        ((eq format 'latex)
         (format <span class="org-string">"\\%s{%s}"</span> path desc)))))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add background color by using custom links like [[bgcolor:red][Warning!]].</span>
    (org-add-link-type
      <span class="org-string">"bgcolor"</span> nil
      (<span class="org-keyword">lambda</span> (path desc format)
       (<span class="org-keyword">cond</span>
        ((eq format 'html)
         (format <span class="org-string">"&lt;span style=\"background-color:%s;\"&gt;%s&lt;/span&gt;"</span> path desc))
        ((eq format 'latex)
         (format <span class="org-string">"\\colorbox{%s}{%s}"</span> path desc))
        (t
         (format <span class="org-string">"BGCOLOR LINK (%s): {%s}{%s}"</span> format path desc))))))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline234" class="outline-3">
<h3 id="orgheadline234">A.5 Tables and lists in arbitrary syntax</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline234">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-org-send-all-buffer-tables</span> ()
    <span class="org-doc">"Export all Org tables of the LaTeX document to their corresponding LaTeX tables."</span>
     (interactive)
     (org-table-map-tables
        (<span class="org-keyword">lambda</span> () (orgtbl-send-table 'maybe))))
</pre></div>
</div>
<div id="outline-container-orgheadline235" class="outline-3">
<h3 id="orgheadline235">A.6 Dynamic blocks</h3>
<div class="outline-text-3" id="text-orgheadline235">
<div class="note">
<p>For some (yet) unknown reason, <code>leuven-org-update-buffer</code> gets added to a local copy of the global variable <code>before-save-hook</code>. We now decided to add it to the hook outside of Org (not anymore in an <code>with-eval-after-load</code> form).</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** A.6 (info "(org)Dynamic blocks")</span>

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-org-update-buffer</span> ()
    <span class="org-doc">"Update all dynamic blocks and all tables in the buffer."</span>
    (interactive)
    (<span class="org-keyword">when</span> (derived-mode-p 'org-mode)
      (message <span class="org-string">"(Info) Update Org buffer %s"</span>
               (file-name-nondirectory (buffer-file-name)))
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(sit-for 1.5)</span>
      (<span class="org-keyword">let</span> ((cache-long-scans nil)    <span class="org-comment-delimiter">; </span><span class="org-comment">Make `</span><span class="org-constant"><span class="org-comment">forward-line</span></span><span class="org-comment">' much faster and</span>
                                      <span class="org-comment-delimiter">; </span><span class="org-comment">thus `</span><span class="org-constant"><span class="org-comment">org-goto-line</span></span><span class="org-comment">', `</span><span class="org-constant"><span class="org-comment">org-table-sum</span></span><span class="org-comment">',</span>
                                      <span class="org-comment-delimiter">; </span><span class="org-comment">etc.</span>
            (flyspell-mode-before-save flyspell-mode)
            (buffer-undo-list buffer-undo-list)) <span class="org-comment-delimiter">; </span><span class="org-comment">For goto-chg.</span>
        (flyspell-mode -1)            <span class="org-comment-delimiter">; </span><span class="org-comment">Temporarily disable Flyspell to avoid</span>
                                      <span class="org-comment-delimiter">; </span><span class="org-comment">checking the following modifications</span>
                                      <span class="org-comment-delimiter">; </span><span class="org-comment">of the buffer.</span>
        (measure-time <span class="org-string">"Realigned all tags"</span> (org-align-all-tags))
        (measure-time <span class="org-string">"Updated all dynamic blocks"</span> (org-update-all-dblocks))
        (measure-time <span class="org-string">"Re-applied formulas to all tables"</span>
                      (org-table-iterate-buffer-tables))
        (<span class="org-keyword">when</span> (file-exists-p (buffer-file-name (current-buffer)))
          (leuven-org-remove-redundant-tags))
        (<span class="org-keyword">when</span> flyspell-mode-before-save (flyspell-mode 1)))))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Make sure that all dynamic blocks and all tables are always up-to-date.</span>
  (add-hook 'before-save-hook 'leuven-org-update-buffer)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline239" class="outline-3">
<h3 id="orgheadline239">Org-contrib</h3>
<div class="outline-text-3" id="text-orgheadline239"></div>
<div id="outline-container-orgheadline236" class="outline-4">
<h4 id="orgheadline236">Org-effectiveness</h4>
<div class="outline-text-4 org-src-container" id="text-orgheadline236">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "org"</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(message "... Org Effectiveness")</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(try-require 'org-effectiveness)</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(with-eval-after-load "org-effectiveness"</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;     </span><span class="org-comment">(add-hook 'org-mode-hook</span>
  <span class="org-comment-delimiter">;;               </span><span class="org-comment">(lambda ()</span>
  <span class="org-comment-delimiter">;;                 </span><span class="org-comment">(org-effectiveness-count-todo)</span>
  <span class="org-comment-delimiter">;;                 </span><span class="org-comment">(sit-for 0.2)))))</span>
</pre></div>
</div>
<div id="outline-container-orgheadline237" class="outline-4">
<h4 id="orgheadline237">Org-notmuch</h4>
<div class="outline-text-4" id="text-orgheadline237">
<p>Link emails from Org files.</p>
</div>
</div>
<div id="outline-container-orgheadline238" class="outline-4">
<h4 id="orgheadline238">Google Weather</h4>
<div class="outline-text-4" id="text-orgheadline238">
<pre class="example">
* Weather

%%(org-google-weather "Lille" "en-gb")
</pre>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (GNUEmacs
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add weather forecast in your Org agenda.</span>
    (autoload 'org-google-weather <span class="org-string">"org-google-weather"</span>
      <span class="org-doc">"Return Org entry with the weather for LOCATION in LANGUAGE."</span> t)

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-google-weather"</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(try-require 'url)</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Add the city.</span>
      (setq org-google-weather-format <span class="org-string">"%C %i %c, %l-%h"</span>)))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 25.9-org-mode ends here</span>
</pre></div>
</div>
</div>
</div>
</div>
<div id="outline-container-orgheadline240" class="outline-2">
<h2 id="orgheadline240">TeX</h2>
<div class="outline-text-2 org-src-container" id="text-orgheadline240">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 25.10 (info "(emacs)TeX Mode")</span>

(leuven--chapter leuven-load-chapter-25.10-tex-mode <span class="org-string">"25.10 TeX Mode"</span>
</pre></div>
<div id="outline-container-orgheadline241" class="outline-3">
<h3 id="orgheadline241">Native TeX Mode</h3>
<div class="outline-text-3" id="text-orgheadline241">
<dl class="org-dl">
<dt>(la)tex-mode</dt>
<dd>Default Emacs built-in (La)TeX mode (menu <code>TeX</code>; text <code>LaTeX</code> displayed in the mode line).</dd>
</dl>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (leuven--section <span class="org-string">"25.10 (emacs)TeX Mode"</span>)
</pre></div>
<p>Under Windows, in the <b>native</b> TeX mode, <code>shell-file-name</code> must be <code>cmdproxy.exe</code> to:</p>
<ul class="org-ul">
<li>avoid the error "comint-send-string: writing to process: invalid argument, tex-shell", and</li>
<li>properly quote <code>tex-start-commands</code>.</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Get colored PDFLaTeX output.</span>
  (<span class="org-keyword">define-derived-mode</span> <span class="org-function-name">latex-output-mode</span> fundamental-mode <span class="org-string">"LaTeX-Output"</span>
    <span class="org-doc">"Simple mode for colorizing LaTeX output."</span>
    (set (make-local-variable 'font-lock-defaults)
         '(((<span class="org-string">"^!.*"</span> .
             compilation-error-face)    <span class="org-comment-delimiter">; </span><span class="org-comment">LaTeX error</span>
            (<span class="org-string">"^-+$"</span> .
             compilation-info-face)     <span class="org-comment-delimiter">; </span><span class="org-comment">Latexmk separator</span>
            (<span class="org-string">"^Package .* Warning: .*"</span> .
             compilation-warning-face)
            (<span class="org-string">"Reference .* undefined"</span> .
             compilation-warning-face)
            (<span class="org-string">"^</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">(?:</span></span><span class="org-string">Overfull</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">|</span></span><span class="org-string">Underfull</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">|</span></span><span class="org-string">Tight</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">|</span></span><span class="org-string">Loose</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">)</span></span><span class="org-string">.*"</span> .
             font-lock-string-face)
            (<span class="org-string">"^LaTeX Font Warning:"</span> .
             font-lock-string-face)
            <span class="org-comment-delimiter">;; </span><span class="org-comment">...</span>
            ))))

  (<span class="org-keyword">defadvice</span> <span class="org-function-name">TeX-recenter-output-buffer</span>
    (after leuven-colorize-latex-output activate)
    (<span class="org-keyword">with-selected-window</span> (get-buffer-window (TeX-active-buffer))
      (latex-output-mode)))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline242" class="outline-3">
<h3 id="orgheadline242">AUCTeX</h3>
<div class="outline-text-3" id="text-orgheadline242">
<dl class="org-dl">
<dt>(La)TeX-mode</dt>
<dd>AUCTeX (menus <code>Preview</code>, <code>LaTeX</code>, <code>Command</code> and <code>Ref</code>; text <code>LaTeX/P</code> displayed in the mode line).</dd>
</dl>
<p>AUCTeX supports TeX and extensions such as LaTeX. For LaTeX, there is a (major) <code>LaTeX-mode</code> in AUCTeX which runs (in this order):</p>
<ol class="org-ol">
<li><code>text-mode-hook</code>, then</li>
<li><code>TeX-mode-hook</code>, and then</li>
<li>a hook <code>LaTeX-mode-hook</code> special to the LaTeX mode.</li>
</ol>
<p>If you need to make a customization via a hook which is only relevant for the LaTeX mode, put it into the <code>LaTeX-mode-hook</code>; if it is relevant for any AUCTeX mode, add it to <code>TeX-mode-hook</code> and if it is relevant for all text modes, append it to <code>text-mode-hook</code>.</p>
<p>AUCTeX defines the <code>tex-mode.el</code> mode names as alias of its own modes: it aliases <code>(la)tex-mode</code> to <code>(La)TeX-mode</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (leuven--section <span class="org-string">"25.10 (emacs)AUCTeX Mode"</span>)

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 1.2 (info "(auctex)Installation") of AUCTeX</span>

  (try-require 'tex-site)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Support for LaTeX documents.</span>
  (GNUEmacs
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"latex"</span>
</pre></div>
<p>You can detect the <b>successful activation of AUCTeX</b>: after loading a LaTeX file, AUCTeX gives you a <code>Command</code> menu.</p>
<ul class="org-ul">
<li>Press <code>C-c C-c File &lt;RET&gt; &lt;RET&gt;</code> to run <code>dvips</code> (note that the command is <code>File</code> and not <code>Dvips</code> as one might expect)</li>
<li>Press <code>C-c C-c Print &lt;RET&gt; &lt;RET&gt;</code> to run <code>GSview</code> (also somewhat misleading name)</li>
<li>If you want to print the document, do it from <code>GSview</code>.</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
      <span class="org-comment-delimiter">;; </span><span class="org-comment">;; LaTeX-sensitive spell checking</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'tex-mode-hook</span>
      <span class="org-comment-delimiter">;;           </span><span class="org-comment">(lambda ()</span>
      <span class="org-comment-delimiter">;;             </span><span class="org-comment">(make-local-variable 'ispell-parser)</span>
      <span class="org-comment-delimiter">;;             </span><span class="org-comment">(setq ispell-parser 'tex)))</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 2.1 (info "(auctex)Quotes")</span>

      (leuven--section <span class="org-string">"2.1 (auctex)Quotes"</span>)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Insert right brace with suitable macro after typing left brace.</span>
      (setq LaTeX-electric-left-right-brace t)

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 2.6 (info "(auctex)Completion")</span>

      (leuven--section <span class="org-string">"2.6 (auctex)Completion"</span>)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">If this is non-nil when AUCTeX is loaded, the TeX escape character `\'</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">will be bound to `</span><span class="org-constant"><span class="org-comment">TeX-electric-macro</span></span><span class="org-comment">'.</span>
      (setq TeX-electric-escape t)

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 2.8 (info "(auctex)Indenting")</span>

      (leuven--section <span class="org-string">"2.8 (auctex)Indenting"</span>)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Leave the `</span><span class="org-constant"><span class="org-comment">tikzpicture</span></span><span class="org-comment">' code unfilled when doing `</span><span class="org-constant"><span class="org-comment">M-q</span></span><span class="org-comment">'.</span>
      (add-to-list 'LaTeX-indent-environment-list '(<span class="org-string">"tikzpicture"</span>))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Auto-indentation (suggested by the AUCTeX manual -- instead of adding</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">a local key binding to `</span><span class="org-constant"><span class="org-comment">&lt;RET&gt;</span></span><span class="org-comment">' in the `</span><span class="org-constant"><span class="org-comment">LaTeX-mode-hook</span></span><span class="org-comment">').</span>
      (setq TeX-newline-function 'newline-and-indent)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 3 Controlling Screen (info "(auctex)Display")</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 3.1 (info "(auctex)Font Locking")</span>

      (leuven--section <span class="org-string">"3.1 (auctex)Font Locking"</span>)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">(for Org mode) Add the `</span><span class="org-constant"><span class="org-comment">comment</span></span><span class="org-comment">' environment to the variable</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">LaTeX-verbatim-environments</span></span><span class="org-comment">' so that, if the `#+TBLFM' line contains</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">an odd number of dollar characters, this does not cause problems with</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">font-lock in LaTeX-mode.</span>
      (add-to-list 'LaTeX-verbatim-environments <span class="org-string">"comment"</span>)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 4.1 Executing (info "(auctex)Commands")</span>

      (leuven--section <span class="org-string">"4.1 Executing (auctex)Commands"</span>)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Add a command to execute on the LaTeX document.</span>
      (add-to-list 'TeX-command-list
                   '(<span class="org-string">"XeLaTeX"</span> <span class="org-string">"%`xelatex%(mode)%' %t"</span> TeX-run-TeX nil t))

      (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--LaTeX-mode-hook</span> ()
        <span class="org-comment-delimiter">;; </span><span class="org-comment">Default command to run in the LaTeX buffer.</span>
        (setq TeX-command-default
              (<span class="org-keyword">save-excursion</span>
                (<span class="org-keyword">save-restriction</span>
                  (widen)
                  (goto-char (point-min))
                  (<span class="org-keyword">let</span> ((re (concat
                             <span class="org-string">"^\\s-*\\\\usepackage</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">(?:</span></span><span class="org-string">\\[.*\\]</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">)</span></span><span class="org-string">?"</span>
                             <span class="org-string">"{.*\\&lt;</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">(?:</span></span><span class="org-string">font</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">|</span></span><span class="org-string">math</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">)</span></span><span class="org-string">spec\\&gt;.*}"</span>)))
                    (<span class="org-keyword">save-match-data</span>
                      (<span class="org-keyword">if</span> (re-search-forward re 3000 t)
                          <span class="org-string">"XeLaTeX"</span>
                        <span class="org-string">"LaTeX"</span>)))))))

      (add-hook 'LaTeX-mode-hook 'leuven--LaTeX-mode-hook)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't ask user for permission to save files before starting TeX.</span>
      (setq TeX-save-query nil)

      (<span class="org-keyword">defun</span> <span class="org-function-name">TeX-default</span> ()
        <span class="org-doc">"Choose the default command from `C-c C-c'."</span>
        (interactive)
        (TeX-save-document <span class="org-string">""</span>)          <span class="org-comment-delimiter">; </span><span class="org-comment">or just use `</span><span class="org-constant"><span class="org-comment">TeX-save-query</span></span><span class="org-comment">'</span>
        (execute-kbd-macro (kbd <span class="org-string">"C-c C-c RET"</span>)))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Rebind the "compile command" to default command from `C-c C-c' (in</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">LaTeX mode only).</span>
      (define-key LaTeX-mode-map (kbd <span class="org-string">"&lt;f9&gt;"</span>) 'TeX-default)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Use PDF mode by default (instead of DVI).</span>
      (setq-default TeX-PDF-mode t)
</pre></div>
<p>A decent viewer reloads the PDF automatically when the file has changed while staying on the same page (no need to close &amp; reopen).</p>
<p>Support for forward search with PDF files means that the viewer jumps to the page in the output file corresponding to the position in the source file. Currently, this only works if you use the pdfsync LaTeX package and xpdf or SumatraPDF as your PDF viewer.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 4.2 (info "(auctex)Viewing") the formatted output</span>

      (leuven--section <span class="org-string">"4.2 (auctex)Viewing the formatted output"</span>)

      (<span class="org-keyword">defvar</span> <span class="org-variable-name">sumatrapdf-command</span>
        (concat leuven--windows-program-files-dir <span class="org-string">"SumatraPDF/SumatraPDF.exe"</span>)
        <span class="org-doc">"Path to the SumatraPDF executable."</span>)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Use a saner PDF viewer (evince, SumatraPDF).</span>
      (setcdr (assoc <span class="org-string">"^pdf$"</span> TeX-output-view-style)
              (<span class="org-keyword">cond</span> ((or leuven--win32-p
                         leuven--cygwin-p)
                     `(<span class="org-string">"."</span> (concat <span class="org-string">"\""</span> ,sumatrapdf-command <span class="org-string">"\" %o"</span>)))
                    <span class="org-comment-delimiter">;; </span><span class="org-comment">under Windows, we could open the PDF file with</span>
                    <span class="org-comment-delimiter">;; </span><span class="org-comment">`start "" xxx.pdf' (in a command prompt)</span>
                    (t
                     '(<span class="org-string">"."</span> <span class="org-string">"evince %o"</span>))))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">For AUCTeX 11.86+.</span>
      (<span class="org-keyword">when</span> (boundp 'TeX-view-program-list)
        (add-to-list 'TeX-view-program-list
                     `(<span class="org-string">"SumatraPDF"</span>
                       (concat <span class="org-string">"\""</span> ,sumatrapdf-command <span class="org-string">"\" %o"</span>))))

      (<span class="org-keyword">when</span> (or leuven--win32-p
                leuven--cygwin-p)
        (setcdr (assoc 'output-pdf TeX-view-program-selection)
                '(<span class="org-string">"SumatraPDF"</span>)))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 4.7 (info "(auctex)Documentation")</span>
</pre></div>
<p><code>C-c ?</code> (or <code>M-x TeX-doc</code>) displays documentation for a package.</p>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> TeX-doc does not provide a list of available keywords for completion</b><br />
<p>Nor a default when point is on a command name</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 5.2 (info "(auctex)Multifile") Documents</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Assume that the file is a master file itself.</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq-default TeX-master t)</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 5.3 Automatic (info "(auctex)Parsing Files")</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable parse on load (if no style hook is found for the file).</span>
      (setq TeX-parse-self t)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable automatic save of parsed style information when saving the</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">buffer.</span>
      (setq TeX-auto-save t)

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 5.4 (info "(auctex)Internationalization")</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Insert a literal hyphen </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq LaTeX-babel-insert-hyphen nil)</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 5.5 (info "(auctex)Automatic") Customization</span>

      <span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment"> Add beamer.el to TeX-style-path</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">*** 5.5.1 (info "(auctex)Automatic Global") Customization for the Site</span>

      (leuven--section <span class="org-string">"5.5.1 (auctex)Automatic Global Customization for the Site"</span>)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Directory containing automatically generated TeX information.</span>
      (setq TeX-auto-global
            (concat user-emacs-directory <span class="org-string">"auctex-auto-generated-info/"</span>))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Must end with a slash.</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">*** 5.5.3 (info "(auctex)Automatic Local") Customization for a Directory</span>

      (leuven--section <span class="org-string">"5.5.3 (auctex)Automatic Local Customization for a Directory"</span>)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Directory containing automatically generated TeX information.</span>
      (setq TeX-auto-local (concat user-emacs-directory <span class="org-string">"auctex-auto-generated-info/"</span>))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Must end with a slash.</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline243" class="outline-3">
<h3 id="orgheadline243">Preview-LaTeX</h3>
<div class="outline-text-3" id="text-orgheadline243">
<p>You can detect the successful activation of <code>preview-latex</code>: after loading a LaTeX file, <code>preview-latex</code> gives you a <code>Preview</code> menu.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(preview-latex)Top")</span>

      (leuven--section <span class="org-string">"(preview-latex)Top"</span>)

      (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"preview"</span>

        <span class="org-comment-delimiter">;; </span><span class="org-comment">Path to `</span><span class="org-constant"><span class="org-comment">gs</span></span><span class="org-comment">' command (for format conversions).</span>
        (setq preview-gs-command
          (<span class="org-keyword">cond</span> (leuven--win32-p
                 (or (executable-find <span class="org-string">"gswin32c.exe"</span>)
                     <span class="org-string">"C:/texlive/2014/tlpkg/tlgs/bin/gswin32c.exe"</span>))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Default value.</span>
                (t
                 <span class="org-string">"/usr/bin/gs"</span>)))
        (leuven--file-exists-and-executable-p preview-gs-command)

        <span class="org-comment-delimiter">;; </span><span class="org-comment">Scale factor for included previews.</span>
        (setq preview-scale-function 1.2))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline244" class="outline-3">
<h3 id="orgheadline244">RefTeX</h3>
<div class="outline-text-3" id="text-orgheadline244">
<p>AUCTeX is fantastic, and RefTeX just makes things better.</p>
<p>To fill in <code>\ref{}</code> and <code>\cite{}</code> commands, you can use <code>C-c &amp;</code> (<code>reftex-view-crossref</code>).</p>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Conflict with YASnippet prefix key and <code>org-mark-ring</code>-push</b><br />
nil</div>
<p>A Table of Contents of the entire (multifile) document with browsing capabilities is available with <code>C-c =</code>. Hitting <code>l</code> there will show all the labels and cites.</p>
<p>Labels can be created with <code>C-c (</code> and referenced with <code>C-c )</code>. When referencing, you get a menu with all labels of a given type and context of the label definition. The selected label is inserted as a <code>\ref</code> macro.</p>
<p>Citations can be made with <code>C-c [</code> which will use a regular expression to pull out a <b>formatted</b> list of articles from your BibTeX database. The selected citation is inserted as a <code>\cite</code> macro.</p>
<p>Index entries can be made with <code>C-c /</code> which indexes the word at point or the current selection. More general index entries are created with <code>C-c &lt;</code>. <code>C-c &gt;</code> displays the compiled index.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
      (add-hook 'LaTeX-mode-hook 'reftex-mode) <span class="org-comment-delimiter">; </span><span class="org-comment">with AUCTeX LaTeX mode</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Minor mode with distinct support for `\label', `\ref', `\cite' and</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">`\index' in LaTeX.</span>
      (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"reftex"</span>

        <span class="org-comment-delimiter">;; </span><span class="org-comment">Turn all plug-ins on.</span>
        (setq reftex-plug-into-AUCTeX t)

        <span class="org-comment-delimiter">;; </span><span class="org-comment">Use a separate selection buffer for each label type -- so the menu</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">generally comes up faster.</span>
        (setq reftex-use-multiple-selection-buffers t))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline245" class="outline-3">
<h3 id="orgheadline245">BibTeX</h3>
<div class="outline-text-3" id="text-orgheadline245">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
      <span class="org-comment-delimiter">;; </span><span class="org-comment">BibTeX mode.</span>
      (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"bibtex"</span>

        <span class="org-comment-delimiter">;; </span><span class="org-comment">Current BibTeX dialect.</span>
        (setq bibtex-dialect 'biblatex))

      ))                                <span class="org-comment-delimiter">; </span><span class="org-comment">with-eval-after-load "latex" ends here</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 25.10-tex-mode ends here</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline246" class="outline-2">
<h2 id="orgheadline246">SGML and HTML Modes</h2>
<div class="outline-text-2 org-src-container" id="text-orgheadline246">
<pre class="src src-emacs-lisp">
(leuven--chapter leuven-load-chapter-25-text <span class="org-string">"25 Commands for Human Languages"</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 25.11 (info "(emacs)HTML Mode")</span>

  (leuven--section <span class="org-string">"25.11 (emacs)HTML Mode"</span>)
</pre></div>
<div id="outline-container-orgheadline249" class="outline-3">
<h3 id="orgheadline249">HTML</h3>
<div class="outline-text-3" id="text-orgheadline249"></div>
<div id="outline-container-orgheadline247" class="outline-4">
<h4 id="orgheadline247">html-mode</h4>
<div class="outline-text-4" id="text-orgheadline247">
<p>The default HTML mode, derived from SGML mode (see the HTML and SGML menus), works quite well for editing HTML4 documents (whose tags don't have to close).</p>
<dl class="org-dl">
<dt><code>C-c C-v</code></dt>
<dd><b>View</b> your file <b>in your browser</b> (<code>browse-url-of-buffer</code>).</dd>
<dt><code>C-c C-b</code> (or <code>C-c &lt;left&gt;</code>)</dt>
<dd>Jump to the opening HTML tag (<code>sgml-skip-tag-backward</code>).</dd>
<dt><code>C-c C-f</code> (or <code>C-c &lt;right&gt;</code>)</dt>
<dd>Jump to the closing HTML tag (<code>sgml-skip-tag-forward</code>).</dd>
<dt><code>C-c TAB</code></dt>
<dd>Hide all of the angle-bracketed tags in the buffer (<code>sgml-tags-invisible</code>). This can be used as a cheap <b>preview</b> of <b>just the bare text</b>.</dd>
<dt><code>C-c /</code></dt>
<dd><code>sgml-close-tag</code>.</dd>
<dt><code>C-M-i</code></dt>
<dd><code>ispell-complete-word</code>.</dd>
</dl>
<p>Plug <a href="http://tidy.sourceforge.net/">HTML Tidy</a> with <code>tidy.el</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"tidy-autoloads"</span>
    (<span class="org-keyword">when</span> (executable-find <span class="org-string">"tidy"</span>)

      (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--html-mode-hook</span> ()
        <span class="org-doc">"Customize html(-helper)-mode."</span>

        <span class="org-comment-delimiter">;; </span><span class="org-comment">Set up a "tidy" menu in the menu bar.</span>
        (<span class="org-keyword">when</span> (boundp 'html-mode-map)
          (tidy-build-menu html-mode-map))
        (<span class="org-keyword">when</span> (boundp 'html-helper-mode-map)
          (tidy-build-menu html-helper-mode-map))

        <span class="org-comment-delimiter">;; </span><span class="org-comment">Bind the key sequence `C-c C-c' to `</span><span class="org-constant"><span class="org-comment">tidy-buffer</span></span><span class="org-comment">'.</span>
        (local-set-key (kbd <span class="org-string">"C-c C-c"</span>) 'tidy-buffer)

        (setq sgml-validate-command <span class="org-string">"tidy"</span>))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Also run from `</span><span class="org-constant"><span class="org-comment">html-helper-mode</span></span><span class="org-comment">'.</span>
      (add-hook 'html-mode-hook 'leuven--html-mode-hook)))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline248" class="outline-4">
<h4 id="orgheadline248">html-helper-mode</h4>
<div class="outline-text-4" id="text-orgheadline248">
<p>You might also want to consider <code>html-helper-mode</code>, which has a lot more features than plain <code>html-mode</code>:</p>
<ul class="org-ul">
<li>autocompletion,</li>
<li>auto-insertion of closing tags and</li>
<li>a lot more.</li>
</ul>
<p>When you open a buffer for HTML editing, a didactic HTML menu appears, so you can use your mouse to invoke commands.</p>
<p>Using the prefix-arg (<code>C-u</code>) to relevant HTML tags, <code>html-helper-mode</code> will put tags around a region you've specified.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">when</span> (locate-library <span class="org-string">"html-helper-mode"</span>)

    (autoload 'html-helper-mode <span class="org-string">"html-helper-mode"</span>
      <span class="org-doc">"Mode for editing HTML documents."</span> t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Invoke html-helper-mode automatically on .html files.</span>
    (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.html?\\'"</span> . html-helper-mode))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Invoke html-helper-mode automatically on .asp files.</span>
    (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.asp\\'"</span> . html-helper-mode))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Invoke html-helper-mode automatically on .jsp files.</span>
    (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.jsp\\'"</span> . html-helper-mode)))
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline251" class="outline-3">
<h3 id="orgheadline251">XHTML</h3>
<div class="outline-text-3" id="text-orgheadline251">
<p><a href="#orgheadline250">nXML</a> seems to be the most recommended mode to view and edit well-formed <b>XHTML</b> (reformulation of HTML as an XML application).</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.xhtml?\\'"</span> . xml-mode))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">alias for `</span><span class="org-constant"><span class="org-comment">nxml-mode</span></span><span class="org-comment">'</span>
</pre></div>
<p>Alternatively, you can use <a href="http://ourcomments.org/Emacs/nXhtml/doc/nxhtml.html">nXhtml</a> mode, derived from nXML mode. It adds a lot of things useful for <b>XHTML</b> files with mixed content:</p>
<ul class="org-ul">
<li>handling <b>multiple major modes</b> (Mumamo) in one buffer (for CSS, JS, PHP and similar things): get the correct syntax highlighting and indentation for each of them,</li>
<li>folding,</li>
<li>improved interface to Tidy (?),</li>
<li>etc.</li>
</ul>
<p>Though, it takes a while to load.</p>
</div>
</div>
<div id="outline-container-orgheadline252" class="outline-3">
<h3 id="orgheadline252">web-mode</h3>
<div class="outline-text-3" id="text-orgheadline252">
<p><a href="http://web-mode.org/">web-mode</a> could be another alternative for editing HTML documents embedding CSS/JS and blocks (client/server side).</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"web-mode-autoloads"</span>
    (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.jsp\\'"</span> . web-mode))
    (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.aspx\\'"</span> . web-mode)))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline250" class="outline-3">
<h3 id="orgheadline250"><a id="ID-786a2051-476a-4277-82df-d8ebf8ba0e99" name="ID-786a2051-476a-4277-82df-d8ebf8ba0e99"></a>XML</h3>
<div class="outline-text-3" id="text-orgheadline250">
<p>nXML mode (default for editing XML files, since GNU Emacs 23.2) does:</p>
<ul class="org-ul">
<li>real-time <b>validation against a schema in RELAX NG</b> (actually RNC, i.e. the "Compact" Syntax): <code>C-c C-n</code> (assuming RNG validation is on),</li>
<li><b>code completion</b> against the RNG schema.</li>
</ul>
<p>Some key bindings:</p>
<dl class="org-dl">
<dt><code>C-M-p</code></dt>
<dd>Move backward over one element (<code>nxml-backward-element</code>).</dd>
<dt><code>C-M-n</code></dt>
<dd>Move forward over one element (<code>nxml-forward-element</code>).</dd>
<dt><code>C-M-u</code></dt>
<dd>Move up the element structure (<code>nxml-backward-up-element</code>).</dd>
<dt><code>C-M-d</code></dt>
<dd>Move down the element structure (<code>nxml-down-element</code>).</dd>
</dl>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"nxml-mode"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Remove the binding of `C-c C-x' (`</span><span class="org-constant"><span class="org-comment">nxml-insert-xml-declaration</span></span><span class="org-comment">'), used by</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Org timeclocking commands.</span>
    (define-key nxml-mode-map (kbd <span class="org-string">"C-c C-x"</span>) nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">View the buffer contents in a browser.</span>
    (define-key nxml-mode-map (kbd <span class="org-string">"C-c C-v"</span>) 'browse-url-of-buffer))
                                        <span class="org-comment-delimiter">; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment"> Normally bound to.</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">rng-validate-mode</span></span><span class="org-comment">'</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline253" class="outline-3">
<h3 id="orgheadline253">Highlight the closing tag</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline253">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Highlight the current SGML tag context.</span>
  (try-require 'hl-tags-mode)
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"hl-tags-mode"</span>

    (add-hook 'html-mode-hook
              (<span class="org-keyword">lambda</span> ()
                (<span class="org-keyword">require</span> '<span class="org-constant">sgml-mode</span>)
                <span class="org-comment-delimiter">;; </span><span class="org-comment">when `</span><span class="org-constant"><span class="org-comment">html-mode-hook</span></span><span class="org-comment">' is called from `</span><span class="org-constant"><span class="org-comment">html-helper-mode</span></span><span class="org-comment">'</span>
                (hl-tags-mode 1)))

    (add-hook 'nxml-mode-hook 'hl-tags-mode))
</pre></div>
</div>
<div id="outline-container-orgheadline254" class="outline-3">
<h3 id="orgheadline254">CSS</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline254">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment">: Handle media queries</span>
<span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment">: Handle wrapped lines</span>
<span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment">: Ignore vendor prefixes</span>
(<span class="org-keyword">defun</span> <span class="org-function-name">sort-css-properties</span> ()
  <span class="org-doc">"Sort CSS properties alphabetically."</span>
  (interactive)
  (<span class="org-keyword">let</span> ((start (search-forward <span class="org-string">"{"</span>))
        (end (search-forward <span class="org-string">"}"</span>)))
    (<span class="org-keyword">when</span> (and start end)
      (sort-lines nil start end)
      (sort-declarations))))
</pre></div>
</div>
<div id="outline-container-orgheadline255" class="outline-3">
<h3 id="orgheadline255">Skewer: live web development with Emacs</h3>
<div class="outline-text-3" id="text-orgheadline255">
<p>This lets you send HTML, CSS, and Javascript fragments to Google Chrome. You may need to start Chrome with <code>chrome --allow-running-insecure-content</code>, if you're using the user script with HTTPS sites.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 25 ends here</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline256" class="outline-2">
<h2 id="orgheadline256">Editing Programs</h2>
<div class="outline-text-2" id="text-orgheadline256">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 26 Editing (info "(emacs)Programs")</span>

(leuven--chapter leuven-load-chapter-26-programs <span class="org-string">"26 Editing Programs"</span>
</pre></div>
<p>Move the current line up or down.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Swap the current and previous line.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-move-line-up</span> ()
    <span class="org-doc">"Move the current line up."</span>
    (interactive)
    (transpose-lines 1)
    (forward-line -2))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Swap the current and next line.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-move-line-down</span> ()
    <span class="org-doc">"Move the current line down."</span>
    (interactive)
    (forward-line 1)
    (transpose-lines 1)
    (forward-line -1))

  (GNUEmacs24
    (add-hook 'prog-mode-hook
              (<span class="org-keyword">lambda</span> ()
                (local-set-key (kbd <span class="org-string">"&lt;C-S-up&gt;"</span>) 'leuven-move-line-up)
                (local-set-key (kbd <span class="org-string">"&lt;C-S-down&gt;"</span>) 'leuven-move-line-down))))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Sublime Text</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-scroll-up-one-line</span> ()
    <span class="org-doc">"Scroll text of current window upward 1 line."</span>
    (interactive)
    (scroll-up 1))

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-scroll-down-one-line</span> ()
    <span class="org-doc">"Scroll text of current window downward 1 line."</span>
    (interactive)
    (scroll-down 1))

  (GNUEmacs24
    (add-hook 'prog-mode-hook
              (<span class="org-keyword">lambda</span> ()
                (local-set-key (kbd <span class="org-string">"&lt;C-up&gt;"</span>) 'leuven-scroll-up-one-line)
                (local-set-key (kbd <span class="org-string">"&lt;C-down&gt;"</span>) 'leuven-scroll-down-one-line))))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Sublime Text + SQL Management Studio</span>
</pre></div>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Add "move view" up/down on C-up/down</b><br />
<p>See an example in SQL Server Management Studio</p>
</div>
</div>
<div id="outline-container-orgheadline257" class="outline-3">
<h3 id="orgheadline257">Major Modes for Programming Languages</h3>
<div class="outline-text-3" id="text-orgheadline257">
<p>Have a look at:</p>
<ul class="org-ul">
<li><a href="http://cedet.sourceforge.net/">CEDET</a> for development in AWK, C/C++, C#, Calc, Erlang, Java, Javascript, Make, PHP, Python, Ruby and Scheme,</li>
<li><a href="http://common-lisp.net/project/slime">SLIME</a> for Common Lisp development,</li>
<li>JDEE for Java programs.</li>
</ul>
<p>Emacs tool for Emacs Lisp code analysis (to keep overview of the function calls and dependecies between functions/variables): byte-compile-generate-call-tree</p>
<p>Also <code>who-calls.el</code></p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 26.1 Major Modes for (info "(emacs)Program Modes")</span>

  (leuven--section <span class="org-string">"26.1 Major Modes for (emacs)Program Modes"</span>)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline258" class="outline-3">
<h3 id="orgheadline258"><a id="ID-ea687cd8-fff0-461f-999e-c9fbc84b5901" name="ID-ea687cd8-fff0-461f-999e-c9fbc84b5901"></a>Top-Level Definitions, or Defuns</h3>
<div class="outline-text-3" id="text-orgheadline258">
<p>Imenu is a great tool allowing you to <b>go to a function definition</b> (by name), but only if the definition is <b>in the buffer you are currently editing</b> (it won't jump and open another file).</p>
<p>XXX Autoloaded?</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 26.2 Top-Level Definitions, or (info "(emacs)Defuns")</span>

  (leuven--section <span class="org-string">"26.2 Top-Level Definitions, or (emacs)Defuns"</span>)

  (GNUEmacs
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Making buffer indexes as menus.</span>
    (try-require 'imenu)                <span class="org-comment-delimiter">; </span><span class="org-comment">Awesome!</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"imenu"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Add Imenu to the menu bar in any mode that supports it.</span>
      (<span class="org-keyword">defun</span> <span class="org-function-name">try-to-add-imenu</span> ()
        (<span class="org-keyword">condition-case</span> nil
            (imenu-add-to-menubar <span class="org-string">"Imenu"</span>)
          (<span class="org-warning">error</span> nil)))
      (add-hook 'font-lock-mode-hook 'try-to-add-imenu)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Bind Imenu from the mouse.</span>
      (GNUEmacs (global-set-key [S-mouse-3] 'imenu))
      (XEmacs (global-set-key [(shift button3)] 'imenu))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">String to display in the mode line when current function is unknown.</span>
      (setq which-func-unknown <span class="org-string">"(Top Level)"</span>)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Show current function in mode line (based on Imenu).</span>
      (which-function-mode 1)           <span class="org-comment-delimiter">; </span><span class="org-comment">~ Stickyfunc mode (in header line)</span>
</pre></div>
<p>Truncate the current function name (for the mode line):</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
      (<span class="org-keyword">defun</span> <span class="org-function-name">my-which-func-current</span> ()
        (<span class="org-keyword">let</span> ((current (gethash (selected-window) which-func-table)))
          (<span class="org-keyword">if</span> current
              (truncate-string-to-width current 20 nil nil <span class="org-string">"..."</span>)
            which-func-unknown)))

      (setq which-func-format
            `(<span class="org-string">"["</span> (<span class="org-builtin">:propertize</span> (<span class="org-builtin">:eval</span> (my-which-func-current))
                               local-map ,which-func-keymap
                               face which-func
                               mouse-face mode-line-highlight
                               help-echo <span class="org-string">"mouse-1: go to beginning\n\</span>
<span class="org-string">mouse-2: toggle rest visibility\n\</span>
<span class="org-string">mouse-3: go to end"</span>) <span class="org-string">"]"</span>))))
</pre></div>
<p><code>helm-imenu-anywhere</code> command pops an Helm interface with all the <b>Imenu tags</b> <b>across all buffers with the same mode as the current one</b>.</p>
<div class="note">
<p>In a sense, it is similar to <code>etag</code> selection, but works only for the <i>open</i> buffers - you don't get thousands of symbols from <code>etags</code> to deal with. And this is often more convenient as you don't have to explicitly build the <code>etags</code> table.</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (GNUEmacs
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Helm Imenu tag selection across all buffers with the same mode.</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"imenu-anywhere-autoloads"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">helm</span></span><span class="org-comment">' source for `</span><span class="org-constant"><span class="org-comment">imenu-anywhere</span></span><span class="org-comment">'.</span>
      (global-set-key (kbd <span class="org-string">"C-."</span>) 'helm-imenu-anywhere)))
                                        <span class="org-comment-delimiter">; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment"> Conflict with</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">flyspell-auto-correct-word</span></span><span class="org-comment">'</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline259" class="outline-3">
<h3 id="orgheadline259">Indentation for Programs</h3>
<div class="outline-text-3" id="text-orgheadline259">
<p>Changing the "hanginess" of a brace and then reindenting, will not move the brace to a different line. For this, you're better off getting an external program like GNU <code>indent</code>, which will rearrange brace location, among other things.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 26.3 (info "(emacs)Program Indent")ation</span>

    (leuven--section <span class="org-string">"26.3 (emacs)Program Indentation"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Turn on auto-fill mode in Lisp modes.</span>
    (add-hook 'lisp-mode-hook 'auto-fill-mode)
    (add-hook 'emacs-lisp-mode-hook 'auto-fill-mode)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Auto-indentation: automatically jump to the "correct" column when</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">the &lt;RET&gt; key is pressed while editing a program (act as if you</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">pressed `</span><span class="org-constant"><span class="org-comment">C-j</span></span><span class="org-comment">').</span>
    (GNUEmacs24
      (add-hook 'prog-mode-hook
                (<span class="org-keyword">lambda</span> ()
                  (local-set-key (kbd <span class="org-string">"&lt;return&gt;"</span>) 'newline-and-indent))))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(defun back-to-indentation-or-beginning ()</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(interactive)</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(if (/= (point) (line-beginning-position))</span>
    <span class="org-comment-delimiter">;;       </span><span class="org-comment">(beginning-of-line)</span>
    <span class="org-comment-delimiter">;;     </span><span class="org-comment">(back-to-indentation)))</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(defun align-with-spaces (beg end)</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">"Align selected using only spaces for whitespace."</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(interactive "r")</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(let ((indent-tabs-mode nil))</span>
    <span class="org-comment-delimiter">;;     </span><span class="org-comment">(align beg end)))</span>

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"sh-script"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Use the SMIE code for navigation and indentation.</span>
      (setq sh-use-smie t))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline260" class="outline-3">
<h3 id="orgheadline260">Commands for Editing with Parentheses</h3>
<div class="outline-text-3" id="text-orgheadline260">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 26.4 Commands for Editing with (info "(emacs)Parentheses")</span>

  (leuven--section <span class="org-string">"26.4 Commands for Editing with (emacs)Parentheses"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Highlight matching paren.</span>
  (GNUEmacs
    (show-paren-mode 1)
    (setq show-paren-style 'mixed)
    (setq show-paren-ring-bell-on-mismatch t))
  (XEmacs
    (paren-set-mode 'paren))
</pre></div>
<p>XXX Is the following still necessary? Paren are highlighted by smartparens?</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Highlight (nearest) surrounding parentheses (abd brackets).</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"highlight-parentheses"</span>

    (<span class="org-keyword">define-globalized-minor-mode</span> <span class="org-function-name">global-highlight-parentheses-mode</span>
      highlight-parentheses-mode
      (<span class="org-keyword">lambda</span> ()
        (highlight-parentheses-mode t)))

    (setq hl-paren-colors '(<span class="org-string">"red"</span>))
    (setq hl-paren-background-colors '(<span class="org-string">"white"</span>))

    (global-highlight-parentheses-mode t))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Highlight nested parens, brackets, braces a different color at each depth.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"rainbow-delimiters-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable rainbow-delimiters in programming modes.</span>
    (add-hook 'prog-mode-hook 'rainbow-delimiters-mode))
</pre></div>
<p>To customize it, see <a href="http://yoo2080.wordpress.com/2013/12/21/small-rainbow-delimiters-tutorial/">http://yoo2080.wordpress.com/2013/12/21/small-rainbow-delimiters-tutorial/</a>.</p>
</div>
<div id="outline-container-orgheadline261" class="outline-4">
<h4 id="orgheadline261">Moving in the Parenthesis Structure</h4>
<div class="outline-text-4 org-src-container" id="text-orgheadline261">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Jump to matching parenthesis.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-match-paren</span> (arg)
    <span class="org-doc">"Go to the matching parenthesis, if on a parenthesis."</span>
    (interactive <span class="org-string">"p"</span>)
    (<span class="org-keyword">cond</span> ((looking-at <span class="org-string">"\\s\("</span>) (forward-list 1) (backward-char 1))
          ((looking-at <span class="org-string">"\\s\)"</span>) (forward-char 1) (backward-list 1))))

  (global-set-key (kbd <span class="org-string">"C-)"</span>) 'leuven-match-paren)
</pre></div>
</div>
<div id="outline-container-orgheadline262" class="outline-4">
<h4 id="orgheadline262">Matching Parentheses</h4>
<div class="outline-text-4" id="text-orgheadline262">
<p>Balanced editing: inserting two matching parentheses at once, etc.</p>
<ul class="org-ul">
<li>
<p>electric-pair-mode (in Emacs, since 24.1)</p>
<p>Here's a quick summary (<code>|</code> marks point):</p>
<ul class="org-ul">
<li>typing <code>((((</code> makes <code>((((|))))</code></li>
<li>typing <code>))))</code> afterwards makes <code>(((())))|</code></li>
<li>if the buffer has too many closers, an opener before them will <b>not</b> autopair</li>
<li>if the buffer has too many openers, a closer after them will <b>not</b> autoskip</li>
<li>in a mixed parenthesis situation with <code>[]</code>'s and <code>()</code>'s, it tries to do sensible things</li>
</ul>
</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable automatic parens pairing (Electric Pair mode).</span>
  (electric-pair-mode 1)

  (<span class="org-keyword">defvar</span> <span class="org-variable-name">org-electric-pairs</span>
    '(
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(?\* . ?\*)</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(?/ . ?/)</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(?_ . ?_)</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(?= . ?=)                      ; Too much used in code blocks.</span>
      (?~ . ?~))
    <span class="org-doc">"Electric pairs for Org mode."</span>)     <span class="org-comment-delimiter">; </span><span class="org-comment">See `</span><span class="org-constant"><span class="org-comment">org-emphasis-alist</span></span><span class="org-comment">'.</span>

  (<span class="org-keyword">defun</span> <span class="org-function-name">org-add-electric-pairs</span> ()
    (setq-local electric-pair-pairs (append electric-pair-pairs org-electric-pairs))
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq-local electric-pair-text-pairs electric-pair-pairs) ; In comments.</span>
  )

  (add-hook 'org-mode-hook 'org-add-electric-pairs)
</pre></div>
<p>Deleting one bracket doesn't delete the other. If you want that, install <code>autopair</code> package.</p>
<ul class="org-ul">
<li>
<p class="c2">smartparens</p>
<p>Pair can be simple as parentheses or brackets, or can be programming tokens such as <code>if</code>  <code>fi</code> or <code>if</code>  <code>end</code> in many languages.</p>
<p>If you get into any serious lisp coding, check out <code>paredit</code> - it forces you to always have balanced brackets in the file, thus avoiding a whole class of silly but hard-to-spot mistakes on lines ending with and avalanche of ))))).</p>
<p>If you are less into bondage&amp;submission, <code>smartparens.el</code> is another option, it <b>helps</b> to have balanced brackets w/o breaking your will ;-)</p>
<p>It is more about ease-of-coding them B&amp;D.</p>
<p class="c2">Bug 18785: Emacs hangs with Org mode when point is in LOGBOOK.</p>
</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Automatic insertion, wrapping and paredit-like navigation with user defined</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">pairs.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"smartparens-autoloads-</span><span class="org-leuven-highlight"><span class="org-string">XXX</span></span><span class="org-string">"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Default configuration for smartparens package.</span>
    (<span class="org-keyword">require</span> '<span class="org-constant">smartparens-config</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Toggle Smartparens mode in all buffers.</span>
    (smartparens-global-mode 1)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Toggle Show-Smartparens mode in all buffers.</span>
    (show-smartparens-global-mode 1)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add local pairs in Org mode.</span>
    (sp-with-modes 'org-mode
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(sp-local-pair "'" nil :actions nil)</span>
      (sp-local-tag <span class="org-string">"*"</span> <span class="org-string">"*"</span> <span class="org-string">"*"</span> <span class="org-builtin">:actions</span> '(wrap)) <span class="org-comment-delimiter">; </span><span class="org-comment">Bold.</span>
      (sp-local-tag <span class="org-string">"/"</span> <span class="org-string">"/"</span> <span class="org-string">"/"</span> <span class="org-builtin">:actions</span> '(wrap)) <span class="org-comment-delimiter">; </span><span class="org-comment">Italic.</span>
      (sp-local-tag <span class="org-string">"_"</span> <span class="org-string">"_"</span> <span class="org-string">"_"</span> <span class="org-builtin">:actions</span> '(wrap)) <span class="org-comment-delimiter">; </span><span class="org-comment">Underline.</span>
      (sp-local-tag <span class="org-string">"="</span> <span class="org-string">"="</span> <span class="org-string">"="</span> <span class="org-builtin">:actions</span> '(wrap)) <span class="org-comment-delimiter">; </span><span class="org-comment">Verbatim.</span>
      (sp-local-tag <span class="org-string">"~"</span> <span class="org-string">"~"</span> <span class="org-string">"~"</span> <span class="org-builtin">:actions</span> '(wrap))) <span class="org-comment-delimiter">; </span><span class="org-comment">Code.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Remove local pairs in Text mode.</span>
    (sp-local-pair 'text-mode <span class="org-string">"'"</span> nil <span class="org-builtin">:actions</span> nil)
    (sp-local-pair 'text-mode <span class="org-string">"\""</span> nil <span class="org-builtin">:actions</span> nil)

    (push 'latex-mode sp-ignore-modes-list)
</pre></div>
<p><code>turn-on-smartparens-strict-mode</code> add years to one's life to allow for more hacking. Seriously.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Enable smartparens-strict-mode in all Lisp modes.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(mapc (lambda (mode)</span>
    <span class="org-comment-delimiter">;;         </span><span class="org-comment">(add-hook (intern (format "%s-hook" (symbol-name mode)))</span>
    <span class="org-comment-delimiter">;;                   </span><span class="org-comment">'smartparens-strict-mode))</span>
    <span class="org-comment-delimiter">;;       </span><span class="org-comment">sp--lisp-modes)</span>
    )
</pre></div>
<ul class="org-ul">
<li>
<p><b>paredit</b> is (was?) the thing to use for Emacs Lisp!</p>
<p>Paredit-kill kills text until next paren or double quote! Also exists now in smartparens strict mode</p>
</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">minor mode for editing parentheses</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"paredit-autoloads"</span>

    (add-hook 'emacs-lisp-mode-hook 'paredit-mode)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Common Lisp editing extensions</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"redshank"</span>    <span class="org-comment-delimiter">; </span><span class="org-comment">requires `</span><span class="org-constant"><span class="org-comment">paredit</span></span><span class="org-comment">'</span>

      (add-hook 'emacs-lisp-mode-hook 'redshank-mode)))
</pre></div>
<p>Use it in ELisp; use smartparens in other modes (NOT globally!)</p>
<ul class="org-ul">
<li>autopair</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"autopair-autoloads"</span>

    (add-hook 'prog-mode-hook
              (<span class="org-keyword">lambda</span> ()

                <span class="org-comment-delimiter">;; </span><span class="org-comment">Attempts to wrap the selected region.</span>
                (setq autopair-autowrap t)

                <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable Autopair-Global mode.</span>
                (autopair-global-mode 1))))
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline263" class="outline-3">
<h3 id="orgheadline263">Manipulating Comments</h3>
<div class="outline-text-3" id="text-orgheadline263">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 26.5 (info "(emacs)Comments")</span>

  (leuven--section <span class="org-string">"26.5 (emacs)Comments"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">always comments out empty lines</span>
  (setq comment-empty-lines t)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (GNUEmacs
    (<span class="org-keyword">defadvice</span> <span class="org-function-name">comment-dwim</span> (around leuven-comment activate)
      <span class="org-doc">"When called interactively with no active region, comment a single line instead."</span>
      (<span class="org-keyword">if</span> (or (use-region-p) (not (called-interactively-p 'any)))
          ad-do-it
        (comment-or-uncomment-region (line-beginning-position)
                                     (line-end-position))
        (message <span class="org-string">"Commented line"</span>))))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline264" class="outline-3">
<h3 id="orgheadline264">Documentation Lookup</h3>
<div class="outline-text-3" id="text-orgheadline264">
<p>Function argument hint.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 26.6 (info "(emacs)Documentation") Lookup</span>

  (leuven--section <span class="org-string">"26.6 (emacs)Documentation Lookup"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">idle time to wait before printing documentation</span>
  (setq eldoc-idle-delay 0.2)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">resize echo area to fit documentation</span>
  (setq eldoc-echo-area-use-multiline-p t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">show the function arglist or the variable docstring in the echo area</span>
  (GNUEmacs
    (add-hook 'emacs-lisp-mode-hook 'eldoc-mode)
    (add-hook 'lisp-interaction-mode-hook 'eldoc-mode)
    (add-hook 'ielm-mode-hook 'eldoc-mode)
    (add-hook 'eval-expression-minibuffer-setup-hook 'eldoc-mode)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-eldoc-mode) ;; in Emacs 25</span>
    )

  <span class="org-comment-delimiter">;; </span><span class="org-comment">highlight the arguments in `</span><span class="org-constant"><span class="org-comment">font-lock-variable-name-face</span></span><span class="org-comment">'</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--frob-eldoc-argument-list</span> (string)
    <span class="org-doc">"Upcase and fontify STRING for use with `</span><span class="org-constant"><span class="org-doc">eldoc-mode</span></span><span class="org-doc">'."</span>
    (propertize (upcase string)
                'face 'font-lock-variable-name-face))
  (setq eldoc-argument-case 'leuven--frob-eldoc-argument-list)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline139" class="outline-3">
<h3 id="orgheadline139"><a id="ID-a36b1dbd-1d05-4ff2-b19a-167e50c4f1f7" name="ID-a36b1dbd-1d05-4ff2-b19a-167e50c4f1f7"></a>Hideshow minor mode</h3>
<div class="outline-text-3" id="text-orgheadline139">
<p>XXX See <a href="http://stackoverflow.com/questions/2399612/why-is-there-no-code-folding-in-emacs">http://stackoverflow.com/questions/2399612/why-is-there-no-code-folding-in-emacs</a></p>
<p>Hideshow can <b>fold</b> and unfold (i.e. hide and un-hide) logical blocks of <b>code</b> in many programming modes.</p>
<p><code>hs-minor-mode.el</code> collapses code for a lot of languages, not only Lisp. See <a href="#orgheadline138">outline-minor-mode</a> as well.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 26.7 (info "(emacs)Hideshow") minor mode</span>

  (leuven--section <span class="org-string">"26.7 (emacs)Hideshow minor mode"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">enable Hideshow (code folding) for programming modes</span>
  (add-hook 'prog-mode-hook 'hs-minor-mode)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"hideshow"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">change those really awkward key bindings with `@' in the middle</span>
    (define-key hs-minor-mode-map (kbd <span class="org-string">"&lt;C-M-S-left&gt;"</span>) 'hs-hide-block) <span class="org-comment-delimiter">; </span><span class="org-comment">or H-left? or C-c left?</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`C-c @ C-h' (collapse current fold) M-l in RStudio</span>
    (define-key hs-minor-mode-map (kbd <span class="org-string">"&lt;C-M-S-right&gt;"</span>) 'hs-show-block)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`C-c @ C-s' (expand current fold) M-S-l</span>
    (define-key hs-minor-mode-map (kbd <span class="org-string">"&lt;C-M-S-up&gt;"</span>) 'hs-hide-all)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`C-c @ C-M-h' (collapse all folds) M-o</span>
    (define-key hs-minor-mode-map (kbd <span class="org-string">"&lt;C-M-S-down&gt;"</span>) 'hs-show-all)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`C-c @ C-M-s' (expand all folds) M-S-o</span>

    (<span class="org-keyword">defcustom</span> <span class="org-variable-name">hs-face</span> 'hs-face
      <span class="org-doc">"*Specify the face to to use for the hidden region indicator"</span>
      <span class="org-builtin">:type</span> 'face
      <span class="org-builtin">:group</span> 'hideshow)

    (<span class="org-keyword">defface</span> <span class="org-variable-name">hs-face</span>
      '((t (<span class="org-builtin">:box</span> (<span class="org-builtin">:line-width</span> 1 <span class="org-builtin">:color</span> <span class="org-string">"#777777"</span>) <span class="org-builtin">:foreground</span> <span class="org-string">"#9A9A6A"</span> <span class="org-builtin">:background</span> <span class="org-string">"#F3F349"</span>)))
      <span class="org-doc">"Face to hightlight the \"...\" area of hidden regions"</span>
      <span class="org-builtin">:group</span> 'hideshow)

    (<span class="org-keyword">defun</span> <span class="org-function-name">hs-display-code-line-counts</span> (ov)
      (<span class="org-keyword">when</span> (eq 'code (overlay-get ov 'hs))
        (overlay-put ov 'display (propertize <span class="org-string">"..."</span> 'face 'hs-face))))

    (setq hs-set-up-overlay 'hs-display-code-line-counts))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">if hideshowvis is not installed, do not attempt to configure it, as this</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">will prevent packages (including hideshowvis itself) from compiling</span>
  (<span class="org-keyword">when</span> display-graphic-p
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"hideshowvis-autoloads"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">enable hideshowvis for programming modes</span>
      (add-hook 'prog-mode-hook
                (<span class="org-keyword">lambda</span> ()
                  (<span class="org-keyword">require</span> '<span class="org-constant">fold-dwim</span>)    <span class="org-comment-delimiter">; </span><span class="org-comment">more syntax definitions</span>
                  (hideshowvis-enable)))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">(defface hs-fringe-face</span>
      <span class="org-comment-delimiter">;;   </span><span class="org-comment">'((t (:box (:line-width 2 :color "#808080" :style released-button)</span>
      <span class="org-comment-delimiter">;;         </span><span class="org-comment">:foreground "#999999")))</span>
      <span class="org-comment-delimiter">;;   </span><span class="org-comment">"Face used to highlight the fringe on folded regions"</span>
      <span class="org-comment-delimiter">;;   </span><span class="org-comment">:group 'hideshow)</span>

      (<span class="org-keyword">defun</span> <span class="org-function-name">hs-display-code-line-counts</span> (ov)
        (<span class="org-keyword">when</span> (eq 'code (overlay-get ov 'hs))
          (<span class="org-keyword">let*</span> ((marker-string <span class="org-string">"*fringe-dummy*"</span>)
                 (marker-length (length marker-string))
                 (display-string <span class="org-string">"..."</span>))
            (overlay-put ov 'help-echo <span class="org-string">"Hidden text. C-c,= to show"</span>)
            (put-text-property 0 marker-length
                               'display (list 'left-fringe
                                              'hs-marker
                                              'hs-fringe-face)
                               marker-string)
            (overlay-put ov 'before-string marker-string)
            (put-text-property 0 (length display-string)
                               'face 'hs-face display-string)
            (overlay-put ov 'display display-string))))

      (setq hs-set-up-overlay 'hs-display-code-line-counts)))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline266" class="outline-3">
<h3 id="orgheadline266"><a id="ID-4b262301-5370-40c6-8da6-019215634e20" name="ID-4b262301-5370-40c6-8da6-019215634e20"></a>Completion for Symbol Names</h3>
<div class="outline-text-3" id="text-orgheadline266">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 26.8 (info "(emacs)Symbol Completion")</span>

  (leuven--section <span class="org-string">"26.8 (emacs)Symbol Completion"</span>)
</pre></div>
<p>It's more or less a convention that each language mode binds its symbol completion command (<code>completion-at-point</code>) to <code>&lt;M-tab&gt;</code>.</p>
<p>Note that <code>&lt;M-tab&gt;</code> is used by many window managers themselves (typically for switching between windows) and is not passed to applications.</p>
<p>In that case, you should:</p>
<ul class="org-ul">
<li>type <code>C-M-i</code> (or <code>&lt;escape&gt; &lt;tab&gt;</code>) for completion, or</li>
<li>bind the command normally bound to <code>&lt;M-tab&gt;</code> to a key that is convenient for you to hit, such as <code>&lt;C-tab&gt;</code>.</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">when you hit `</span><span class="org-constant"><span class="org-comment">&lt;C-tab&gt;</span></span><span class="org-comment">', call the command normally bound to `</span><span class="org-constant"><span class="org-comment">&lt;M-tab&gt;</span></span><span class="org-comment">'</span>
  (global-set-key (kbd <span class="org-string">"&lt;C-tab&gt;"</span>)
    (<span class="org-keyword">lambda</span> ()
      (interactive)
      (call-interactively (key-binding (kbd <span class="org-string">"&lt;M-tab&gt;"</span>)))))
</pre></div>
<p>See also <a href="#orgheadline265">Dabbrev</a>, Emacs' standard autocompletion (on by default).</p>
</div>
</div>
<div id="outline-container-orgheadline267" class="outline-3">
<h3 id="orgheadline267">Glasses minor mode</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline267">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 26.9 (info "(emacs)Glasses") minor mode</span>

  (leuven--section <span class="org-string">"26.9 (emacs)Glasses minor mode"</span>)

  (add-hook 'ess-mode-hook 'glasses-mode)
  (add-hook 'inferior-ess-mode-hook 'glasses-mode)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"glasses"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">string to be displayed as a visual separator in unreadable identifiers</span>
    (setq glasses-separator <span class="org-string">""</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">no display change</span>
    (setq glasses-original-separator <span class="org-string">""</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">face to be put on capitals of an identifier looked through glasses</span>
    (make-face 'leuven-glasses-face)
    (set-face-attribute 'leuven-glasses-face nil <span class="org-builtin">:weight</span> 'bold)
    (setq glasses-face 'leuven-glasses-face)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">avoid the black foreground set in</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">emacs-leuven-theme</span></span><span class="org-comment">' to face `</span><span class="org-constant"><span class="org-comment">bold</span></span><span class="org-comment">'</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">set properties of glasses overlays</span>
    (glasses-set-overlay-properties)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">no space between an identifier and an opening parenthesis</span>
    (setq glasses-separate-parentheses-p nil))
</pre></div>
</div>
<div id="outline-container-orgheadline268" class="outline-3">
<h3 id="orgheadline268">Other Features Useful for Editing Programs</h3>
<div class="outline-text-3" id="text-orgheadline268">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 26.11 (info "(emacs)Misc for Programs")</span>

  (leuven--section <span class="org-string">"26.11 (emacs)Misc for Programs"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable Prettify-Symbols mode in all buffers that support it.</span>
  (global-prettify-symbols-mode 1)      <span class="org-comment-delimiter">; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment"> Emacs 24.4 needed!</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'prog-mode-hook</span>
  <span class="org-comment-delimiter">;;           </span><span class="org-comment">(lambda ()</span>
  <span class="org-comment-delimiter">;;             </span><span class="org-comment">(setq-local prettify-symbols-alist</span>
  <span class="org-comment-delimiter">;;                         </span><span class="org-comment">'(("lambda" . ?)</span>
  <span class="org-comment-delimiter">;;                           </span><span class="org-comment">("math.sqrt" . ?)</span>
  <span class="org-comment-delimiter">;;                           </span><span class="org-comment">("math.pi" . ?)</span>
  <span class="org-comment-delimiter">;;                           </span><span class="org-comment">("sum" . ?)))</span>
  <span class="org-comment-delimiter">;;             </span><span class="org-comment">(prettify-symbols-mode 1)))</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 26 ends here</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline269" class="outline-2">
<h2 id="orgheadline269">Compiling and Testing Programs</h2>
<div class="outline-text-2 org-src-container" id="text-orgheadline269">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 27 (info "(emacs)Building") Compiling and Testing Programs</span>

(leuven--chapter leuven-load-chapter-27-building <span class="org-string">"27 Compiling and Testing Programs"</span>
</pre></div>
<div id="outline-container-orgheadline270" class="outline-3">
<h3 id="orgheadline270">Running Compilations under Emacs</h3>
<div class="outline-text-3" id="text-orgheadline270">
<p>My build command: <code>cd /path/to/Makefile &amp;&amp; make -f Makefile</code>.</p>
<p>You don't need a <code>Makefile</code> to perform simple tasks, because <code>make</code> knows a lot of built in rules out of the box. For example, to compile a <code>.c</code> source file <code>foo.c</code> into a program <code>foo</code>, all you need is say <code>make -k foo</code>, and <code>make</code> will do it even without a <code>Makefile</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 27.1 Running (info "(emacs)Compilation")s under Emacs</span>

  (leuven--section <span class="org-string">"27.1 Running (emacs)Compilations under Emacs"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">invoke a compiler with the same command as in the last invocation of</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">compile</span></span><span class="org-comment">'</span>
  (autoload 'recompile <span class="org-string">"compile"</span>
    <span class="org-doc">"Re-compile the program including the current buffer."</span> t)

  (global-set-key (kbd <span class="org-string">"&lt;f9&gt;"</span>) 'recompile)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">scroll the `</span><span class="org-constant"><span class="org-comment">*compilation*</span></span><span class="org-comment">' buffer window to follow output as it appears</span>
  (setq compilation-scroll-output t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">number of lines in a compilation window</span>
  (setq compilation-window-height 8)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; I also don't like that the compilation window sticks around after</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; a successful compile.  After all, most of the time, all I care</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; about is that the compile completed cleanly.  Here's how I make the</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; compilation window go away, only if there was no compilation</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; errors:</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq compilation-finish-function</span>
  <span class="org-comment-delimiter">;;       </span><span class="org-comment">(lambda (buf str)</span>
  <span class="org-comment-delimiter">;;         </span><span class="org-comment">(if (string-match "exited abnormally" str)</span>
  <span class="org-comment-delimiter">;;             </span><span class="org-comment">;; there were errors</span>
  <span class="org-comment-delimiter">;;             </span><span class="org-comment">(message "Compilation errors, press C-x ` to visit")</span>
  <span class="org-comment-delimiter">;;           </span><span class="org-comment">;; no errors, make compilation window go away in 0.5 sec</span>
  <span class="org-comment-delimiter">;;           </span><span class="org-comment">(run-at-time 0.5 nil 'delete-windows-on buf)</span>
  <span class="org-comment-delimiter">;;           </span><span class="org-comment">(message "NO COMPILATION ERRORS!"))))</span>

  (GNUEmacs
    (<span class="org-keyword">defun</span> <span class="org-function-name">cc-goto-first-error</span>( buffer exit-condition )
      (<span class="org-keyword">with-current-buffer</span> buffer
        (goto-char (point-min))
        (compilation-next-error 1)
        (beep)))

    (add-to-list 'compilation-finish-functions 'cc-goto-first-error))

  (<span class="org-keyword">defvar</span> <span class="org-variable-name">make-clean-command</span> <span class="org-string">"make clean all"</span>
    <span class="org-doc">"*Command used by the `</span><span class="org-constant"><span class="org-doc">make-clean</span></span><span class="org-doc">' function."</span>)

  (<span class="org-keyword">defun</span> <span class="org-function-name">make-clean</span> (<span class="org-type">&amp;optional</span> arg)
    <span class="org-doc">"Run a make clean."</span>
    (interactive <span class="org-string">"P"</span>)
    (<span class="org-keyword">require</span> '<span class="org-constant">compile</span>)                  <span class="org-comment-delimiter">; </span><span class="org-comment">needed for compile-internal</span>
    (<span class="org-keyword">if</span> arg
        (setq make-clean-command
              (read-string <span class="org-string">"Command: "</span> make-clean-command)))
    (save-some-buffers (not compilation-ask-about-save) nil)
    (compile-internal make-clean-command <span class="org-string">"No more errors"</span>))

  (global-set-key (kbd <span class="org-string">"&lt;S-f9&gt;"</span>) 'make-clean)
</pre></div>
<p>You're debugging Bash code? I normally use <code>mode-compile.el</code> for this. Basically, it runs Bash with lots of debug output.</p>
</div>
</div>
<div id="outline-container-orgheadline271" class="outline-3">
<h3 id="orgheadline271">Compilation Mode</h3>
<div class="outline-text-3" id="text-orgheadline271">
<p>When Emacs visits the locus of an error message, it momentarily highlights the relevant source line. The duration of this highlight is determined by the variable <code>next-error-highlight</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 27.2 (info "(emacs)Compilation Mode")</span>

  (leuven--section <span class="org-string">"27.2 (emacs)Compilation Mode"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">automatically jump to the first error during compilation</span>
  (setq compilation-auto-jump-to-first-error t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">display the next compiler error message</span>
  (global-set-key (kbd <span class="org-string">"&lt;f10&gt;"</span>) 'next-error)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">also on `C-x `' and `M-g n'</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">display the previous compiler error message</span>
  (global-set-key (kbd <span class="org-string">"&lt;S-f10&gt;"</span>) 'previous-error)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">also on `M-g p'</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">display the first compiler error message</span>
  (global-set-key (kbd <span class="org-string">"&lt;C-f10&gt;"</span>) 'first-error)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; prefer fringe</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq next-error-highlight 'fringe-arrow)</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">highlight and parse the whole compilation output as soon as it arrives</span>
  (setq compile-auto-highlight t)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline272" class="outline-3">
<h3 id="orgheadline272">Searching with Grep under Emacs</h3>
<div class="outline-text-3" id="text-orgheadline272">
<p>Find files matching some regexp, and click on the hyperlinks to the files to locate your match.</p>
<p>The commands</p>
<ul class="org-ul">
<li><code>lgrep</code> (local search, with <code>grep-template</code>) and</li>
<li><code>rgrep</code> (<b>recursive</b> search, with <code>grep-find-template</code>)</li>
</ul>
<p>are somehow more user-friendly than the <code>M-x grep</code> command.</p>
<p>The doc string of <code>grep-use-null-device</code> which explains that, with its default value <code>auto-detect</code>, Emacs invokes Grep once with <code>/dev/null</code> appended (causing the search to return no results) for the purposes of detecting how to invoke it thereafter.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 27.4 (info "(emacs)Grep Searching") under Emacs</span>

  (leuven--section <span class="org-string">"27.4 (emacs)Grep Searching under Emacs"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">ignore case distinctions in the default `</span><span class="org-constant"><span class="org-comment">grep</span></span><span class="org-comment">' command</span>
  (setq grep-command <span class="org-string">"grep -i -H -n -e "</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">do not append `</span><span class="org-constant"><span class="org-comment">null-device</span></span><span class="org-comment">' (`</span><span class="org-constant"><span class="org-comment">/dev/null</span></span><span class="org-comment">' or `</span><span class="org-constant"><span class="org-comment">NUL</span></span><span class="org-comment">') to `</span><span class="org-constant"><span class="org-comment">grep</span></span><span class="org-comment">' commands</span>
  (setq grep-use-null-device nil)       <span class="org-comment-delimiter">; </span><span class="org-comment">not necessary if the `</span><span class="org-constant"><span class="org-comment">grep</span></span><span class="org-comment">' program</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">used supports the `</span><span class="org-constant"><span class="org-comment">-H</span></span><span class="org-comment">' option</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; for Windows</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq grep-find-command '("findstr /sn *" . 13))</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">use `find -print0' and `xargs -0'</span>
  (setq grep-find-use-xargs 'gnu)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">run `</span><span class="org-constant"><span class="org-comment">grep</span></span><span class="org-comment">' via `</span><span class="org-constant"><span class="org-comment">find</span></span><span class="org-comment">', with user-friendly interface</span>
  (global-set-key (kbd <span class="org-string">"C-c 3"</span>) 'rgrep)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">10.3.5 Org keyword search</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-grep-org-files</span> (regexp <span class="org-type">&amp;optional</span> context)
    <span class="org-doc">"Recursively search for REGEXP in Org files in directory tree rooted at `</span><span class="org-constant"><span class="org-doc">org-directory</span></span><span class="org-doc">'.</span>
<span class="org-doc">  Prefix argument determines number of lines of output context."</span>
    (interactive <span class="org-string">"sSearch regexp: \nP"</span>)
    (<span class="org-keyword">let</span> ((grep-find-ignored-files '(<span class="org-string">"#*"</span> <span class="org-string">".#*"</span>))
          (grep-template (concat <span class="org-string">"grep &lt;X&gt; -i -nH "</span>
                                 (<span class="org-keyword">when</span> context
                                   (concat <span class="org-string">"-C"</span> (number-to-string context)))
                                 <span class="org-string">" -e &lt;R&gt; &lt;F&gt;"</span>)))
      (rgrep regexp <span class="org-string">"*.org"</span> org-directory)))
</pre></div>
<p>See <code>leuven-helm-grep-org-files</code>.</p>
</div>
</div>
<div id="outline-container-orgheadline273" class="outline-3">
<h3 id="orgheadline273">Finding Syntax Errors On The Fly</h3>
<div class="outline-text-3" id="text-orgheadline273">
<p>Flycheck (aka "Flymake done right") can perform static code analysis <b>on-the-fly</b>, and <b>highlight warnings and errors</b> in the code immediately as you are editing it, if you made a mistake.</p>
<p>To <b>list all errors in the current buffer</b>, you can popup an error list with <code>C-c ! l</code> (<code>M-x flycheck-list-errors</code>).</p>
<p>In the error list window the following keybindings are available:</p>
<dl class="org-dl">
<dt><code>n</code></dt>
<dd>Move to the next error.</dd>
<dt><code>p</code></dt>
<dd>Move to the previous error.</dd>
<dt><code>q</code></dt>
<dd>Hide the error list window.</dd>
<dt><code>RET</code></dt>
<dd>Jump to the location of the error at point.</dd>
<dt><code>g</code></dt>
<dd>Refresh the error list, by triggering a new syntax check in the associated buffer.</dd>
<dt><code>S</code></dt>
<dd>Sort the error list by the column at point. Press repeatedly to inverse the sorting order.</dd>
</dl>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 27.5 (info "(emacs)Flymake")</span>

  (leuven--section <span class="org-string">"27.5 (emacs)Flymake"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">modern on-the-fly syntax checking</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"flycheck-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">enable Flycheck mode in all programming modes</span>
    (add-hook 'prog-mode-hook 'flycheck-mode))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"flycheck"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">delay in seconds before displaying errors at point</span>
    (setq flycheck-display-errors-delay 0.3)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; indicate errors and warnings via icons in the right fringe</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq flycheck-indication-mode 'right-fringe)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Remove newline checks, since they would trigger an immediate check when</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">we want the `</span><span class="org-constant"><span class="org-comment">flycheck-idle-change-delay</span></span><span class="org-comment">' to be in effect while editing.</span>
    (setq flycheck-check-syntax-automatically
          '(save
            idle-change
            <span class="org-comment-delimiter">;; </span><span class="org-comment">new-line</span>
            mode-enabled))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Each buffer get its local `</span><span class="org-constant"><span class="org-comment">flycheck-idle-change-delay</span></span><span class="org-comment">' because of the</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">buffer-sensitive adjustment above.</span>
    (make-variable-buffer-local 'flycheck-idle-change-delay)

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--adjust-flycheck-automatic-syntax-eagerness</span> ()
      <span class="org-doc">"Adjust how often we check for errors based on if there are any.</span>

<span class="org-doc">This lets us fix any errors as quickly as possible, but in</span>
<span class="org-doc">a clean buffer we're an order of magnitude laxer about checking."</span>
      (setq flycheck-idle-change-delay
            (<span class="org-keyword">if</span> (assq 'error (flycheck-count-errors flycheck-current-errors))
                <span class="org-comment-delimiter">; </span><span class="org-comment">only check for REAL errors (original source: Magnar Sveen)</span>
                1
              20)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">functions to run after each syntax check</span>
    (add-hook 'flycheck-after-syntax-check-hook
              'leuven--adjust-flycheck-automatic-syntax-eagerness))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (global-set-key (kbd <span class="org-string">"C-x C-S-e"</span>) 'elint-current-buffer)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"elint"</span>
    (add-to-list 'elint-standard-variables 'current-prefix-arg)
    (add-to-list 'elint-standard-variables 'command-line-args-left)
    (add-to-list 'elint-standard-variables 'buffer-file-coding-system)
    (add-to-list 'elint-standard-variables 'emacs-major-version)
    (add-to-list 'elint-standard-variables 'window-system))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline274" class="outline-3">
<h3 id="orgheadline274">Running Debuggers Under Emacs</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline274">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 27.6 Running (info "(emacs)Debuggers") Under Emacs</span>

  (leuven--section <span class="org-string">"27.6 Running (emacs)Debuggers Under Emacs"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"gdb-mi"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">enable Gdb-Many-Windows mode</span>
    (setq gdb-many-windows t))          <span class="org-comment-delimiter">; </span><span class="org-comment">the only important parameter for GDB</span>
</pre></div>
</div>
<div id="outline-container-orgheadline275" class="outline-3">
<h3 id="orgheadline275">Debugging Lisp programs</h3>
<div class="outline-text-3" id="text-orgheadline275">
<p>Emacs has the basic debugger/stack trace, but it also has the Edebug facility, which is very powerful, for the more complex situation.</p>
<p>With that source-level debugger for Emacs Lisp, you can:</p>
<ul class="org-ul">
<li>step through evaluation, stopping before and after each expression,</li>
<li>set conditional or unconditional breakpoints.</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** Debugging Lisp programs</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">source-level debugger for Emacs Lisp</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"edebug"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; display a trace of function entry and exit</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq edebug-trace t)</span>
</pre></div>
<p>While <code>edebug</code>'ging, use <code>T</code> to view a trace buffer (<code>*edebug-trace*</code>). Emacs will quickly execute the rest of your code, printing out the arguments and return values for each expression it evaluates.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (<span class="org-keyword">defadvice</span> <span class="org-function-name">edebug-overlay-arrow</span> (around leuven-highlight-line activate)
      <span class="org-doc">"Highlight line currently being Edebug'ged."</span>
      (<span class="org-keyword">require</span> '<span class="org-constant">hl-line</span>)
      (hl-line-mode)
      ad-do-it)

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-edebug-quit</span> ()
      <span class="org-doc">"Stop Edebug'ging and remove highlighting."</span>
      (interactive)
      (hl-line-mode -1)
      (top-level))

    (define-key edebug-mode-map [remap top-level] 'leuven-edebug-quit))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline276" class="outline-3">
<h3 id="orgheadline276">Executing Lisp Expressions</h3>
<div class="outline-text-3" id="text-orgheadline276">
<p>Just as in C, C++, Java, Perl, Python, etc, Lisp code is kept in files. All the normal editing operations are performed on files. In this respect, hacking in Lisp is like hacking in any other language that you are used to. What's different is that what you are hacking is a running Lisp program. When you edit a function definition or add a new one, you compile it into a running program. There is no compile, link, run, debug cycle as you know it from C or Java.</p>
<p>Ponder that for a minute.</p>
<p>When you fix a bug in a C function, you have to recompile, relink, and reload your program before you can test the fix. You don't do that in Lisp. You make the fix and then go straight to testing it. This process can be even faster than fixing a bug in a scripting language like Perl.</p>
</div>
</div>
<div id="outline-container-orgheadline277" class="outline-3">
<h3 id="orgheadline277">Libraries of Lisp Code for Emacs</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline277">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 27.8 (info "(emacs)Lisp Libraries") for Emacs</span>

  (leuven--section <span class="org-string">"27.8 (emacs)Lisp Libraries"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Force load of `</span><span class="org-constant"><span class="org-comment">.el</span></span><span class="org-comment">' files when they are newer than the `</span><span class="org-constant"><span class="org-comment">.elc</span></span><span class="org-comment">' files.</span>
  (setq load-prefer-newer t)            <span class="org-comment-delimiter">; </span><span class="org-comment">From Emacs 24.4.</span>
</pre></div>
</div>
<div id="outline-container-orgheadline278" class="outline-3">
<h3 id="orgheadline278">Evaluating Emacs Lisp Expressions</h3>
<div class="outline-text-3" id="text-orgheadline278">
<dl class="org-dl">
<dt><code>C-x C-e</code></dt>
<dd>Evaluate the Emacs Lisp expression before point, and print the value in the echo area (<code>eval-last-sexp</code>).</dd>
<dt><code>C-M-x</code> (in Emacs Lisp mode)</dt>
<dd>Evaluate the defun containing or after point, and print the value in the echo area (<code>eval-defun</code>).</dd>
</dl>
<p>To (attempt to) cleanly reevaluate a buffer of Emacs Lisp code, use <code>nuke-and-eval</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 27.9 (info "(emacs)Lisp Eval") Expressions</span>

  (leuven--section <span class="org-string">"27.9 (emacs)Lisp Eval Expressions"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable the use of the command `</span><span class="org-constant"><span class="org-comment">eval-expression</span></span><span class="org-comment">' without confirmation.</span>
  (put 'eval-expression 'disabled nil)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Maximum depth of lists to print in the result of the evaluation commands</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">before abbreviating them.</span>
  (setq eval-expression-print-level nil) <span class="org-comment-delimiter">; </span><span class="org-comment">No limit.</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Maximum length of lists to print in the result of the evaluation commands</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">before abbreviating them.</span>
  (setq eval-expression-print-length nil) <span class="org-comment-delimiter">; </span><span class="org-comment">No limit.</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class="org-function-name">eval-and-replace</span> ()
    <span class="org-doc">"Replace the preceding sexp with its value."</span>
    (interactive)
    (<span class="org-keyword">let</span> ((value (eval (preceding-sexp))))
      (kill-sexp -1)
      (insert (format <span class="org-string">"%S"</span> value))))

  (global-set-key (kbd <span class="org-string">"C-c e"</span>) 'eval-and-replace)
</pre></div>
<p>For on-the-fly evaluation/substitution of Emacs Lisp code, see <a href="https://github.com/Fuco1/litable">https://github.com/Fuco1/litable</a>.</p>
<p>See demo of it: <a href="http://www.youtube.com/watch?v=TMoPuv-xXMM">http://www.youtube.com/watch?v=TMoPuv-xXMM</a>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">dynamic evaluation replacement with emacs</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"litable-autoloads"</span>

    (add-hook 'lisp-interaction-mode-hook 'litable-mode))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline279" class="outline-3">
<h3 id="orgheadline279">Lisp Interaction Buffers (<code>*scratch*</code>)</h3>
<div class="outline-text-3" id="text-orgheadline279">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 27.10 (info "(emacs)Lisp Interaction") Buffers</span>

  (leuven--section <span class="org-string">"27.10 (emacs)Lisp Interaction Buffers"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">don't display the "Welcome to GNU Emacs" buffer on startup</span>
  (setq inhibit-startup-screen t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">don't insert instructions in the `</span><span class="org-constant"><span class="org-comment">*scratch*</span></span><span class="org-comment">' buffer at startup</span>
  (setq initial-scratch-message nil)
</pre></div>
<p>Don't use any specific mode for the initial buffer. That ensure that no Lisp or Org specific stuff gets loaded at each startup time.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">major mode command symbol to use for the initial `</span><span class="org-constant"><span class="org-comment">*scratch*</span></span><span class="org-comment">' buffer</span>
  (setq initial-major-mode 'fundamental-mode)
</pre></div>
<p><b>That code must be used in the <code>.emacs</code> file (or libraries loaded from it).</b> Otherwise, <code>*scratch*</code> will already have been created, in the default major mode.</p>
<p>To evaluate a non-interactive command, simply use <code>IELM</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 27 ends here</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline280" class="outline-2">
<h2 id="orgheadline280">Maintaining Programs</h2>
<div class="outline-text-2 org-src-container" id="text-orgheadline280">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 28 (info "(emacs)Maintaining") Programs</span>

(leuven--chapter leuven-load-chapter-28-maintaining <span class="org-string">"28 Maintaining Programs"</span>
</pre></div>
<div id="outline-container-orgheadline281" class="outline-3">
<h3 id="orgheadline281">Version Control</h3>
<div class="outline-text-3" id="text-orgheadline281">
<p>Version control systems that interact with Emacs in a generic way.</p>
<dl class="org-dl">
<dt><code>C-x v d</code></dt>
<dd>Open Dired buffer in VC-mode.</dd>
<dt><code>C-x v v</code></dt>
<dd>Take appropriate "next" action (add, commit).</dd>
<dt><code>C-x v r</code> (or <code>M-!</code> ?)</dt>
<dd>Switch Git branches.</dd>
</dl>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 28.1 (info "(emacs)Version Control")</span>

  (leuven--section <span class="org-string">"28.1 (emacs)Version Control"</span>)
</pre></div>
</div>
<div id="outline-container-orgheadline283" class="outline-4">
<h4 id="orgheadline283">Version Control and the Mode Line</h4>
<div class="outline-text-4" id="text-orgheadline283">
<p>"Unmodified-according-to-VC" buffers use <code>-</code> as a separator in their VC indicator, and modified buffers have <code>:</code> (e.g., <code>CVS-1.2</code> vs. <code>CVS:1.2</code>). The tooltip over the VC indicator also says more explicitly.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">*** 28.1.2 (info "(emacs)VC Mode Line")</span>

  (leuven--section <span class="org-string">"28.1.2 Version Control and the Mode Line"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "vc"</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(GNUEmacs</span>
  <span class="org-comment-delimiter">;;     </span><span class="org-comment">(when (image-type-available-p 'png)</span>
  <span class="org-comment-delimiter">;;       </span><span class="org-comment">;; http://www.emacswiki.org/emacs/VcIcon</span>
  <span class="org-comment-delimiter">;;       </span><span class="org-comment">(defun vc-icon ()</span>
  <span class="org-comment-delimiter">;;         </span><span class="org-comment">"Display a colored icon indicating the vc status of the current file."</span>
  <span class="org-comment-delimiter">;;         </span><span class="org-comment">(let ((icon (if (eq (vc-state buffer-file-name) 'up-to-date)</span>
  <span class="org-comment-delimiter">;;                         </span><span class="org-comment">(concat leuven--directory "Pictures/NormalIcon.png")</span>
  <span class="org-comment-delimiter">;;                       </span><span class="org-comment">(concat leuven--directory "Pictures/ModifiedIcon.png")))</span>
  <span class="org-comment-delimiter">;;               </span><span class="org-comment">(bg-colour (face-attribute 'mode-line :background)))</span>
  <span class="org-comment-delimiter">;;           </span><span class="org-comment">(propertize</span>
  <span class="org-comment-delimiter">;;            </span><span class="org-comment">"  "</span>
  <span class="org-comment-delimiter">;;            </span><span class="org-comment">'display (find-image `((:type png</span>
  <span class="org-comment-delimiter">;;                                    </span><span class="org-comment">:file ,icon</span>
  <span class="org-comment-delimiter">;;                                    </span><span class="org-comment">:ascent center</span>
  <span class="org-comment-delimiter">;;                                    </span><span class="org-comment">:background ,bg-colour))))))</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;       </span><span class="org-comment">(setq-default mode-line-format</span>
  <span class="org-comment-delimiter">;;                     </span><span class="org-comment">(push '(vc-mode (:eval (vc-icon))) mode-line-format)))))</span>
</pre></div>
<p>If you choose a JPG icon, you must set its type to <code>jpeg</code> (<b>NOT</b> <code>jpg</code>) in <code>find-image</code>.</p>
<p>But don't forget that JPEG images can't have <i>transparent backgrounds</i></p>
<p>If PNG images are not correctly supported, see <a href="#orgheadline282">Images</a>.</p>
<div class="inlinetask"><b>Lisp expression in mode-line-format</b><br />
<p>The Lisp expressions supported in <code>mode-line-format</code> are those documented in the manual, and nothing else. In particular, the <code>:eval</code> part must appear explicitly, and any symbol stands for its value (which is not eval'ed). IOW, a full-blown Lisp evaluation there is not implemented</p>
</div>
</div>
</div>
<div id="outline-container-orgheadline284" class="outline-4">
<h4 id="orgheadline284">Features of the Log Entry Buffer</h4>
<div class="outline-text-4" id="text-orgheadline284">
<dl class="org-dl">
<dt><code>C-c C-d</code></dt>
<dd>Show the diff we are about to commit.</dd>
<dt><code>D</code> (<code>vc-git-previous-revision</code>)</dt>
<dd>Get the previous revision.</dd>
</dl>
<p>Using Emacs VC, you only have to write the ChangeLog, then use <code>C-c C-a</code> to insert it into the commit buffer. So there is no need to "write the same thing twice".</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">*** 28.1.4 (info "(emacs)Log Buffer")</span>

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--vc-log-mode-setup</span> ()
    <span class="org-comment-delimiter">;; </span><span class="org-comment">check if `</span><span class="org-constant"><span class="org-comment">ispell-program-name</span></span><span class="org-comment">' seems correct</span>
    (<span class="org-keyword">when</span> (leuven--ispell-check-program-name)
      (setq ispell-local-dictionary <span class="org-string">"american"</span>)
      (flyspell-mode)))

  (add-hook 'vc-log-mode-hook 'leuven--vc-log-mode-setup)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"vc-git"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">major mode for editing git commit messages</span>
    (try-require 'git-commit-mode))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"git-commit-mode"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">turn on on-the-fly spell-checking</span>
    (add-hook 'git-commit-mode-hook 'flyspell-mode)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">turn off save-place</span>
    (add-hook 'git-commit-mode-hook
              (<span class="org-keyword">lambda</span> ()
                (toggle-save-place 0))))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"magit-autoloads"</span>

    (setq magit-auto-revert-mode nil)   <span class="org-comment-delimiter">; </span><span class="org-comment">Avoid any data loss.</span>
    )
</pre></div>
<p>See <a href="http://whattheemacsd.com/setup-magit.el-01.html">http://whattheemacsd.com/setup-magit.el-01.html</a>.</p>
</div>
</div>
<div id="outline-container-orgheadline285" class="outline-4">
<h4 id="orgheadline285">Examining And Comparing Old Revisions</h4>
<div class="outline-text-4 org-src-container" id="text-orgheadline285">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">*** 28.1.6 (info "(emacs)Old Revisions")</span>

  (leuven--section <span class="org-string">"28.1.6 Examining And Comparing Old Revisions"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">switches for diff under VC</span>
  (setq vc-diff-switches diff-switches)
</pre></div>
</div>
<div id="outline-container-orgheadline286" class="outline-4">
<h4 id="orgheadline286">VC Change Log</h4>
<div class="outline-text-4" id="text-orgheadline286">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">*** 28.1.7 (info "(emacs)VC Change Log")</span>

  (leuven--section <span class="org-string">"28.1.7 VC Change Log"</span>)
</pre></div>
<dl class="org-dl">
<dt><code>C-x v L</code></dt>
<dd>
<p>Open the <b>log buffer</b> for the current <b>repository</b> (List the change log for the current VC controlled tree in a window).</p>
<p>When in it:</p>
<ul class="org-ul">
<li><code>C-m</code> to read the commit message,</li>
<li><code>d</code> to see the corresponding diff.</li>
</ul>
</dd>
</dl>
<p>We have at least two pairs of commands (C-x v l vs. C-x v L <i>and</i> C-x v = vs. C-x v D), of which one operates on the current <b>file</b> <i>and</i> the other on the <b>repository</b> as a whole.</p>
<ul class="org-ul">
<li><code>C-x v l</code> to view the file's history.</li>
<li><code>n</code> and <code>p</code> to move between commits.</li>
<li><code>f</code> to visit the file as of the commit at point.</li>
</ul>
<p><code>git-timemachine</code> makes the process of <b>navigating between different versions</b> of a file almost completely seamless.</p>
<p>You call <code>M-x git-timemachine RET</code> from a buffer visiting a tracked file, then you can use the following keys to navigate historic versions of the file:</p>
<dl class="org-dl">
<dt><code>p</code></dt>
<dd>Visit previous historic version.</dd>
<dt><code>n</code></dt>
<dd>Visit next historic version.</dd>
<dt><code>w</code></dt>
<dd>Copy the abbreviated hash of the current historic version.</dd>
<dt><code>W</code></dt>
<dd>Copy the full hash of the current historic version.</dd>
<dt><code>q</code></dt>
<dd>Exit the time machine.</dd>
</dl>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Walk through Git revisions of a file.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"git-timemachine-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Number of chars from the full SHA1 hash to use for abbreviation.</span>
    (setq git-timemachine-abbreviation-length 7)

    (global-set-key (kbd <span class="org-string">"C-x v t"</span>) 'git-timemachine))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Pop up last commit information of current line.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"git-messenger-autoloads"</span>

    (global-set-key (kbd <span class="org-string">"C-x v p"</span>) 'git-messenger:popup-message) <span class="org-comment-delimiter">; </span><span class="org-comment">`C-h g'.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Pop up commit ID and author name too.</span>
    (setq git-messenger:show-detail t))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline287" class="outline-4">
<h4 id="orgheadline287">VC Directory Mode</h4>
<div class="outline-text-4 org-src-container" id="text-orgheadline287">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">*** 28.1.9 (info "(emacs)VC Directory Mode")</span>

  (leuven--section <span class="org-string">"28.1.9 VC Directory Mode"</span>)

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-vc-jump</span> ()
    <span class="org-doc">"Jump to VC status buffer."</span>
    (interactive)
    (<span class="org-keyword">let*</span> ((fname (buffer-file-name))
           (dname (<span class="org-keyword">if</span> fname
                      (<span class="org-keyword">if</span> (file-directory-p fname)
                          fname
                        (file-name-directory fname))
                    default-directory)))
      (message <span class="org-string">"VC status for directory: %s"</span> dname)
      (vc-dir dname)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">vc status without asking for a directory</span>
  (global-set-key (kbd <span class="org-string">"&lt;C-f9&gt;"</span>) 'leuven-vc-jump)

  (add-hook  'vc-dir-mode-hook
             (<span class="org-keyword">lambda</span> ()
               <span class="org-comment-delimiter">;; </span><span class="org-comment">hide up-to-date and unregistered files</span>
               (define-key vc-dir-mode-map
                 (kbd <span class="org-string">"x"</span>) 'leuven-vc-dir-hide-up-to-date-and-unregistered)
               (define-key vc-dir-mode-map
                 (kbd <span class="org-string">"E"</span>) 'vc-ediff)
               (define-key vc-dir-mode-map
                 (kbd <span class="org-string">"#"</span>) 'vc-ediff-ignore-whitespace)
                                         <span class="org-comment-delimiter">; </span><span class="org-comment">ediff-windows-wordwise?</span>
               ))

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-vc-dir-hide-up-to-date-and-unregistered</span> ()
    (interactive)
    (vc-dir-hide-up-to-date)
    (vc-dir-hide-unregistered))

  (<span class="org-keyword">defun</span> <span class="org-function-name">vc-dir-hide-unregistered</span> ()
    <span class="org-doc">"Hide unregistered items from display."</span>
    (interactive)
    (<span class="org-keyword">let</span> ((crt (ewoc-nth vc-ewoc -1))
          (first (ewoc-nth vc-ewoc 0)))
      <span class="org-comment-delimiter">;; </span><span class="org-comment">go over from the last item to the first and remove the</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">unregistered files and directories with no child files</span>
      (<span class="org-keyword">while</span> (not (eq crt first))
        (<span class="org-keyword">let*</span> ((data (ewoc-data crt))
               (dir (vc-dir-fileinfo-&gt;directory data))
               (next (ewoc-next vc-ewoc crt))
               (prev (ewoc-prev vc-ewoc crt))
               <span class="org-comment-delimiter">;; </span><span class="org-comment">ewoc-delete does not work without this...</span>
               (inhibit-read-only t))
          (<span class="org-keyword">when</span> (or
                 <span class="org-comment-delimiter">;; </span><span class="org-comment">remove directories with no child files</span>
                 (and dir
                      (or
                       <span class="org-comment-delimiter">;; </span><span class="org-comment">nothing follows this directory</span>
                       (not next)
                       <span class="org-comment-delimiter">;; </span><span class="org-comment">next item is a directory</span>
                       (vc-dir-fileinfo-&gt;directory (ewoc-data next))))
                 <span class="org-comment-delimiter">;; </span><span class="org-comment">remove files in the unregistered state</span>
                 (eq (vc-dir-fileinfo-&gt;state data) 'unregistered))
            (ewoc-delete vc-ewoc crt))
          (setq crt prev)))))

  (<span class="org-keyword">defun</span> <span class="org-function-name">vc-ediff-ignore-whitespace</span> (historic <span class="org-type">&amp;optional</span> not-urgent)
    <span class="org-doc">"Ignore regions that differ in white space &amp; line breaks only."</span>
    (interactive (list current-prefix-arg t))
    (<span class="org-keyword">require</span> '<span class="org-constant">ediff</span>)
    (<span class="org-keyword">let</span> ((ediff-ignore-similar-regions t))
      (call-interactively 'vc-ediff)))  <span class="org-comment-delimiter">; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment"> does not work yet</span>
</pre></div>
</div>
<div id="outline-container-orgheadline288" class="outline-4">
<h4 id="orgheadline288">Customizing VC</h4>
<div class="outline-text-4" id="text-orgheadline288">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">*** 28.1.13 (info "(emacs)Customizing VC")</span>

  (leuven--section <span class="org-string">"28.1.13 Customizing VC"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">files covered by VC get backups (as with other files)</span>
  (setq vc-make-backup-files t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">http://www.emacswiki.org/emacs/VcTopDirectory</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">For git</span>
  (<span class="org-keyword">defadvice</span> <span class="org-function-name">vc-dir-prepare-status-buffer</span>
             (before leuven-vcs-goto-top-directory activate compile)
    (<span class="org-keyword">let*</span> ((backend (ad-get-arg 2))
           (vcs-dir (ad-get-arg 1))
           (vcs-top-dir (vc-call-backend backend 'responsible-p vcs-dir)))
      (<span class="org-keyword">when</span> (stringp vcs-top-dir)
        (ad-set-arg 1 vcs-top-dir))))

  (GNUEmacs
    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--ediff-revision</span> (file rev1 <span class="org-type">&amp;optional</span> rev2)
      <span class="org-doc">"Run Ediff by comparing 'master' against the 'current'."</span>
      (<span class="org-keyword">require</span> '<span class="org-constant">ediff</span>)
      (find-file file)
      (<span class="org-keyword">if</span> (and (buffer-modified-p)
               (y-or-n-p (format <span class="org-string">"Buffer %s is modified.  Save buffer? "</span>
                                 (buffer-name))))
          (save-buffer (current-buffer)))
      (ediff-load-version-control)
      (funcall
       (intern (format <span class="org-string">"ediff-%S-internal"</span> ediff-version-control-package))
       rev1 rev2 nil))

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-vc-diff</span> (<span class="org-type">&amp;optional</span> arg)
      (interactive <span class="org-string">"P"</span>)
      (call-interactively
       (<span class="org-keyword">cond</span> (arg
              (<span class="org-keyword">lambda</span> ()
                (interactive)
                (vc-diff nil)))
             (t
              (<span class="org-keyword">lambda</span> ()
                (interactive)
                (leuven--ediff-revision (buffer-file-name)
                                        (read-string <span class="org-string">"revision? "</span>
                                                     <span class="org-string">"HEAD"</span> nil <span class="org-string">"HEAD"</span>)
                                        <span class="org-string">""</span>))))))

    (define-key vc-prefix-map (kbd <span class="org-string">"="</span>) 'leuven-vc-diff))
</pre></div>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Customize `vc-annotate-background' (and future `vc-annotate-foreground')</b><br />
nil</div>
</div>
</div>
</div>
<div id="outline-container-orgheadline289" class="outline-3">
<h3 id="orgheadline289">Change Logs</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline289">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 28.2 (info "(emacs)Change Log")</span>

  (leuven--section <span class="org-string">"28.2 (emacs)Change Logs"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"add-log"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">don't make a new entry, when the last entry was made by you and on</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">the same date</span>
    (setq add-log-always-start-new-record nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">adds the file's version number to the change log entry</span>
    (setq change-log-version-info-enabled t)

    (add-hook 'change-log-mode-hook
              (add-to-list
               'change-log-font-lock-keywords
               '(<span class="org-string">"^[0-9-]+:? +</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">|</span></span><span class="org-string">^</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">(</span></span><span class="org-string">Sun</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">|</span></span><span class="org-string">Mon</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">|</span></span><span class="org-string">Tue</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">|</span></span><span class="org-string">Wed</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">|</span></span><span class="org-string">Thu</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">|</span></span><span class="org-string">Fri</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">|</span></span><span class="org-string">Sat</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">)</span></span><span class="org-string"> [A-z][a-z][a-z] [0-9:+ ]+"</span>
                 (0 'change-log-date-face)
                 (<span class="org-string">"</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">(</span></span><span class="org-string">[</span><span class="org-negation-char"><span class="org-string">^</span></span><span class="org-string">&lt;(]+?</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">)</span></span><span class="org-string">[   ]*[(&lt;]</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">(</span></span><span class="org-string">[[:alnum:]_.+-]+@[[:alnum:]_.-]+</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">)</span></span><span class="org-string">[&gt;)]"</span> nil nil
                  (1 'change-log-name)
                  (2 'change-log-email))))))
</pre></div>
</div>
<div id="outline-container-orgheadline291" class="outline-3">
<h3 id="orgheadline291">Tags Tables (navigating code)</h3>
<div class="outline-text-3" id="text-orgheadline291">
<p>Using tags tables is the most generic approach to setup <b>code navigation</b>. A "tag" signifies a language object for which an index entry is available.</p>
<div class="note">
<p>There are many situations when you cannot or might not want to use <code>tags</code>. You would like to use <a href="#orgheadline258">Imenu</a> because:</p>
<ul class="org-ul">
<li>Imenu is meaningful in non-programing modes and for non-visiting buffers.</li>
<li>Virtually all modes already define Imenu, so it works out of the box everywhere, even if you read a language in which you will never write.</li>
<li>And finally, Imenu operates on what you work on - open files - you don't get thousands of symbols from <code>etags</code> to deal with.</li>
</ul>
<p>Using <code>imenu-anywhere</code> offers a much better, more uniform and more consistent experience than anything else.</p>
</div>
<p>Always run <code>make TAGS</code> right after you build some project.</p>
<p>Once you've built a <code>TAGS</code> file (<code>ctags</code> / <code>etags</code>), you can find all commands that match a regexp.</p>
<p>Support for tags has been in Emacs for a long time: any installation of Emacs should comes with the <code>etags</code> program, which supports many different languages.</p>
<p>Comparison of tools:</p>
<dl class="org-dl">
<dt>etags (Emacs-style TAGS file)</dt>
<dd>
<p>Ada, Asm, C, Objective C, C++, C#, Cobol, Erlang, Forth, Fortran, HTML, Java, Lisp, Lua, Makefile, Pascal, Perl, PHP, Postscript, Prolog, Python, Scheme, TeX, TeXinfo, and YACC.</p>
<p>On Windows, Emacs comes with <code>etags</code> and a similar executable file called <code>ctags</code>. In the Emacs distribution, <code>etags.exe</code> = <code>ctags.exe</code> in the <code>bin</code> directory.</p>
</dd>
<dt>Exuberant Ctags</dt>
<dd>
<p>Ant, Asm, Asp, Awk, Basic, BETA, C, C++, C#, Cobol, DosBatch, Eiffel, Erlang, Flex, Fortran, HTML, Java, JavaScript, Lisp, Lua, Makefile, MatLab, OCaml, Pascal, Perl, PHP, Python, REXX, Ruby, Scheme, Sh, SLang, SML, SQL, Tcl, TeX, Vera, Verilog, VHDL, Vim, and YACC.</p>
<p>You should download <b>Exuberant Ctags</b> from <a href="http://ctags.sourceforge.net/">http://ctags.sourceforge.net/</a> or from Cygwin. Only <b>Exuberant</b> <code>ctags.exe</code> recognizes <code>-e</code> option (<i>etags mode</i>, which will create a tag file for use with the Emacs editor).</p>
<p>Exuberant Ctags can be extended to look for other things via regular expression. It is a wonderful thing!</p>
<p>For example, I can now look for tags in my shell code to by running:</p>
<div class="org-src-container">
<pre class="src src-shell">
etags --langdef=shell --regex-shell=<span class="org-string">'/function [_[:alnum:]]+/[_[:alnum:]]+/'</span> --language-force=shell
</pre></div>
</dd>
<dt>Cscope</dt>
<dd>C, but flexible enough to support C++ and Java, and to be used as a generalized "grep database".</dd>
<dt>ebrowse</dt>
<dd>For C++, you will be better off with ebrowse, a program that also comes with Emacs. It understands C++ much better than etags does, and provides similar commands (so you don't lose anything). Check out the Ebrowse manual, which is part of the Emacs distribution, for details.</dd>
<dt>GNU Idutils</dt>
<dt>GNU Global (gtags)</dt>
<dd>
<p>C, C++, Yacc, Java, and PHP4.</p>
<p>Global is a lot smarter about finding tags tables, and is fairly fast to update.</p>
</dd>
</dl>
<p><b>Emacs TAGS</b> and <b>Exuberant Ctags</b> don't do fancy stuff, e.g. keeping an index of function references. They record only positions where a function (or variable etc.) is <b>defined</b>.</p>
<p>Recording positions where a function is <b>called</b> (finding all <b>symbol references</b>) is the kind of thing external tools such as <b>GNU Global</b>, <b>GNU Idutils</b> and <b>Cscope</b> can do for you, if you're working with a language that they support. <b>Grep</b> would be the fallback method.</p>
<p>Please also see <a href="http://hub.opensolaris.org/bin/view/Project+opengrok/">Comparison with Similar Tools</a>.</p>
<p>Once you have a good tagging system in place, many tools become enabled for your language, such as:</p>
<ul class="org-ul">
<li>tag decoration mode (like drawing lines over the top of function tags),</li>
<li>stickyfunc mode (which shows the current function in the header line),</li>
<li><a href="#orgheadline290">Emacs Code Browser</a>, and</li>
<li>tag jumping.</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 28.3 (info "(emacs)Tags")</span>

  (leuven--section <span class="org-string">"28.3 (emacs)Tags Tables"</span>)
</pre></div>
</div>
<div id="outline-container-orgheadline292" class="outline-4">
<h4 id="orgheadline292">Creating Tags Tables</h4>
<div class="outline-text-4" id="text-orgheadline292">
<p>First of all, you must build a <code>TAGS</code> file (which keeps the symbols from your project, by scanning all the source and header files with the <code>etags</code> command).</p>
<p>For example, you can have a <code>TAGS</code> Makefile target to do this for you:</p>
<div class="org-src-container">
<pre class="src src-makefile">
<span class="org-makefile-targets">TAGS</span>:
<span class="org-whitespace-indentation">        </span>rm -f TAGS
<span class="org-whitespace-indentation">        </span>find $$(pwd) \( -name \*.el \
<span class="org-whitespace-indentation">                </span>     -o -name \*.[chCH] \
<span class="org-whitespace-indentation">                </span>     \) -print | /usr/bin/ctags -e -
</pre></div>
<p>You can create a <code>TAGS</code> file by using <code>M-x compile &lt;RET&gt; tags &lt;RET&gt;</code>. Every time you changes your source file, you need to regenerate the tag file.</p>
<p>Alternatively,</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"etags"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">tags enhancements</span>
    (try-require 'sure-tags))
</pre></div>
<p>will make sure that <code>TAGS</code> file exists (and builds it if it doesn't), allowing you to</p>
<ul class="org-ul">
<li>first rebuild the <code>TAGS</code> file or</li>
<li>specify a new one</li>
</ul>
<p>when the search fails.</p>
</div>
</div>
<div id="outline-container-orgheadline293" class="outline-4">
<h4 id="orgheadline293">Selecting a Tags Table</h4>
<div class="outline-text-4" id="text-orgheadline293">
<p>After this, you can select the tag file to use with the command <code>M-x visit-tags-table &lt;RET&gt;</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">list of file names of tags tables to search</span>
  (setq tags-table-list
        '(
          <span class="org-string">"~/TAGS"</span>
          <span class="org-comment-delimiter">;; </span><span class="org-comment">"/usr/local/lib/emacs/src/TAGS"</span>
          <span class="org-comment-delimiter">;; </span><span class="org-comment">"/usr/share/texmf-texlive/tex/latex/TAGS"</span>
          ))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline294" class="outline-4">
<h4 id="orgheadline294">Finding a Tag (go to function definition)</h4>
<div class="outline-text-4" id="text-orgheadline294">
<p>You can <b>go to</b> the first <b>definition</b> of a tag (matching your regexp) - <b>according</b> <b>to TAGS file</b> - by using <code>M-x find-tag</code> (bound to <code>M-.</code>). The default tag is the identifier under the cursor.</p>
<p>To continue searching for <b>next definition</b>, use <code>C-u M-.</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class="org-function-name">find-next-tag</span> ()
    (interactive)
    (find-tag nil t))
</pre></div>
<p>Use <code>M-*</code> (<code>M-x pop-tag-mark</code>) to <b>jump back</b> to where you last invoked <code>M-.</code>.</p>
<p>XXX See <a href="http://marmalade-repo.org/packages/jump-dls">http://marmalade-repo.org/packages/jump-dls</a> to jump to the source of the symbol at point using a number of possible methods, such as semantic, tags, etc.</p>
</div>
</div>
<div id="outline-container-orgheadline295" class="outline-4">
<h4 id="orgheadline295">Select from multiple TAGS files</h4>
<div class="outline-text-4" id="text-orgheadline295">
<p>You can search for <b>occurrences</b> of tags that match you regexp on all files in the TAGS table, by using <code>M-x tags-search &lt;RET&gt;</code>.</p>
<p>To continue searching for next match, use ~M-,~.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"etags"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">select from multiple tags</span>
    (try-require 'etags-select))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"etags-select"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">do a `</span><span class="org-constant"><span class="org-comment">find-tag-at-point</span></span><span class="org-comment">', and display all exact matches</span>
    (global-set-key (kbd <span class="org-string">"M-?"</span>) 'etags-select-find-tag-at-point))
</pre></div>
<p>However, the default Emacs' etag feature is not quite good. You should use etags provided by Helm. Instead of activating <code>etags-select-goto-tag</code>, try <code>helm-etags-select</code>. If the project is big, it take some time to load tag file. But when it is done, the next search will be very fast.</p>
<p>See <a href="http://truongtx.me/2014/04/20/emacs-javascript-completion-and-refactoring/">http://truongtx.me/2014/04/20/emacs-javascript-completion-and-refactoring/</a>.</p>
</div>
</div>
<div id="outline-container-orgheadline296" class="outline-4">
<h4 id="orgheadline296">Find Emacs Lisp symbol definition</h4>
<div class="outline-text-4" id="text-orgheadline296">
<p>Find the definition of the Emacs Lisp symbol near point:</p>
<dl class="org-dl">
<dt><code>C-x F</code></dt>
<dd>Find <b>function</b>.</dd>
<dt><code>C-x V</code></dt>
<dd>Find <b>variable</b>.</dd>
<dt><code>C-x K</code></dt>
<dd>Find function <b>bound to key</b> sequence.</dd>
</dl>
<p>Use <code>C-x 4</code> for displaying in another window, and <code>C-x 5</code> for displaying in another frame.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">find the definition of the Emacs Lisp function or variable near point</span>
  (GNUEmacs
    (find-function-setup-keys))
</pre></div>
<p>Go to source code for symbol at point:</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"lisp-mode"</span>

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-goto-lisp-symbol-at-point</span> ()
      <span class="org-doc">"Go to the definition of the Emacs Lisp symbol at point."</span>
      (interactive)
      (<span class="org-keyword">require</span> '<span class="org-constant">thingatpt</span>)              <span class="org-comment-delimiter">; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment"> use find-tag instead?</span>
      (<span class="org-keyword">let</span> ((sym (symbol-at-point)))    <span class="org-comment-delimiter">; </span><span class="org-comment">or (find-tag-default) or (current-word)?</span>
        (funcall (<span class="org-keyword">pcase</span> sym
                   ((pred facep)           'find-face)
                   ((pred symbol-function) 'find-function)
                   (_                      'find-variable))
                 sym)))

    (define-key emacs-lisp-mode-map (kbd <span class="org-string">"M-."</span>) 'leuven-goto-lisp-symbol-at-point))
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline299" class="outline-3">
<h3 id="orgheadline299">Emacs Development Environment</h3>
<div class="outline-text-3" id="text-orgheadline299"></div>
<div id="outline-container-orgheadline297" class="outline-4">
<h4 id="orgheadline297">Collection of Emacs Development Environment Tools</h4>
<div class="outline-text-4" id="text-orgheadline297">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 28.4 (info "(emacs)EDE")</span>

  (leuven--section <span class="org-string">"28.4 Emacs Development Environment"</span>)
</pre></div>
<p>CEDET (integrated into Emacs 23.2) brings improvements over a plain TAGS file. It provides:</p>
<dl class="org-dl">
<dt><a href="http://www.gnu.org/software/emacs/manual/semantic.html">Semantic</a></dt>
<dd>A <b>parser</b> and code analyzer which provides <b>smart completion</b> ("Intellisense").</dd>
<dt>EDE</dt>
<dd>
<p>A <b>project management</b> system which can <b>generate Makefiles</b> to compile your code for you.</p>
<p>(Look as well at Projectile!)</p>
</dd>
<dt>SRecode</dt>
<dd>A template / <b>code generation</b> system which can convert tags from semantic back into code.</dd>
<dt>COGRE (COnnected GRaph Editor)</dt>
<dd>A <b>UML diagram editor</b> which can generate code from a class diagram that you draw in Emacs.</dd>
</dl>
<p>See <a href="http://cedet.sourceforge.net/languagesupport.shtml">supported languages</a>.</p>
<p>The commands to display <b>symbol references</b> are:</p>
<dl class="org-dl">
<dt><code>C-c , g</code></dt>
<dd><code>semantic-symref-symbol</code>.</dd>
<dt><code>C-c , G</code></dt>
<dd><code>semantic-symref</code> (current tag).</dd>
</dl>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">unless</span> (string&lt; emacs-version <span class="org-string">"23.2"</span>)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; enable global EDE (project management) features</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-ede-mode 1)</span>

    (setq semantic-default-submodes
          '(
            <span class="org-comment-delimiter">;; </span><span class="org-comment">turn Semantic DB mode on (Semantic parsers store the results of</span>
            <span class="org-comment-delimiter">;; </span><span class="org-comment">parsing source code in a database file, which can be saved for</span>
            <span class="org-comment-delimiter">;; </span><span class="org-comment">future Emacs sessions)</span>
            global-semanticdb-minor-mode

            <span class="org-comment-delimiter">;; </span><span class="org-comment">the idle scheduler will automatically reparse buffers in idle</span>
            <span class="org-comment-delimiter">;; </span><span class="org-comment">time</span>
            global-semantic-idle-scheduler-mode <span class="org-comment-delimiter">; </span><span class="org-comment">[minimum-features]</span>

            <span class="org-comment-delimiter">;; </span><span class="org-comment">display a summary of the symbol at point in the echo area</span>
            <span class="org-comment-delimiter">;; </span><span class="org-comment">(~ ElDoc)</span>
            global-semantic-idle-summary-mode <span class="org-comment-delimiter">; </span><span class="org-comment">[code-helpers]</span>

            <span class="org-comment-delimiter">;; </span><span class="org-comment">display a tooltip with a list of possible completions near the</span>
            <span class="org-comment-delimiter">;; </span><span class="org-comment">cursor</span>
            global-semantic-idle-completions-mode <span class="org-comment-delimiter">; </span><span class="org-comment">[gaudy-code-helpers]</span>

            <span class="org-comment-delimiter">;; </span><span class="org-comment">turn Semantic MRU Bookmarks on (keep track of the Most</span>
            <span class="org-comment-delimiter">;; </span><span class="org-comment">Recently Used tags)</span>
            global-semantic-mru-bookmark-mode

            <span class="org-comment-delimiter">;; </span><span class="org-comment">enable Semantic-Stickyfunc mode (display a header line that shows</span>
            <span class="org-comment-delimiter">;; </span><span class="org-comment">the declaration line of the function or tag)</span>
            global-semantic-stickyfunc-mode <span class="org-comment-delimiter">; </span><span class="org-comment">[gaudy-code-helpers]</span>

            <span class="org-comment-delimiter">;; </span><span class="org-comment">enable Semantic-Highlight-Func mode</span>
            global-semantic-highlight-func-mode <span class="org-comment-delimiter">; </span><span class="org-comment">[excessive-code-helpers]</span>

            <span class="org-comment-delimiter">;; </span><span class="org-comment">turn on all active decorations</span>
            global-semantic-decoration-mode <span class="org-comment-delimiter">; </span><span class="org-comment">[gaudy-code-helpers]</span>
            ))

    <span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment"> if prog-mode, then Semantic will be launched after Emacs init, as</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">the scratch buffer is in Emacs Lisp...</span>
    (add-hook 'java-mode-hook 'semantic-mode) <span class="org-comment-delimiter">; </span><span class="org-comment">enable parser features (Semantic</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">mode) and install a `</span><span class="org-constant"><span class="org-comment">Development</span></span><span class="org-comment">' menu</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">on the menu-bar</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; smart completion, and display of information for tags &amp; classes</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(require 'semantic/ia)</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(require 'semantic/db)</span>

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"semantic"</span>

      (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--semantic</span> ()
        <span class="org-comment-delimiter">;; </span><span class="org-comment">automatically complete whatever symbol you are typing</span>
        (local-set-key
          (kbd <span class="org-string">"C-c ?"</span>) 'semantic-ia-complete-symbol) <span class="org-comment-delimiter">; </span><span class="org-comment">better binding: `</span><span class="org-constant"><span class="org-comment">M-/</span></span><span class="org-comment">'?</span>

        <span class="org-comment-delimiter">;; </span><span class="org-comment">jump to the definition of the symbol under cursor</span>
        (local-set-key
          (kbd <span class="org-string">"C-c j"</span>) 'semantic-ia-fast-jump) <span class="org-comment-delimiter">; </span><span class="org-comment">where a symbol is declared</span>

        <span class="org-comment-delimiter">;; </span><span class="org-comment">show the documentation of the symbol under cursor</span>
        (local-set-key
          (kbd <span class="org-string">"C-c q"</span>) 'semantic-ia-show-doc) <span class="org-comment-delimiter">; </span><span class="org-comment">show javadoc of the right method</span>

        <span class="org-comment-delimiter">;; </span><span class="org-comment">show a summary about the symbol under cursor</span>
        (local-set-key
          (kbd <span class="org-string">"C-c s"</span>) 'semantic-ia-show-summary)


        <span class="org-comment-delimiter">;; </span><span class="org-comment">show possible public member functions or data members (when at `.'</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">or `</span><span class="org-constant"><span class="org-comment">-&gt;</span></span><span class="org-comment">' after an object name)</span>
        (local-set-key
          (kbd <span class="org-string">"C-c &gt;"</span>) 'semantic-complete-analyze-inline)

        <span class="org-comment-delimiter">;; </span><span class="org-comment">toggle between the implementation and a prototype of symbol under</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">cursor</span>
        (local-set-key
          (kbd <span class="org-string">"C-c p"</span>) 'semantic-analyze-proto-impl-toggle)

        <span class="org-comment-delimiter">;; </span><span class="org-comment">visit the header file under cursor</span>
        (local-set-key
          (kbd <span class="org-string">"C-c ="</span>) 'semantic-decoration-include-visit)


        <span class="org-comment-delimiter">;; </span><span class="org-comment">unfold the block under cursor</span>
        (local-set-key
          (kbd <span class="org-string">"C-c +"</span>) 'semantic-tag-folding-show-block)

        <span class="org-comment-delimiter">;; </span><span class="org-comment">fold the block under cursor</span>
        (local-set-key
          (kbd <span class="org-string">"C-c -"</span>) 'semantic-tag-folding-fold-block)

        <span class="org-comment-delimiter">;; </span><span class="org-comment">C-c C-c is not a prefix key!</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">;; unfold all</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">(local-set-key</span>
        <span class="org-comment-delimiter">;;   </span><span class="org-comment">(kbd "C-c C-c +") 'semantic-tag-folding-show-all)</span>
        <span class="org-comment-delimiter">;;</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">;; fold all</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">(local-set-key</span>
        <span class="org-comment-delimiter">;;   </span><span class="org-comment">(kbd "C-c C-c -") 'semantic-tag-folding-fold-all)</span>
        )

      (add-hook 'prog-mode-hook 'leuven--semantic)

      (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--c-mode-semantic</span> ()
        <span class="org-doc">"Completion on `.' or `</span><span class="org-constant"><span class="org-doc">-&gt;</span></span><span class="org-doc">'."</span>
        (local-set-key (kbd <span class="org-string">"."</span>) 'semantic-complete-self-insert)
        (local-set-key (kbd <span class="org-string">"&gt;"</span>) 'semantic-complete-self-insert)
        (local-set-key (kbd <span class="org-string">"C-c C-r"</span>) 'semantic-symref))

      (add-hook 'c-mode-common-hook 'leuven--c-mode-semantic))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Note that this will apply to all</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">cc-modes, e.g. c-mode, c++-mode,</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">php-mode, csharp-mode, awk-mode.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">hooks, specific for Semantic</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--semantic-imenu</span> ()
      (imenu-add-to-menubar <span class="org-string">"TAGS"</span>))

    (add-hook 'semantic-init-hooks 'leuven--semantic-imenu)

    )
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline290" class="outline-4">
<h4 id="orgheadline290"><a id="ID-5032bcdb-ac6b-4101-a0ce-28192fb7e247" name="ID-5032bcdb-ac6b-4101-a0ce-28192fb7e247"></a>Advanced Code Browsing</h4>
<div class="outline-text-4" id="text-orgheadline290">
<p>Some people use CEDET in combination with <a href="http://www.xemacs.org/Documentation/packages/html/ecb_2.html">ECB (the Emacs Code Browser)</a>, which provides views of directories and files.</p>
<p>Keyboard navigation:</p>
<dl class="org-dl">
<dt><code>C-c . g d</code></dt>
<dd>Go to directories.</dd>
<dt><code>C-c . g s</code></dt>
<dd>Go to sources.</dd>
<dt><code>C-c . g m</code></dt>
<dd>Go to methods.</dd>
<dt><code>C-c . g h</code></dt>
<dd>Go to history.</dd>
<dt><code>C-c . g 1</code></dt>
<dd>Go to edit buffer.</dd>
</dl>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Emacs Code Browser</span>
  (custom-set-variables '(ecb-options-version <span class="org-string">"2.40"</span>))
  (try-require 'ecb-autoloads)
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ecb-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">trick for starting ECB 2.40 (with CEDET merged in Emacs since 23.2)</span>
    (GNUEmacs
      (<span class="org-keyword">require</span> '<span class="org-constant">semantic/analyze</span>))
    (<span class="org-keyword">provide</span> '<span class="org-constant">semantic-analyze</span>)
    (<span class="org-keyword">provide</span> '<span class="org-constant">semantic-ctxt</span>)
    (<span class="org-keyword">provide</span> '<span class="org-constant">semanticdb</span>)
    (<span class="org-keyword">provide</span> '<span class="org-constant">semanticdb-find</span>)
    (<span class="org-keyword">provide</span> '<span class="org-constant">semanticdb-mode</span>)
    (<span class="org-keyword">provide</span> '<span class="org-constant">semantic-load</span>)

    (setq stack-trace-on-error t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">don't show tip of the day at start time of ECB</span>
    (setq ecb-tip-of-the-day nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; toggle activation of ECB (between `</span><span class="org-constant"><span class="org-comment">ecb-activate</span></span><span class="org-comment">' and `</span><span class="org-constant"><span class="org-comment">ecb-deactivate</span></span><span class="org-comment">')</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-c e") 'ecb-minor-mode)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "&lt;M-left&gt;") 'ecb-goto-window-methods)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "&lt;M-right&gt;") 'ecb-goto-window-edit1)</span>
    )
</pre></div>
<p>If you've installed CEDET and ECB, EmacsAssist is worth trying out: <a href="http://www.mail-archive.com/gnu-emacs-sources@gnu.org/msg00292.html">http://www.mail-archive.com/gnu-emacs-sources@gnu.org/msg00292.html</a></p>
<p>It uses CEDET to provide a handy symbols browser for the current file, that narrows down the list as you type substrings. Tastes differ, but I for one really like this.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
   (try-require 'eassist)
   (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"eassist"</span>

     (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--c-mode-eassist</span> ()
       (local-set-key (kbd <span class="org-string">"C-c t"</span>) 'eassist-switch-h-cpp)
       (local-set-key (kbd <span class="org-string">"C-x t"</span>) 'eassist-switch-h-cpp)
       <span class="org-comment-delimiter">;; </span><span class="org-comment">(local-set-key (kbd "C-c e") 'eassist-list-methods)</span>
       )

     (add-hook 'c-mode-common-hook 'leuven--c-mode-eassist))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Note that this will apply to all</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">cc-modes, e.g. c-mode, c++-mode,</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">php-mode, csharp-mode, awk-mode.</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 28 ends here</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline298" class="outline-4">
<h4 id="orgheadline298">Refactoring</h4>
<div class="outline-text-4 org-src-container" id="text-orgheadline298">
<pre class="src src-emacs-lisp">
(req-package emr
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">progn</span> (emr-initialize)
                 (define-key emacs-lisp-mode-map
                   (kbd <span class="org-string">"M-RET"</span>)
                   'emr-show-refactor-menu)))
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline300" class="outline-2">
<h2 id="orgheadline300">Abbrevs</h2>
<div class="outline-text-2" id="text-orgheadline300">
<p>An "abbrev" is a <b>word</b> which has been defined (in a fixed list) to "expand" into a specified <b>expansion</b>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 29 (info "(emacs)Abbrevs")</span>

(leuven--chapter leuven-load-chapter-29-abbrevs <span class="org-string">"29 Abbrevs"</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">See (info "(autotype)") as well</span>
</pre></div>
</div>
<div id="outline-container-orgheadline301" class="outline-3">
<h3 id="orgheadline301">Controlling Abbrev Expansion</h3>
<div class="outline-text-3" id="text-orgheadline301">
<p>Inspired by <a href="http://macromates.com/">TextMate</a>.</p>
<p>For complex templates, I use <code>YASnippet</code>. For example, new file templates (where it's Lisp evaluation is handy), class and function templates with docblocks, etc. I use it to reduce the repetitious parts of programming, and let me focus on getting things done.</p>
<p><code>YASnippet</code> does support mirror fields and transformations. It also does support multiple snippets with same name. It will also expand snippets containing non-word-constituent characters, which <code>abbrev</code> can't. So I can't have <code>@p</code> expand to <code>@param</code> with <code>abbrev</code>, but I can with <code>YASnippet</code>.</p>
<p>XXX Look at <a href="https://github.com/vderyagin/dotemacs/blob/master/conf/yasnippet-configuration.el">https://github.com/vderyagin/dotemacs/blob/master/conf/yasnippet-configuration.el</a></p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 29.3 Controlling (info "(emacs)Expanding Abbrevs")</span>

  (leuven--section <span class="org-string">"29.3 Controlling Expanding Abbrevs"</span>)
</pre></div>
</div>
<div id="outline-container-orgheadline302" class="outline-4">
<h4 id="orgheadline302">Installation</h4>
<div class="outline-text-4 org-src-container" id="text-orgheadline302">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Yet Another Snippet extension for Emacs</span>
  (GNUEmacs
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"yasnippet-autoloads"</span>
      (idle-require 'yasnippet))

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"yasnippet"</span>
</pre></div>
<div id="outline-container-orgheadline303" class="outline-5">
<h5 id="orgheadline303">Use YASnippet as a global minor mode</h5>
<div class="outline-text-5 org-src-container" id="text-orgheadline303">
<pre class="src src-emacs-lisp">
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable YASnippet in all buffers.</span>
      (yas-global-mode 1)
</pre></div>
</div>
<div id="outline-container-orgheadline304" class="outline-5">
<h5 id="orgheadline304">Use <code>yas-minor-mode</code> on a per-buffer basis</h5>
<div class="outline-text-5" id="text-orgheadline304">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable YASnippet in programming modes only.</span>
      (add-hook 'prog-mode-hook 'yas-minor-mode)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq yas-verbosity 1)</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Load the snippet tables.</span>
      (yas-reload-all)
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline305" class="outline-4">
<h4 id="orgheadline305">Organizing snippets</h4>
<div class="outline-text-4" id="text-orgheadline305">
<p>Where are the snippets? <code>yas-snippet-dirs</code> is assumed to contain <b>directories of modes</b> with snippets. By default, put <b>your own snippets</b> in the directory <code>~/.emacs.d/snippets</code>.</p>
<p>Load additional snippets.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Add root directories that store the snippets.</span>
      (<span class="org-keyword">let</span> ((leuven-snippets            <span class="org-comment-delimiter">; </span><span class="org-comment">Additional YASnippets.</span>
             (concat leuven--directory <span class="org-string">"snippets"</span>))
            (org-snippets
             (concat leuven--local-repos-directory <span class="org-string">"yasnippet-org-mode"</span>)))

        (<span class="org-keyword">when</span> (file-directory-p org-snippets)
          (add-to-list 'yas-snippet-dirs org-snippets))

        (<span class="org-keyword">when</span> (file-directory-p leuven-snippets)
          (add-to-list 'yas-snippet-dirs leuven-snippets)))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">The first element (inserted last) is</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">always the user-created snippets</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">directory.</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Use Snippet mode for files with a `</span><span class="org-constant"><span class="org-comment">yasnippet</span></span><span class="org-comment">' extension.</span>
      (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.yasnippet\\'"</span> . snippet-mode))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline306" class="outline-4">
<h4 id="orgheadline306">Expanding snippets</h4>
<div class="outline-text-4" id="text-orgheadline306">
<dl class="org-dl">
<dt><code>C-c &amp; C-s</code></dt>
<dd>Insert snippet at point.</dd>
</dl>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Bind `</span><span class="org-constant"><span class="org-comment">yas-expand</span></span><span class="org-comment">' to SPC.</span>
      (define-key yas-minor-mode-map (kbd <span class="org-string">"&lt;tab&gt;"</span>) nil)
      (define-key yas-minor-mode-map (kbd <span class="org-string">"TAB"</span>) nil)
      (define-key yas-minor-mode-map (kbd <span class="org-string">"SPC"</span>) 'yas-expand)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't expand when you are typing in a string or comment.</span>
      (add-hook 'prog-mode-hook
                '(<span class="org-keyword">lambda</span> ()
                   (setq yas-buffer-local-condition
                         '(<span class="org-keyword">if</span> (nth 8 (syntax-ppss))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Non-nil if in a string or comment.</span>
                              '(require-snippet-condition . force-in-comment)
                            t))))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">UI for selecting snippet when there are multiple candidates.</span>
      (setq yas-prompt-functions '(yas-dropdown-prompt))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline307" class="outline-4">
<h4 id="orgheadline307">Writing snippets</h4>
<div class="outline-text-4" id="text-orgheadline307">
<p>See <a href="http://cupfullofcode.com/snippet-expansion-with-yasnippet/">http://cupfullofcode.com/snippet-expansion-with-yasnippet/</a>.</p>
<dl class="org-dl">
<dt><code>C-c &amp; C-n</code> (<code>yas-new-snippet</code>)</dt>
<dd>Creates a new snippet, pre-filled out with the basic structure.</dd>
<dt><code>C-c &amp; C-v</code></dt>
<dd><code>yas-visit-snippet-file</code>.</dd>
</dl>
</div>
</div>
<div id="outline-container-orgheadline308" class="outline-4">
<h4 id="orgheadline308">YASnippet menu</h4>
<div class="outline-text-4" id="text-orgheadline308">
<p>After editing your snippets:</p>
<ul class="org-ul">
<li><code>M-x yas-recompile-all</code> to compile all snippets,</li>
<li><code>M-x yas-reload-all</code> to reload them all.</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
      (global-set-key (kbd <span class="org-string">"C-c &amp; C-r"</span>) 'yas-reload-all)
</pre></div>
<p>Automatically reload snippets after saving.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Automatically reload snippets after saving.</span>
      (<span class="org-keyword">defun</span> <span class="org-function-name">recompile-and-reload-all-snippets</span> ()
        (interactive)
        (<span class="org-keyword">when</span> (derived-mode-p 'snippet-mode)
          (yas-recompile-all)
          (yas-reload-all)
          (message <span class="org-string">"Reloaded all snippets"</span>)))

      (add-hook 'after-save-hook 'recompile-and-reload-all-snippets)
</pre></div>
<p>Display all available snippets with <code>M-x yas-describe-tables</code> (or <code>C-c &amp; C-l</code> in Emacs Leuven):</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
      (global-set-key (kbd <span class="org-string">"C-c &amp; C-l"</span>) 'yas-describe-tables)
</pre></div>
<p>See <a href="http://stackoverflow.com/questions/10155181/display-all-snippets-of-yasnippet">http://stackoverflow.com/questions/10155181/display-all-snippets-of-yasnippet</a>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
      (<span class="org-keyword">defvar</span> <span class="org-variable-name">lawlist-context-menu-map</span>
        (<span class="org-keyword">let</span> ((map (make-sparse-keymap <span class="org-string">"Context Menu"</span>)))
          (define-key map [help-for-help] (cons <span class="org-string">"Help"</span> 'help-for-help))
          (define-key map [seperator-two] '(menu-item <span class="org-string">"--"</span>))
          (define-key map [my-menu] (cons <span class="org-string">"LAWLIST"</span> (make-sparse-keymap <span class="org-string">"My Menu"</span>)))
          (define-key map [my-menu 01] (cons <span class="org-string">"Next Line"</span> 'next-line))
          (define-key map [my-menu 02] (cons <span class="org-string">"Previous Line"</span> 'previous-line))
          (define-key map [seperator-one] '(menu-item <span class="org-string">"--"</span>))
        map) <span class="org-doc">"Keymap for the LAWLIST context menu."</span>)

      (<span class="org-keyword">defun</span> <span class="org-function-name">lawlist-popup-context-menu</span>  (event <span class="org-type">&amp;optional</span> prefix)
        <span class="org-doc">"Popup a context menu."</span>
        (interactive <span class="org-string">"@e \nP"</span>)
          (define-key lawlist-context-menu-map [lawlist-major-mode-menu]
            `(menu-item ,(symbol-name major-mode)
              ,(mouse-menu-major-mode-map) <span class="org-builtin">:visible</span> t))
          (define-key lawlist-context-menu-map (vector major-mode)
            `(menu-item ,(concat <span class="org-string">"YAS "</span> (symbol-name major-mode))
              ,(gethash major-mode yas--menu-table)
                <span class="org-builtin">:visible</span> (yas--show-menu-p ',major-mode)))
          (popup-menu lawlist-context-menu-map event prefix))

      (global-set-key [mouse-3] 'lawlist-popup-context-menu)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline312" class="outline-4">
<h4 id="orgheadline312">Frequently Asked Questions</h4>
<div class="outline-text-4" id="text-orgheadline312"></div>
<div id="outline-container-orgheadline309" class="outline-5">
<h5 id="orgheadline309">Why is there an extra newline?</h5>
<div class="outline-text-5 org-src-container" id="text-orgheadline309">
<pre class="src src-emacs-lisp">
      (add-hook 'snippet-mode-hook
                (<span class="org-keyword">lambda</span> ()
                  (setq require-final-newline nil)))
</pre></div>
</div>
<div id="outline-container-orgheadline310" class="outline-5">
<h5 id="orgheadline310">Why doesn't TAB expand a snippet?</h5>
<div class="outline-text-5" id="text-orgheadline310">
<ol class="org-ol">
<li>
<p>Check the mode line to see if there's <code>yas</code>. If not, then try <code>M-x yas-minor-mode</code> to manually turn on the minor mode and try to expand the snippet again.</p>
<p>If it works, then, you can add the following code to your <code>.emacs</code> before loading YASnippet:</p>
<pre class="example">
(add-hook 'the-major-mode-hook 'yas-minor-mode-on)
</pre>
<p>where <code>the-major-mode</code> is the major mode in which <code>yas-minor-mode</code> isn't enabled by default.</p>
<p>You can also use the command <code>M-x yas-global-mode</code> to turn on YASnippet automatically for all major modes.</p>
</li>
<li>
<p>If <code>yas-minor-mode</code> is on but the snippet still not expanded, then try to see what command is bound to the <code>TAB</code> key: press <code>C-h k</code> and then press <code>TAB</code>. Emacs will show you the result.</p>
<p>You'll see a buffer prompted by Emacs saying that <code>TAB</code> runs the command "". Alternatively, you might see <code>&lt;tab&gt;</code> runs the command "". Note the difference between <code>TAB</code> and <code>&lt;tab&gt;</code> where the latter has priority.</p>
<p>If you see <code>&lt;tab&gt;</code> bound to a command other than <code>yas-expand</code> (e.g. in org-mode), you can try a work around. See <a href="https://github.com/capitaomorte/yasnippet/blob/master/doc/faq.org">https://github.com/capitaomorte/yasnippet/blob/master/doc/faq.org</a>.</p>
</li>
</ol>
</div>
</div>
<div id="outline-container-orgheadline311" class="outline-5">
<h5 id="orgheadline311">yas-key-syntaxes</h5>
<div class="outline-text-5" id="text-orgheadline311">
<p><code>yas-key-syntaxes</code> is the variable that allows you control the behavior "don't expand words finishing with the snippet key", even if:</p>
<ul class="org-ul">
<li>the default syntax table for the major mode you are working on says that "C-s" (for example) is two separate words, and</li>
<li>assuming you don't want to fix the major mode's behavior.</li>
</ul>
<p>Find it at <a href="http://capitaomorte.github.io/yasnippet/snippet-reference.html#yas-key-syntaxes">http://capitaomorte.github.io/yasnippet/snippet-reference.html#yas-key-syntaxes</a></p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
      <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Make the "yas/minor-mode"'s expansion behavior to take input word</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">;; including hyphen.</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq yas-key-syntaxes '("w_" "w_." "^ "))</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">[default:</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">'("w" "w_" "w_." "w_.()"</span>
                                        <span class="org-comment-delimiter">;   </span><span class="org-comment">yas-try-key-from-whitespace)]</span>

      )
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline313" class="outline-4">
<h4 id="orgheadline313">Reference</h4>
<div class="outline-text-4 org-src-container" id="text-orgheadline313">
<pre class="src src-emacs-lisp">
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Log level for `</span><span class="org-constant"><span class="org-comment">yas--message</span></span><span class="org-comment">'.</span>
      (setq yas-verbosity 2))           <span class="org-comment-delimiter">; </span><span class="org-comment">Warning.</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline265" class="outline-3">
<h3 id="orgheadline265"><a id="ID-0fa23e4a-e42c-4317-834c-d2ef7c9d741c" name="ID-0fa23e4a-e42c-4317-834c-d2ef7c9d741c"></a>Dynamic Abbrev Expansion</h3>
<div class="outline-text-3" id="text-orgheadline265">
<p>"Dynamic abbrevs" allow the meanings of abbreviations (expansions) to be <b>determined automatically from the contents of the buffer</b>. It is completely independent of Abbrev mode.</p>
<ul class="org-ul">
<li><code>M-/</code> runs the command <code>dabbrev-expand</code> by default. Expand previous word "dynamically". <b>Expands to the most recent, preceding word</b> for which this is a prefix.</li>
<li><code>C-M-/</code> runs the command <code>dabbrev-completion</code>. Completion on current word. Like <code>M-/</code> but finds all expansions in the current buffer and <b>presents suggestions for completion</b>.</li>
</ul>
<p>See <a href="#orgheadline266">completion for symbol names</a>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 29.7 (info "(emacs)Dabbrev Customization")</span>

  (leuven--section <span class="org-string">"29.7 Dabbrev Customization"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "dabbrev"</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; Preserve case when expanding the abbreviation.</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(setq dabbrev-case-replace nil))</span>
</pre></div>
</div>
<div id="outline-container-orgheadline314" class="outline-4">
<h4 id="orgheadline314">Hippie-expand</h4>
<div class="outline-text-4" id="text-orgheadline314">
<p>Typically, we bind <code>hippie-expand</code> to <code>M-/</code>, with <code>dabbrev-expand</code> (the standard binding of <code>M-/</code>) providing one of the expansion possibilities.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Expand text trying various ways to find its expansion.</span>
  (global-set-key (kbd <span class="org-string">"M-/"</span>) 'hippie-expand) <span class="org-comment-delimiter">; </span><span class="org-comment">Built-in.</span>
</pre></div>
<div class="note">
<p>Would we want to bind <code>hippie-expand</code> on TAB, we should have to write a <code>smart-tab</code> command which would look if the major mode is Org and then act differently</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"hippie-exp"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">List of expansion functions tried (in order) by `</span><span class="org-constant"><span class="org-comment">hippie-expand</span></span><span class="org-comment">'</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(completion strategy).</span>
    (setq hippie-expand-try-functions-list
          '(try-expand-all-abbrevs      <span class="org-comment-delimiter">; </span><span class="org-comment">Abbreviations.</span>

            try-expand-dabbrev          <span class="org-comment-delimiter">; </span><span class="org-comment">Current buffer.</span>
            try-expand-dabbrev-visible  <span class="org-comment-delimiter">; </span><span class="org-comment">Visible (parts of all) buffers.</span>
            <span class="org-comment-delimiter">;; </span><span class="org-comment">try-expand-dabbrev-all-buffers ; (Almost) all buffers (see `</span><span class="org-constant"><span class="org-comment">hippie-expand-ignore-buffers</span></span><span class="org-comment">').</span>
            try-expand-dabbrev-from-kill <span class="org-comment-delimiter">; </span><span class="org-comment">Kill ring.</span>

            try-complete-file-name-partially <span class="org-comment-delimiter">; </span><span class="org-comment">File names.</span>
            try-complete-file-name

            try-complete-lisp-symbol-partially
            try-complete-lisp-symbol

            try-expand-whole-kill))
</pre></div>
<p>Configure Hippie-expand to also expand YASnippets (on the key used by <code>hippie-expand</code>, then).</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">integrate YASnippet with `</span><span class="org-constant"><span class="org-comment">hippie-expand</span></span><span class="org-comment">'</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"yasnippet"</span>

      (add-to-list 'hippie-expand-try-functions-list
                   'yas-hippie-try-expand)))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Makes more sense when placed at the</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">top of the list.</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline315" class="outline-4">
<h4 id="orgheadline315">Auto-Complete ("IntelliSensy" completion when writing code)</h4>
<div class="outline-text-4" id="text-orgheadline315">
<p>Auto-Complete shows completions as you type, so you can fill in long words by typing only a few characters - really brilliant!</p>
<p>Auto-complete uses the variable <code>ac-modes</code> to decide whether to enable auto-completion in a particular mode; by default, <code>org-mode</code> (which interprets the <code>&lt;tab&gt;</code> key) is not present in this list. So, to enable auto-completion in Org mode, simply add it to the <code>ac-modes</code>:</p>
<pre class="example">
(add-to-list 'ac-modes 'org-mode)
</pre>
<p>Popups:</p>
<ul class="org-ul">
<li>
<p class="c2">Completion menu</p>
<p>Candidates suffix:</p>
<ul class="org-ul">
<li>(nothing) - means it is buffer string cache complete.</li>
<li><code>v</code> - Variable</li>
<li><code>f</code> - Function</li>
<li><code>s</code> - Symbol</li>
<li><code>c</code> - Constant</li>
<li><code>a</code> - Abbrev, yasnippet</li>
<li><code>d</code> - Dictionary, environment variable (e.g. LC_CTYPE)</li>
<li><code>m</code> - Module</li>
</ul>
</li>
<li><b>Quick help</b> (tooltip appearing at the side of the completion menu)</li>
</ul>
<p>According to the default settings, completion is done by <code>TAB</code> or <code>RET</code>:</p>
<dl class="org-dl">
<dt><code>ac-expand</code> (<code>TAB</code>)</dt>
<dd>Select candidates in cycle.</dd>
<dt><code>ac-complete</code> (<code>RET</code>)</dt>
<dd>Complete a selected candidate immediately.</dd>
</dl>
<p>There are other ways to select candidates:</p>
<ul class="org-ul">
<li><code>M-1</code> to select candidate 1,</li>
<li><code>M-2</code> to select candidate 2,</li>
<li>and so on (until 9).</li>
</ul>
<p>Other operations are enabled temporarily when completion is started:</p>
<dl class="org-dl">
<dt><code>C-s</code> (<code>ac-isearch</code>)</dt>
<dd><b>Filter</b> completion candidates.</dd>
<dt><code>&lt;C-down&gt;</code> or <code>C-M-n</code> (<code>ac-quick-help-scroll-down</code>)</dt>
<dd>Scroll down quick help.</dd>
<dt><code>&lt;C-up&gt;</code> or <code>C-M-p</code> (<code>ac-quick-help-scroll-up</code>)</dt>
<dd>Scroll up quick help.</dd>
<dt><code>&lt;f1&gt;</code> (or <code>C-?</code>, <code>ac-help</code>)</dt>
<dd>
<p>Show additional <b>help</b> (for functions, arguments and objects) in <b>temporary buffer</b>.</p>
<p>Use <code>C-M-v</code> (or <code>C-M-S-v</code>) to scroll down (or up).</p>
</dd>
<dt><code>&lt;M-f1&gt;</code> (or <code>C-M-?</code>, <code>ac-persist-help</code>)</dt>
<dd>Show additional <b>help</b> in <b>persistent buffer</b>.</dd>
</dl>
<p>Eventually, see <a href="http://stackoverflow.com/questions/19900949/how-to-make-auto-complete-work-with-yasnippet-and-abbrev">How to make auto-complete work with yasnippet and abbrev?</a></p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (GNUEmacs

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Auto Completion.</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"auto-complete-autoloads-</span><span class="org-leuven-highlight"><span class="org-string">XXX</span></span><span class="org-string">"</span>
      (idle-require 'auto-complete-config))

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"auto-complete-config"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">6.1 Set a list of sources to use (by default + for some major modes)</span>
      (ac-config-default))              <span class="org-comment-delimiter">; </span><span class="org-comment">... and enable Auto-Complete mode in</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">all buffers.</span>

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"auto-complete"</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Required by ESS.</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">;; 5.4 Completion will be started automatically by inserting 2 characters.</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq ac-auto-start 2)            ; Also applies on arguments after opening</span>
      <span class="org-comment-delimiter">;;                                   </span><span class="org-comment">; parenthesis in ESS.</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">7.5 Use `</span><span class="org-constant"><span class="org-comment">C-n/C-p</span></span><span class="org-comment">' to select candidates (only when completion menu is</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">displayed).</span>
      (setq ac-use-menu-map t)
      (define-key ac-menu-map (kbd <span class="org-string">"C-n"</span>) 'ac-next)
      (define-key ac-menu-map (kbd <span class="org-string">"C-p"</span>) 'ac-previous)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Unbind some keys (inconvenient in Comint buffers).</span>
      (define-key ac-completing-map (kbd <span class="org-string">"M-n"</span>) nil)
      (define-key ac-completing-map (kbd <span class="org-string">"M-p"</span>) nil)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Add other modes into `</span><span class="org-constant"><span class="org-comment">ac-modes</span></span><span class="org-comment">'.</span>
      (setq ac-modes
            (append ac-modes
                    '(change-log-mode
                      latex-mode
                      org-mode
                      prog-mode       <span class="org-comment-delimiter">; </span><span class="org-comment">Programming modes.</span>
                      snippet-mode
                      sql-mode
                      text-mode)))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">8.1 Delay to completions will be available.</span>
      (setq ac-delay 0)               <span class="org-comment-delimiter">; </span><span class="org-comment">Faster than default 0.1.</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">8.2 Completion menu will be automatically shown.</span>
      (setq ac-auto-show-menu 0.2)    <span class="org-comment-delimiter">; </span><span class="org-comment">[Default: 0.8].</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">8.13 Delay to show quick help.</span>
      (setq ac-quick-help-delay 0.5)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">8.15 Max height of quick help.</span>
      (setq ac-quick-help-height 10)  <span class="org-comment-delimiter">; </span><span class="org-comment">Same as `</span><span class="org-constant"><span class="org-comment">ac-menu-height</span></span><span class="org-comment">'.</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">8.16 Limit on number of candidates.</span>
      (setq ac-candidate-limit 100)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq ac-disable-inline t)</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq ac-candidate-menu-min 0)</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Completion by TAB.</span>
      (define-key ac-completing-map (kbd <span class="org-string">"&lt;tab&gt;"</span>) 'ac-complete)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Completion by RET.</span>
      (define-key ac-completing-map (kbd <span class="org-string">"&lt;return&gt;"</span>) 'ac-complete)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Abort.</span>
      (define-key ac-completing-map (kbd <span class="org-string">"C-g"</span>) 'ac-stop)
      (define-key ac-completing-map (kbd <span class="org-string">"&lt;left&gt;"</span>) 'ac-stop)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">11.1 Avoid Flyspell processes when auto completion is being started.</span>
      (ac-flyspell-workaround)))
</pre></div>
<p>XXX Test the following.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable the drop down auto complete inside comment lines.</span>
      (setq ac-disable-faces nil)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline316" class="outline-4">
<h4 id="orgheadline316">Company mode ("Complete anything")</h4>
<div class="outline-text-4" id="text-orgheadline316">
<p>The best alternative to Auto-Complete seems to be Company mode.</p>
<p>Besides that the maintainer of company-mode is incredibly competent and friendly,</p>
<ul class="org-ul">
<li>company-mode is super easy to extend (whereas you often have to write 3-4 times as much code to get the equivalent functionality out of AC backend);</li>
<li>company "just works", most of the time. It's incredibly simple to use.</li>
</ul>
<p>See <a href="https://github.com/company-mode/company-mode/issues/68">https://github.com/company-mode/company-mode/issues/68</a> for a <b>feature comparison</b> between both.</p>
<p>Completion will start automatically after you type a few letters. Use <code>M-n</code> and <code>M-p</code> to select, <code>&lt;return&gt;</code> to complete or <code>&lt;tab&gt;</code> to complete the common part. <b>Search through the completions</b> with <code>C-s</code>, <code>C-r</code> and <code>C-o</code>. Press <code>M-(digit)</code> to quickly complete with one of the first 10 candidates.</p>
<p>Type <code>M-x company-complete</code> to initiate completion manually. Bind this command to a key combination of your choice.</p>
<p>When the completion candidates are shown, press <code>&lt;f1&gt;</code> to <b>display the full documentation</b> for the selected symbol, or <code>C-w</code> to <b>show its definition</b>. Not all back-ends support this.</p>
<p>company-mode has a unique take on auto-completion where it will reject keystrokes if it doesn't match any possibilities. It can also search available completions and filter as well.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Modular text completion framework.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"company-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable Company mode in all buffers ....</span>
    (add-hook 'after-init-hook 'global-company-mode))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"company"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">... Except in some modes.</span>
    (setq company-global-modes
          '(not ess-mode                <span class="org-comment-delimiter">; </span><span class="org-comment">In (i)ESS buffers, Auto-Complete is</span>
                inferior-ess-mode       <span class="org-comment-delimiter">; </span><span class="org-comment">enabled by default.</span>
                magit-status-mode
                help-mode))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Minimum prefix length for idle completion.</span>
    (setq company-minimum-prefix-length 2)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Start completion immediately.</span>
    (setq company-idle-delay 0)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Show quick-access numbers for the first ten candidates.</span>
    (setq company-show-numbers t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Use `</span><span class="org-constant"><span class="org-comment">C-n/C-p</span></span><span class="org-comment">' to select candidates (only when completion menu is</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">displayed).</span>
    (define-key company-active-map (kbd <span class="org-string">"C-n"</span>) 'company-select-next)
    (define-key company-active-map (kbd <span class="org-string">"C-p"</span>) 'company-select-previous)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Unbind some keys (inconvenient in Comint buffers).</span>
    (define-key company-active-map (kbd <span class="org-string">"M-n"</span>) nil)
    (define-key company-active-map (kbd <span class="org-string">"M-p"</span>) nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Completion by TAB.</span>
    (define-key company-active-map (kbd <span class="org-string">"&lt;tab&gt;"</span>) 'company-complete-selection)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Abort.</span>
    (define-key company-active-map (kbd <span class="org-string">"C-g"</span>) 'company-abort)
    (define-key company-active-map (kbd <span class="org-string">"&lt;left&gt;"</span>) 'company-abort)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add support for keypad events (`</span><span class="org-constant"><span class="org-comment">&lt;kp-numbers&gt;</span></span><span class="org-comment">' without the modifier).</span>
    (eval-after-load 'company
      '(<span class="org-keyword">dotimes</span> (i 10)
         (define-key company-active-map
           (read-kbd-macro (format <span class="org-string">"&lt;kp-%d&gt;"</span> i))
           'company-complete-number)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Do nothing if the indicated candidate contains digits (actually, it will</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">try to insert the digit you type).</span>
    (advice-add
     'company-complete-number <span class="org-builtin">:around</span>
     (<span class="org-keyword">lambda</span> (fun n)
       (<span class="org-keyword">let</span> ((cand (nth (+ (1- n) company-tooltip-offset)
                        company-candidates)))
         (<span class="org-keyword">if</span> (string-match-p <span class="org-string">"[0-9]"</span> cand)
             (<span class="org-keyword">let</span> ((last-command-event (+ ?0 n)))
               (self-insert-command 1))
           (funcall fun n))))
     '((name . <span class="org-string">"Don't complete numbers"</span>)))
</pre></div>
<p>If you press <code>&lt;right&gt;</code> when the menu is displayed, it will cancel completion.</p>
<p><b>First</b> run the <b>indent</b> function, then try <b>completion</b> only if it didn't change anything.</p>
<p>XXX The following does not work in Org files (TAB does not expand nodes anymore)!</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">See `</span><span class="org-constant"><span class="org-comment">tab-always-indent</span></span><span class="org-comment">'.</span>

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-indent-or-complete</span> ()
      <span class="org-doc">"Indent the current line; if point doesn't move, then try to complete."</span>
      (interactive)
      (<span class="org-keyword">let</span> ((p (point)))
        <span class="org-comment-delimiter">;; </span><span class="org-comment">(if (minibufferp)</span>
        <span class="org-comment-delimiter">;;     </span><span class="org-comment">(minibuffer-complete)</span>
        (call-interactively 'indent-for-tab-command)
        (<span class="org-keyword">when</span> (and (= p (point))
                   (not (bolp))
                   (looking-at <span class="org-string">"\\_&gt;"</span>))
          (call-interactively 'company-complete-selection))))

    (define-key company-mode-map (kbd <span class="org-string">"&lt;tab&gt;"</span>) 'leuven-indent-or-complete)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(defun leuven--tab-fix ()</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(local-set-key (kbd "&lt;tab&gt;") 'leuven-indent-or-complete))</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'prog-mode-hook 'leuven--tab-fix)</span>
</pre></div>
<p>Only trigger the tooltip on manual invocation, but still have the preview (of the first candidate) show up immediately:</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (<span class="org-keyword">defadvice</span> <span class="org-function-name">company-pseudo-tooltip-unless-just-one-frontend</span>
               (around only-show-tooltip-when-invoked activate)
      (<span class="org-keyword">when</span> (company-explicit-action-p)
        ad-do-it))
</pre></div>
<p>From <a href="https://github.com/company-mode/company-mode/issues/87">https://github.com/company-mode/company-mode/issues/87</a>.</p>
<p>See also <a href="https://github.com/company-mode/company-mode/issues/123">https://github.com/company-mode/company-mode/issues/123</a>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    )
</pre></div>
<p>With the following text (where "|" stands for the cursor):</p>
<pre class="example">
GOODBYE
good|
</pre>
<ul class="org-ul">
<li>the prefix "good" will match no word (no completion to "goodBYE"!) while</li>
<li>the prefix "GOOD" will match "GOODBYE" only.</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"company-dabbrev"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Only search in the current buffer</span>
    (setq company-dabbrev-other-buffers nil) <span class="org-comment-delimiter">; </span><span class="org-comment">Prevent Company completing</span>
                                             <span class="org-comment-delimiter">; </span><span class="org-comment">numbers coming from other files</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't ignore case when collecting completion candidates.</span>
    (setq company-dabbrev-ignore-case nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't downcase the returned candidates.</span>
    (setq company-dabbrev-downcase nil))
</pre></div>
<p>XXX What about <code>company-search-candidates</code> vs <code>company-filter-candidates</code>?</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (setq company-idle-delay nil)
    (global-set-key (kbd <span class="org-string">"&lt;tab&gt;"</span>) 'company-complete-selection)
</pre></div>
</div>
<div id="outline-container-orgheadline317" class="outline-5">
<h5 id="orgheadline317">Company-quickhelp</h5>
<div class="outline-text-5 org-src-container" id="text-orgheadline317">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"company-quickhelp-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable `</span><span class="org-constant"><span class="org-comment">company-quickhelp-mode</span></span><span class="org-comment">'.</span>
    (company-quickhelp-mode 1)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Delay to show quick help.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq company-quickhelp-delay 0.5)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Maximum number of lines to show in the popup.</span>
    (setq company-quickhelp-max-lines 10))

)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 29 ends here</span>
</pre></div>
</div>
</div>
</div>
</div>
<div id="outline-container-orgheadline318" class="outline-2">
<h2 id="orgheadline318">Dired, the Directory Editor</h2>
<div class="outline-text-2" id="text-orgheadline318">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 30 (info "(emacs)Dired"), the Directory Editor</span>

(leuven--chapter leuven-load-chapter-30-dired <span class="org-string">"30 Dired, the Directory Editor"</span>
</pre></div>
<p>Type <code>0 w</code> (<code>dired-copy-filename-as-kill</code>) in Dired to put the <b>full path</b> to some local file into the kill ring.</p>
<div class="note">
<p>If you want to insert a link to a file in an Org mode document, you can also call <code>org-insert-link</code> (<code>C-c C-l</code>) with a <code>C-u</code> prefix (to get the regular <code>find-file</code> interface).</p>
</div>
</div>
<div id="outline-container-orgheadline319" class="outline-3">
<h3 id="orgheadline319">Entering Dired</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline319">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(emacs)Dired Enter")</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">directory-browsing commands</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"dired"</span>

    (leuven--section <span class="org-string">"30.1 (emacs)Dired Enter"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">switches passed to `</span><span class="org-constant"><span class="org-comment">ls</span></span><span class="org-comment">' for Dired</span>
    (setq dired-listing-switches
          (<span class="org-keyword">cond</span> ((or leuven--win32-p
                     leuven--cygwin-p)
                 <span class="org-string">"-a -F -l"</span>)
                (t
                 <span class="org-string">"-a -F --group-directories-first -l --time-style=long-iso"</span>)))
</pre></div>
</div>
<div id="outline-container-orgheadline320" class="outline-3">
<h3 id="orgheadline320">30.2 Navigation in the Dired Buffer</h3>
<div class="outline-text-3" id="text-orgheadline320">
<p>In Dired, <code>M-&gt;</code> and <code>M-&lt;</code> never took me where I wanted to go. Now, they do.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(emacs)Dired Navigation")</span>

    (leuven--section <span class="org-string">"30.2 (emacs)Dired Navigation"</span>)

    (<span class="org-keyword">defun</span> <span class="org-function-name">dired-back-to-top</span> ()
      (interactive)
      (beginning-of-buffer)
      (dired-next-line 4))

    (define-key dired-mode-map
      (vector 'remap 'beginning-of-buffer) 'dired-back-to-top)

    (<span class="org-keyword">defun</span> <span class="org-function-name">dired-jump-to-bottom</span> ()
      (interactive)
      (end-of-buffer)
      (dired-next-line -1))

    (define-key dired-mode-map
      (vector 'remap 'end-of-buffer) 'dired-jump-to-bottom)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline321" class="outline-3">
<h3 id="orgheadline321">Deleting Files with Dired</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline321">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(emacs)Dired Deletion")</span>

    (leuven--section <span class="org-string">"30.3 (emacs)Dired Deletion"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">recursive deletes allowed, after asking for each directory at top level</span>
    (setq dired-recursive-deletes 'top)
</pre></div>
</div>
<div id="outline-container-orgheadline322" class="outline-3">
<h3 id="orgheadline322">Visiting Files in Dired</h3>
<div class="outline-text-3" id="text-orgheadline322">
<dl class="org-dl">
<dt><code>^</code></dt>
<dd><code>dired-up-directory</code>.</dd>
</dl>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(emacs)Dired Visiting")</span>

    (leuven--section <span class="org-string">"30.5 (emacs)Dired Visiting"</span>)
</pre></div>
</div>
<div id="outline-container-orgheadline323" class="outline-4">
<h4 id="orgheadline323">Reuse Dired buffers</h4>
<div class="outline-text-4" id="text-orgheadline323">
<p>Single Dired buffer.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">reuse Dired buffers, by running the command</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">dired-find-alternate-file</span></span><span class="org-comment">' (bound to `a') on a directory</span>
    (put 'dired-find-alternate-file 'disabled nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">reuse the current Dired directory buffer to visit another directory</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(limit Dired to 1 single buffer)</span>
    (try-require 'dired-single)
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"dired-single"</span>

      (define-key dired-mode-map (kbd <span class="org-string">"&lt;return&gt;"</span>) 'dired-single-buffer)

      (define-key dired-mode-map (kbd <span class="org-string">"&lt;mouse-1&gt;"</span>) 'dired-single-buffer-mouse)

      (define-key dired-mode-map (kbd <span class="org-string">"^"</span>)
        (<span class="org-keyword">lambda</span> ()
          (interactive)
          (dired-single-buffer <span class="org-string">".."</span>)))

      (define-key dired-mode-map (kbd <span class="org-string">"C-x C-j"</span>)
        (<span class="org-keyword">lambda</span> ()
          (interactive)
          (dired-single-buffer <span class="org-string">".."</span>))))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline324" class="outline-4">
<h4 id="orgheadline324">Open file with default tool (open directory with Windows Explorer)</h4>
<div class="outline-text-4" id="text-orgheadline324">
<p>On top of the traditional ways, there are also these add-ons which open files using external programs (such as PDF viewers), based on their extension.</p>
<p>One advantage is that using the traditional <code>!</code> (or <code>X</code>) switch with Dired locks up Emacs until you close the other program. These add-ons do not and leave Emacs free for continued used.</p>
<div class="note">
<p>Alternative</p>
<p>Nowadays, there's at least the built-in <code>dired-do-async-shell-command</code>, bound to <code>&amp;</code>.</p>
<p>In addition to what others have mentioned, if you are on MS Windows then, after loading <code>w32-browser.el</code> and <code>dired+.el</code>, you can use item <code>Open Associated Windows App</code> in the <code>Single</code> menu to open a file with the associated program.</p>
<p>Same thing for the marked files, using <code>Oepn Associated Windows Apps</code> in menus <code>Multiple</code> and <code>Multiple &gt; Marked Here and Below</code>.</p>
<p>And you can use item <code>Single &gt; ~Open in Windows Explorer</code> to open a file or folder in Windows Explorer.</p>
<p>You can also right-click on a file and pick <code>Open Associated Windows App</code> or <code>Open in Windows Explorer</code>.</p>
<p>There are key bindings for these as wel:</p>
<dl class="org-dl">
<dt><code>M-RET</code> or <code>mouse-2</code></dt>
<dd>open with associated proram</dd>
<dt><code>C-RET</code></dt>
<dd>open in Explorer</dd>
</dl>
</div>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Read <a href="http://www.piprime.fr/1302/plus-qu-un-explorateur-de-fichiers-le-mode-dired-d-emacs/">http://www.piprime.fr/1302/plus-qu-un-explorateur-de-fichiers-le-mode-dired-d-emacs/</a></b><br />
nil</div>
<p>These days, there are mature programs for launching an arbitrary file with an appropriate viewer:</p>
<ul class="org-ul">
<li><code>xdg-open</code> on GNU systems,</li>
<li>
<p><code>open</code> on Mac OS X,</p>
<p>If <code>xdg-open</code> is not available, one can replace it with <code>gnome-open</code> or <code>kde-open</code>.</p>
</li>
<li>
<p><code>start</code> on MS Windows.</p>
<p>Though, it is a bad idea to use <code>start</code> on Windows: it has too many quirks regarding quoting of its command line. Instead, just invoke the existing primitive <code>w32-shell-execute</code> with the <code>open</code> verb. As a nice side effect, this will support Unicode file names, something that is currently impossible when you invoke an external command.</p>
</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (<span class="org-keyword">defun</span> <span class="org-function-name">helm-open-file-with-default-tool</span> (file)
      <span class="org-doc">"Open FILE with the default tool on this platform."</span>
      (<span class="org-keyword">let</span> ((program (<span class="org-keyword">cond</span> (leuven--linux-p <span class="org-string">"xdg-open"</span>)
                           (leuven--mac-p <span class="org-string">"open"</span>)))
            process-connection-type)
        (<span class="org-keyword">if</span> leuven--win32-p
            (helm-w32-shell-execute-open-file file)
          (start-process <span class="org-string">"helm-open-file-with-default-tool"</span> nil program file))))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (<span class="org-keyword">defun</span> <span class="org-function-name">dired-open</span> ()
      (interactive)
      (<span class="org-keyword">let</span> ((program (<span class="org-keyword">cond</span> (leuven--linux-p <span class="org-string">"xdg-open"</span>)
                           (leuven--mac-p <span class="org-string">"open"</span>))))
        (dired-do-shell-command program nil
                                (dired-get-marked-files t current-prefix-arg))))

    (define-key dired-mode-map (kbd <span class="org-string">"F"</span>) 'dired-open)
</pre></div>
</div>
<div id="outline-container-orgheadline325" class="outline-5">
<h5 id="orgheadline325">Ask a WWW browser to display file</h5>
<div class="outline-text-5" id="text-orgheadline325">
<p>Just ask a WWW browser to display the current file.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (define-key dired-mode-map (kbd <span class="org-string">"e"</span>) 'browse-url-of-dired-file) <span class="org-comment-delimiter">; </span><span class="org-comment">&lt;C-RET&gt;?</span>
</pre></div>
<p>It works for files as well as for directories.</p>
<p>It opens the Windows Explorer for:</p>
<ul class="org-ul">
<li>the <b>current directory</b> when invoked on <code>.</code>, and</li>
<li>
<p>the <b>parent directory</b> when invoked on <code>..</code>.</p>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Mapcar on the browse-url function</b><br />
<p>See code of <code>w32-dired-open-files-externally</code>.</p>
</div>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> <code>C-u &lt;RET&gt;</code> opens dired on Org link</b><br />
<p>We should probably have the same type of key binding for opening Explorer from Dired.</p>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-orgheadline326" class="outline-5">
<h5 id="orgheadline326">MANY FILES at once (for Windows)</h5>
<div class="outline-text-5" id="text-orgheadline326">
<p>For those under Windows:</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">open files using Windows associations</span>
    (GNUEmacs
      (<span class="org-keyword">when</span> (or leuven--win32-p
                leuven--cygwin-p)
        (<span class="org-keyword">defun</span> <span class="org-function-name">w32-dired-open-files-externally</span> (<span class="org-type">&amp;optional</span> arg)
          <span class="org-doc">"In Dired, open the marked files (or directories) with the default</span>
<span class="org-doc">        Windows tool."</span>
          (interactive <span class="org-string">"P"</span>)
          (mapcar
           (<span class="org-keyword">lambda</span> (file)
             (w32-shell-execute <span class="org-string">"open"</span> (convert-standard-filename file)))
           (dired-get-marked-files nil arg)))

        <span class="org-comment-delimiter">;; </span><span class="org-comment">bind it to `E' in Dired mode</span>
        (define-key dired-mode-map (kbd <span class="org-string">"E"</span>) 'w32-dired-open-files-externally)))
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline327" class="outline-4">
<h4 id="orgheadline327">Open file with w3m</h4>
<div class="outline-text-4" id="text-orgheadline327">
<p>See news "Opening html-File in Dired with w3m" for extra info.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">open current file with w3m</span>
    (<span class="org-keyword">when</span> (executable-find <span class="org-string">"w3m"</span>)
      (<span class="org-keyword">defun</span> <span class="org-function-name">dired-open-with-w3m</span> ()
        <span class="org-doc">"In Dired, visit (with find-w3m) the file named on this line."</span>
        (interactive)
        (w3m-find-file (file-name-sans-versions (dired-get-filename) t)))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">add a binding "W" -&gt; `</span><span class="org-constant"><span class="org-comment">dired-open-with-w3m</span></span><span class="org-comment">' to Dired</span>
      (define-key dired-mode-map <span class="org-string">"W"</span> 'dired-open-with-w3m))
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline328" class="outline-3">
<h3 id="orgheadline328">Operating on Files</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline328">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(emacs)Operating on Files")</span>

    (leuven--section <span class="org-string">"30.7 (emacs)Operating on Files"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">try to guess a default target directory</span>
    (setq dired-dwim-target t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">copy recursively without asking</span>
    (setq dired-recursive-copies 'always)
</pre></div>
</div>
<div id="outline-container-orgheadline329" class="outline-3">
<h3 id="orgheadline329">Updating the Dired Buffer</h3>
<div class="outline-text-3" id="text-orgheadline329">
<div class="warning">
<p>The following code block is currently disabled, because it causes problems with Org and PDF LaTeX: when we've opened the TeX file, to compile it from LaTeX because an error has been reported (with no details), then the TeX file blocks the next automatic exports (<code>C-u C-c C-e</code>), asking for confirmation because the TeX buffer is open</p>
<pre class="example">
Reverting buffer `prestations/'.
prestations-2013-06.tex changed on disk; really edit the buffer? (y, n, r or C-h) n
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(add-hook 'dired-mode-hook
          (<span class="org-keyword">lambda</span> ()

            <span class="org-comment-delimiter">;; </span><span class="org-comment">Auto-refresh Dired on file change.</span>
            (auto-revert-mode)
            (setq-default auto-revert-interval 1)))
</pre></div>
<p>Maybe the following fixes this above problem?</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(emacs)Dired Updating")</span>

    (leuven--section <span class="org-string">"30.15 (emacs)Dired Updating"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Automatically revert Dired buffer on revisiting.</span>
    (setq dired-auto-revert-buffer t)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Dired sort</span>
    (try-require 'dired-sort-map)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">press `s' then `s', `x', `t', `n' or `d' to sort by</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Size, eXtension, Time, Name or name grouping Dirs first</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline330" class="outline-3">
<h3 id="orgheadline330">Dired and <code>find</code></h3>
<div class="outline-text-3" id="text-orgheadline330">
<p>For searches in Dired, see <code>dired-do-search</code> (<code>A</code>).</p>
<ul class="org-ul">
<li>Search through all <b>marked files</b> for a match for regexp</li>
<li>Stops when a match is found</li>
<li>To continue searching for next match, use command "M-,"</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(emacs)Dired and Find")</span>

    (leuven--section <span class="org-string">"30.16 (emacs)Dired and Find"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; what to use in place of `</span><span class="org-constant"><span class="org-comment">-ls</span></span><span class="org-comment">' as the final argument</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq find-ls-option '("-print0 | xargs -0 ls -ld" . "-ld"))</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; quicker to collate the matches and then use `</span><span class="org-constant"><span class="org-comment">xargs</span></span><span class="org-comment">' to run the</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; command (variable defined in `</span><span class="org-constant"><span class="org-comment">find-dired.el</span></span><span class="org-comment">')</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">(when Cygwin... </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">search for files with names matching a wild card pattern and Dired</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">the output</span>
    (global-set-key (kbd <span class="org-string">"C-c 1"</span>) 'find-name-dired)
      <span class="org-comment-delimiter">;; </span><span class="org-comment">case insensitive if `</span><span class="org-constant"><span class="org-comment">read-file-name-completion-ignore-case</span></span><span class="org-comment">' is non-nil</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">find-grep-dired</span></span><span class="org-comment">' case insensitivity</span>
    (setq find-grep-options <span class="org-string">"-i -q"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">search for files with contents matching a wild card pattern and Dired</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">the output</span>
    (global-set-key (kbd <span class="org-string">"C-c 2"</span>) 'find-grep-dired)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline331" class="outline-3">
<h3 id="orgheadline331">Editing the Dired Buffer</h3>
<div class="outline-text-3" id="text-orgheadline331">
<p><code>Wdired</code> mode is great for renaming (a lot of) files in a directory, as it allows editing the Dired buffer like a text file, using all the power of Emacs. That is, one can use keyboard macros, search and replace, rectangle mode (great for adding prefixes to file names), flip mode bits with the mouse, etc.!</p>
<p>To enter it, type <code>C-x C-q</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(emacs)Wdired")</span>

    (leuven--section <span class="org-string">"30.17 Editing the (emacs)Wdired Buffer"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">put a Dired buffer in a mode in which filenames are editable</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"wdired"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">permissions bits of the files are editable</span>
      (setq wdired-allow-to-change-permissions t))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline332" class="outline-3">
<h3 id="orgheadline332">Viewing Image Thumbnails in Dired</h3>
<div class="outline-text-3" id="text-orgheadline332">
<p><code>M-x image-dired</code> and choose a directory with images.</p>
<p>Prerequisites:</p>
<ul class="org-ul">
<li><a href="http://www.imagemagick.org./">ImageMagick</a> package</li>
<li>JpegTRAN program</li>
<li><a href="http://www.sno.phy.queensu.ca/~phil/exiftool/">exiftool</a> to <b>edit comments and tags</b> for each image.</li>
</ul>
<p>Key bindings:</p>
<dl class="org-dl">
<dt>C-t d</dt>
<dd><code>image-dired-display-thumbs</code> (on marked files).</dd>
<dt>C-t e</dt>
<dd><code>image-dired-dired-edit-comment-and-tags</code>.</dd>
</dl>
<p>For more information, see:</p>
<ul class="org-ul">
<li><a href="http://www.emacswiki.org/Tumme">http://www.emacswiki.org/Tumme</a></li>
<li><a href="http://wikemacs.org/wiki/Image-dired">http://wikemacs.org/wiki/Image-dired</a></li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(emacs)Image-Dired")</span>

    (leuven--section <span class="org-string">"30.18 Viewing Image Thumbnails in Dired"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">use Dired to browse and manipulate your images</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"image-dired"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">maximum number of files to show before warning the user</span>
      (setq image-dired-show-all-from-dir-max-files 100)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">size of button-like border around thumbnails</span>
      (setq image-dired-thumb-relief 0)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">size of the margin around thumbnails</span>
      (setq image-dired-thumb-margin 4))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline333" class="outline-3">
<h3 id="orgheadline333">Dired Extra</h3>
<div class="outline-text-3" id="text-orgheadline333">
<p>Extra Dired functionality</p>
<ul class="org-ul">
<li><code>dired-x</code> has a feature to "guess" the right shell command and the right external viewer for documents (see <code>dired-guess-shell-alist-user</code>)</li>
<li>
<p>You can also jump to the Dired buffer corresponding to the current buffer by pressing <code>C-x C-j</code> (<code>dired-jump</code>). If in Dired already, pop up a level and goto old directory's line.</p>
<p><b>Standard</b> alternative: <code>C-x d &lt;RET&gt;</code>, though it doesn't set point on the right file.</p>
</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** Dired Extra</span>

    (leuven--section <span class="org-string">"30.XX (dired-x)Top"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">load `</span><span class="org-constant"><span class="org-comment">dired-x.el</span></span><span class="org-comment">' when Dired is first invoked (for example, when</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">you first type `C-x d')</span>
    (add-hook 'dired-load-hook
              (<span class="org-keyword">lambda</span> ()
                (load <span class="org-string">"dired-x"</span>)))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    )                                   <span class="org-comment-delimiter">; </span><span class="org-comment">with-eval-after-load "dired" ends here</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline334" class="outline-3">
<h3 id="orgheadline334">Dired+</h3>
<div class="outline-text-3" id="text-orgheadline334">
<p>Library <code>Dired+</code> lets you act on sets of marked files in subdirs, recursively, for example.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** Dired+</span>

  (leuven--section <span class="org-string">"30.XX Dired+"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">extensions to Dired (provides fancy highlighting, etc.)</span>
  (add-hook 'dired-load-hook
            (<span class="org-keyword">lambda</span> ()
              <span class="org-comment-delimiter">;; </span><span class="org-comment">don't hide details in Dired</span>
              (setq diredp-hide-details-initially-flag nil)

              <span class="org-comment-delimiter">;; </span><span class="org-comment">don't display the next Dired buffer the same way as the last</span>
              (setq diredp-hide-details-propagate-flag nil)

              <span class="org-comment-delimiter">;; </span><span class="org-comment">don't wrap "next" command around to buffer beginning</span>
              (setq diredp-wrap-around-flag nil)

              (try-require 'dired+)))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"diff-hl-autoloads"</span>
    (add-hook 'dired-mode-hook
              (<span class="org-keyword">lambda</span> ()
                (diff-hl-dired-mode 1))))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline335" class="outline-3">
<h3 id="orgheadline335">Emulation of <code>ls</code> on MS-Windows</h3>
<div class="outline-text-3" id="text-orgheadline335">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(emacs)ls in Lisp")</span>

  (leuven--section <span class="org-string">"G.4 (emacs)ls in Lisp"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">emulate insert-directory completely in Emacs Lisp</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ls-lisp"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">disable the case sensitive sort of file names</span>
    (setq ls-lisp-ignore-case t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">sort directories first</span>
    (setq ls-lisp-dirs-first t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">use ISO 8601 dates (on MS-Windows)</span>
    (setq ls-lisp-format-time-list
          '(<span class="org-string">"%Y-%m-%d %H:%M"</span>
            <span class="org-string">"%Y-%m-%d %H:%M"</span>))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">use localized date/time format</span>
    (setq ls-lisp-use-localized-time-format t))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 30 ends here</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline336" class="outline-2">
<h2 id="orgheadline336">The Calendar and the Diary</h2>
<div class="outline-text-2 org-src-container" id="text-orgheadline336">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 31 The (info "(emacs)Calendar/Diary")</span>

(leuven--chapter leuven-load-chapter-31-calendar-diary <span class="org-string">"31 The Calendar and the Diary"</span>
</pre></div>
<div id="outline-container-orgheadline337" class="outline-3">
<h3 id="orgheadline337">Calendar Motion</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline337">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 31.1 (info "(emacs)Calendar Motion")</span>

  (leuven--section <span class="org-string">"31.1 (emacs)Calendar Motion"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">years must be written in full</span>
  (setq diary-abbreviated-year-flag nil)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">set the style of calendar and diary dates to ISO (how to interpret the</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">dates)</span>
  (setq calendar-date-style 'iso)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">week in the calendar begins on Monday</span>
  (setq calendar-week-start-day 1)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">mark all visible dates that have diary entries</span>
  (<span class="org-keyword">when</span> (file-exists-p <span class="org-string">"~/diary"</span>)
    (setq calendar-mark-diary-entries-flag t))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">mark the current date (by changing its face) after generating a calendar,</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">if today's date is visible</span>
  (add-hook 'calendar-today-visible-hook 'calendar-mark-today)
</pre></div>
</div>
<div id="outline-container-orgheadline338" class="outline-3">
<h3 id="orgheadline338">Scroll Calendar</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline338">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 31.2 (info "(emacs)Scroll Calendar")</span>

  (leuven--section <span class="org-string">"31.2 (emacs)Scroll Calendar"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">fix foolish calendar-mode scrolling after loading `</span><span class="org-constant"><span class="org-comment">calendar.el</span></span><span class="org-comment">'</span>
  (add-hook 'calendar-load-hook
            (<span class="org-keyword">lambda</span> ()
              (define-key calendar-mode-map (kbd <span class="org-string">"&gt;"</span>) 'calendar-scroll-left)
              (define-key calendar-mode-map (kbd <span class="org-string">"&lt;"</span>) 'calendar-scroll-right)))
</pre></div>
</div>
<div id="outline-container-orgheadline339" class="outline-3">
<h3 id="orgheadline339">Times of Sunrise/Sunset</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline339">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 31.7 Times of (info "(emacs)Sunrise/Sunset")</span>

  (leuven--section <span class="org-string">"31.7 Times of (emacs)Sunrise/Sunset"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; calendar functions for solar events</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "solar"</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; name of the calendar location</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(setq calendar-location-name "Leuven, BE")</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; latitude of `</span><span class="org-constant"><span class="org-comment">calendar-location-name</span></span><span class="org-comment">'</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(setq calendar-latitude 50.88)</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; longitude of `</span><span class="org-constant"><span class="org-comment">calendar-location-name</span></span><span class="org-comment">'</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(setq calendar-longitude 4.70))</span>
</pre></div>
</div>
<div id="outline-container-orgheadline340" class="outline-3">
<h3 id="orgheadline340">Diary</h3>
<div class="outline-text-3" id="text-orgheadline340">
<p>The Emacs diary keeps track of appointments or other events on a daily basis, in conjunction with the calendar. To use the diary feature, you must first create a "diary file" containing a list of events and their dates.</p>
<p>But <a href="#orgheadline148">Org</a> outperforms it!</p>
</div>
</div>
<div id="outline-container-orgheadline341" class="outline-3">
<h3 id="orgheadline341">Appointments</h3>
<div class="outline-text-3" id="text-orgheadline341">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 31.11 (info "(emacs)Appointments")</span>

  (leuven--section <span class="org-string">"31.11 (emacs)Appointments"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">insinuate appt if `</span><span class="org-constant"><span class="org-comment">diary-file</span></span><span class="org-comment">' exists</span>
  (<span class="org-keyword">if</span> (file-readable-p <span class="org-string">"~/diary"</span>)
      (try-require 'appt)               <span class="org-comment-delimiter">; </span><span class="org-comment">requires `</span><span class="org-constant"><span class="org-comment">diary-lib</span></span><span class="org-comment">', which requires</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">diary-loaddefs</span></span><span class="org-comment">'</span>
    (message <span class="org-string">"Appointment reminders lib `</span><span class="org-constant"><span class="org-string">appt</span></span><span class="org-string">' not loaded (no diary file found)"</span>))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"appt"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">send the first warning 60 minutes before an appointment</span>
    (setq appt-message-warning-time 60) <span class="org-comment-delimiter">; </span><span class="org-comment">[default: 12]</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">warn every 15 minutes</span>
    (setq appt-display-interval 15)     <span class="org-comment-delimiter">; </span><span class="org-comment">[default: 3]</span>
</pre></div>
<p>Send notifications using <code>notifications-notify</code> (which was added in Emacs 24). It uses <code>notify-send</code> (if the <code>libnotify-bin</code> Ubuntu package is installed).</p>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> For Windows users: use `todochicku.el' (cross-platform?) and the snarl notifier</b><br />
nil</div>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Diff between shell-command and call-process? Blocking call?</b><br />
nil</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">use a separate window to display appointment reminders</span>
    (setq appt-display-format 'window)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">function called to display appointment reminders *in a window*</span>
    (setq appt-disp-window-function (function leuven--appt-display))

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--appt-display</span> (mins-to-appt current-time notification-string)
      <span class="org-doc">"Display a reminder for appointments.</span>
<span class="org-doc">    Use `</span><span class="org-constant"><span class="org-doc">libnotify</span></span><span class="org-doc">' if available and if display is graphical, or fall back on a</span>
<span class="org-doc">    message in the echo area."</span>
      (or (listp mins-to-appt)
          (setq notification-string (list notification-string)))
      (<span class="org-keyword">dotimes</span> (i (length notification-string))
        (<span class="org-keyword">cond</span> ((and (display-graphic-p)
                    (executable-find <span class="org-string">"notify-send"</span>))
               (shell-command
                (concat <span class="org-string">"notify-send "</span>
                        <span class="org-string">"-i /usr/share/icons/gnome/32x32/status/appointment-soon.png "</span>
                        <span class="org-string">"-t 1000 "</span>
                        <span class="org-string">"'Appointment' "</span>
                        <span class="org-string">"'"</span> (nth i notification-string) <span class="org-string">"'"</span>)))
              (t
               (message <span class="org-string">"%s"</span> (nth i notification-string))
               (sit-for 1)))))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">turn appointment checking on (enable reminders)</span>
    (<span class="org-keyword">when</span> leuven-load-verbose
      (message <span class="org-string">"(Info) Enable appointment reminders..."</span>))
    (GNUEmacs
      (appt-activate 1))
    (XEmacs
      (appt-initialize))
    (<span class="org-keyword">when</span> leuven-load-verbose
      (message <span class="org-string">"(Info) Enable appointment reminders... Done"</span>))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">enable appointment notification, several minutes beforehand</span>
    (add-hook 'diary-hook 'appt-make-list)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-agenda"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">keep your appointment list clean: if you delete an appointment from your</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Org agenda file, delete the corresponding alert</span>
      (<span class="org-keyword">defadvice</span> <span class="org-function-name">org-agenda-to-appt</span> (before leuven-org-agenda-to-appt activate)
        <span class="org-doc">"Clear the existing `</span><span class="org-constant"><span class="org-doc">appt-time-msg-list</span></span><span class="org-doc">'."</span>
        (setq appt-time-msg-list nil))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">add today's appointments (found in `</span><span class="org-constant"><span class="org-comment">org-agenda-files</span></span><span class="org-comment">') each time the</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">agenda buffer is (re)built</span>
      (add-hook 'org-agenda-finalize-hook 'org-agenda-to-appt)
                                          <span class="org-comment-delimiter">;</span><span class="org-comment">! don't use the `</span><span class="org-constant"><span class="org-comment">org-agenda-mode-hook</span></span><span class="org-comment">'</span>
                                          <span class="org-comment-delimiter">;</span><span class="org-comment">! because the Org agenda files would be</span>
                                          <span class="org-comment-delimiter">;</span><span class="org-comment">! opened once by `</span><span class="org-constant"><span class="org-comment">org-agenda-to-appt</span></span><span class="org-comment">',</span>
                                          <span class="org-comment-delimiter">;</span><span class="org-comment">! and then killed by</span>
                                          <span class="org-comment-delimiter">;</span><span class="org-comment">! `</span><span class="org-constant"><span class="org-comment">org-release-buffers</span></span><span class="org-comment">' (because</span>
                                          <span class="org-comment-delimiter">;</span><span class="org-comment">! `</span><span class="org-constant"><span class="org-comment">org-agenda-to-appt</span></span><span class="org-comment">' closes all the</span>
                                          <span class="org-comment-delimiter">;</span><span class="org-comment">! files it opened itself -- as they</span>
                                          <span class="org-comment-delimiter">;</span><span class="org-comment">! weren't already opened), to be</span>
                                          <span class="org-comment-delimiter">;</span><span class="org-comment">! finally re-opened!</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">;; add today's appointments (found in `</span><span class="org-constant"><span class="org-comment">org-agenda-files</span></span><span class="org-comment">') each time such a</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">;; file is saved</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'after-save-hook          ; VERY TIME CONSUMING (~ 30 s) at each save...</span>
      <span class="org-comment-delimiter">;;           </span><span class="org-comment">(lambda ()</span>
      <span class="org-comment-delimiter">;;             </span><span class="org-comment">(when (and (derived-mode-p 'org-mode) ; ... of an Org</span>
      <span class="org-comment-delimiter">;;                        </span><span class="org-comment">(org-agenda-file-p)) ; agenda file...</span>
      <span class="org-comment-delimiter">;;               </span><span class="org-comment">(org-agenda-to-appt))))</span>
      )
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    )                                   <span class="org-comment-delimiter">; </span><span class="org-comment">with-eval-after-load "appt" ends here</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline342" class="outline-3">
<h3 id="orgheadline342">Advanced Calendar/Diary Usage</h3>
<div class="outline-text-3" id="text-orgheadline342">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 31.15 (info "(emacs)Advanced Calendar/Diary Usage")</span>

  (leuven--section <span class="org-string">"31.15 (emacs)Advanced Calendar/Diary Usage"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">get rid of some holidays</span>
  (setq holiday-general-holidays nil)   <span class="org-comment-delimiter">; </span><span class="org-comment">too U.S.-centric holidays</span>
  (setq holiday-oriental-holidays nil)  <span class="org-comment-delimiter">; </span><span class="org-comment">Oriental holidays</span>
  (setq holiday-hebrew-holidays nil)    <span class="org-comment-delimiter">; </span><span class="org-comment">religious holidays</span>
  (setq holiday-islamic-holidays nil)   <span class="org-comment-delimiter">; </span><span class="org-comment">religious holidays</span>
  (setq holiday-bahai-holidays nil)     <span class="org-comment-delimiter">; </span><span class="org-comment">Baha'i holidays</span>
  (setq holiday-solar-holidays nil)     <span class="org-comment-delimiter">; </span><span class="org-comment">sun-related holidays</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">mark dates of holidays in the calendar window</span>
  (setq calendar-mark-holidays-flag t)
</pre></div>
<p>After the calendar is loaded, <code>calendar-holidays</code> is the list of notable days for the command <code>M-x holidays</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-insert-current-date</span> (prefix)
    <span class="org-doc">"Insert the current date in ISO format.</span>
<span class="org-doc">  With one PREFIX argument, add day of week.  With two PREFIX arguments, add day</span>
<span class="org-doc">  of week and time."</span>
    (interactive <span class="org-string">"P"</span>)
    (<span class="org-keyword">let</span> ((format (<span class="org-keyword">cond</span> ((not prefix) <span class="org-string">"%Y-%m-%d"</span>)
                        ((equal prefix '(4)) <span class="org-string">"%Y-%m-%d %a"</span>)
                        ((equal prefix '(16)) <span class="org-string">"%Y-%m-%d %a %H:%M"</span>))))
      (insert (format-time-string format))))

  (global-set-key (kbd <span class="org-string">"C-c ."</span>) 'leuven-insert-current-date)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline343" class="outline-3">
<h3 id="orgheadline343">Calendar framework</h3>
<div class="outline-text-3" id="text-orgheadline343">
<p>After displaying your <code>calfw</code> buffer, you can get a HTML buffer with <code>M-x htmlfontify-buffer</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* Calendar view framework on Emacs</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">calendar view framework on Emacs</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"calfw"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Unicode characters</span>
    (setq cfw:fchar-junction ?
          cfw:fchar-vertical-line ?
          cfw:fchar-horizontal-line ?
          cfw:fchar-left-junction ?
          cfw:fchar-right-junction ?
          cfw:fchar-top-junction ?
          cfw:fchar-top-left-corner ?
          cfw:fchar-top-right-corner ?))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">calendar view for org-agenda</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"calfw-org"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">remove some strings (tags and filenames) from item summary</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">cfw:org-summary-format</span> (item)
      <span class="org-doc">"Format an item (How should it be displayed?)."</span>
      (<span class="org-keyword">let*</span> ((time (cfw:org-tp item 'time))
             (time-of-day (cfw:org-tp item 'time-of-day))
             (time-str (and time-of-day
                            (format <span class="org-string">"%02i:%02i "</span>
                                    (/ time-of-day 100)
                                    (% time-of-day 100))))
             (category (cfw:org-tp item 'org-category))
             (tags (cfw:org-tp item 'tags))
             (marker (cfw:org-tp item 'org-marker))
             (buffer (and marker (marker-buffer marker)))
             (text (cfw:org-extract-summary item))
             (props (cfw:extract-text-props item 'face 'keymap)))
        (propertize
         (concat
          (<span class="org-keyword">if</span> time-str (apply 'propertize time-str props)) text <span class="org-string">" "</span>
          <span class="org-comment-delimiter">;; </span><span class="org-comment">(and buffer (buffer-name buffer))</span>
          )
         'keymap cfw:org-text-keymap
         <span class="org-comment-delimiter">;; </span><span class="org-comment">Delete the display property, since displaying images will break our</span>
         <span class="org-comment-delimiter">;; </span><span class="org-comment">table layout</span>
         'display nil))))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 31 ends here</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline344" class="outline-2">
<h2 id="orgheadline344">Sending Mail</h2>
<div class="outline-text-2" id="text-orgheadline344">
<p>Minimal configuration for sending a bug report, for example.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 32 (info "(emacs)Sending Mail")</span>

(leuven--chapter leuven-load-chapter-32-sending-mail <span class="org-string">"32 Sending Mail"</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">full name of this user</span>
  (setq user-full-name <span class="org-string">"John Doe"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">full mailing address of this user</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(used in MAIL envelope FROM, and to select the default personality ID)</span>
  (setq user-mail-address <span class="org-string">"johndoe@example.com"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">sending mail</span>
  (setq send-mail-function 'smtpmail-send-it)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">default SMTP server (overriden by `</span><span class="org-constant"><span class="org-comment">smtpmail-smtp-server</span></span><span class="org-comment">')</span>
  (setq smtpmail-default-smtp-server <span class="org-string">"smtp"</span>)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">SMTP process must be running there</span>

)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 32 ends here</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline345" class="outline-2">
<h2 id="orgheadline345">Gnus</h2>
<div class="outline-text-2 org-src-container" id="text-orgheadline345">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 34 (info "(emacs)Gnus")</span>

(leuven--chapter leuven-load-chapter-34-gnus <span class="org-string">"34 Gnus"</span>

  (global-set-key (kbd <span class="org-string">"C-c n"</span>)
    (<span class="org-keyword">lambda</span> ()
      (interactive)
      (switch-or-start 'gnus <span class="org-string">"*Group*"</span>)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">directory beneath which additional per-user Gnus-specific files are placed</span>
  (setq gnus-directory <span class="org-string">"~/.gnus.d/"</span>)    <span class="org-comment-delimiter">; </span><span class="org-comment">this should end with a directory</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">separator</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">a newsreader for GNU Emacs</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"gnus"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">package to compose an outgoing mail (Message, with Gnus paraphernalia)</span>
    (setq mail-user-agent 'gnus-user-agent)

    (XEmacs
      (setq toolbar-mail-reader 'gnus))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">reading mail with Gnus</span>
    (setq read-mail-command 'gnus))
</pre></div>
<div id="outline-container-orgheadline346" class="outline-3">
<h3 id="orgheadline346">BBDB</h3>
<div class="outline-text-3" id="text-orgheadline346">
<p>bbdb3: <a href="https://savannah.nongnu.org/projects/bbdb">https://savannah.nongnu.org/projects/bbdb</a></p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** Insidious bbdb</span>

  (leuven--section <span class="org-string">"Insidious bbdb"</span>)

<span class="org-comment-delimiter">;;</span><span class="org-comment">* (info "(bbdb)Installation")</span>

  (<span class="org-keyword">unless</span> (<span class="org-keyword">ignore-errors</span> (load-library <span class="org-string">"bbdb-autoloads"</span>)) <span class="org-comment-delimiter">; </span><span class="org-comment">"hand-made"</span>
    (autoload 'bbdb <span class="org-string">"bbdb-com"</span>
      <span class="org-doc">"Insidious Big Brother Database."</span> t)
    (autoload 'bbdb-name <span class="org-string">"bbdb-com"</span>
      <span class="org-doc">"Insidious Big Brother Database."</span> t)
    (autoload 'bbdb-company <span class="org-string">"bbdb-com"</span>
      <span class="org-doc">"Insidious Big Brother Database."</span> t)
    (autoload 'bbdb-net <span class="org-string">"bbdb-com"</span>
      <span class="org-doc">"Insidious Big Brother Database."</span> t)
    (autoload 'bbdb-notes <span class="org-string">"bbdb-com"</span>
      <span class="org-doc">"Insidious Big Brother Database."</span> t)

    (autoload 'bbdb-insinuate-gnus <span class="org-string">"bbdb-gnus"</span>
      <span class="org-doc">"Hook BBDB into Gnus."</span>)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(autoload 'bbdb-insinuate-message "bbdb"</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">"Hook BBDB into `</span><span class="org-constant"><span class="org-comment">message-mode</span></span><span class="org-comment">'.") ; BBDB 2.35</span>
    (autoload 'bbdb-insinuate-message <span class="org-string">"bbdb-message"</span>
      <span class="org-doc">"Hook BBDB into `</span><span class="org-constant"><span class="org-doc">message-mode</span></span><span class="org-doc">'."</span>))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">search the BBDB</span>
  (global-set-key (kbd <span class="org-string">"&lt;C-f11&gt;"</span>) 'bbdb)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"bbdb"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">coding system used for reading and writing `</span><span class="org-constant"><span class="org-comment">bbdb-file</span></span><span class="org-comment">'</span>
    (setq bbdb-file-coding-system 'utf-8)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">ensure `</span><span class="org-constant"><span class="org-comment">~/.bbdb</span></span><span class="org-comment">' never becomes non utf-8 again (it is defined with</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">defconst</span></span><span class="org-comment">', so it is reset whenever `</span><span class="org-constant"><span class="org-comment">bbdb.el</span></span><span class="org-comment">' is loaded)</span>
    (add-hook 'bbdb-load-hook
              (<span class="org-keyword">lambda</span> ()
                (setq bbdb-file-coding-system 'utf-8)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">enable the various package-specific BBDB functions</span>
    (bbdb-initialize 'gnus 'message)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">- add bindings for the default keys to Gnus and configure Gnus to notify</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">the BBDB when new messages are loaded (required if the BBDB is to be</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">able to display BBDB entries for messages displayed in Gnus)</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">- add a binding for `</span><span class="org-constant"><span class="org-comment">M-TAB</span></span><span class="org-comment">' to Message mode.  This will enable completion</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">of addresses based on BBDB records</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">what do we do when invoking bbdb interactively (`:' to display sender)</span>
    (setq bbdb-mua-update-interactive-p '(query . create))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">update BBDB silently (don't display an auto-updated BBDB window)</span>
    (setq bbdb-mua-pop-up nil)
</pre></div>
</div>
<div id="outline-container-orgheadline347" class="outline-4">
<h4 id="orgheadline347">Interfaces</h4>
<div class="outline-text-4 org-src-container" id="text-orgheadline347">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* (info "(bbdb)Interfaces")</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">mail aliases (local mailing lists)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'message-setup-hook 'bbdb-define-all-aliases) ; BBDB 2.35</span>
    (add-hook 'message-setup-hook 'bbdb-mail-aliases) <span class="org-comment-delimiter">; </span><span class="org-comment">BBDB 3</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">always use full name when sending mail</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(even if User Name has an address of the form <a href="mailto:user.name%40domain">&lt;user.name@domain&gt;</a>)</span>
    (setq bbdb-dwim-net-address-allow-redundancy t) <span class="org-comment-delimiter">; </span><span class="org-comment">BBDB 2.35</span>
    (setq bbdb-mail-avoid-redundancy nil) <span class="org-comment-delimiter">; </span><span class="org-comment">BBDB 3</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">no popup on auto-complete</span>
    (setq bbdb-completion-display-record nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">completion is done across the set of all full-names and user-ids</span>
    (setq bbdb-completion-type nil)
</pre></div>
</div>
<div id="outline-container-orgheadline348" class="outline-4">
<h4 id="orgheadline348">Reader-specific Features</h4>
<div class="outline-text-4 org-src-container" id="text-orgheadline348">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* (info "(bbdb)Reader-specific Features")</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">marking posters with records in the BBDB</span>
    (setq bbdb/gnus-summary-mark-known-posters t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">mark authors in the Summary Buffer who have records in the BBDB</span>
    (setq bbdb/gnus-summary-known-poster-mark <span class="org-string">"B"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">display the poster's name from the BBDB if we have one</span>
    (setq bbdb/gnus-summary-prefer-real-names t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">replace the information provided in the From header with data from the</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">BBDB if we have one</span>
    (setq bbdb/gnus-summary-prefer-bbdb-data t)

    (setq bbdb/gnus-summary-show-bbdb-names t)
</pre></div>
</div>
<div id="outline-container-orgheadline349" class="outline-4">
<h4 id="orgheadline349">Options</h4>
<div class="outline-text-4" id="text-orgheadline349">
<p>You can add the author of a mail or posting to the BBDB by hitting <code>:</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* (info "(bbdb)Options")</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">no default area code to use when prompting for a new phone number</span>
    (setq bbdb-default-area-code nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">default country to use if none is specified</span>
    (setq bbdb-default-country <span class="org-string">""</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">disable syntax-checking of telephone numbers</span>
    (setq bbdb-north-american-phone-numbers-p nil) <span class="org-comment-delimiter">; </span><span class="org-comment">BBDB 2.35</span>
    (setq bbdb-phone-style nil)         <span class="org-comment-delimiter">; </span><span class="org-comment">BBDB 3</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">restoration of the window configuration</span>
    (setq bbdb-electric-p t)            <span class="org-comment-delimiter">; </span><span class="org-comment">BBDB 2.35</span>
    (setq bbdb-electric t)              <span class="org-comment-delimiter">; </span><span class="org-comment">BBDB 3</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">don't display a continuously-updating BBDB window while in GNUS</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq bbdb-use-pop-up nil)       ; BBDB 2.35</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq bbdb-pop-up-layout nil)    ; BBDB 3</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">desired number of lines in a GNUS pop-up BBDB window</span>
    (setq bbdb-pop-up-target-lines 1)   <span class="org-comment-delimiter">; </span><span class="org-comment">BBDB 2.35</span>
    (setq bbdb-pop-up-window-size 1)    <span class="org-comment-delimiter">; </span><span class="org-comment">BBDB 3</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">default display layout</span>
    (setq bbdb-display-layout 'multi-line)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">default display layout pop-up BBDB buffers</span>
    (setq bbdb-pop-up-display-layout 'one-line)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">omit creation-date and time stamp from BBDB display</span>
    (setq bbdb-display-layout-alist
          '((one-line          (order     . (phones notes))
                               (name-end  . 24)
                               (toggle    . t)
                               (omit      . (net AKA mail-alias gnus-private
                                                 creation-date timestamp)))
            (multi-line        (indention . 14)
                               (toggle    . t)
                               (omit      . (AKA creation-date timestamp)))
            (pop-up-multi-line (indention . 14))))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">allow cycling of email addresses while completing them</span>
    (setq bbdb-complete-name-allow-cycling t) <span class="org-comment-delimiter">; </span><span class="org-comment">BBDB 2.35</span>
    (setq bbdb-complete-mail-allow-cycling t) <span class="org-comment-delimiter">; </span><span class="org-comment">BBDB 3</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">save the database without asking (any time it would ask)</span>
    (setq bbdb-offer-save 'auto)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">automatically add some text to the notes field of the BBDB record</span>
    (add-hook 'bbdb-notice-hook 'bbdb-auto-notes-hook)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">capture auto-notes</span>
    (setq bbdb-auto-notes-alist
          <span class="org-comment-delimiter">;; </span><span class="org-comment">organization</span>
          `((<span class="org-string">"Organization"</span> (<span class="org-string">".*"</span> Organization 0))

            <span class="org-comment-delimiter">;; </span><span class="org-comment">X-Face bitmaps of the people</span>
            (<span class="org-string">"x-face"</span> ,(list (concat <span class="org-string">"[ \t\n]*</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">(</span></span><span class="org-string">[</span><span class="org-negation-char"><span class="org-string">^</span></span><span class="org-string"> \t\n]*</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">)</span></span><span class="org-string">"</span>
                                     <span class="org-string">"</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">(</span></span><span class="org-string">[ \t\n]+</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">(</span></span><span class="org-string">[</span><span class="org-negation-char"><span class="org-string">^</span></span><span class="org-string"> \t\n]+</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">)</span></span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">)</span></span><span class="org-string">?"</span>
                                     <span class="org-string">"</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">(</span></span><span class="org-string">[ \t\n]+</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">(</span></span><span class="org-string">[</span><span class="org-negation-char"><span class="org-string">^</span></span><span class="org-string"> \t\n]+</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">)</span></span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">)</span></span><span class="org-string">?"</span>
                                     <span class="org-string">"</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">(</span></span><span class="org-string">[ \t\n]+</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">(</span></span><span class="org-string">[</span><span class="org-negation-char"><span class="org-string">^</span></span><span class="org-string"> \t\n]+</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">)</span></span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">)</span></span><span class="org-string">?"</span>)
                             'face
                             <span class="org-string">"\\1\\3\\5\\7"</span>)))))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline350" class="outline-4">
<h4 id="orgheadline350">Utilities</h4>
<div class="outline-text-4" id="text-orgheadline350">
<p>BBDB 3 has a dial interface which allows you to call an external interface to make a call. This is done by modifying <code>bbdb-dial-function</code>. There are examples which interface with Skype to make a phone call.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 34 ends here</span>
</pre></div>
</div>
</div>
</div>
</div>
<div id="outline-container-orgheadline351" class="outline-2">
<h2 id="orgheadline351">Document Viewing</h2>
<div class="outline-text-2" id="text-orgheadline351">
<p>If <code>doc-view</code> is not showing the PDF files as images in Emacs, it may be because:</p>
<ul class="org-ul">
<li>no PNG support is available in Emacs (see <a href="#orgheadline282">Images</a>), or</li>
<li>some conversion utility for PDF files (Ghostscript) is not on your <code>PATH</code>.</li>
</ul>
<p>In that case, <code>doc-view</code> falls back to show you the plain text contents of the PDF if <code>doc-view-pdftotext-program</code> is on your <code>PATH</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 35 (info "(emacs)Document View")</span>

(leuven--chapter leuven-load-chapter-35-document-view <span class="org-string">"35 Document Viewing"</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">view PDF/PostScript/DVI files in Emacs</span>
</pre></div>
<p class="verse">From Tassilo Horn:<br />
<br />
&gt;&gt; <a href="https://github.com/politza/pdf-tools">https://github.com/politza/pdf-tools</a> (available through MELPA).<br />
&gt;<br />
&gt; Oh, that looks pretty impressive. I haven't used it, though, so I<br />
&gt; cannot help with this.<br />
<br />
Ok, now I had to check it out, and Andreas, it's a really superb<br />
package. I'm gonna use that now for reading PDF files instead of<br />
doc-view (where I'm the author) and Evince (which I use due to<br />
doc-view's limitations).<br />
<br />
But Troy is correct. The PDF he links makes emacs freeze, although I've<br />
been able to recover by hitting `C-g' repeatedly. The result was that<br />
the raw PDF data was shown.<br />
<br />
Before I had opened that file successfully with doc-view and then did<br />
M-x pdf-view-mode. That worked. When doing it that way, it seems some<br />
if not all of PDF Tools minor modes aren't active, so I guess one of<br />
them does something that triggers the freeze.<br />
<br />
Andreas, do you plan to propose PDF Tools for inclusion in Emacs? IMO,<br />
that's really a package anybody's gonna love. (Oh my god, how well the<br />
syntex stuff/AUCTeX integration works!)<br /></p>
<p>PDF Tools (<code>pdf-view-mode</code>) is no external program but a major mode for viewing PDFs in Emacs similar (but much more advanced) than <code>doc-view-mode</code>.</p>
<p>It's the best PDF viewer on GNU/Linux (including the ones not running in Emacs).</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">when</span> (and leuven--linux-p
             <span class="org-comment-delimiter">;; </span><span class="org-comment">(executable-find "epdfinfo")</span>
             )
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"pdf-tools-autoloads"</span>
      (pdf-tools-install)))
</pre></div>
</div>
<div id="outline-container-orgheadline352" class="outline-3">
<h3 id="orgheadline352">Navigation</h3>
<div class="outline-text-3" id="text-orgheadline352">
<p><code>doc-view</code> integrates with the usual bookmark facility. So, simply use <code>C-x r m</code> (<code>bookmark-set</code>) to jump back to the last page you've read in a PDF document.</p>
</div>
</div>
<div id="outline-container-orgheadline353" class="outline-3">
<h3 id="orgheadline353">Conversion</h3>
<div class="outline-text-3" id="text-orgheadline353">
<p>In <code>doc-view-mode</code>, you can use <code>C-s</code> to do regexp search on the page images.</p>
<p>In addition, by pressing <code>C-c C-t</code>, you can open the <b>text</b>-only representation (actually, the output of the command <code>pdftotext</code>) of the current doc in a new buffer, which is more suitable for heavy manipulation of the text of the PDF.</p>
<p>Another option, without <code>doc-view</code>, is <code>! pdtotext ? - &lt;RET&gt;</code>.</p>
<p><code>doc-view-enlarge</code> (<code>+</code>) and <code>doc-view-shrink</code> (<code>-</code>) work fine to zoom in or out.</p>
</div>
</div>
<div id="outline-container-orgheadline354" class="outline-3">
<h3 id="orgheadline354">XXX</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline354">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">antiword will be run on every `</span><span class="org-constant"><span class="org-comment">.doc</span></span><span class="org-comment">' file you open</span>
  <span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment"> sudo aptitude install antiword (or via Cygwin setup)</span>
  (autoload 'no-word <span class="org-string">"no-word"</span>
    <span class="org-doc">"Word to txt."</span>)
  (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.doc\\'"</span> . no-word))



  (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.docx\\'"</span> . docx2txt))

  (<span class="org-keyword">defun</span> <span class="org-function-name">docx2txt</span> ()
    <span class="org-doc">"Run `</span><span class="org-constant"><span class="org-doc">docx2txt</span></span><span class="org-doc">' on the entire buffer."</span>
    (shell-command-on-region (point-min) (point-max) <span class="org-string">"docx2txt.pl"</span> t t))



  <span class="org-comment-delimiter">;; </span><span class="org-comment">un-xls files</span>
  <span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment"> sudo aptitude install xlhtml</span>
  (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.xls\\'"</span> . no-xls))
  (<span class="org-keyword">defun</span> <span class="org-function-name">no-xls</span> (<span class="org-type">&amp;optional</span> filename)
    <span class="org-doc">"Run `</span><span class="org-constant"><span class="org-doc">xlhtml</span></span><span class="org-doc">' and `w3m -dump' on the entire buffer.</span>
<span class="org-doc">  Optional FILENAME says what filename to use.  This is only necessary for</span>
<span class="org-doc">  buffers without proper `</span><span class="org-constant"><span class="org-doc">buffer-file-name</span></span><span class="org-doc">'.  FILENAME should be a real</span>
<span class="org-doc">  filename, not a path."</span>
    (interactive <span class="org-string">"fExcel File: "</span>)
    (<span class="org-keyword">when</span> (and filename
               (not (buffer-file-name)))
      (write-file (make-temp-file filename)))
    (erase-buffer)
    (shell-command
     (format <span class="org-string">"xlhtml -nc -te %s | w3m -dump -T text/html"</span>
             (buffer-file-name))
     (current-buffer))
    (setq buffer-file-name nil)
    (set-buffer-modified-p nil))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">no-ppt</span>
  <span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment"> sudo aptitude install ppthtml</span>
  <span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">FIXME</span></span><span class="org-comment"> Not that good! (some text repeated multiple times)</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">no-ppt</span> (<span class="org-type">&amp;optional</span> filename)
    <span class="org-doc">"Run `</span><span class="org-constant"><span class="org-doc">ppthtml</span></span><span class="org-doc">' and `w3m -dump' on the entire buffer.</span>
<span class="org-doc">  Optional FILENAME says what filename to use.  This is only necessary for</span>
<span class="org-doc">  buffers without proper `</span><span class="org-constant"><span class="org-doc">buffer-file-name</span></span><span class="org-doc">'.  FILENAME should be a real</span>
<span class="org-doc">  filename, not a path."</span>
    (interactive <span class="org-string">"fPowerPoint File: "</span>)
    (<span class="org-keyword">when</span> (and filename
               (not (buffer-file-name)))
      (write-file (make-temp-file filename)))
    (erase-buffer)
    (shell-command
     (format <span class="org-string">"ppthtml %s | w3m -dump -T text/html"</span> (buffer-file-name))
     (current-buffer))
    (setq buffer-file-name nil)
    (set-buffer-modified-p nil))
  (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.ppt\\'"</span> . no-ppt))

)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 35 ends here</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline357" class="outline-2">
<h2 id="orgheadline357">Web Browsing</h2>
<div class="outline-text-2" id="text-orgheadline357"></div>
<div id="outline-container-orgheadline355" class="outline-3">
<h3 id="orgheadline355">Emacs-w3m</h3>
<div class="outline-text-3" id="text-orgheadline355">
<p>Emacs/W3 is dead, long live <a href="http://emacs-w3m.namazu.org/">Emacs-w3m</a> (a terrific text-based web and file browser).</p>
<p>For Win32, use the Cygwin version of the executable.</p>
<p><code>w3m-browse-url</code> asks Emacs-w3m to browse a URL.</p>
<p>When JavaScript is needed or the "design" is just too bad, use an <b>external browser</b>: you can open the current page in your graphical browser by hitting <code>M</code> (bound to <code>w3m-view-url-with-external-browser</code>) - at your own risk. For what "risk" means, please see: <code>(info "(emacs-w3m)Gnus")</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** Emacs-w3m</span>

  (leuven--section <span class="org-string">"Emacs-w3m"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">only use if `</span><span class="org-constant"><span class="org-comment">w3m</span></span><span class="org-comment">' command is available on system</span>
  (<span class="org-keyword">when</span> (executable-find <span class="org-string">"w3m"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">name of the executable file of the `</span><span class="org-constant"><span class="org-comment">w3m</span></span><span class="org-comment">' command</span>
    (setq w3m-command <span class="org-string">"w3m"</span>)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">I don't want `</span><span class="org-constant"><span class="org-comment">/usr/bin/w3m</span></span><span class="org-comment">' (which requires `</span><span class="org-constant"><span class="org-comment">cygwin-mount</span></span><span class="org-comment">')</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">an Emacs interface to w3m</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"w3m"</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">*** 3.1 Browsing Web Pages</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">go ahead, just try it</span>
      (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-w3m-goto-url</span> ()
        <span class="org-doc">"Type in directly the URL to visit (avoiding to hit `</span><span class="org-constant"><span class="org-doc">C-k</span></span><span class="org-doc">')."</span>
        (interactive)
        (<span class="org-keyword">let</span> ((w3m-current-url <span class="org-string">""</span>))
          (call-interactively 'w3m-goto-url)))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">make w3m stop "stealing" my arrow keys, allowing to move the</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">cursor down the lines of an HTML email (in Gnus)</span>
      (setq w3m-minor-mode-map nil)

      (define-key w3m-mode-map (kbd <span class="org-string">"U"</span>) 'leuven-w3m-goto-url)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">fix inappropriate key bindings for moving from place to place in a page</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(let the cursor keys behave normally, don't jump from link to link)</span>
      (define-key w3m-mode-map (kbd <span class="org-string">"&lt;up&gt;"</span>) 'previous-line)
      (define-key w3m-mode-map (kbd <span class="org-string">"&lt;down&gt;"</span>) 'next-line)
      (define-key w3m-mode-map (kbd <span class="org-string">"&lt;left&gt;"</span>) 'backward-char)
      (define-key w3m-mode-map (kbd <span class="org-string">"&lt;right&gt;"</span>) 'forward-char)

      (define-key w3m-mode-map (kbd <span class="org-string">"&lt;tab&gt;"</span>) 'w3m-next-anchor)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">moving from page to page</span>
      (define-key w3m-mode-map (kbd <span class="org-string">"F"</span>) 'w3m-view-next-page)

<span class="org-comment-delimiter">;;</span><span class="org-comment">*** 3.5 Using Tabs</span>

      (define-key w3m-mode-map (kbd <span class="org-string">"&lt;C-tab&gt;"</span>) 'w3m-next-buffer)
      (define-key w3m-mode-map (kbd <span class="org-string">"&lt;C-S-tab&gt;"</span>) 'w3m-previous-buffer)

      (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-w3m-new-tab</span> ()
        (interactive)
        (w3m-copy-buffer nil nil nil t))

      (define-key w3m-mode-map (kbd <span class="org-string">"C-t"</span>) 'leuven-w3m-new-tab)

      (define-key w3m-mode-map (kbd <span class="org-string">"C-w"</span>) 'w3m-delete-buffer)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">*** 5.1 General Variables</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">send referers only when both the current page and the target page are</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">provided by the same server</span>
      (setq w3m-add-referer 'lambda)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">home page</span>
      (setq w3m-home-page <span class="org-string">"http://www.emacswiki.org/"</span>)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">number of steps in columns used when scrolling a window horizontally</span>
      (setq w3m-horizontal-shift-columns 1)  <span class="org-comment-delimiter">; </span><span class="org-comment">2</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">proxy settings</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq w3m-command-arguments</span>
      <span class="org-comment-delimiter">;;          </span><span class="org-comment">(nconc w3m-command-arguments</span>
      <span class="org-comment-delimiter">;;                 </span><span class="org-comment">'("-o" "http_proxy=proxy:8080")))</span>
      <span class="org-comment-delimiter">;;                          </span><span class="org-comment">; </span><span class="org-leuven-highlight"><span class="org-comment">FIXME</span></span><span class="org-comment"> https_proxy for HTTPS support</span>

      (setq w3m-no-proxy-domains '(<span class="org-string">"localhost"</span> <span class="org-string">"127.0.0.1"</span>))

<span class="org-comment-delimiter">;;</span><span class="org-comment">*** 5.2 Image Variables</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">always display images</span>
      (setq w3m-default-display-inline-images t)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">show favicon images if they are available</span>
      (setq w3m-use-favicon t)

<span class="org-comment-delimiter">;;</span><span class="org-comment">*** 5.4 Cookie Variables</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">functions for cookie processing</span>
      (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"w3m-cookie"</span>

        <span class="org-comment-delimiter">;; </span><span class="org-comment">ask user whether accept bad cookies or not</span>
        (setq w3m-cookie-accept-bad-cookies 'ask)

        <span class="org-comment-delimiter">;; </span><span class="org-comment">list of trusted domains</span>
        (setq w3m-cookie-accept-domains
              '(<span class="org-string">"google.com"</span> <span class="org-string">"google.be"</span>
                <span class="org-string">"yahoo.com"</span> <span class="org-string">".yahoo.com"</span> <span class="org-string">"groups.yahoo.com"</span>
                <span class="org-string">"www.dyndns.org"</span>)))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">enable cookies (mostly required to use sites such as Gmail)</span>
      (setq w3m-use-cookies t)

<span class="org-comment-delimiter">;;</span><span class="org-comment">*** 5.14 Other Variables</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">list of content types, regexps (matching a url or a file</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">name), commands to view contents, and filters to override the</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">content type specified at first</span>
      (setq w3m-content-type-alist
            (append '((<span class="org-string">"text/html"</span> <span class="org-string">"\\.xhtml\\'"</span> nil nil))
                    w3m-content-type-alist))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">toggle a minor mode showing link numbers</span>
      (try-require 'w3m-lnum)
      (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"w3m-lnum"</span>

        (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-w3m-go-to-link-number</span> ()
          <span class="org-doc">"Turn on link numbers and ask for one to go to."</span>
          (interactive)
          (<span class="org-keyword">let</span> ((active w3m-lnum-mode))
            (<span class="org-keyword">when</span> (not active) (w3m-lnum-mode))
            (<span class="org-keyword">unwind-protect</span>
                (w3m-move-numbered-anchor (read-number
                                           <span class="org-string">"Anchor number: "</span>))
              (<span class="org-keyword">when</span> (not active) (w3m-lnum-mode))
              (w3m-view-this-url))))

        (define-key w3m-mode-map (kbd <span class="org-string">"f"</span>) 'leuven-w3m-go-to-link-number)

        <span class="org-comment-delimiter">;; </span><span class="org-comment">enable link numbering mode by default</span>
        (add-hook 'w3m-mode-hook 'w3m-lnum-mode))

      ))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline356" class="outline-3">
<h3 id="orgheadline356">EWW (Emacs Web Browser)</h3>
<div class="outline-text-3" id="text-orgheadline356">
<p><code>EWW</code> is the new Web browser for Emacs.</p>
<p>See <a href="https://www.gnu.org/software/emacs/manual/html_node/eww/index.html">https://www.gnu.org/software/emacs/manual/html_node/eww/index.html</a>.</p>
<dl class="org-dl">
<dt><code>&amp;</code> (<code>eww-browse-with-external-browser</code>)</dt>
<dd>Open the Web page in an external browser.</dd>
</dl>
</div>
</div>
</div>
<div id="outline-container-orgheadline358" class="outline-2">
<h2 id="orgheadline358">Running Shell Commands from Emacs</h2>
<div class="outline-text-2" id="text-orgheadline358">
<p>See customizations at <a href="http://snarfed.org/why_i_run_shells_inside_emacs">http://snarfed.org/why_i_run_shells_inside_emacs</a>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 36 Running (info "(emacs)Shell") Commands from Emacs</span>

(leuven--chapter leuven-load-chapter-36-shell <span class="org-string">"36 Running Shell Commands from Emacs"</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">transform shell names to what they really are</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"sh-script"</span>

    (add-to-list 'sh-alias-alist '(sh . bash)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Use shell from Cygwin/MinGW.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq shell-file-name "bash")</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setenv "SHELL" "/bin/bash")</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq explicit-bash-args '("-i")) ; --noediting added in Emacs 24.4</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq explicit-sh-args '("-i"))</span>
</pre></div>
</div>
<div id="outline-container-orgheadline359" class="outline-3">
<h3 id="orgheadline359">Single Shell</h3>
<div class="outline-text-3" id="text-orgheadline359">
<p><code>M-!</code> (<code>shell-command</code>) reads a line of text using the minibuffer and executes it as a shell command, in a subshell made just for that command.</p>
<p><code>M-|</code> (<code>shell-command-on-region</code>) passes the contents of the region as the standard input to the shell command. By prefixing it with <code>C-u</code>, it deletes the old region and <b>replaces</b> it with the output from the shell command.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 36.1 Single Shell</span>

  (leuven--section <span class="org-string">"36.1 Single Shell"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">force interactive behavior (to get my handy shell aliases)</span>
  <span class="org-comment-delimiter">;; </span><span class="org-leuven-highlight"><span class="org-comment">FIXME</span></span><span class="org-comment"> Fix for Zsh (zsh:1: command not found: shopt)</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(defadvice shell-command (before leuven-shell-command activate)</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(ad-set-arg 0</span>
  <span class="org-comment-delimiter">;;               </span><span class="org-comment">(concat "source ~/.bashrc; shopt -s -q expand_aliases;\n "</span>
  <span class="org-comment-delimiter">;;                       </span><span class="org-comment">(ad-get-arg 0))))</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">for single shell commands (= "the" reference)</span>
  (setq shell-file-name                 <span class="org-comment-delimiter">; </span><span class="org-comment">must be in the `</span><span class="org-constant"><span class="org-comment">PATH</span></span><span class="org-comment">'</span>
        (or (<span class="org-keyword">ignore-errors</span>
              (file-name-nondirectory (or (executable-find <span class="org-string">"zsh"</span>)
                                          (executable-find <span class="org-string">"bash"</span>)
                                          (executable-find <span class="org-string">"sh"</span>))))
            (<span class="org-keyword">when</span> leuven--win32-p <span class="org-string">"cmdproxy.exe"</span>)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">use `</span><span class="org-constant"><span class="org-comment">shell-file-name</span></span><span class="org-comment">' as the default shell</span>
  (setenv <span class="org-string">"SHELL"</span> shell-file-name)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">switch used to have the shell execute its command line argument</span>
  (setq shell-command-switch <span class="org-string">"-c"</span>)      <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">/c</span></span><span class="org-comment">' does not work with XEmacs</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">quote process arguments to ensure correct parsing on Windows</span>
  (setq w32-quote-process-args t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Workaround for Cygwin when 'shell-file-name' is 'bash'.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq null-device "/dev/null"))</span>
</pre></div>
<p>The above assignments may <b>NOT</b> be done <b>in an eval-after-load</b> as those variables are used by the (La)TeX modes (default + AUCTeX) among others.</p>
</div>
</div>
<div id="outline-container-orgheadline360" class="outline-3">
<h3 id="orgheadline360">Interactive Shell</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline360">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 36.2 Interactive Shell</span>

  (leuven--section <span class="org-string">"36.2 Interactive Shell"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">for the interactive (sub)shell (and AUCTeX compilation?)</span>
  (setq explicit-shell-file-name shell-file-name)
</pre></div>
</div>
<div id="outline-container-orgheadline365" class="outline-3">
<h3 id="orgheadline365">Shell Mode</h3>
<div class="outline-text-3" id="text-orgheadline365"></div>
<div id="outline-container-orgheadline361" class="outline-4">
<h4 id="orgheadline361">Entering commands and fixing mistakes</h4>
<div class="outline-text-4" id="text-orgheadline361">
<dl class="org-dl">
<dt><code>RET</code></dt>
<dd><b>Execute</b> the <b>command (on</b> the <b>current line)</b>.</dd>
<dt><code>C-c C-u</code></dt>
<dd><b>Delete input</b> (from the prompt) up to point (equivalent to <code>C-u</code> in Unix shells).</dd>
</dl>
</div>
</div>
<div id="outline-container-orgheadline362" class="outline-4">
<h4 id="orgheadline362">Completion of filenames</h4>
<div class="outline-text-4" id="text-orgheadline362">
<dl class="org-dl">
<dt><code>M-?</code></dt>
<dd>Display a list of possible completions for the filename at point.</dd>
</dl>
</div>
</div>
<div id="outline-container-orgheadline363" class="outline-4">
<h4 id="orgheadline363">Manipulating the output from the last command</h4>
<div class="outline-text-4" id="text-orgheadline363">
<dl class="org-dl">
<dt><code>C-c C-r</code></dt>
<dd><b>Show output</b> from last command (move first line of output to top of window).</dd>
<dt><code>C-c C-o</code></dt>
<dd><b>Delete output</b> (only) from last command.</dd>
</dl>
</div>
</div>
<div id="outline-container-orgheadline364" class="outline-4">
<h4 id="orgheadline364">Sending signals</h4>
<div class="outline-text-4" id="text-orgheadline364">
<dl class="org-dl">
<dt><code>C-c C-c</code></dt>
<dd>Interrupt current job (equivalent to <code>C-c</code> in Unix shells, <code>BREAK</code> signal).</dd>
<dt><code>C-c C-z</code></dt>
<dd>Suspend or stop current job (equivalent to <code>C-z</code> in Unix shells, <code>STOP</code> signal).</dd>
<dt><code>C-c C-d</code></dt>
<dd>Send <code>EOF</code> character.</dd>
</dl>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 36.3 Shell Mode</span>

  (leuven--section <span class="org-string">"36.3 Shell Mode"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">general command-interpreter-in-a-buffer stuff (Shell, SQLi, Lisp, R,</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Python, ...)</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(try-require 'comint)</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "comint"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">comint prompt is read only</span>
    (setq comint-prompt-read-only t)    <span class="org-comment-delimiter">; </span><span class="org-comment">Text is read-only (in ESS)?</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">no duplicates in command history</span>
    (setq-default comint-input-ignoredups t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">input to interpreter causes windows showing the buffer to scroll</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(insert at the bottom)</span>
    (setq-default comint-scroll-to-bottom-on-input t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">output to interpreter causes windows showing the buffer to scroll</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(add output at the bottom)</span>
    (setq-default comint-move-point-for-output t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">maximum size in lines for Comint buffers</span>
    (setq comint-buffer-maximum-size (* 5 1024)) <span class="org-comment-delimiter">; </span><span class="org-comment">if the function</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">comint-truncate-buffer</span></span><span class="org-comment">' is added to</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">comint-output-filter-functions</span></span><span class="org-comment">'</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">strip `</span><span class="org-constant"><span class="org-comment">^M</span></span><span class="org-comment">' characters</span>
    (add-to-list 'process-coding-system-alist
                 '(<span class="org-string">"bash"</span> . (undecided-dos . undecided-unix)))
    (add-to-list 'process-coding-system-alist
                 '(<span class="org-string">"zsh"</span> . (undecided-dos . undecided-unix)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">show completion list when ambiguous</span>
    (setq comint-completion-autolist t)

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-comint-clear-buffer</span> ()
      <span class="org-doc">"Clear the Comint buffer."</span>
      (interactive)
      (<span class="org-keyword">let</span> ((comint-buffer-maximum-size 0))
        (comint-truncate-buffer)))

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"comint"</span>
      (define-key comint-mode-map (kbd <span class="org-string">"C-c C-k"</span>) 'leuven-comint-clear-buffer))

<span class="org-comment-delimiter">;; </span><span class="org-comment">)</span>
</pre></div>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Command Prompt Here in Emacs</b><br />
<p>See <a href="http://tsdh.wordpress.com/category/lisp/emacs-lisp/">http://tsdh.wordpress.com/category/lisp/emacs-lisp/</a> to quickly open a Shell bufffer from Emacs.</p>
</div>
</div>
</div>
</div>
<div id="outline-container-orgheadline366" class="outline-3">
<h3 id="orgheadline366">Shell Prompts</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline366">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 36.4 Shell Prompts</span>

  (leuven--section <span class="org-string">"36.4 Shell Prompts"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">regexp to match prompts in the inferior shell</span>
  (setq shell-prompt-pattern <span class="org-string">"^[</span><span class="org-negation-char"><span class="org-string">^</span></span><span class="org-string">#$%&gt;\n]*[#$%&gt;] *"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">regexp to recognize prompts in the inferior process</span>
  (setq comint-prompt-regexp shell-prompt-pattern)
                                        <span class="org-comment-delimiter">;</span><span class="org-comment">! only used if the variable</span>
                                        <span class="org-comment-delimiter">;</span><span class="org-comment">! `</span><span class="org-constant"><span class="org-comment">comint-use-prompt-regexp</span></span><span class="org-comment">' is non-nil</span>
</pre></div>
</div>
<div id="outline-container-orgheadline367" class="outline-3">
<h3 id="orgheadline367">History</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline367">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 36.5 Shell Command History</span>

  (leuven--section <span class="org-string">"36.5 Shell Command History"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">rejects short commands</span>
  (setq comint-input-filter
    #'(<span class="org-keyword">lambda</span> (str)
        (and (not (string-match <span class="org-string">"\\`\\s *\\'"</span> str))
             (&gt; (length str) 2))))      <span class="org-comment-delimiter">; </span><span class="org-comment">ignore '!!' and kin</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"comint"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">cycle backwards/forwards through input history</span>
    (define-key comint-mode-map
      (kbd <span class="org-string">"C-p"</span>) 'comint-previous-input) <span class="org-comment-delimiter">; </span><span class="org-comment">Shell</span>
    (define-key comint-mode-map
      (kbd <span class="org-string">"&lt;up&gt;"</span>) 'comint-previous-input) <span class="org-comment-delimiter">; </span><span class="org-comment">Shell + RStudio</span>
    (define-key comint-mode-map
      (kbd <span class="org-string">"C-n"</span>) 'comint-next-input)   <span class="org-comment-delimiter">; </span><span class="org-comment">Shell</span>
    (define-key comint-mode-map
      (kbd <span class="org-string">"&lt;down&gt;"</span>) 'comint-next-input) <span class="org-comment-delimiter">; </span><span class="org-comment">Shell + RStudio</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">search backwards/forwards through input history for match for current</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">input</span>
    (define-key comint-mode-map
      (kbd <span class="org-string">"M-p"</span>) 'comint-previous-matching-input-from-input) <span class="org-comment-delimiter">; </span><span class="org-comment">Shell</span>
    (define-key comint-mode-map
      (kbd <span class="org-string">"&lt;C-up&gt;"</span>) 'comint-previous-matching-input-from-input) <span class="org-comment-delimiter">; </span><span class="org-comment">RStudio</span>
    (define-key comint-mode-map
      (kbd <span class="org-string">"M-n"</span>) 'comint-next-matching-input-from-input) <span class="org-comment-delimiter">; </span><span class="org-comment">Shell</span>
    (define-key comint-mode-map
      (kbd <span class="org-string">"&lt;C-down&gt;"</span>) 'comint-next-matching-input-from-input) <span class="org-comment-delimiter">; </span><span class="org-comment">RStudio</span>

    (<span class="org-keyword">when</span> (<span class="org-keyword">featurep</span> '<span class="org-constant">helm-misc</span>)
      <span class="org-comment-delimiter">;; </span><span class="org-comment">provide completion of `</span><span class="org-constant"><span class="org-comment">comint</span></span><span class="org-comment">' history</span>
      (define-key comint-mode-map
        (kbd <span class="org-string">"C-c C-l"</span>) 'helm-comint-input-ring)))
</pre></div>
<div id="outline-container-orgheadline368" class="outline-4">
<h4 id="orgheadline368">Command History</h4>
<div class="outline-text-4" id="text-orgheadline368">
<dl class="org-dl">
<dt><code>C-p</code> (or <code>&lt;up&gt;</code>)</dt>
<dd>Fetch the next <b>earlier</b> command in the history (doesn't execute it).</dd>
<dt><code>C-n</code> (or <code>&lt;down&gt;</code>)</dt>
<dd>Fetch the next <b>later</b> command in the history (doesn't execute it).</dd>
<dt><code>M-p</code> (or <code>&lt;C-up&gt;</code>)</dt>
<dd>Fetch the next <b>earlier</b> command in the history matching the string typed so far (doesn't execute it).</dd>
<dt><code>M-n</code> (or <code>&lt;C-down&gt;</code>)</dt>
<dd>Fetch the next <b>later</b> command in the history matching the string typed so far (doesn't execute it).</dd>
<dt><code>M-r</code></dt>
<dd>Begin an incremental <b>regexp search of old commands</b>.</dd>
<dt><code>C-c C-l</code></dt>
<dd>Display the current buffer's <b>history</b> of shell commands.</dd>
</dl>
</div>
</div>
<div id="outline-container-orgheadline369" class="outline-4">
<h4 id="orgheadline369">Manipulating the transcript: Viewing older commands</h4>
<div class="outline-text-4" id="text-orgheadline369">
<dl class="org-dl">
<dt><code>C-c C-p</code></dt>
<dd>Move point to <b>previous command prompt</b>.</dd>
<dt><code>C-c C-n</code></dt>
<dd>Move point to <b>next command prompt</b>.</dd>
</dl>
</div>
</div>
</div>
<div id="outline-container-orgheadline370" class="outline-3">
<h3 id="orgheadline370">Directory Tracking</h3>
<div class="outline-text-3" id="text-orgheadline370">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 36.6 Directory Tracking</span>

  (leuven--section <span class="org-string">"36.6 Directory Tracking"</span>)
</pre></div>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Fix case when 2 Shell buffers are run in the same dir (same name error!)</b><br />
<p>apply: Buffer name `*shell d:/Users/fni/*' is in use</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--rename-buffer-to-curdir</span> (<span class="org-type">&amp;optional</span> _string)
    <span class="org-doc">"Change Shell buffer's name to current directory."</span>
    (rename-buffer (concat <span class="org-string">"*shell "</span> default-directory <span class="org-string">"*"</span>)))

  (add-hook 'shell-mode-hook
            (<span class="org-keyword">lambda</span> ()
              (leuven--rename-buffer-to-curdir)
              (add-hook 'comint-output-filter-functions
                        'leuven--rename-buffer-to-curdir nil t)))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">local to Shell comint</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline371" class="outline-3">
<h3 id="orgheadline371">Options</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline371">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 36.7 Options</span>

  (leuven--section <span class="org-string">"36.7 Options"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">disable command echoing</span>
  (setq-default comint-process-echoes t) <span class="org-comment-delimiter">; </span><span class="org-comment">for Linux (not needed for Cygwin)</span>
</pre></div>
<div id="outline-container-orgheadline373" class="outline-4">
<h4 id="orgheadline373">Paging in Shell</h4>
<div class="outline-text-4" id="text-orgheadline373">
<p>If you ever tried to run a program like <code>git</code> under <code>M-x shell</code>, you will have come across the warning "terminal is not fully functional" followed by unusable behavior. This is because <code>git</code> sends its output through a pager (probably <code>less</code>), which requires a real <a href="#orgheadline372">terminal emulator</a>.</p>
<p>Setting the <code>PAGER</code> environment variable to <code>/bin/cat</code> (but only inside Emacs) solves this problem:</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (setenv <span class="org-string">"PAGER"</span> <span class="org-string">"/usr/bin/cat"</span>)
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline372" class="outline-3">
<h3 id="orgheadline372"><a id="ID-d12c2e1e-8147-4b39-8128-aaa70fbf4657" name="ID-d12c2e1e-8147-4b39-8128-aaa70fbf4657"></a>Terminal emulator</h3>
<div class="outline-text-3" id="text-orgheadline372">
<p>Full terminal emulation is available.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 36.8 Terminal emulator</span>

  (leuven--section <span class="org-string">"36.8 Terminal emulator"</span>)
</pre></div>
<p>From my experience, none of the terminal emulators in Emacs (<code>term</code>, <code>ansi-term</code>, <code>multi-term</code>) is supported under Windows. It looks like the main reason is all of them rely on low-level support for terminals (<code>stty</code>, etc.) which is not provided by Windows.</p>
<p>Though, <code>term</code>, <code>ansi-term</code>, and <code>multi-term</code> do <b>work in Cygwin Emacs</b>.</p>
</div>
</div>
<div id="outline-container-orgheadline374" class="outline-3">
<h3 id="orgheadline374">Term Mode</h3>
<div class="outline-text-3" id="text-orgheadline374">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 36.9 Term Mode</span>

  (leuven--section <span class="org-string">"36.9 Term Mode"</span>)
</pre></div>
<p>Emacs <b>Shell mode</b> doesn't support (all) terminal control codes, so <code>less</code> doesn't work ("page-at-a-time" feature).</p>
<p>Shell mode buffers do not use ptys (pseudo-terminals), so programs running in such a buffer (the shell, the programs run by the shell, etc.) can't perform character-at-a-time input. Each line is typed in full and only sent when <code>&lt;RET&gt;</code> is pressed. To see proof, run the <code>tty</code> command in a Shell mode buffer, and its output will be <code>not a tty</code>.</p>
<p>Note that it may seem that this is not true because you can perform command-line editing with <code>C-b</code>, <code>C-f</code>, etc. But this is only because <code>shell-mode</code> itself simulates the typical command-line editing features of shells like Bash, Zsh, etc. using Emacs own internal editing capabilities.</p>
<p>Anyway, you can:</p>
<ul class="org-ul">
<li>use <code>isearch</code> to search through the command output,</li>
<li>copy stuff into the kill ring or</li>
<li>use the rectangle functions.</li>
</ul>
<p>Or you might just prefer the Emacs key bindings over the ones your shell offers.</p>
<p>On the other hand, <b>Term mode</b> provides a proper <b>terminal emulator</b> (though not as good as the good old <code>xterm</code>). You must use it for applications that are interactive with your terminal (such as the command <code>top</code>).</p>
<div class="note">
<p>In Shell mode, use <code>M-x proced</code> instead of <code>top</code>.</p>
</div>
<div class="note">
<p><code>MPlayer</code> commands do not work in the Emacs shell. Use <code>term</code> for <code>/</code> and <code>*</code> to decrease / increase volume.</p>
</div>
<p>You can <b>switch to line mode</b> (<code>C-c C-j</code>) when you need Term to <i>basically</i> act like a Shell mode buffer, and move around the buffer pretty much like anywhere else in Emacs. Copy / kill-ring commands, <code>isearch</code>, etc. do work.</p>
<p>Then, you can use <code>C-c C-k</code> to <b>switch</b> back <b>to character mode</b>, the default, which is like your normal <b>terminal</b> emulator except the escape key.</p>
<p>It's wrong to think that <code>M-x term</code> captures everything it seems (which would defeat the purpose of running it inside Emacs):</p>
<ul class="org-ul">
<li>In the default character mode, <code>C-c</code> is the key prefix.</li>
<li>In line mode, you don't need a prefix.</li>
</ul>
<p>Try also to use <code>M-x ansi-term</code> that is much better than <code>term</code>:</p>
<ul class="org-ul">
<li>with <code>M-x term</code>, you can run <b>only one shell</b>;</li>
<li>with <code>M-x ansi-term</code>, you can start more than one (<code>*ansi-term*&lt;2&gt;</code>, <code>*ansi-term*&lt;3&gt;</code>).</li>
</ul>
<p>Note that <code>TERM</code> is different in both environments:</p>
<ul class="org-ul">
<li>In <code>M-x shell</code>, <code>TERM=emacs</code></li>
<li>In <code>M-x term</code>, <code>TERM=eterm-color</code></li>
</ul>
<p>MultiTerm (<a href="http://www.emacswiki.org/emacs/MultiTerm">http://www.emacswiki.org/emacs/MultiTerm</a>) works much better than shell or term.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">managing multiple terminal buffers in Emacs</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(and fixing some troubles of `</span><span class="org-constant"><span class="org-comment">term-mode</span></span><span class="org-comment">': key bindings, etc.)</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">"multi-term on POSIX hosts has let me switch from using screen, with one</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Emacs screen and lots of shell screens; to just using Emacs, with lots of</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">terminals inside it."</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"multi-term-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-c t") 'multi-term-next)</span>
    (global-set-key (kbd <span class="org-string">"C-c T"</span>) 'multi-term)) <span class="org-comment-delimiter">; </span><span class="org-comment">create a new one</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"multi-term"</span>

    (setq multi-term-program shell-file-name))
</pre></div>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Try <i>visual</i> commands (like <code>top</code> or <code>less</code>) in <code>multi-term</code></b><br />
nil</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; run an inferior shell, with I/O through buffer `</span><span class="org-constant"><span class="org-comment">*shell*</span></span><span class="org-comment">'</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(kbd "C-c !")</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(cond (leuven--win32-p 'shell)</span>
  <span class="org-comment-delimiter">;;         </span><span class="org-comment">(t 'term)))</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">toggle to and from the `</span><span class="org-constant"><span class="org-comment">*shell*</span></span><span class="org-comment">' buffer</span>
  (global-set-key (kbd <span class="org-string">"C-!"</span>)
    (<span class="org-keyword">lambda</span> ()
      (interactive)
      (switch-or-start 'shell <span class="org-string">"*shell*"</span>)))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline375" class="outline-3">
<h3 id="orgheadline375">Remote Host</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline375">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 36.10 Remote Host Shell</span>

  (leuven--section <span class="org-string">"36.10 Remote Host Shell"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">load ssh.el file</span>
  (add-to-list 'same-window-regexps <span class="org-string">"^\\*ssh-.*\\*</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">(</span></span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">|</span></span><span class="org-string">&lt;[0-9]+&gt;</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">)</span></span><span class="org-string">"</span>)
  (autoload 'ssh <span class="org-string">"ssh"</span>
    <span class="org-doc">"Open a network login connection via `</span><span class="org-constant"><span class="org-doc">ssh</span></span><span class="org-doc">'."</span> t)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">this is to run ESS remotely on another computer in my own Emacs, or just</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">plain old reading remote files</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">See http://emacs.1067599.n5.nabble.com/SSH-inside-Emacs-td225528.html</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">- plink (with `</span><span class="org-constant"><span class="org-comment">dumb</span></span><span class="org-comment">' terminal option?) as interactive shell</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">- ssh -t -t user@host</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">- Cygwin'ized Emacs</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">- MSYS (MinGW)</span>
</pre></div>
</div>
<div id="outline-container-orgheadline376" class="outline-3">
<h3 id="orgheadline376">Serial Terminal</h3>
<div class="outline-text-3" id="text-orgheadline376">
<p>Since GNU Emacs 23, there's now support for serial port access. The new command <code>serial-term</code> starts an interactive terminal on a serial port.</p>
</div>
</div>
<div id="outline-container-orgheadline377" class="outline-3">
<h3 id="orgheadline377">Helper for GNU Emacs on w32</h3>
<div class="outline-text-3" id="text-orgheadline377">
<p>Let Emacs, for example, find the program <code>/usr/bin/w3m</code>.</p>
<p class="c2">But <code>cygwin-mount-activate</code> causes problems (Emacs crashes or unable to connect) when reading mail with Gnus</p>
<p>Those problems disappear as soon as we do <code>cygwin-mount-deactivate</code></p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Let Emacs recognize Cygwin paths (e.g. /usr/local/lib).</span>
  (<span class="org-keyword">when</span> (and leuven--win32-p
             (executable-find <span class="org-string">"mount"</span>)) <span class="org-comment-delimiter">; </span><span class="org-comment">Cygwin bin directory found</span>

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"cygwin-mount-autoloads"</span>

      (autoload 'cygwin-mount-activate <span class="org-string">"cygwin-mount"</span>
        <span class="org-doc">"Activate cygwin-mount- and cygwin-style-handling."</span> t)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">(cygwin-mount-activate)           ; This is sometimes VERY SLOW!</span>
      ))
</pre></div>
<p>See <code>w32-settings.el</code> for more!</p>
</div>
</div>
<div id="outline-container-orgheadline378" class="outline-3">
<h3 id="orgheadline378">Helper for Cygwin Emacs</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline378">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Let Emacs recognize Windows paths (e.g. C:/Program Files/).</span>
  (<span class="org-keyword">when</span> leuven--cygwin-p

    (try-require 'windows-path)

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"windows-path"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Activate windows-path-style-handling.</span>
      (windows-path-activate)))
</pre></div>
</div>
<div id="outline-container-orgheadline379" class="outline-3">
<h3 id="orgheadline379">Emacs Speaks Statistics (ESS)</h3>
<div class="outline-text-3" id="text-orgheadline379">
<p>See:</p>
<ul class="org-ul">
<li><a href="http://ess.r-project.org/Manual/ess.html">http://ess.r-project.org/Manual/ess.html</a>,</li>
<li><a href="http://www.emacswiki.org/emacs/EmacsSpeaksStatistics">http://www.emacswiki.org/emacs/EmacsSpeaksStatistics</a>.</li>
</ul>
</div>
<div id="outline-container-orgheadline380" class="outline-4">
<h4 id="orgheadline380">2 Installing ESS on your system</h4>
<div class="outline-text-4 org-src-container" id="text-orgheadline380">
<pre class="src src-emacs-lisp">
  (leuven--section <span class="org-string">"Utilities -- ESS"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">ESS: Emacs Speaks Statistics</span>
  (autoload 'R <span class="org-string">"ess-site"</span>
    <span class="org-doc">"Call 'R', the 'GNU S' system from the R Foundation."</span> t)

  (autoload 'R-mode <span class="org-string">"ess-site"</span>
    <span class="org-doc">"Major mode for editing R source."</span> t)

  (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.[rR]\\'"</span> . R-mode))
</pre></div>
</div>
<div id="outline-container-orgheadline381" class="outline-4">
<h4 id="orgheadline381">3 Interacting with statistical programs</h4>
<div class="outline-text-4" id="text-orgheadline381">
<p>Start an R session with <code>M-x R</code>.</p>
<div class="note">
<p>To run statistical processes under ESS, Windows users will need to make sure that the directories for <code>R</code> or <code>Rterm</code> (see <code>inferior-R-program-name</code>) are in their <code>PATH</code> environment variable.</p>
</div>
<p><b>Customize</b> variables for ESS (set these variables <b>before</b> loading <code>ess-site</code>).</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">start R in current working directory, don't ask user</span>
  (setq ess-ask-for-ess-directory nil)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">new inferior ESS process appears in another window in the current frame</span>
  (setq inferior-ess-same-window nil)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">when</span> leuven--cygwin-p                 <span class="org-comment-delimiter">; </span><span class="org-comment">using R from Cygwin</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">safe 8.3 name for 32-bit programs</span>
    (setq ess-program-files <span class="org-string">"c:/PROGRA~2"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">safe 8.3 name for 64-bit programs</span>
    (setq ess-program-files-64 <span class="org-string">"c:/PROGRA~1"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">program name for invoking an inferior ESS with `M-x R'</span>
    (setq inferior-R-program-name <span class="org-string">"R"</span>)) <span class="org-comment-delimiter">; </span><span class="org-comment">[default: Rterm]</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">accented characters on graphics</span>
  (add-to-list 'process-coding-system-alist
               '(<span class="org-string">"R.*"</span> . iso-latin-1))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline382" class="outline-4">
<h4 id="orgheadline382">4 Interacting with the ESS process</h4>
<div class="outline-text-4" id="text-orgheadline382">
<ul class="org-ul">
<li><code>inferior-ess-mode-map</code> for R console only</li>
<li><code>comint-mode-map</code> for Shell console as well</li>
</ul>
</div>
</div>
<div id="outline-container-orgheadline383" class="outline-4">
<h4 id="orgheadline383">5 Sending code to the ESS process</h4>
<div class="outline-text-4 org-src-container" id="text-orgheadline383">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; display input commands in the process buffer</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq ess-eval-visibly 'nowait)       ; but avoid Emacs hanging on large</span>
  <span class="org-comment-delimiter">;;                                       </span><span class="org-comment">; evaluations</span>
</pre></div>
</div>
<div id="outline-container-orgheadline384" class="outline-4">
<h4 id="orgheadline384">7 Editing objects and functions</h4>
<div class="outline-text-4" id="text-orgheadline384">
<p>Smart underscore:</p>
<ul class="org-ul">
<li>Pressing underscore once inserts <code>&lt;-</code>.</li>
<li>Pressing underscore twice inserts a literal underscore.</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">default ESS indentation style</span>
  (setq ess-default-style 'DEFAULT)
</pre></div>
</div>
<div id="outline-container-orgheadline385" class="outline-5">
<h5 id="orgheadline385">Code folding</h5>
<div class="outline-text-5 org-src-container" id="text-orgheadline385">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ess-site"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">code folding in ESS mode</span>
    (add-hook 'ess-mode-hook 'hs-minor-mode)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline387" class="outline-4">
<h4 id="orgheadline387">9 Completion</h4>
<div class="outline-text-4" id="text-orgheadline387"></div>
<div id="outline-container-orgheadline386" class="outline-5">
<h5 id="orgheadline386">Integration with auto-complete package</h5>
<div class="outline-text-5" id="text-orgheadline386">
<div class="note">
<p>R docs are not in Info format. Though, they are available via the quick help of Auto-Complete.</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">suffix appended by `</span><span class="org-constant"><span class="org-comment">ac-source-R-args</span></span><span class="org-comment">' to candidates</span>
    (setq ess-ac-R-argument-suffix <span class="org-string">"="</span>)
</pre></div>
<p>XXX Switch to <code>company-ess</code>, which does auto-start completion of function arguments with 0 characters.</p>
<p>On <span class="timestamp-wrapper"><span class="timestamp">[2014-11-13 Thu]</span></span>, Vitalie Spinu wrote that he will add native Company support in ESS in the near future.</p>
</div>
</div>
</div>
<div id="outline-container-orgheadline388" class="outline-4">
<h4 id="orgheadline388">10 Developing with ESS</h4>
<div class="outline-text-4" id="text-orgheadline388">
<p>See</p>
<ul class="org-ul">
<li><a href="http://code.google.com/p/ess-tracebug/">http://code.google.com/p/ess-tracebug/</a></li>
<li><a href="http://code.google.com/p/ess-tracebug/wiki/GettingStarted">http://code.google.com/p/ess-tracebug/wiki/GettingStarted</a>.</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">activate ess-tracebug every time r session starts</span>
    (add-hook 'ess-post-run-hook 'ess-tracebug)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline394" class="outline-4">
<h4 id="orgheadline394">11 Other ESS features and tools</h4>
<div class="outline-text-4" id="text-orgheadline394"></div>
<div id="outline-container-orgheadline389" class="outline-5">
<h5 id="orgheadline389">Describe object at point</h5>
<div class="outline-text-5" id="text-orgheadline389">
<p>Get info for object at point, and display it in an electric buffer with the command <code>ess-describe-object-at-point</code> (bound to <code>C-c C-d C-e</code>, repeat <code>C-e</code> or <code>e</code> to cycle between <code>str()</code>, <code>head()</code>, <code>tail()</code> and <code>summary()</code>).</p>
<p>Use <code>other-window</code> to switch to <code>*ess-describe*</code> window.</p>
<p>It was inspired by Erik Iverson's <code>ess-R-object-tooltip</code>.</p>
</div>
</div>
<div id="outline-container-orgheadline390" class="outline-5">
<h5 id="orgheadline390">ElDoc</h5>
<div class="outline-text-5" id="text-orgheadline390">
<p>Since ESS v12.02, ElDoc functionality (to report R function arguments) has been moved into the core, and is active by default; so you don't need to configure anything</p>
<p>When you visit a R mode, ElDoc will be turned on. However, you will <b>first need to associate the R buffer with an R process</b> so that args can be looked up - otherwise, ElDoc will silently not report anything.</p>
<p>So, e.g. try:</p>
<ol class="org-ol">
<li><code>C-x C-f somefile.R</code></li>
<li><code>M-x R</code> (so that <code>somefile.R</code> is associated with <code>*R*</code>)</li>
<li>ElDoc should then work.</li>
</ol>
</div>
</div>
<div id="outline-container-orgheadline391" class="outline-5">
<h5 id="orgheadline391">Highlighting</h5>
<div class="outline-text-5 org-src-container" id="text-orgheadline391">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">font-lock keywords for the R mode</span>
    (setq ess-R-font-lock-keywords
          '((ess-R-fl-keyword:modifiers . t) <span class="org-comment-delimiter">; </span><span class="org-comment">default</span>
            (ess-R-fl-keyword:fun-defs . t) <span class="org-comment-delimiter">; </span><span class="org-comment">default</span>
            (ess-R-fl-keyword:keywords . t) <span class="org-comment-delimiter">; </span><span class="org-comment">default</span>
            (ess-R-fl-keyword:assign-ops . t) <span class="org-comment-delimiter">; </span><span class="org-comment">default</span>
            (ess-R-fl-keyword:constants . t) <span class="org-comment-delimiter">; </span><span class="org-comment">default</span>
            (ess-fl-keyword:fun-calls . t)
            (ess-fl-keyword:numbers . t)
            (ess-fl-keyword:operators . t)
            (ess-fl-keyword:delimiters . t)
            (ess-fl-keyword:= . t)
            (ess-R-fl-keyword:F&amp;T . t)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">font-lock patterns used in inferior-R-mode buffers</span>
    (setq inferior-R-font-lock-keywords
          '((ess-S-fl-keyword:prompt . t) <span class="org-comment-delimiter">; </span><span class="org-comment">default</span>
            (ess-R-fl-keyword:messages . t) <span class="org-comment-delimiter">; </span><span class="org-comment">default</span>
            (ess-R-fl-keyword:modifiers . t) <span class="org-comment-delimiter">; </span><span class="org-comment">default</span>
            (ess-R-fl-keyword:fun-defs . t) <span class="org-comment-delimiter">; </span><span class="org-comment">default</span>
            (ess-R-fl-keyword:keywords . t) <span class="org-comment-delimiter">; </span><span class="org-comment">default</span>
            (ess-R-fl-keyword:assign-ops . t) <span class="org-comment-delimiter">; </span><span class="org-comment">default</span>
            (ess-R-fl-keyword:constants . t) <span class="org-comment-delimiter">; </span><span class="org-comment">default</span>
            (ess-fl-keyword:matrix-labels . t) <span class="org-comment-delimiter">; </span><span class="org-comment">default</span>
            (ess-fl-keyword:fun-calls . t)
            (ess-fl-keyword:numbers . t)
            (ess-fl-keyword:operators . t)
            (ess-fl-keyword:delimiters . t)
            (ess-fl-keyword:= . t)
            (ess-R-fl-keyword:F&amp;T . t)))
</pre></div>
</div>
<div id="outline-container-orgheadline392" class="outline-5">
<h5 id="orgheadline392">Rdired</h5>
<div class="outline-text-5" id="text-orgheadline392">
<p>With your point on the line of a variable,</p>
<ul class="org-ul">
<li><code>p</code> will plot the object,</li>
<li><code>v</code> will view it, and</li>
<li><code>d</code> will mark the object for deletion (<code>x</code> will actually perform the deletion).</li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    <span class="org-comment-delimiter">;; </span><span class="org-comment">prototype object browser for R, looks like dired mode</span>
    (autoload 'ess-rdired <span class="org-string">"ess-rdired"</span>
      <span class="org-doc">"View *R* objects in a dired-like buffer."</span> t)
</pre></div>
<p>You could prefer to have the <code>*R dired*</code> buffer in a separate frame. Check out <code>special-display-buffer-names</code>.</p>
<p>Or have it dedicated in a window. Check out <a href="https://github.com/emacsmirror/dedicated">https://github.com/emacsmirror/dedicated</a>.</p>
</div>
</div>
<div id="outline-container-orgheadline393" class="outline-5">
<h5 id="orgheadline393">Interaction with Org mode</h5>
<div class="outline-text-5 org-src-container" id="text-orgheadline393">
<pre class="src src-emacs-lisp">
)
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline395" class="outline-3">
<h3 id="orgheadline395">Proced</h3>
<div class="outline-text-3" id="text-orgheadline395">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* Proced</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">start Proced in a similar manner to Dired</span>
  (global-set-key (kbd <span class="org-string">"C-x p"</span>) 'proced)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"proced"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">current sort scheme for proced listing</span>
    (setq-default proced-sort 'start)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">display of Proced buffer as process tree</span>
    (setq-default proced-tree-flag t))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline396" class="outline-2">
<h2 id="orgheadline396">Using Emacs Server</h2>
<div class="outline-text-2" id="text-orgheadline396">
<p>The Emacs version you're using and the <code>emacsclient</code> version you're using must be from the <b>same Emacs version</b> If the latter is not the cause of a refused connection, re-try <code>M-x server-start</code> in Emacs.</p>
<p><code>emacsclient</code> is waiting for Emacs to tell it it's done editing that file. That's important if you use <code>emacsclient</code> as your <code>EDITOR</code>. If you want <code>emacsclient</code> to return immediately, use the <code>-n</code> option.</p>
<p>Do you use <code>emacsclient</code> in terminals? If not, just use parameter <code>-c -n</code>, which creates an X Window and doesn't wait for <code>(server-edit)</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 37 (info "(emacs)Emacs Server")</span>

(leuven--chapter leuven-load-chapter-37-emacs-server <span class="org-string">"37 Using Emacs as a Server"</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">use Emacs as a server (with the `</span><span class="org-constant"><span class="org-comment">emacsclient</span></span><span class="org-comment">' program)</span>
  (GNUEmacs

    (<span class="org-keyword">unless</span> noninteractive
      (idle-require 'server))           <span class="org-comment-delimiter">; </span><span class="org-comment">after init</span>

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"server"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">test whether server is (definitely) running, avoiding the message of</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">"server-start" while opening another Emacs session</span>
      (or (equal (server-running-p) t)

          <span class="org-comment-delimiter">;; </span><span class="org-comment">start the Emacs server</span>
          (server-start))               <span class="org-comment-delimiter">; </span><span class="org-comment">~ 0.20 s</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">save file without confirmation before returning to the client</span>
      (<span class="org-keyword">defadvice</span> <span class="org-function-name">server-edit</span> (before save-buffer-if-needed activate)
        <span class="org-doc">"Save current buffer before marking it as done."</span>
        (<span class="org-keyword">when</span> server-buffer-clients (save-buffer)))))

)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 37 ends here</span>
</pre></div>
<p>Since GNU Emacs 23, there is also a <code>--daemon</code> flag to start the server in a convenient way.</p>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Understand the following:</b><br />
<div class="org-src-container">
<pre class="src src-emacs-lisp">
        <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'server-done-hook</span>
        <span class="org-comment-delimiter">;;        </span><span class="org-comment">(lambda ()</span>
        <span class="org-comment-delimiter">;;          </span><span class="org-comment">(shell-command "screen -r -X select `cat ~/tmp/emacsclient-caller`")))</span>
</pre></div>
<p>and see <a href="http://blog.jr0cket.co.uk/2012/10/using-emacs-24-server-on-mac-osx-for.html">http://blog.jr0cket.co.uk/2012/10/using-emacs-24-server-on-mac-osx-for.html</a> for ideas about having the right <code>emacsclient</code> used to connect to the Emacs server.</p>
</div>
</div>
</div>
<div id="outline-container-orgheadline397" class="outline-2">
<h2 id="orgheadline397">Printing Hard Copies</h2>
<div class="outline-text-2" id="text-orgheadline397">
<p>You can print any buffer with <code>C-u M-x ps-print-buffer-with-faces &lt;RET&gt;</code>. Because of the <code>C-u</code>, it will prompt for a file to place the PostScript into. You can then convert PS to PDF, if so desired.</p>
<p>You can print without faces (i.e. no colour) with <code>ps-print-buffer</code>.</p>
<p>You may wish to set <code>ps-print-landscape</code> to <code>t</code>.</p>
<p>See <code>(info "(emacs)Windows Printing")</code> for several methods of correctly setting up printing on Windows.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 38 (info "(emacs)Printing")</span>

(leuven--chapter leuven-load-chapter-38-printing <span class="org-string">"38 Printing Hard Copies"</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Print Emacs buffer on line printer</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">for {lpr,print}-{buffer,region}.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"lpr"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Name of program for printing a file.</span>
    (setq lpr-command (executable-find <span class="org-string">"enscript"</span>))
                                    <span class="org-comment-delimiter">; </span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment"> Install `</span><span class="org-constant"><span class="org-comment">enscript</span></span><span class="org-comment">'.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">List of strings to pass as extra options for the printer program.</span>
    (setq lpr-switches (list <span class="org-string">"--font=Courier8"</span>
                             <span class="org-string">"--header-font=Courier10"</span>
                             (format <span class="org-string">"--header=%s"</span> (buffer-name))))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Name of a printer to which data is sent for printing.</span>
    (setq printer-name t))

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-ps-print-buffer-with-faces-query</span> ()
    <span class="org-doc">"Query user before printing the buffer."</span>
    (interactive)
    (<span class="org-keyword">when</span> (y-or-n-p <span class="org-string">"Are you sure you want to print this buffer? "</span>)
      (ps-print-buffer-with-faces)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Generate and print a PostScript image of the buffer.</span>
  (GNUEmacs
    (<span class="org-keyword">when</span> leuven--win32-p
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Override `Print Screen' globally used as a hotkey by Windows.</span>
      (w32-register-hot-key (kbd <span class="org-string">"&lt;snapshot&gt;"</span>))
      (global-set-key
        (kbd <span class="org-string">"&lt;snapshot&gt;"</span>) 'leuven-ps-print-buffer-with-faces-query)))

  (global-set-key (kbd <span class="org-string">"M-p"</span>) 'leuven-ps-print-buffer-with-faces-query)

  (XEmacs
    (setq toolbar-print-function 'ps-print-buffer-with-faces))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Print text from the buffer as PostScript.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ps-print"</span>

    (<span class="org-keyword">defvar</span> <span class="org-variable-name">gsprint-program</span>
      (concat leuven--windows-program-files-dir <span class="org-string">"Ghostgum/gsview/gsprint.exe"</span>)
      <span class="org-doc">"Defines the Windows path to the gsview executable."</span>)

    (leuven--file-exists-and-executable-p gsprint-program)

    (<span class="org-keyword">if</span> (and gsprint-program
             (executable-find gsprint-program))

        (<span class="org-keyword">progn</span>
          <span class="org-comment-delimiter">;; </span><span class="org-comment">Name of a local printer for printing PostScript files.</span>
          (setq ps-printer-name t)      <span class="org-comment-delimiter">; </span><span class="org-comment">Adjusted to run Ghostscript.</span>


          <span class="org-comment-delimiter">;; </span><span class="org-comment">Name of program for printing a PostScript file.</span>
          (setq ps-lpr-command gsprint-program)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Tell Emacs where Ghostscript print</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">utility is located.</span>

          <span class="org-comment-delimiter">;; </span><span class="org-comment">List of extra switches to pass to `</span><span class="org-constant"><span class="org-comment">ps-lpr-command</span></span><span class="org-comment">'.</span>
          (setq ps-lpr-switches '(<span class="org-string">"-query"</span>)))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Tell Ghostscript to query which</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">printer to use.</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">'("-q" "-dNOPAUSE" "-dBATCH" "-sDEVICE=mswinpr2")</span>

      (setq ps-printer-name <span class="org-string">"//PRINT-SERVER/Brother HL-4150CDN"</span>) <span class="org-comment-delimiter">; </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span>
      (setq ps-lpr-command <span class="org-string">""</span>)
      (setq ps-lpr-switches '(<span class="org-string">"raw"</span>)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq ps-error-handler-message 'system)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Size of paper to format for.</span>
    (setq ps-paper-type 'a4)
    (setq ps-warn-paper-type nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Print in portrait mode.</span>
    (setq ps-landscape-mode nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq ps-print-control-characters nil)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Number of columns.</span>
    (setq ps-number-of-columns 1)

    (setq ps-left-margin 40)
    (setq ps-right-margin 56)
    (setq ps-bottom-margin 22)
    (setq ps-top-margin 32)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Page layout: Header [file-name     2001-06-18 Mon]</span>
    (setq ps-print-header-frame nil)    <span class="org-comment-delimiter">; </span><span class="org-comment">No box around the header.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">See http://www.emacswiki.org/emacs/PsPrintPackage-23.</span>
    (setq ps-header-frame-alist '((fore-color . <span class="org-string">"#CCCCCC"</span>)))
    (setq ps-header-lines 1)
    (setq ps-header-font-family 'Helvetica)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq ps-header-font-size 11)</span>
    (setq ps-header-title-font-size 11)
    (<span class="org-keyword">defun</span> <span class="org-function-name">ps-time-stamp-yyyy-mm-dd-aaa</span> ()
      <span class="org-doc">"Return date as \"2001-06-18 Mon\" (ISO date + day of week)."</span>
      (format-time-string <span class="org-string">"%Y-%m-%d %a"</span>))
    (setq ps-right-header '(ps-time-stamp-yyyy-mm-dd-aaa))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Page layout: Footer [                         n/m]</span>
    (setq ps-footer-offset 14)
    (setq ps-footer-line-pad .50)
    (setq ps-print-footer t)
    (setq ps-print-footer-frame nil)    <span class="org-comment-delimiter">; </span><span class="org-comment">No box around the footer.</span>
    (setq ps-footer-frame-alist '((fore-color . <span class="org-string">"#666666"</span>)))
    (setq ps-footer-lines 1)
    (setq ps-footer-font-family 'Helvetica)
    (setq ps-footer-font-size 8)
    (setq ps-left-footer nil)
    (setq ps-right-footer (list <span class="org-string">"/pagenumberstring load"</span>)) <span class="org-comment-delimiter">; </span><span class="org-comment">Page n of m.</span>

    (setq ps-font-family 'Courier)      <span class="org-comment-delimiter">; </span><span class="org-comment">See `</span><span class="org-constant"><span class="org-comment">ps-font-info-database</span></span><span class="org-comment">'.</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Legitimate values include Courier,</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Helvetica, NewCenturySchlbk, Palatino</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">and Times.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Font size, in points, for ordinary text, when generating PostScript.</span>
    (setq ps-font-size 9.1)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Specify if face background should be used.</span>
    (setq ps-use-face-background t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Specify line spacing, in points, for ordinary text.</span>
    (setq ps-line-spacing 3))

)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 38 ends here</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline398" class="outline-2">
<h2 id="orgheadline398">Sorting Text</h2>
<div class="outline-text-2 org-src-container" id="text-orgheadline398">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 39 (info "(emacs)Sorting") Text</span>

(leuven--chapter leuven-load-chapter-39-sorting <span class="org-string">"39 Sorting Text"</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Key binding.</span>
  (global-set-key (kbd <span class="org-string">"C-c ^"</span>) 'sort-lines)

)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 39 ends here</span>
</pre></div>
</div>
<div id="outline-container-orgheadline399" class="outline-2">
<h2 id="orgheadline399">Saving Emacs Sessions</h2>
<div class="outline-text-2" id="text-orgheadline399">
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Check that there is no extra ~/.saves directory!</b><br />
nil</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 42 (info "(emacs)Saving Emacs Sessions")</span>

(leuven--chapter leuven-load-chapter-42-saving-emacs-sessions <span class="org-string">"42 Saving Emacs Sessions"</span>

  (try-require 'saveplace)
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"saveplace"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Automatically save place in each file.</span>
    (setq-default save-place t))        <span class="org-comment-delimiter">; </span><span class="org-comment">default value for all buffers</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Name of the file that records `</span><span class="org-constant"><span class="org-comment">save-place-alist</span></span><span class="org-comment">' value.</span>
    (setq save-place-file <span class="org-string">"~/.emacs.d/.places"</span>)

)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 42 ends here</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline400" class="outline-2">
<h2 id="orgheadline400">Hyperlinking and Navigation Features</h2>
<div class="outline-text-2 org-src-container" id="text-orgheadline400">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 45 (info "(emacs)Hyperlinking")</span>

(leuven--chapter leuven-load-chapter-45-hyperlinking <span class="org-string">"45 Hyperlinking and Navigation Features"</span>
</pre></div>
<div id="outline-container-orgheadline401" class="outline-3">
<h3 id="orgheadline401">Following URLs</h3>
<div class="outline-text-3" id="text-orgheadline401">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Use proxy.</span>
  (setq url-proxy-services              <span class="org-comment-delimiter">;</span><span class="org-comment">! Emacs expects just hostname and port</span>
                                        <span class="org-comment-delimiter">;</span><span class="org-comment">! in `</span><span class="org-constant"><span class="org-comment">url-proxy-services</span></span><span class="org-comment">', NOT prefixed</span>
                                        <span class="org-comment-delimiter">;</span><span class="org-comment">! with "http://"</span>
        `((<span class="org-string">"http"</span>     . ,(getenv <span class="org-string">"http_proxy"</span>))
          (<span class="org-string">"ftp"</span>      . ,(getenv <span class="org-string">"http_proxy"</span>))
          (<span class="org-string">"no_proxy"</span> . <span class="org-string">"^.*example.com"</span>)))
          <span class="org-comment-delimiter">;; </span><span class="org-comment">Disable proxy for some hosts.</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** Pass a URL to a WWW browser.</span>

  (leuven--section <span class="org-string">"pass a URL to a WWW browser"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Default browser started when you click on some URL in the buffer.</span>
  (setq browse-url-browser-function
        (<span class="org-keyword">cond</span> ((or leuven--win32-p
                   leuven--cygwin-p)
               'browse-url-default-windows-browser)
              (leuven--mac-p
               'browse-url-default-macosx-browser)
              ((not (display-graphic-p)) <span class="org-comment-delimiter">; </span><span class="org-comment">Console.</span>
               'eww-browse-url)         <span class="org-comment-delimiter">; </span><span class="org-comment">'w3m-browse-url</span>
              (t                        <span class="org-comment-delimiter">; </span><span class="org-comment">Linux.</span>
               'browse-url-generic)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; TEMP For testing purpose</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq browse-url-browser-function 'eww-browse-url)</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Name of the browser program used by `</span><span class="org-constant"><span class="org-comment">browse-url-generic</span></span><span class="org-comment">'.</span>
  (setq browse-url-generic-program (executable-find <span class="org-string">"gnome-open"</span>))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Defer the decision to Gnome.  We could</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">use "firefox" or "google-chrome" as</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">well.</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline402" class="outline-3">
<h3 id="orgheadline402">Finding Files and URLs at Point</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline402">
<pre class="src src-emacs-lisp">
  (leuven--section <span class="org-string">"FFAP"</span>)

  (<span class="org-keyword">unless</span> (<span class="org-keyword">featurep</span> '<span class="org-constant">helm-config</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">visit a file</span>
    (global-set-key (kbd <span class="org-string">"&lt;f3&gt;"</span>) 'find-file-at-point))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">find file (or URL) at point</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ffap"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">function called to fetch an URL</span>
    (setq ffap-url-fetcher 'browse-url))<span class="org-comment-delimiter">; </span><span class="org-comment">could be `</span><span class="org-constant"><span class="org-comment">browse-url-emacs</span></span><span class="org-comment">' or</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">w3m-browse-url</span></span><span class="org-comment">'</span>
</pre></div>
</div>
<div id="outline-container-orgheadline403" class="outline-3">
<h3 id="orgheadline403">Google search</h3>
<div class="outline-text-3" id="text-orgheadline403">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** Web search</span>

  (leuven--section <span class="org-string">"Web search"</span>)
</pre></div>
<dl class="org-dl">
<dt><code>C-c g SPC</code></dt>
<dd><code>google-this-region</code></dd>
<dt><code>C-c g n</code></dt>
<dd><code>google-this-noconfirm</code></dd>
<dt><code>C-c g t</code></dt>
<dd><code>google-this</code></dd>
</dl>
<p><code>url-parse</code> and <code>url-cookies</code> are quite heavy to load, hence:</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">A set of functions and bindings to Google under point.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"google-this-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Keybinding under which `</span><span class="org-constant"><span class="org-comment">google-this-mode-submap</span></span><span class="org-comment">' is assigned.</span>
    (setq google-this-keybind (kbd <span class="org-string">"C-c g"</span>))

    (idle-require 'google-this))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"google-this"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable Google-This mode.</span>
    (google-this-mode 1))
</pre></div>
<p>When I want to Google most of a line, I call <code>google-this-line</code> and edit the prompt. And when I to Google the entire line, hitting <code>RET</code> one extra time doesn't quite bother me.</p>
<p>If you'd like to skip confirmation, you can define the following function and bind it to a key:</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (<span class="org-keyword">defun</span> <span class="org-function-name">google-this-line-noconfirm</span> (prefix)
      <span class="org-doc">"Google the current line without confirmationl.</span>
<span class="org-doc">    PREFIX determines quoting."</span>
      (interactive <span class="org-string">"P"</span>)
      (google-this-line prefix 'noconfirm))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-google-search-active-region-or-word-at-point</span> ()
    <span class="org-doc">"Create a Google search URL and send it to your web browser.</span>
<span class="org-doc">  If `</span><span class="org-constant"><span class="org-doc">transient-mark-mode</span></span><span class="org-doc">' is non-nil and the mark is active, it defaults to the</span>
<span class="org-doc">  current region, else to the word at or before point."</span>
    (interactive)
    (<span class="org-keyword">let</span> ((query
           (<span class="org-keyword">if</span> (use-region-p)
               (buffer-substring-no-properties (region-beginning) (region-end))
             (find-tag-default))))      <span class="org-comment-delimiter">; </span><span class="org-comment">or (current-word) for word at point?</span>
      (browse-url
       (concat
        <span class="org-string">"http://www.google.com/search?q="</span>
        (url-hexify-string query)))))

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-duckduckgo-search-active-region-or-word-at-point</span> ()
    <span class="org-doc">"Create a DuckDuckGo search URL and send it to your web browser.</span>
<span class="org-doc">  If `</span><span class="org-constant"><span class="org-doc">transient-mark-mode</span></span><span class="org-doc">' is non-nil and the mark is active, it defaults to the</span>
<span class="org-doc">  current region, else to the word at or before point."</span>
    (interactive)
    (<span class="org-keyword">let</span> ((query
           (<span class="org-keyword">if</span> (use-region-p)
               (buffer-substring-no-properties (region-beginning) (region-end))
             (find-tag-default))))      <span class="org-comment-delimiter">; </span><span class="org-comment">or (current-word) for word at point?</span>
      (browse-url
       (concat
        <span class="org-string">"https://duckduckgo.com/?q="</span>
        (url-hexify-string query)))))

  (global-set-key (kbd <span class="org-string">"C-c g G"</span>) 'leuven-google-search-active-region-or-word-at-point)
  (global-set-key (kbd <span class="org-string">"C-c g D"</span>) 'leuven-duckduckgo-search-active-region-or-word-at-point)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline404" class="outline-3">
<h3 id="orgheadline404">Babel translator</h3>
<div class="outline-text-3" id="text-orgheadline404">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** Babel</span>

  (leuven--section <span class="org-string">"Babel"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">interface to web translation services such as Babelfish</span>
  (<span class="org-keyword">when</span> (locate-library <span class="org-string">"babel"</span>)

    (autoload 'babel <span class="org-string">"babel"</span>
      <span class="org-doc">"Use a web translation service to translate the message MSG."</span> t)
    (autoload 'babel-region <span class="org-string">"babel"</span>
      <span class="org-doc">"Use a web translation service to translate the current region."</span> t)
    (autoload 'babel-as-string <span class="org-string">"babel"</span>
      <span class="org-doc">"Use a web translation service to translate MSG, returning a string."</span> t)
    (autoload 'babel-buffer <span class="org-string">"babel"</span>
      <span class="org-doc">"Use a web translation service to translate the current buffer."</span> t)

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-babel-translate</span> ()
      <span class="org-doc">"Translate using many online translators."</span>
      (interactive)
      (<span class="org-keyword">require</span> '<span class="org-constant">babel</span>)
      (<span class="org-keyword">let</span> (source)
        (switch-to-buffer <span class="org-string">"*leuven--translate*"</span>)
        (erase-buffer)
        (yank)
        (setq source (buffer-substring-no-properties (point-min) (point-max)))
        (erase-buffer)
        (insert <span class="org-string">"--- Source ---\n\n"</span>)
        (insert source)
        (insert <span class="org-string">"\n\n\n--- Translation FR -&gt; EN done by FreeTranslation ---\n\n"</span>)
        (insert (babel-work source <span class="org-string">"fr"</span> <span class="org-string">"en"</span> 'babel-free-fetch 'babel-free-wash))
        (insert <span class="org-string">"\n\n\n--- Translation EN -&gt; FR done by FreeTranslation ---\n\n"</span>)
        (insert (babel-work source <span class="org-string">"en"</span> <span class="org-string">"fr"</span> 'babel-free-fetch 'babel-free-wash)))))

)
</pre></div>
<p>Switch between different translation directions directly from minibuffer by using <code>C-n</code> and <code>C-p</code> key bindings.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Emacs interface to Google Translate</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"google-translate-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">translate a text using translation directions</span>
    (global-set-key <span class="org-string">"\C-ct"</span> 'google-translate-smooth-translate))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">just another UI to Google</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"google-translate-smooth-ui"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">translation directions</span>
    (setq google-translate-translation-directions-alist
          '((<span class="org-string">"fr"</span> . <span class="org-string">"en"</span>) (<span class="org-string">"en"</span> . <span class="org-string">"fr"</span>)
            (<span class="org-string">"fr"</span> . <span class="org-string">"nl"</span>) (<span class="org-string">"nl"</span> . <span class="org-string">"fr"</span>)
            (<span class="org-string">"fr"</span> . <span class="org-string">"es"</span>) (<span class="org-string">"es"</span> . <span class="org-string">"fr"</span>))))
</pre></div>
<p>fniessen</p>
</div>
</div>
</div>
<div id="outline-container-orgheadline405" class="outline-2">
<h2 id="orgheadline405">Other Amusements</h2>
<div class="outline-text-2 org-src-container" id="text-orgheadline405">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 46 Other (info "(emacs)Amusements")</span>

(leuven--chapter leuven-load-chapter-46-amusements <span class="org-string">"46 Other Amusements"</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">define a default menu bar</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"menu-bar"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">get rid of the Games in the Tools menu</span>
    (define-key menu-bar-tools-menu [games] nil))

)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 46 ends here</span>
</pre></div>
</div>
<div id="outline-container-orgheadline406" class="outline-2">
<h2 id="orgheadline406">Customization</h2>
<div class="outline-text-2" id="text-orgheadline406">
<p>Emacs 24 custom themes allow loading multiple themes simultaneously. If you don't want the previous theme to stay in effect, you will need to unload it first.</p>
<p>Install Leuven Theme via the <a href="#orgheadline8">Emacs Lisp Packages</a> (or use the one bundled in GNU Emacs 24.4).</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* 48 (info "(emacs)Customization")</span>

(leuven--chapter leuven-load-chapter-48-customization <span class="org-string">"48 Customization"</span>

  (GNUEmacs24
    (<span class="org-keyword">ignore-errors</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Load custom theme "Leuven" and enable it.</span>
      (load-theme 'leuven t)))
</pre></div>
</div>
<div id="outline-container-orgheadline407" class="outline-3">
<h3 id="orgheadline407">Color</h3>
<div class="outline-text-3" id="text-orgheadline407">
<p>You can govern the sort order of colors now such as HSV or RGB distance from a particular color</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">color sort order for `</span><span class="org-constant"><span class="org-comment">list-colors-display</span></span><span class="org-comment">'</span>
  (setq list-colors-sort '(rgb-dist . <span class="org-string">"#FFFFFF"</span>))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline408" class="outline-3">
<h3 id="orgheadline408">Color theme</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline408">
<pre class="src src-emacs-lisp">
  (XEmacs
    <span class="org-comment-delimiter">;; </span><span class="org-comment">the real color theme functions</span>
    (try-require 'color-theme-autoloads)
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"color-theme-autoloads"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">`</span><span class="org-constant"><span class="org-comment">color-theme-print</span></span><span class="org-comment">' allows to keep what you see</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">initialize the color theme package</span>
      (<span class="org-keyword">if</span> (fboundp 'color-theme-initialize)
          (color-theme-initialize))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">color themes will be installed for all frames</span>
      (setq color-theme-is-global t)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">set my default color theme</span>
      (try-require 'color-theme-leuven)
      (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"color-theme-leuven"</span>
        (color-theme-leuven)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">save whatever changes you make to the faces (colors and other font</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">properties)</span>
    (setq options-save-faces t))
</pre></div>
</div>
<div id="outline-container-orgheadline409" class="outline-3">
<h3 id="orgheadline409">Not sorted</h3>
<div class="outline-text-3" id="text-orgheadline409">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; limit serving to catch infinite recursions for you before they</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; cause actual stack overflow in C, which would be fatal for Emacs</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq max-lisp-eval-depth 600)        ; 1000?</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">limit on number of Lisp variable bindings &amp; unwind-protects</span>
  (setq max-specpdl-size 3000)          <span class="org-comment-delimiter">; </span><span class="org-comment">XEmacs 21.5.29</span>
</pre></div>
<p>By default Emacs will initiate GC every 0.76 MB allocated (<code>gc-cons-threshold</code> == 800,000).</p>
<p>If you have a modern machine, I encourage you to add the following:</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">speed up things by preventing garbage collections</span>
  (setq gc-cons-threshold (* 20 1024 1024)) <span class="org-comment-delimiter">; </span><span class="org-comment">20 MB.</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">don't display messages at start and end of garbage collection (as it hides</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">too many interesting messages)</span>
  (setq garbage-collection-messages nil)
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline410" class="outline-3">
<h3 id="orgheadline410">Variables</h3>
<div class="outline-text-3" id="text-orgheadline410">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 48.3 (info "(emacs)Variables")</span>

  (leuven--section <span class="org-string">"48.3 (emacs)Variables"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">file local variables specifications are obeyed, without query --</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">RISKY!</span>
  (setq enable-local-variables t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">obey `</span><span class="org-constant"><span class="org-comment">eval</span></span><span class="org-comment">' variables -- RISKY!</span>
  (setq enable-local-eval t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">record safe values for some local variables</span>
  (setq safe-local-variable-values
        '((TeX-master . t)
          (ac-sources . (ac-source-words-in-buffer ac-source-dictionary))
          (flycheck-emacs-lisp-initialize-packages . t)
          (flycheck-mode . nil)
          (flyspell-mode . -1)
          (flyspell-mode . 1)
          (ispell-local-dictionary . <span class="org-string">"american"</span>)
          (ispell-local-dictionary . <span class="org-string">"francais"</span>)
          (org-tags-column . -80)       <span class="org-comment-delimiter">; </span><span class="org-comment">org-issues.org</span>
          (outline-minor-mode)
          (whitespace-style face tabs spaces trailing lines
                            space-before-tab::space newline indentation::space
                            empty space-after-tab::space space-mark tab-mark
                            newline-mark)))
</pre></div>
<p>Have a look at (info "(emacs)Directory Variables").</p>
</div>
</div>
<div id="outline-container-orgheadline411" class="outline-3">
<h3 id="orgheadline411">Key Bindings</h3>
<div class="outline-text-3" id="text-orgheadline411">
<p>The keys <code>C-c LETTER</code> are <a href="http://www.gnu.org/software/emacs/manual/html_node/elisp/Key-Binding-Conventions.html">reserved for user functions</a>.</p>
<p>You can get a list of all the disabled functions by typing:</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
M-: (<span class="org-keyword">let</span> (lst) (mapatoms (<span class="org-keyword">lambda</span> (x) (<span class="org-keyword">if</span> (get x 'disabled) (push x lst)))) lst) &lt;RET&gt;
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 48.4 Customizing (info "(emacs)Key Bindings")</span>

  (leuven--section <span class="org-string">"48.4 Customizing (emacs)Key Bindings"</span>)
</pre></div>
<p>See as well Print keybindings (pkb).</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">print the key bindings in a tabular form</span>
  (GNUEmacs
   (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-keytable</span> (arg)
     <span class="org-doc">"Print the key bindings in a tabular form."</span>
     (interactive <span class="org-string">"sEnter a modifier string:"</span>)
     (<span class="org-keyword">with-output-to-temp-buffer</span> <span class="org-string">"*Key table*"</span>
       (<span class="org-keyword">let*</span> ((i 0)
              (keys (list <span class="org-string">"a"</span> <span class="org-string">"b"</span> <span class="org-string">"c"</span> <span class="org-string">"d"</span> <span class="org-string">"e"</span> <span class="org-string">"f"</span> <span class="org-string">"g"</span> <span class="org-string">"h"</span> <span class="org-string">"i"</span> <span class="org-string">"j"</span> <span class="org-string">"k"</span> <span class="org-string">"l"</span>
                          <span class="org-string">"m"</span> <span class="org-string">"n"</span> <span class="org-string">"o"</span> <span class="org-string">"p"</span> <span class="org-string">"q"</span> <span class="org-string">"r"</span> <span class="org-string">"s"</span> <span class="org-string">"t"</span> <span class="org-string">"u"</span> <span class="org-string">"v"</span> <span class="org-string">"w"</span> <span class="org-string">"x"</span>
                          <span class="org-string">"y"</span> <span class="org-string">"z"</span> <span class="org-string">"&lt;return&gt;"</span> <span class="org-string">"&lt;down&gt;"</span> <span class="org-string">"&lt;up&gt;"</span> <span class="org-string">"&lt;right&gt;"</span>
                          <span class="org-string">"&lt;left&gt;"</span> <span class="org-string">"&lt;home&gt;"</span> <span class="org-string">"&lt;end&gt;"</span> <span class="org-string">"&lt;f1&gt;"</span> <span class="org-string">"&lt;f2&gt;"</span> <span class="org-string">"&lt;f3&gt;"</span>
                          <span class="org-string">"&lt;f4&gt;"</span> <span class="org-string">"&lt;f5&gt;"</span> <span class="org-string">"&lt;f6&gt;"</span> <span class="org-string">"&lt;f7&gt;"</span> <span class="org-string">"&lt;f8&gt;"</span> <span class="org-string">"&lt;f9&gt;"</span>
                          <span class="org-string">"&lt;f10&gt;"</span> <span class="org-string">"&lt;f11&gt;"</span> <span class="org-string">"&lt;f12&gt;"</span> <span class="org-string">"1"</span> <span class="org-string">"2"</span> <span class="org-string">"3"</span> <span class="org-string">"4"</span> <span class="org-string">"5"</span> <span class="org-string">"6"</span>
                          <span class="org-string">"7"</span> <span class="org-string">"8"</span> <span class="org-string">"9"</span> <span class="org-string">"0"</span> <span class="org-string">"`"</span> <span class="org-string">"~"</span> <span class="org-string">"!"</span> <span class="org-string">"@"</span> <span class="org-string">"#"</span> <span class="org-string">"$"</span> <span class="org-string">"%"</span> <span class="org-string">"^"</span>
                          <span class="org-string">"&amp;"</span> <span class="org-string">"*"</span> <span class="org-string">"("</span> <span class="org-string">")"</span> <span class="org-string">"-"</span> <span class="org-string">"_"</span> <span class="org-string">"="</span> <span class="org-string">"+"</span> <span class="org-string">"\\"</span> <span class="org-string">"|"</span> <span class="org-string">"{"</span> <span class="org-string">"["</span>
                          <span class="org-string">"]"</span> <span class="org-string">"}"</span> <span class="org-string">";"</span> <span class="org-string">"'"</span> <span class="org-string">":"</span> <span class="org-string">"\""</span> <span class="org-string">"&lt;"</span> <span class="org-string">"&gt;"</span> <span class="org-string">","</span> <span class="org-string">"."</span> <span class="org-string">"/"</span> <span class="org-string">"?"</span>
                          ))
              (n (length keys))
              (modifiers (list <span class="org-string">""</span> <span class="org-string">"S-"</span> <span class="org-string">"C-"</span> <span class="org-string">"M-"</span> <span class="org-string">"M-C-"</span>))
              (k))
         (or (string= arg <span class="org-string">""</span>) (setq modifiers (list arg)))
         (setq k (length modifiers))
         (princ (format <span class="org-string">" %-10.10s |"</span> <span class="org-string">"Key"</span>))
         (<span class="org-keyword">let</span> ((j 0))
           (<span class="org-keyword">while</span> (&lt; j k)
             (princ (format <span class="org-string">" %-28.28s |"</span> (nth j modifiers)))
             (setq j (1+ j))))
         (princ <span class="org-string">"\n"</span>)
         (princ (format <span class="org-string">"_%-10.10s_|"</span> <span class="org-string">"__________"</span>))
         (<span class="org-keyword">let</span> ((j 0))
           (<span class="org-keyword">while</span> (&lt; j k)
             (princ (format <span class="org-string">"_%-28.28s_|"</span>
                            <span class="org-string">"_______________________________"</span>))
             (setq j (1+ j))))
         (princ <span class="org-string">"\n"</span>)
         (<span class="org-keyword">while</span> (&lt; i n)
           (princ (format <span class="org-string">" %-10.10s |"</span> (nth i keys)))
           (<span class="org-keyword">let</span> ((j 0))
             (<span class="org-keyword">while</span> (&lt; j k)
               (<span class="org-keyword">let*</span> ((binding
                       (key-binding (read-kbd-macro
                                     (concat (nth j modifiers)
                                             (nth i keys)))))
                      (binding-string <span class="org-string">"_"</span>))
                 (<span class="org-keyword">when</span> binding
                   (<span class="org-keyword">if</span> (eq binding 'self-insert-command)
                       (setq binding-string (concat <span class="org-string">"'"</span> (nth i keys) <span class="org-string">"'"</span>))
                     (setq binding-string (format <span class="org-string">"%s"</span> binding))))
                 (setq binding-string
                       (substring binding-string 0
                                  (min (length binding-string) 28)))
                 (princ (format <span class="org-string">" %-28.28s |"</span> binding-string))
                 (setq j (1+ j)))))
           (princ <span class="org-string">"\n"</span>)
           (setq i (1+ i)))
         (princ (format <span class="org-string">"_%-10.10s_|"</span> <span class="org-string">"__________"</span>))
         (<span class="org-keyword">let</span> ((j 0))
           (<span class="org-keyword">while</span> (&lt; j k)
             (princ (format <span class="org-string">"_%-28.28s_|"</span>
                            <span class="org-string">"_______________________________"</span>))
             (setq j (1+ j))))))
     (delete-window)
     (setq truncate-lines t)))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Guide the following key bindings automatically and dynamically.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"guide-key-autoloads"</span>
    (idle-require 'guide-key))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"guide-key"</span>

    (setq guide-key/guide-key-sequence
          '(<span class="org-string">"C-c"</span>
            <span class="org-string">"C-h"</span>
            <span class="org-string">"C-x 4"</span>                     <span class="org-comment-delimiter">; </span><span class="org-comment">Other window. OK.</span>
            <span class="org-string">"C-x 5"</span>                     <span class="org-comment-delimiter">; </span><span class="org-comment">Other frame.</span>
            <span class="org-string">"C-x 8"</span>                     <span class="org-comment-delimiter">; </span><span class="org-comment">Unicode. OK.</span>
            <span class="org-string">"C-x RET"</span>                   <span class="org-comment-delimiter">; </span><span class="org-comment">Coding system.</span>
            <span class="org-string">"C-x a"</span>                     <span class="org-comment-delimiter">; </span><span class="org-comment">Abbrev.</span>
            <span class="org-string">"C-x c"</span>                     <span class="org-comment-delimiter">; </span><span class="org-comment">Helm.</span>
            <span class="org-string">"C-x n"</span>                     <span class="org-comment-delimiter">; </span><span class="org-comment">Narrow.</span>
            <span class="org-string">"C-x p"</span>                     <span class="org-comment-delimiter">; </span><span class="org-comment">Bmkp.</span>
            <span class="org-string">"C-x r"</span>                     <span class="org-comment-delimiter">; </span><span class="org-comment">Register + rectangle. OK.</span>
            <span class="org-string">"C-x v"</span>                     <span class="org-comment-delimiter">; </span><span class="org-comment">VC. OK.</span>
            <span class="org-string">"C-x w"</span>                     <span class="org-comment-delimiter">; </span><span class="org-comment">Hi-lock.</span>
            <span class="org-string">"M-g"</span>                       <span class="org-comment-delimiter">; </span><span class="org-comment">Goto + error.</span>
            <span class="org-string">"M-s"</span>                       <span class="org-comment-delimiter">; </span><span class="org-comment">Occur + highlight.</span>
            (org-mode <span class="org-string">"C-c C-x"</span>
                      <span class="org-string">"C-c C-v"</span>)
            (outline-minor-mode <span class="org-string">"C-c @"</span>)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq guide-key/idle-delay 0.3)</span>

    (setq guide-key/recursive-key-sequence-flag t)

    (setq guide-key/popup-window-position 'bottom)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable guide-key-mode.</span>
    (guide-key-mode 1)

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"guide-key"</span>
      (diminish 'guide-key-mode)))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline412" class="outline-3">
<h3 id="orgheadline412">Syntax Table</h3>
<div class="outline-text-3" id="text-orgheadline412">
<p>The syntax table contains information that tells Emacs how to operate on text, words, sentences etc. It will make Emacs know enough about all the symbols in a buffer. Syntax table is used for example for:</p>
<ul class="org-ul">
<li>commands like <code>forward-word</code> (<code>M-f</code>) or <code>backward-kill-word</code> (<code>M-DEL</code>),</li>
<li>spell-checking of words,</li>
<li>expansion commands of abbrevs,</li>
<li>etc.</li>
</ul>
<p>Evaluate <code>current-word</code> and see whether characters such as <code>-</code> and <code>_</code> are considered part of the word (depending on the current major mode).</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 48.5 The (info "(emacs)Syntax") Table</span>

  (leuven--section <span class="org-string">"48.5 The (emacs)Syntax Table"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">now '-' is not considered a word-delimiter</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'emacs-lisp-mode-hook</span>
  <span class="org-comment-delimiter">;;           </span><span class="org-comment">(lambda ()</span>
  <span class="org-comment-delimiter">;;             </span><span class="org-comment">(modify-syntax-entry ?- "w")))</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter 48 ends here</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline413" class="outline-2">
<h2 id="orgheadline413">Emacs Display</h2>
<div class="outline-text-2 org-src-container" id="text-orgheadline413">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* Emacs Display</span>

(leuven--chapter leuven-load-chapter-XX-emacs-display <span class="org-string">"XX Emacs Display"</span>
</pre></div>
<div id="outline-container-orgheadline414" class="outline-3">
<h3 id="orgheadline414">Faces</h3>
<div class="outline-text-3" id="text-orgheadline414">
<p>You can get text properties of any char by typing <code>C-u C-x =</code>.</p>
<p>Under Windows, you can get the current <b>font</b> by typing <code>(w32-select-font)</code> followed by <code>C-x C-e</code>.</p>
<p>You can find the current <b>font string</b> by typing <code>M-x ielm &lt;RET&gt; (frame-parameters) &lt;RET&gt;</code> - see the line <code>font</code>.</p>
<p>To check if some font is available in Emacs do following:</p>
<ol class="org-ol">
<li>Switch to the <code>*scratch*</code> buffer.</li>
<li>
<p>Type</p>
<p><code>(prin1-to-string (x-list-fonts "font-you-want-to-check or pattern"))</code></p>
</li>
<li>Place the cursor after the last closing paren and hit <code>C-j</code>. List of the names of available fonts matching given pattern will appear in the current buffer (<code>*scratch*</code>).</li>
<li>
<p>For listing of all available fonts, use</p>
<p><code>(prin1-to-string (x-list-fonts "*"))</code></p>
<p>or</p>
<p><code>(dolist (i (x-list-fonts "*")) (princ i) (terpri))</code></p>
<p>for a better output.</p>
</li>
</ol>
<p>Under Linux, use the <code>xfontsel</code> utility (or the command-line <code>xlsfonts</code>) to try out different fonts. After choosing a font, click the select button in <code>xfontsel</code> window. This will copy font name you choose to copy &amp; paste buffer.</p>
<p>Now Emacs should start with that font.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(elisp)Faces")</span>

  (leuven--section <span class="org-string">"Faces"</span>)
</pre></div>
<p>For reasons unknown to me, Emacs takes a long time to change fonts in an X environment.</p>
<p>Rather than using <code>(set-default-font ...)</code> in <code>.emacs</code>, stick the font definition in your <code>.Xresources</code> file (key 'Emacs*font') and then use <code>xrdb -load</code> to activate it. You will find that startup time is greatly improved!</p>
<p>Edit your <code>~/.Xresources</code> file to have a line with "Emacs.font". Then do a</p>
<p><code>xrdb -merge ~/.Xresources</code></p>
<p>or restart your X11 to validate the modification. I let Emacs do this for me:</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--merge-x-resources</span> ()
    (<span class="org-keyword">let</span> ((file (file-name-nondirectory (buffer-file-name))))
      (<span class="org-keyword">when</span> (or (string= file <span class="org-string">".Xdefaults"</span>)
                (string= file <span class="org-string">".Xresources"</span>))
        (start-process <span class="org-string">"xrdb"</span> nil <span class="org-string">"xrdb"</span> <span class="org-string">"-merge"</span> (buffer-file-name))
        (message (format <span class="org-string">"Merged %s into X resource database"</span> file)))))

  (add-hook 'after-save-hook 'leuven--merge-x-resources)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">allow any scalable font</span>
  (setq scalable-fonts-allowed t)
</pre></div>
</div>
<div id="outline-container-orgheadline415" class="outline-4">
<h4 id="orgheadline415">UTF-8</h4>
<div class="outline-text-4" id="text-orgheadline415">
<p>Fonts that have a good UTF-8 coverage are:</p>
<ul class="org-ul">
<li>DejaVu Sans Mono</li>
<li>FreeMono (FreeSans, FreeSerif)</li>
<li>Monospace</li>
</ul>
<p>None of them has all four variants, some have regular (medium) and bold or light and regular, one regular and oblique.</p>
</div>
</div>
<div id="outline-container-orgheadline416" class="outline-4">
<h4 id="orgheadline416">Anti-aliasing</h4>
<div class="outline-text-4" id="text-orgheadline416">
<p>To see if anti-aliasing is active, use <code>xmag</code> (under Linux) or any of the other magnifier applications. The fonts should have gray edges.</p>
</div>
</div>
<div id="outline-container-orgheadline417" class="outline-4">
<h4 id="orgheadline417">Adjust the height of the default face</h4>
<div class="outline-text-4" id="text-orgheadline417">
<p>There are a few commands to adjust the font sizes:</p>
<dl class="org-dl">
<dt><code>C-x C-+</code></dt>
<dd>Increase the default face height by one step.</dd>
<dt><code>C-x C--</code></dt>
<dd>Decrease the default face height by one step.</dd>
<dt><code>C-x C-0</code></dt>
<dd>Resets to defaults.</dd>
</dl>
<p>Those bindings are global and repeatable, e.g. <code>C-x C-+ C-+ C-+</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (define-key global-map (kbd <span class="org-string">"C-+"</span>) 'text-scale-increase)
  (define-key global-map (kbd <span class="org-string">"C--"</span>) 'text-scale-decrease)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
)
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline282" class="outline-3">
<h3 id="orgheadline282"><a id="ID-9432da83-fa9d-4466-a4da-57f33d662bbd" name="ID-9432da83-fa9d-4466-a4da-57f33d662bbd"></a>Images</h3>
<div class="outline-text-3" id="text-orgheadline282">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">** 38.16 (info "(elisp)Images")</span>
</pre></div>
<p>How do I get image support? See <code>image-library-alist</code>, a list of image types vs. external libraries needed to display them.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(describe-variable 'image-library-alist)
</pre></div>
<div class="note">
<p>You can download the corresponding dlls from ezwinports <a href="http://sourceforge.net/projects/ezwinports/files/">http://sourceforge.net/projects/ezwinports/files/</a> and put them into emacs's `bin` directory.</p>
<p>There are some instructions in the "Image support" part on page <a href="https://ftp.gnu.org/gnu/emacs/windows/">https://ftp.gnu.org/gnu/emacs/windows/</a>.</p>
</div>
<p>If you use compiled Emacs binaries (available on the <a href="http://ftp.gnu.org/gnu/emacs/windows/">GNU Website</a>), eventually, copy those DLLs (<code>libpng16.dll</code>, for example) from an old EmacsW32 installation to your Emacs <code>bin</code> directory, and restart Emacs for image support to be enabled.</p>
<p>If you use Cygwin Emacs, install <code>libpng</code> via Cygwin as well.</p>
<p>You can do:</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(image-type-available-p 'png)
</pre></div>
<p>to check if you have <code>png</code> image support in your Emacs.</p>
<p><code>image-library-alist</code> maps image type to a list of dlls which support it.</p>
<p>To check all image libraries at once:</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(mapcar (<span class="org-keyword">lambda</span> (elt)
          (list (car elt) (image-type-available-p (car elt))))
        dynamic-library-alist)
</pre></div>
<p>If missing image libraries bother you, read <code>README.W32</code> (or <code>nt/INSTALL</code>).</p>
<p>For animated GIF (or multi-page TIFF):</p>
<ul class="org-ul">
<li><code>f</code> steps through image frame frame, and</li>
<li><code>RET</code> animates.</li>
</ul>
<p>No need for ImageMagick.</p>
</div>
</div>
</div>
<div id="outline-container-orgheadline418" class="outline-2">
<h2 id="orgheadline418">Calc</h2>
<div class="outline-text-2" id="text-orgheadline418">
<p><code>C-x *</code> invokes the GNU Emacs Calculator.</p>
</div>
<div id="outline-container-orgheadline421" class="outline-3">
<h3 id="orgheadline421">Introduction</h3>
<div class="outline-text-3" id="text-orgheadline421"></div>
<div id="outline-container-orgheadline419" class="outline-4">
<h4 id="orgheadline419">Basic Commands</h4>
<div class="outline-text-4" id="text-orgheadline419">
<p>Start the Calc: <code>C-x * c</code>.</p>
</div>
</div>
<div id="outline-container-orgheadline420" class="outline-4">
<h4 id="orgheadline420">"Quick Calculator" Mode</h4>
<div class="outline-text-4" id="text-orgheadline420">
<p>Run the Calculator in the minibuffer: <code>C-x * q</code> (<code>M-x quick-calc</code>).</p>
</div>
</div>
</div>
<div id="outline-container-orgheadline422" class="outline-3">
<h3 id="orgheadline422">Embedded Mode</h3>
<div class="outline-text-3" id="text-orgheadline422">
<p>Try the Embedded mode of Calc: <code>C-x * e</code> (no need to mark the region).</p>
<p>Similar commands: in place of <code>e</code>,</p>
<dl class="org-dl">
<dt><code>w</code></dt>
<dd>Start Embedded mode on the current "word".</dd>
<dt><code>j</code></dt>
<dd>Operate on <b>assignments</b>.</dd>
</dl>
<p>You need to type <code>C-x * e</code> again to exit the Embedded mode.</p>
</div>
</div>
</div>
<div id="outline-container-orgheadline423" class="outline-2">
<h2 id="orgheadline423">IRC client for Emacs</h2>
<div class="outline-text-2" id="text-orgheadline423">
<p>See <a href="http://en.wikipedia.org/wiki/List_of_IRC_commands">List of Internet Relay Chat commands</a>:</p>
<ul class="org-ul">
<li><code>/whois</code></li>
<li><code>/leave</code></li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* Emacs IRC client</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Other IRC for Emacs: rcirc, circe, bitlbee, liece, riece, zenirc, erc</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Circe is advised by Tassilo (contributor)</span>

  (autoload 'circe <span class="org-string">"circe"</span>
    <span class="org-doc">"Connect to an IRC server."</span> t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">connect to the Freenode network</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-irc-connect</span> ()
    <span class="org-doc">"Connect to Freenode."</span>
    (interactive)
    (circe <span class="org-string">"irc.freenode.net"</span> <span class="org-string">"6667"</span> <span class="org-string">"freenode"</span>))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">... upon hitting `C-c i'</span>
  (global-set-key (kbd <span class="org-string">"C-c i"</span>)
    (<span class="org-keyword">lambda</span> ()
      (interactive)
      (switch-or-start 'leuven-irc-connect <span class="org-string">"irc.freenode.net:6667"</span>)))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"circe"</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 1 Basics</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">default channels to join whenever connecting to Freenode</span>
    (setq circe-server-auto-join-channels
          '((<span class="org-string">"^freenode$"</span>
             <span class="org-string">"#emacs"</span>
             <span class="org-comment-delimiter">;; </span><span class="org-comment">"#gnus"</span>
             <span class="org-comment-delimiter">;; </span><span class="org-comment">"#latex"</span>
             <span class="org-comment-delimiter">;; </span><span class="org-comment">"#ledger"</span>
             <span class="org-string">"#org-mode"</span>
             <span class="org-comment-delimiter">;; </span><span class="org-comment">"#stumpwm"</span>
             <span class="org-comment-delimiter">;; </span><span class="org-comment">"#zsh"</span>
             <span class="org-comment-delimiter">;; </span><span class="org-comment">"#xemacs"</span>
             )))

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 2 Reference</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">*** 2.3 Configuration</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">default nick</span>
    (setq circe-default-nick <span class="org-string">"johndoe"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">your "real name" on IRC</span>
    (setq circe-default-realname <span class="org-string">"John Doe"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">authentication info</span>
    (setq freenode-passwd <span class="org-string">""</span>)
    (setq circe-nickserv-passwords
          `((<span class="org-string">"freenode"</span> ,freenode-passwd)))

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 3 Fighting Information Overload</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">*** 3.1 Channels</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">When other people say things in buffers that are currently buried (no</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">window is showing them), the mode line will now show you the abbreviated</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">channel or nick name.  Use `C-c C-SPC' to switch to these buffers.</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">*** 3.3 Keywords</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">list of keywords to highlight</span>
    (setq lui-highlight-keywords
          '(
            <span class="org-comment-delimiter">;; </span><span class="org-comment">"[</span><span class="org-negation-char"><span class="org-comment">^</span></span><span class="org-comment">&lt;]vauban"</span>
            <span class="org-string">"org"</span> <span class="org-string">"beamer"</span> <span class="org-string">"ledger"</span> <span class="org-string">"tikz"</span>))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">add IRC color support to LUI</span>
    (try-require 'lui-irc-colors)
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"lui-irc-colors"</span>
      (add-to-list 'lui-pre-output-hook 'lui-irc-colors))

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 4 Hacking and Tweaking</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">*** 4.2 Using fly spell mode</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">check if `</span><span class="org-constant"><span class="org-comment">ispell-program-name</span></span><span class="org-comment">' seems correct</span>
    (<span class="org-keyword">when</span> (leuven--ispell-check-program-name)
      (setq lui-flyspell-p t)
      (setq lui-flyspell-alist '((<span class="org-string">"."</span> <span class="org-string">"american"</span>))))

<span class="org-comment-delimiter">;;</span><span class="org-comment">** Others</span>

    (setq circe-highlight-nick-type 'occurrence)

    (try-require 'circe-highlight-all-nicks)
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"circe-highlight-all-nicks"</span>
      (enable-circe-highlight-all-nicks))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">format for messages to queries or channels</span>
    (setq circe-format-self-say <span class="org-string">"&lt;{nick}&gt; {body}"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">truncate the buffer (at the top) if it grows too much</span>
    (setq lui-max-buffer-size 30000)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">column at which Lui should break output</span>
    (setq lui-fill-column fill-column)

    )                                   <span class="org-comment-delimiter">; </span><span class="org-comment">with-eval-after-load "circe" ends here</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Jabber (GTalk)</span>
  (try-require 'jabber-autoloads-<span class="org-leuven-highlight">XXX</span>)
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"jabber-autoloads-</span><span class="org-leuven-highlight"><span class="org-string">XXX</span></span><span class="org-string">"</span>
    (setq jabber-account-list '((<span class="org-string">"johndoe@example.com"</span>
                                 (<span class="org-builtin">:network-server</span> . <span class="org-string">"talk.google.com"</span>)
                                 (<span class="org-builtin">:connection-type</span> . ssl)
                                 (<span class="org-builtin">:port</span> . 443))))

    (setq jabber-history-enabled t)

    (setq jabber-use-global-history nil)

    (setq jabber-history-dir (concat user-emacs-directory <span class="org-string">"jabber"</span>))

    (setq jabber-vcard-avatars-retrieve nil)

    (setq jabber-chat-buffer-show-avatar nil))
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline424" class="outline-2">
<h2 id="orgheadline424">Emacs and Microsoft Windows/MS-DOS</h2>
<div class="outline-text-2" id="text-orgheadline424">
<p>Eventually have a look as well at <code>input-decode-map</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* App G Emacs and (info "(emacs)Microsoft Windows/MS-DOS")</span>

(leuven--chapter leuven-load-chapter-AppG-ms-dos <span class="org-string">"Appendix G Emacs and MS-DOS"</span>
</pre></div>
<p>Use the Caps Lock key as Ctrl:</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; read the Caps Lock key as &lt;capslock&gt;</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq w32-enable-caps-lock nil)</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; map the Caps Lock key to Control</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key function-key-map (kbd "&lt;capslock&gt;") 'event-apply-control-modifier)</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  <span class="org-comment-delimiter">;; </span><span class="org-comment">divide key (needed in GNU Emacs for Windows)</span>
  (GNUEmacs
    (global-set-key (kbd <span class="org-string">"&lt;kp-divide&gt;"</span>) (kbd <span class="org-string">"/"</span>)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">numeric keypad (needed in XEmacs for Windows)</span>
  (XEmacs
    <span class="org-comment-delimiter">;; </span><span class="org-comment">keys to the right of the regular keyboard</span>
    (define-key key-translation-map [kp-divide]     [?/])
    (define-key key-translation-map [kp-multiply]   [?*])
    (define-key key-translation-map [kp-subtract]   [?-])
    (define-key key-translation-map [kp-add]        [?+])
    (define-key key-translation-map [kp-enter]     [?\r])
    (define-key key-translation-map [kp-decimal]    [?.])

    <span class="org-comment-delimiter">;; </span><span class="org-comment">keys with digits</span>
    (define-key key-translation-map [kp-0]          [?0])
    (define-key key-translation-map [kp-1]          [?1])
    (define-key key-translation-map [kp-2]          [?2])
    (define-key key-translation-map [kp-3]          [?3])
    (define-key key-translation-map [kp-4]          [?4])
    (define-key key-translation-map [kp-5]          [?5])
    (define-key key-translation-map [kp-6]          [?6])
    (define-key key-translation-map [kp-7]          [?7])
    (define-key key-translation-map [kp-8]          [?8])
    (define-key key-translation-map [kp-9]          [?9])

    <span class="org-comment-delimiter">;; </span><span class="org-comment">additional keypad duplicates of keys ordinarily found elsewhere</span>
    (define-key key-translation-map [kp-left]     [left])
    (define-key key-translation-map [kp-right]   [right])
    (define-key key-translation-map [kp-up]         [up])
    (define-key key-translation-map [kp-down]     [down])
    (define-key key-translation-map [kp-begin]   [begin])
    (define-key key-translation-map [kp-home]     [home])
    (define-key key-translation-map [kp-end]       [end])
    (define-key key-translation-map [kp-next]     [next])
    (define-key key-translation-map [kp-prior]   [prior])
    (define-key key-translation-map [kp-insert] [insert])
    (define-key key-translation-map [kp-delete] [delete]))

)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">chapter G ends here</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline425" class="outline-2">
<h2 id="orgheadline425">Profiler</h2>
<div class="outline-text-2 org-src-container" id="text-orgheadline425">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;;</span><span class="org-comment">* Profiler</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"profiler"</span>

    (setq profiler-report-cpu-line-format
      '((100 left)                      <span class="org-comment-delimiter">; </span><span class="org-comment">The 100 above is increased from the</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">default of 50 to allow the deeply</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">nested call tree to be seen.</span>
        (24 right ((19 right)
                   (5 right))))))
</pre></div>
</div>
<div id="outline-container-orgheadline426" class="outline-2">
<h2 id="orgheadline426">Reporting Bugs</h2>
<div class="outline-text-2" id="text-orgheadline426">
<p>To get a backtrace when a specific regexp is displayed in the echo area (through calls to message), set the variable <code>debug-on-message</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;; </span><span class="org-comment">Recovery from Problems</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">* Reporting Bugs</span>

(leuven--chapter leuven-load-chapter-99-debugging <span class="org-string">"99 Debugging"</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">get the backtrace when uncaught errors occur</span>
  (setq debug-on-error nil)             <span class="org-comment-delimiter">; </span><span class="org-comment">was set to `t' at beginning of file</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">hit `</span><span class="org-constant"><span class="org-comment">C-g</span></span><span class="org-comment">' while it's frozen to get an Emacs Lisp backtrace</span>
  (setq debug-on-quit nil)              <span class="org-comment-delimiter">; </span><span class="org-comment">was set to `t' at beginning of file</span>

  (setq debug-on-entry 'user-error))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">when</span> (and (string-match <span class="org-string">"GNU Emacs"</span> (version))
           leuven-load-verbose)
  (ad-disable-advice 'message 'before 'leuven-when-was-that)
  (ad-update 'message))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">when</span> leuven-load-verbose
  (message <span class="org-string">"| Chapter | Time |"</span>)
  (message <span class="org-string">"|---------+------|"</span>)
  (mapcar (<span class="org-keyword">lambda</span> (el)                  <span class="org-comment-delimiter">; </span><span class="org-leuven-highlight"><span class="org-comment">FIXME</span></span><span class="org-comment"> use mapc or dolist</span>
            (message el))
          (nreverse leuven--load-times-list))
  (message <span class="org-string">"|---------+------|"</span>)
  (message <span class="org-string">"|         | =vsum(@-I..@-II) |"</span>))
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(message <span class="org-string">"Loading `</span><span class="org-constant"><span class="org-string">%s</span></span><span class="org-string">'...done (in %.3f s)"</span>
         load-file-name
         (- (float-time) leuven--before-time))
(sit-for 0.3)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">let</span> ((elapsed (float-time (time-subtract (current-time)
                                          emacs-start-time))))
  (message <span class="org-string">"Loading `</span><span class="org-constant"><span class="org-string">%s</span></span><span class="org-string">'... loaded in %.3f s"</span> load-file-name elapsed))

(add-hook 'after-init-hook
          `(<span class="org-keyword">lambda</span> ()
             (<span class="org-keyword">let</span> ((elapsed (float-time (time-subtract (current-time)
                                                       emacs-start-time))))
               (message <span class="org-string">"Loading %s...done (%.3fs) [after-init]"</span>
                        ,load-file-name elapsed)))
  t)
</pre></div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;; </span><span class="org-comment">(message "Emacs startup time: %s" (emacs-init-time))</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline427" class="outline-2">
<h2 id="orgheadline427">Leuven</h2>
<div class="outline-text-2" id="text-orgheadline427">
<p>If you are like me, you want to know if there are:</p>
<ul class="org-ul">
<li>changes to existing files</li>
<li>newly added files</li>
<li>deleted files</li>
</ul>
<p>and specifically do not want to know about <b>untracked files</b>.</p>
<p>This should do it:</p>
<p>git status -untracked-files=no -porcelain</p>
<p>See <a href="https://github.com/mordocai/.emacs.d/blob/master/init.el">https://github.com/mordocai/.emacs.d/blob/master/init.el</a> for many Git functions implemented in Emacs Lisp.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-update</span> ()
    <span class="org-doc">"Update Leuven Emacs Config to its latest version."</span>
    (interactive)
    (leuven-emacs-version)
    (message <span class="org-string">"Updating Leuven..."</span>)
    (cd leuven--directory)
    (<span class="org-keyword">let</span> ((ret (shell-command-to-string <span class="org-string">"LC_ALL=C git pull --rebase"</span>)))
      (<span class="org-keyword">if</span> (string-match <span class="org-string">"</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">(</span></span><span class="org-string">up to date</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">|</span></span><span class="org-string">up-to-date</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">)</span></span><span class="org-string">"</span> ret)
          (message <span class="org-string">"Configuration already up-to-date."</span>)
        (princ ret)
        (sit-for 3)
        (message <span class="org-string">"Configuration updated. Restart Emacs to complete the process."</span>))))

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-show-latest-commits</span> ()
    <span class="org-doc">"List latest changes in Leuven Emacs Config."</span>
    (interactive)
    (leuven-emacs-version)
    (message <span class="org-string">"Fetching last changes in Leuven..."</span>)
    (cd leuven--directory)
    (<span class="org-keyword">let</span> ((ret (shell-command-to-string <span class="org-string">"LC_ALL=C git fetch --verbose"</span>))
          (bufname <span class="org-string">"*Leuven latest commits*"</span>))
      (<span class="org-keyword">if</span> (string-match <span class="org-string">"</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">(</span></span><span class="org-string">up to date</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">|</span></span><span class="org-string">up-to-date</span><span class="org-regexp-grouping-backslash"><span class="org-string">\\</span></span><span class="org-regexp-grouping-construct"><span class="org-string">)</span></span><span class="org-string">"</span> ret)
          (message <span class="org-string">"Configuration already up-to-date."</span>)
       (<span class="org-keyword">with-output-to-temp-buffer</span> bufname
         (shell-command
          <span class="org-string">"LC_ALL=C git log --pretty=format:'%h %ad %s' --date=short HEAD..origin"</span>
          bufname)
         (pop-to-buffer bufname)))))

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-emacs-version</span> ()
    (interactive)
    (message <span class="org-string">"Leuven Emacs Config version %s"</span> leuven--emacs-version))
</pre></div>
<p>Please address particular issues or suggestions <b>specifically</b>, using <code>M-x leuven-send-bug-report</code>.</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(message <span class="org-string">"* --[ Loaded Leuven Emacs Config %s]--"</span> leuven--emacs-version)
</pre></div>
</div>
<div id="outline-container-orgheadline428" class="outline-3">
<h3 id="orgheadline428">Feature</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline428">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">provide</span> '<span class="org-constant">emacs-leuven</span>)
</pre></div>
</div>
<div id="outline-container-orgheadline429" class="outline-3">
<h3 id="orgheadline429">File Local Variables</h3>
<div class="outline-text-3 org-src-container" id="text-orgheadline429">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;; </span><span class="org-comment">This is for the sake of Emacs.</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Local Variables:</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">coding: utf-8-unix</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">eval: (when (require 'rainbow-mode nil t) (rainbow-mode))</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">flycheck-emacs-lisp-initialize-packages: t</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">flycheck-mode: nil</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">ispell-local-dictionary: "american"</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">End:</span>

<span class="org-comment-delimiter">;;; </span><span class="org-comment">emacs-leuven.el ends here</span>
</pre></div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Fabrice Niessen</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
